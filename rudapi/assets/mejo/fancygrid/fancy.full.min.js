/*
All of the code within the FancyGrid software is developed and copyrighted by FancyGrid, Inc., and may not be copied,
replicated, or used in any other software or application without prior permission from FancyGrid. All usage must coincide with the
FancyGrid End User License Agreement which can be requested by email at support@fancygrid.com.

Build: 1.6.20
*/

var Fancy={global:this,version:"1.6.20",site:"fancygrid.com",COLORS:["#9DB160","#B26668","#4091BA","#8E658E","#3B8D8B","#ff0066","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"]};Fancy.apply=function(a,b){if(void 0!==b)for(var c in b)a[c]=b[c]},Fancy.applyIf=function(a,b){for(var c in b)void 0===a[c]&&(a[c]=b[c])},Fancy.namespace=function(){for(var a=0,b=arguments.length;a<b;a++){var c=arguments[a],d=c.split("."),e=1,f=d.length;Fancy.global[d[0]]=Fancy.global[d[0]]||{};for(var g=Fancy.global[d[0]];e<f;e++)g[d[e]]=g[d[e]]||{},g=g[d[e]]}},Fancy.ns=Fancy.namespace,Fancy.typeOf=function(a){if(null===a)return"null";var b=typeof a;if("undefined"===b||"string"===b||"number"===b||"boolean"===b)return b;var c=Object.prototype.toString,d=c.call(a);if(void 0!==a.length&&"function"!=typeof a)return"array";switch(d){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===b?"function":"object"===b?"object":void 0},Fancy.isArray="isArray"in Array?Array.isArray:function(a){var b=Object.prototype.toString;return"[object Array]"===b.call(a)},Fancy.isObject=function(a){var b=Object.prototype.toString;return"[object Object]"===b.call(a)},Fancy.isFunction=function(a){var b=Object.prototype.toString;return"[object Function]"===b.apply(a)},Fancy.isString=function(a){return"string"==typeof a},Fancy.isNumber=function(a){return"number"==typeof a&&isFinite(a)},Fancy.isBoolean=function(a){return"boolean"==typeof a},Fancy.isDate=function(a){return"date"===Fancy.typeOf(a)},Fancy.each=function(a,b){switch(Fancy.typeOf(a)){case"array":case"string":for(var c=0,d=a.length;c<d&&!0!==b(a[c],c,a);c++);break;case"object":for(var e in a)if(!0===b(a[e],e,a))break}},Fancy.mixin=function(a,b){var c=0,d=b.length;if("object"===Fancy.typeOf(b[0]))for(;c<d;c++)for(var e=b[c],f=e._class,g=e.methods,h=0,i=g.length;h<i;h++){var j=g[h];a[j]=f.prototype[j]}else for(;c<d;c++){var e=b[c];if(Fancy.isString(e)){var k=Fancy.ClassManager.getMixin(e);k?Fancy.apply(a,k.prototype):Fancy.ClassManager.waitMixin(e,a)}else Fancy.apply(a,e.prototype)}},Fancy.Mixin=function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];d<e;d++)f=f[c[d]];c.length>1?(f[c[c.length-1]]=function(){},f[c[c.length-1]].prototype=b):(Fancy.global[c[0]]=function(){},Fancy.global[c[0]].prototype=b);var g=Fancy.ClassManager.waitMixins[a];if(g){g=g.waiters;for(var d=0,e=g.length;d<e;d++)Fancy.apply(g[d],b)}},Fancy.applyConfig=function(a,b){var c,b=b||{};if(a.plugins&&b.plugins&&(a.plugins=a.plugins.concat(b.plugins),delete b.plugins),!0===a._isConfigApplied)return a;for(c in b)a[c]=b[c];return a._isConfigApplied=!0,a},Fancy.styleToString=function(a){var b="";a=a||{};for(var c in a)b+=c+": "+a[c]+";";return b},Fancy.apply(Fancy,{prefix:"fancy-gen-",idSeed:0,zIndex:1,id:function(a,b){return a?(a=a.dom||{},a.id||(a.id=(b||Fancy.prefix)+ ++Fancy.idSeed),a.id):(b||Fancy.prefix)+ ++Fancy.idSeed}}),Fancy.apply(Fancy,{cls:"fancy",TOUCH_CLS:"fancy-touch",HIDDEN_CLS:"fancy-display-none",CLEARFIX_CLS:"fancy-clearfix",MODAL_CLS:"fancy-modal",PANEL_CLS:"fancy-panel",PANEL_BODY_CLS:"fancy-panel-body",PANEL_BODY_INNER_CLS:"fancy-panel-body-inner",PANEL_GRID_INSIDE_CLS:"fancy-panel-grid-inside",PANEL_SHADOW_CLS:"fancy-panel-shadow",PANEL_SUB_HEADER_CLS:"fancy-panel-sub-header",PANEL_SUB_HEADER_TEXT_CLS:"fancy-panel-sub-header-text",PANEL_HEADER_CLS:"fancy-panel-header",PANEL_HEADER_IMG_CLS:"fancy-panel-header-img",PANEL_HEADER_TEXT_CLS:"fancy-panel-header-text",PANEL_HEADER_TOOLS_CLS:"fancy-panel-header-tools",PANEL_TBAR_CLS:"fancy-panel-tbar",PANEL_BBAR_CLS:"fancy-panel-bbar",PANEL_SUB_TBAR_CLS:"fancy-panel-sub-tbar",PANEL_BUTTONS_CLS:"fancy-panel-buttons",PANEL_NOFRAME_CLS:"fancy-panel-noframe",PANEL_FOOTER_CLS:"fancy-panel-footer",PANEL_TAB_CLS:"fancy-panel-tab",PANEL_DRAGGABLE_CLS:"fancy-panel-draggable",BAR_CLS:"fancy-bar",BAR_TEXT_CLS:"fancy-bar-text",BAR_CONTAINER_CLS:"fancy-bar-container",BAR_BUTTON_CLS:"fancy-bar-button",BAR_SEG_BUTTON_CLS:"fancy-bar-seg-button",BAR_LEFT_SCROLLER_CLS:"fancy-bar-left-scroller",BAR_RIGHT_SCROLLER_CLS:"fancy-bar-right-scroller",FORM_CLS:"fancy-form",FORM_BODY_CLS:"fancy-form-body",FIELD_CLS:"fancy-field",FIELD_LABEL_CLS:"fancy-field-label",FIELD_EMPTY_CLS:"fancy-field-empty",FIELD_BLANK_ERR_CLS:"fancy-field-blank-err",FIELD_NOT_VALID_CLS:"fancy-field-not-valid",FIELD_TEXT_CLS:"fancy-field-text",FIELD_TEXT_INPUT_CLS:"fancy-field-text-input",FIELD_ERROR_CLS:"fancy-field-error",FIELD_SPIN_CLS:"fancy-field-spin",FIELD_SPIN_UP_CLS:"fancy-field-spin-up",FIELD_SPIN_DOWN_CLS:"fancy-field-spin-down",FIELD_CHECKBOX_CLS:"fancy-field-checkbox",FIELD_CHECKBOX_INPUT_CLS:"fancy-field-checkbox-input",FIELD_CHECKBOX_ON_CLS:"fancy-checkbox-on",FIELD_INPUT_LABEL_CLS:"fancy-field-input-label",FIELD_BUTTON_CLS:"fancy-field-button",FIELD_TAB_CLS:"fancy-field-tab",FIELD_COMBO_CLS:"fancy-combo",FIELD_SEARCH_CLS:"fancy-field-search",FIELD_SEARCH_LIST_CLS:"fancy-field-search-list",FIELD_SEARCH_PARAMS_LINK_CLS:"fancy-field-search-params-link",FIELD_SEARCH_PARAMED_CLS:"fancy-field-search-paramed",FIELD_SEARCH_PARAMED_EMPTY_CLS:"fancy-field-search-paramed-empty",FIELD_PICKER_BUTTON_CLS:"fancy-field-picker-button",FIELD_LABEL_ALIGN_TOP_CLS:"fancy-field-label-align-top",FIELD_LABEL_ALIGN_RIGHT_CLS:"fancy-field-label-align-right",FIELD_TEXTAREA_CLS:"fancy-textarea",FIELD_TEXTAREA_TEXT_CLS:"fancy-textarea-text",FIELD_TEXTAREA_TEXT_INPUT_CLS:"fancy-textarea-text-input",FIELD_RADIO_CLS:"fancy-field-radio",FIELD_RADIO_COLUMN_CLS:"fancy-field-radio-column",FIELD_RADIO_ON_CLS:"fancy-field-radio-on",FIELD_RADIO_INPUT_CLS:"fancy-field-radio-input",FIELD_TAB_ACTIVE_CLS:"fancy-field-tab-active",GRID_CLS:"fancy-grid",GRID_UNSELECTABLE_CLS:"fancy-grid-unselectable",GRID_EMPTY_CLS:"fancy-grid-empty-text",GRID_LEFT_EMPTY_CLS:"fancy-grid-left-empty",GRID_RIGHT_EMPTY_CLS:"fancy-grid-right-empty",GRID_CENTER_CLS:"fancy-grid-center",GRID_LEFT_CLS:"fancy-grid-left",GRID_RIGHT_CLS:"fancy-grid-right",GRID_RESIZER_LEFT_CLS:"fancy-grid-resizer-left",GRID_RESIZER_RIGHT_CLS:"fancy-grid-resizer-right",GRID_STATE_DRAG_COLUMN_CLS:"fancy-grid-state-drag-column",GRID_STATE_RESIZE_COLUMN_CLS:"fancy-grid-state-resize-column",GRID_HEADER_CLS:"fancy-grid-header",GRID_HEADER_CELL_CLS:"fancy-grid-header-cell",GRID_HEADER_CELL_CONTAINER_CLS:"fancy-grid-header-cell-container",GRID_HEADER_CELL_TEXT_CLS:"fancy-grid-header-cell-text",GRID_HEADER_CELL_DOUBLE_CLS:"fancy-grid-header-cell-double",GRID_HEADER_CELL_TRIPLE_CLS:"fancy-grid-header-cell-triple",GRID_HEADER_CELL_TRIGGER_CLS:"fancy-grid-header-cell-trigger",GRID_HEADER_CELL_TRIGGER_IMAGE_CLS:"fancy-grid-header-cell-trigger-image",GRID_HEADER_CELL_TRIGGER_DISABLED_CLS:"fancy-grid-header-cell-trigger-disabled",GRID_HEADER_CELL_GROUP_LEVEL_1_CLS:"fancy-grid-header-cell-group-level-1",GRID_HEADER_CELL_GROUP_LEVEL_2_CLS:"fancy-grid-header-cell-group-level-2",GRID_HEADER_CELL_SELECT_CLS:"fancy-grid-header-cell-select",GRID_HEADER_CELL_TRIGGER_UP_CLS:"fancy-grid-header-cell-trigger-up",GRID_HEADER_CELL_TRIGGER_DOWN_CLS:"fancy-grid-header-cell-trigger-down",GRID_HEADER_COLUMN_TRIGGERED_CLS:"fancy-gridf-header-column-triggered",GRID_HEADER_CELL_FILTER_CLS:"fancy-grid-header-filter-cell",GRID_HEADER_CELL_FILTER_FULL_CLS:"fancy-grid-header-filter-cell-full",GRID_HEADER_CELL_FILTER_SMALL_CLS:"fancy-grid-header-filter-cell-small",GRID_CELL_CLS:"fancy-grid-cell",GRID_CELL_INNER_CLS:"fancy-grid-cell-inner",GRID_CELL_OVER_CLS:"fancy-grid-cell-over",GRID_CELL_SELECTED_CLS:"fancy-grid-cell-selected",GRID_CELL_EVEN_CLS:"fancy-grid-cell-even",GRID_CELL_WRAPPER_CLS:"fancy-grid-cell-wrapper",GRID_CELL_DIRTY_CLS:"fancy-grid-cell-dirty",GRID_CELL_DIRTY_EL_CLS:"fancy-grid-cell-dirty-el",GRID_PSEUDO_CELL_CLS:"fancy-grid-pseudo-cell",GRID_COLUMN_CLS:"fancy-grid-column",GRID_COLUMN_OVER_CLS:"fancy-grid-column-over",GRID_COLUMN_SELECT_CLS:"fancy-grid-column-select",GRID_COLUMN_SELECTED_CLS:"fancy-grid-column-selected",GRID_COLUMN_ELLIPSIS_CLS:"fancy-grid-column-ellipsis",GRID_COLUMN_ORDER_CLS:"fancy-grid-column-order",GRID_COLUMN_TEXT_CLS:"fancy-grid-column-text",GRID_COLUMN_SORT_ASC:"fancy-grid-column-sort-ASC",GRID_COLUMN_SORT_DESC:"fancy-grid-column-sort-DESC",GRID_COLUMN_COLOR_CLS:"fancy-grid-column-color",GRID_COLUMN_RESIZER_CLS:"fancy-grid-column-resizer",GRID_COLUMN_SPARKLINE_CLS:"fancy-grid-column-sparkline",GRID_COLUMN_SPARKLINE_BULLET_CLS:"fancy-grid-column-sparkline-bullet",GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS:"fancy-grid-column-spark-progress-donut",GRID_COLUMN_CHART_CIRCLE_CLS:"fancy-grid-column-chart-circle",GRID_COLUMN_GROSSLOSS_CLS:"fancy-grid-column-grossloss",GRID_COLUMN_PROGRESS_CLS:"fancy-grid-column-progress",GRID_COLUMN_PROGRESS_BAR_CLS:"fancy-grid-column-progress-bar",GRID_COLUMN_H_BAR_CLS:"fancy-grid-column-h-bar",GRID_COLUMN_ACTION_ITEM_CLS:"fancy-grid-column-action-item",GRID_ROW_OVER_CLS:"fancy-grid-cell-over",GRID_ROW_EDIT_CLS:"fancy-grid-row-edit",GRID_ROW_EDIT_BUTTONS_CLS:"fancy-grid-row-edit-buttons",GRID_ROW_EDIT_BUTTON_UPDATE_CLS:"fancy-edit-row-button-update",GRID_ROW_EDIT_BUTTON_CANCEL_CLS:"fancy-edit-row-button-cancel",GRID_ROW_GROUP_CLS:"fancy-grid-group-row",GRID_ROW_GROUP_INNER_CLS:"fancy-grid-group-row-inner",GRID_ROW_GROUP_COLLAPSED_CLS:"fancy-grid-group-row-collapsed",GRID_ROW_SUMMARY_CLS:"fancy-grid-summary-row",GRID_ROW_SUMMARY_CONTAINER_CLS:"fancy-grid-summary-container",GRID_ROW_SUMMARY_BOTTOM_CLS:"fancy-grid-summary-row-bottom",GRID_ROW_EXPAND_CLS:"fancy-grid-expand-row",GRID_ROW_EXPAND_OVER_CLS:"fancy-grid-expand-row-over",GRID_ROW_EXPAND_SELECTED_CLS:"fancy-grid-expand-row-selected",GRID_BODY_CLS:"fancy-grid-body",MENU_CLS:"fancy-menu",MENU_ITEM_CLS:"fancy-menu-item",MENU_ITEM_IMAGE_CLS:"fancy-menu-item-image",MENU_ITEM_TEXT_CLS:"fancy-menu-item-text",MENU_ITEM_ACTIVE_CLS:"fancy-menu-item-active",MENU_ITEM_RIGHT_IMAGE_CLS:"fancy-menu-item-right-image",MENU_ITEM_EXPAND_CLS:"fancy-menu-item-expand",TAB_WRAPPER_CLS:"fancy-tab-wrapper",TAB_ACTIVE_WRAPPER_CLS:"fancy-active-tab-wrapper",TAB_TBAR_CLS:"fancy-toolbar-tab",TAB_TBAR_ACTIVE_CLS:"fancy-toolbar-tab-active",BUTTON_CLS:"fancy-button",BUTTON_DISABLED_CLS:"fancy-button-disabled",BUTTON_PRESSED_CLS:"fancy-button-pressed",BUTTON_IMAGE_CLS:"fancy-button-image",BUTTON_IMAGE_COLOR_CLS:"fancy-button-image-color",BUTTON_TEXT_CLS:"fancy-button-text",BUTTON_DROP_CLS:"fancy-button-drop",SEG_BUTTON_CLS:"fancy-seg-button",TOOLTIP_CLS:"fancy-tooltip",TOOLTIP_INNER_CLS:"fancy-tooltip-inner",SEPARATOR_CLS:"fancy-separator",FOOTER_STATUS_CLS:"fancy-footer-status",STATUS_SOURCE_TEXT_CLS:"fancy-status-source-text",STATUS_SOURCE_LINK_CLS:"fancy-status-source-link",FOOTER_SOURCE_CLS:"fancy-footer-source",PICKER_MONTH_CELL_ACTIVE_CLS:"fancy-month-picker-cell-active",PICKER_MONTH_CLS:"fancy-month-picker",PICKER_BUTTON_BACK_CLS:"fancy-picker-button-back",PICKER_BUTTON_NEXT_CLS:"fancy-picker-button-next",PICKER_MONTH_ACTION_BUTTONS_CLS:"fancy-month-picker-action-buttons",PICKER_DATE_CLS:"fancy-date-picker",PICKER_DATE_CELL_TODAY_CLS:"fancy-date-picker-cell-today",PICKER_DATE_CELL_ACTIVE_CLS:"fancy-date-picker-cell-active",PICKER_DATE_CELL_OUT_RANGE_CLS:"fancy-date-picker-cell-out-range",PICKER_BUTTON_DATE_CLS:"fancy-picker-button-date",PICKER_BUTTON_DATE_WRAPPER_CLS:"fancy-picker-button-date-wrapper",PICKER_BUTTON_TODAY_CLS:"fancy-picker-button-today",PICKER_BUTTON_TODAY_WRAPPER_CLS:"fancy-picker-button-today-wrapper"}),Fancy.ANIMATE_DURATION=300,function(){var a=navigator.userAgent.toLowerCase(),b=function(b){return b.test(a)},c=b(/opera/),d=!c&&b(/msie/),e=window.chrome,f=window.navigator,g=f.vendor,h=f.userAgent.indexOf("Edge")>-1,i=f.userAgent.match("CriOS"),j=function(){var a=f.userAgent.indexOf("OPR")>-1;return!!i||null!==e&&void 0!==e&&"Google Inc."===g&&!1===a&&!1===h}();11===function(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var b=navigator.userAgent,c=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}return a}()&&(d=!0),!1===d&&h&&(d=!0),Fancy.apply(Fancy,{isOpera:c,isIE:d,isChrome:j}),Fancy.getViewSize=function(){var a=[];return Fancy.isIE?(a[0]=document.documentElement.clientHeight,a[1]=document.documentElement.clientWidth):(a[0]=window.innerHeight,a[1]=window.innerWidth),a},Fancy.getScroll=function(){var a=document.documentElement,b=document.body;return a&&(a.scrollTop||a.scrollLeft)?[a.scrollTop,a.scrollLeft]:b?[b.scrollTop,b.scrollLeft]:[0,0]},Fancy.getMouseWheelEventName=function(){return"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll"},Fancy.getWheelDelta=function(a){var b=0;return a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3),b},Fancy.isTouch=void 0!==document.ontouchstart,Fancy.i18n={},Fancy.currencies={map:{EUR:"€",USD:"$",GBP:"£",RUB:"₽",CZK:"Kč",AUD:"$",JPY:"¥",PLN:"zł",TRY:"₺",DKK:"kr",KRW:"₩",BRL:"R$",CNY:"¥",SEK:"kr",CAD:"$",NOK:"kr",IDR:"Rp"}}}(),Fancy.modules={},function(){var a={};Fancy.loadModule=function(b,c){var d=document.getElementsByTagName("body")[0],e=document.createElement("script"),f=b,g=Fancy.DEBUG?".js":".min.js",c=c||function(){},h=location.protocol,i=Fancy.version.replace(/\./g,""),j=Fancy.MODULESDIR||FancyGrid.MODULESDIR||h+"//cdn.fancygrid.com/modules/";!1!==Fancy.MODULELOAD&&!1!==Fancy.MODULESLOAD&&(b=b.replace(/ /g,"-"),Fancy.DEBUG?g+="?_dc="+ +new Date:g+="?_v="+i,Fancy.Modules.on("loaded",function(a,d){d===b&&(Fancy.modules[f]=!0,c(b))}),a[b]||(a[b]=!0,e.src=j+b+g,e.charset="utf-8",e.onload=function(){Fancy.Modules.fire("loaded",b)},e.onerror=function(){throw new Error("[FancyGrid error] - module "+b+" was not loaded")},d.appendChild(e)))},Fancy.loadLang=function(a,b){if(void 0!==Fancy.i18n[a])return!0;var c=document.getElementsByTagName("body")[0],d=document.createElement("script"),e=location.protocol,f=Fancy.MODULESDIR||FancyGrid.MODULESDIR||e+"//cdn.fancygrid.com/modules/";d.src=f+"i18n/"+a+".js",d.charset="utf-8",d.async="true",d.onload=function(){b({lang:Fancy.i18n[a]})},c.appendChild(d)}}(),Fancy.fullBuilt=!0,Fancy.themes={},Fancy.defineTheme=function(a,b){var c={};b.extend?Fancy.apply(c,Fancy.getTheme(b.extend).config):"default"!==a&&Fancy.apply(c,Fancy.getTheme("default").config),Fancy.apply(c,b.config),b.config=c,Fancy.themes[a]=b},Fancy.getTheme=function(a){var b={config:{}};return Fancy.isObject(a)?(Fancy.applyIf(b,Fancy.themes[a.name||"default"]),Fancy.apply(b.config,Fancy.themes[a.name||"default"].config),Fancy.apply(b.config,a.config),b):Fancy.themes[a]},Fancy.defineTheme("default",{config:{cellHeaderHeight:30,cellWidth:70,minCellWidth:40,cellHeight:32,titleHeight:42,subTitleHeight:42,barHeight:38,bottomScrollHeight:12,minCenterWidth:100,panelBorderWidth:2,groupRowHeight:31,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,2,2,2],knobOffSet:2,fieldHeight:37}}),Fancy.defineTheme("blue",{config:{panelBorderWidth:1,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0]}}),Fancy.defineTheme("gray",{config:{panelBorderWidth:0,gridBorders:[0,0,1,0],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0]}}),Fancy.defineTheme("dark",{config:{panelBorderWidth:1,gridBorders:[0,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0]}}),Fancy.defineTheme("sand",{config:{panelBorderWidth:1,gridBorders:[0,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0]}}),Fancy.defineTheme("bootstrap",{config:{panelBorderWidth:1,gridBorders:[1,1,1,1],gridWithoutPanelBorders:[1,1,1,1],panelBodyBorders:[0,0,0,0]}}),Fancy.String={format:function(a){var b,c,d;if("array"===Fancy.typeOf(arguments[1]))b=arguments[1];else for(d=arguments.length,b=[],c=1;c<d;c++)b[c-1]=arguments[c];return a.replace(/\[(\d+)]/g,function(a,c){return b[c]})},upFirstChar:function(a){return a[0].toLocaleUpperCase()+a.substr(1,a.length)},trim:function(a){return a.replace(/\s/g,"")}},Fancy.Array={copy:function(a,b){if(!b)return a.slice();for(var c=[],d=0,e=a.length;d<e;d++)switch(Fancy.typeOf(a[d])){case"object":c[d]=Fancy.Object.copy(a[d]);break;case"array":c[d]=Fancy.Array.copy(a[d]);break;default:c=a[d]}return c},each:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},count:function(a){return a.length},sum:function(a){var b=0,c=a.length,d=0;if(Fancy.isArray(a[0]))for(d=[];b<c;b++)for(var e=0,f=a[b].length;e<f;e++)void 0===d[e]&&(d[e]=0),d[e]+=a[b][e];else for(;b<c;b++)d+=a[b];return d},min:function(a){return Math.min.apply(this,a)},max:function(a){return Math.max.apply(this,a)},average:function(a){for(var b=0,c=0,d=a.length;c<d;c++)b+=a[c];return b/a.length},insert:function(a,b,c){var d=a.splice(b,a.length-b);return a=a.concat(c).concat(d)}},Fancy.Object={copy:function(a){var b={};for(var c in a)b[c]=a[c];return b},isEmpty:function(a){var b=!0;for(var c in a)b=!1;return b}},Fancy.Date={daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],dayIndexes:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],format:function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t="",d=d||"";d=d.toLocaleLowerCase(),void 0===c?c=Fancy.i18n.en:Fancy.isString(c)&&(c=Fancy.i18n[c]);for(var u=0,v=b.length;u<v;u++){var w=b[u];switch(w){case"i":f=a.getMinutes(),t+=f<10?"0"+f:f;break;case"s":if(f=a.getSeconds(),"sql"===d){if("ss"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=f<10?"0"+f:f,u++}else t+=f<10?"0"+f:f;break;case"S":if(f=a.getSeconds(),"sql"!==d)throw new Error("[FancyGrid Error] - Invalid date format: "+b);if("SS"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=f<10?"0"+f:f,u++;break;case"a":e=a.getHours(),t+=e<13?c.date.am:c.date.pm;break;case"A":e=a.getHours(),t+=e<13?c.date.AM:c.date.PM;break;case"n":t+=a.getMonth();break;case"j":t+=a.getDate();break;case"m":if(s=a.getMonth()+1,"sql"===d)if("mm"===b.substr(u,2))s<10&&(s="0"+s),t+=s,u++;else{if("mi"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);f=a.getMinutes(),t+=f<10?"0"+f:f,u++}else s<10&&(s="0"+s),t+=s;break;case"d":if(r=a.getDate(),"sql"===d){if("dd"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);r<10&&(r="0"+r),t+=r,u++}else r<10&&(r="0"+r),t+=r;break;case"Y":if("sql"===d)if("YYYY"===b.substr(u,4))t+=a.getFullYear(),u+=3;else{if("YY"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);String(a.getFullYear()).substr(2,t.length),u+=1}else t+=a.getFullYear();break;case"y":if("sql"===d)if("yyyy"===b.substr(u,4))t+=a.getFullYear(),u+=3;else{if("yy"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);String(a.getFullYear()).substr(2,t.length),u+=1}else t+=String(a.getFullYear()).substr(2,t.length);break;case"D":if(g=a.getDay(),"sql"===d){if("DD"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=c.date.days[g].substr(0,3),u++}else t+=c.date.days[g].substr(0,3);break;case"l":h=a.getDay(),t+=c.date.days[h];break;case"N":i=a.getDay(),0===i&&(i=7),t+=i;break;case"w":j=a.getDay(),t+=j;break;case"F":k=a.getMonth(),t+=c.date.months[k];break;case"M":if(l=a.getMonth(),"sql"===d)if("MM"===b.substr(u,2))t+=c.date.months[l].substr(0,3),u+=1;else{if("MI"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);f=a.getMinutes(),t+=f<10?"0"+f:f,u++}else t+=c.date.months[l].substr(0,3);break;case"t":"sql"===d?t+=" ":(m=new Date(a.getFullYear(),a.getMonth(),0).getDate(),t+=m);break;case"T":if("sql"!==d)throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=" ";break;case"g":n=a.getHours()%12,t+=n;break;case"G":n=a.getHours(),t+=n;break;case"h":if(e=a.getHours(),"sql"===d){if("hh"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=e>12?e-12:e>9&&e<13?e:"0"+e,u+=1}else t+=e>12?e-12:e>9&&e<13?e:"0"+e;break;case"H":if(o=a.getHours(),"sql"===d){if("HH"!==b.substr(u,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);t+=o<10?"0"+o:o,u+=1}else t+=o<10?"0"+o:o;break;case"u":p=a.getMilliseconds(),t+=p;break;case"U":q=Number(a)/1e3,t+=q;break;default:t+=w}}return t},parse:function(a,b,c){var d=new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=0,i=0,j=0,k=0,c=c||"";c=c.toLocaleLowerCase();for(var l=0,m=b.length;l<m;l++){var n,o,p,q=b[l];switch(q){case"n":var r;"0"===a[1]||"1"===a[1]||"2"===a[1]?(r=a[0]+a[1],a=a.substr(2,a.length)):(r=a[0],a=a.substr(1,a.length)),f=Number(r);break;case"j":Fancy.isNumber(parseInt(a[1]))?(n=a[0]+a[1],a=a.substr(2,a.length)):(n=a[0],a=a.substr(1,a.length)),g=Number(n);break;case"h":if("sql"===c){if("hh"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);var s;isNaN(Number(a[1]))?(s=a[0],a=a.substr(1,a.length)):(s=a[0]+a[1],a=a.substr(2,a.length),l+=1),h=Number(s)}else{var s;"0"===a[1]||"1"===a[1]||"2"===a[1]?(s=a[0]+a[1],a=a.substr(2,a.length)):(s=a[0],a=a.substr(1,a.length)),h=Number(s)}break;case"a":"m"===a[1]&&(h+=12),a=a.substr(2,a.length);break;case"A":"M"===a[1]&&(h+=12),a=a.substr(2,a.length);break;case"i":i=a[0]+a[1],a=a.substr(2,a.length);break;case"s":if("sql"===c){if("ss"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);j=a[0]+a[1],a=a.substr(2,a.length),l++}else j=a[0]+a[1],a=a.substr(2,a.length);break;case"S":if("sql"===c){if("SS"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);j=a[0]+a[1],a=a.substr(2,a.length),l++}else j=a[0]+a[1],a=a.substr(2,a.length);break;case"u":k=a[0]+a[1]+a[2],a=a.substr(3,a.length);break;case"m":if("sql"===c)if("mm"===b.substr(l,2))switch(a[0]){case"0":case"1":case"2":case"3":isNaN(parseInt(a[1]))?(f=Number(a[0])-1,a=a.substr(1,a.length)):(f=Number(a[0]+a[1])-1,a=a.substr(2,a.length)),l+=1;break;default:f=Number(a[0])-1,a=a.substr(1,a.length)}else{if("mi"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);i=a[0]+a[1],a=a.substr(2,a.length),l++}else switch(a[0]){case"0":case"1":case"2":case"3":isNaN(parseInt(a[1]))?(f=Number(a[0])-1,a=a.substr(1,a.length)):(f=Number(a[0]+a[1])-1,a=a.substr(2,a.length));break;default:f=Number(a[0])-1,a=a.substr(1,a.length)}break;case"d":if("sql"===c){if("dd"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);isNaN(parseInt(a[1]))?(g=Number(a[0]),a=a.substr(1,a.length)):(g=Number(a[0]+a[1]),a=a.substr(2,a.length)),l++}else isNaN(parseInt(a[1]))?(g=Number(a[0]),a=a.substr(1,a.length)):(g=Number(a[0]+a[1]),a=a.substr(2,a.length));break;case"Y":if("sql"===c)if("YYYY"===b.substr(l,4))e=Number(a[0]+a[1]+a[2]+a[3]),a=a.substr(4,a.length),l+=3;else{if("YY"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);e=Number(a[0]+a[1]),a=a.substr(2,a.length),l+=1,e=e<51?Number("20"+e):Number("19"+e)}else e=Number(a[0]+a[1]+a[2]+a[3]),a=a.substr(4,a.length);break;case"y":if("sql"===c)if("yyyy"===b.substr(l,4))e=Number(a[0]+a[1]+a[2]+a[3]),a=a.substr(4,a.length),l+=3;else{if("yy"!==b.substr(0,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);e=Number(a[0]+a[1]),a=a.substr(2,a.length),l+=1,e=e<51?Number("20"+e):Number("19"+e)}else e=Number(a[0]+a[1]),e=e<51?Number("20"+e):Number("19"+e),a=a.substr(2,a.length);break;case"D":if("sql"===c){if("DD"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);isNaN(parseInt(a[1]))?(g=Number(a[0]),a=a.substr(1,a.length)):(g=Number(a[0]+a[1]),a=a.substr(2,a.length)),l++}else a=a.substr(3,a.length);break;case"l":for(p=a[0]+a[1]+a[2],n=0,o=7;n<o;n++){var t=lang.days[n];if(p===t.substr(0,3)){a=a.substr(t.length,a.length);break}}break;case"N":case"w":a=a.substr(1,a.length);break;case"F":for(p=a[0]+a[1]+a[2],n=0,o=7;n<o;n++){var u=lang.months[n];if(p===u.substr(0,3)){a=a.substr(u.length,a.length);break}}break;case"M":if("sql"===c)if("MM"===b.substr(l,2))switch(a[0]){case"0":case"1":case"2":case"3":isNaN(parseInt(a[1]))?(f=Number(a[0])-1,a=a.substr(1,a.length)):(f=Number(a[0]+a[1])-1,a=a.substr(2,a.length)),l+=1;break;default:f=Number(a[0])-1,a=a.substr(1,a.length)}else{if("MI"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);i=a[0]+a[1],a=a.substr(2,a.length),l++}else a=a.substr(3,a.length);break;case"t":a="sql"===c?a.substr(1,a.length):a.substr(2,a.length);break;case"T":if("sql"!==c)throw new Error("[FancyGrid Error] - Invalid date format: "+b);a=a.substr(1,a.length);break;case"G":Fancy.isNumber(parseInt(a[1]))?(h=Number(a[0]+a[1]),a=a.substr(2,a.length)):(h=Number(a[0]),a=a.substr(1,a.length));break;case"g":a=a.substr(1,a.length);break;case"H":if("sql"===c){if("HH"!==b.substr(l,2))throw new Error("[FancyGrid Error] - Invalid date format: "+b);var s;isNaN(Number(a[1]))?(s=a[0],a=a.substr(1,a.length)):(s=a[0]+a[1],a=a.substr(2,a.length),l+=1),h=Number(s)}else h=Number(a[0]+a[1]),a=a.substr(2,a.length);break;default:a=a.substr(1,a.length)}}return new Date(e,f,g,h,i,j,k)},getDaysInMonth:function(a){var b=a.getMonth();return 1===b&&Fancy.Date.isLeapYear(a)?29:Fancy.Date.daysInMonth[b]},getFirstDayOfMonth:function(a){var b=(a.getDay()-(a.getDate()-1))%7;return b<0?b+7:b},isLeapYear:function(a){var b=a.getFullYear();return!(0!=(3&b)||!(b%100||b%400==0&&b))},getMonthNumber:function(a,b){return new Date(a,b+1,0).getDate()}},Fancy.Number={isFloat:function(a){return Number(a)===a&&a%1!=0},getPrecision:function(a){return(a+"").split(".")[1].length+1},correctFloat:function(a){return parseFloat(a.toPrecision(14))}},Fancy.Collection=function(a){var b=this;if(b.items=[],b.keys=[],b.map={},b.indexMap={},b.length=0,a)if(a.length>0)for(var c=0,d=a.length;c<d;c++)b.add(c,a[c]);else for(var e in a)b.add(e,a[e])},Fancy.Collection.prototype={add:function(a,b){var c=this;c.items.push(b),c.keys.push(a),c.map[a]=b,c.indexMap[a]=c.length,c.length++},remove:function(a){var b=this,c=b.indexMap[a];b.items.splice(c,1),b.keys.splice(c,1),delete b.indexMap[c],delete b.map[a],b.length--,b.updateIndexMap()},updateIndexMap:function(){var a=this,b=0,c=a.keys.length;for(a.indexMap={};b<c;b++)a.indexMap[a.keys[b]]=b},removeAll:function(){var a=this;a.items=[],a.keys=[],a.indexMap={},a.map={},a.length=0},get:function(a){return this.map[a]},each:function(a){for(var b=this,c=0,d=b.length;c<d;c++)a(b.keys[c],b.items[c],c,b.length)}},Fancy.Template=function(a){var b=this;Fancy.isArray(a)?b.tpl=a.join(""):b.tpl=a,b.compile()},Fancy.Template.prototype={re:/\{([\w\-]+)\}/g,getHTML:function(a){return this.compiled(a)},compile:function(){function fn(a,b){return"'+("+(b="values['"+b+"']")+" === undefined ? '' : "+b+")+'"}var me=this;return eval("me.compiled = function(values){ return '"+me.tpl.replace(me.re,fn)+"';};"),me}},Fancy.key={BACKSPACE:8,TAB:9,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_PLUS:107,NUM_MINUS:109,NUM_DOT:110,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,DOT:190},Fancy.Key={isNum:function(a){var b=Fancy.key;switch(a){case b.ZERO:case b.ONE:case b.TWO:case b.THREE:case b.FOUR:case b.FIVE:case b.SIX:case b.SEVEN:case b.EIGHT:case b.NINE:case b.NUM_ZERO:case b.NUM_ONE:case b.NUM_TWO:case b.NUM_THREE:case b.NUM_FOUR:case b.NUM_FIVE:case b.NUM_SIX:case b.NUM_SEVEN:case b.NUM_EIGHT:case b.NUM_NINE:return!0;default:return!1}},isNumControl:function(a,b){var c=Fancy.key;if(Fancy.Key.isNum(a))return!0;if(b.shiftKey&&187===a)return!0;switch(a){case c.NUM_PLUS:case 189:case c.NUM_MINUS:case c.NUM_DOT:case c.BACKSPACE:case c.DELETE:case c.TAB:case c.ENTER:case c.RETURN:case c.SHIFT:case c.CTRL:case c.ALT:case c.ESC:case c.END:case c.HOME:case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:case c.INSERT:case c.DOT:return!0;default:return!1}}},function(){var a={},b={},c=function(a,b){for(var c in b.prototype)void 0===a.prototype[c]&&(a.prototype[c]=b.prototype[c])},d=function(){this.waitMixins={}};d.prototype={items:new Fancy.Collection,add:function(a,b){var c=a.split("."),d=1,e=c.length-1;Fancy.ns(a);for(var f=Fancy.global[c[0]];d<e;d++)f=f[c[d]];c.length>1?f[c[c.length-1]]=b:Fancy.global[c[0]]=b,this.items.add(a,b)},get:function(a){return this.items.get(a)},waitMixin:function(a,b){var c=this;c.waitMixins[a]=c.waitMixins[a]||{waiters:[]},c.waitMixins[a].waiters.push(b)},getMixin:function(a){var b=a.split("."),c=1,d=b.length,e=Fancy.global[b[0]];if(void 0===e)return!1;for(;c<d;c++)if(void 0===(e=e[b[c]]))return!1;return e}},Fancy.ClassManager=new d,Fancy.define=function(d,e){var e=e||{},f=[];if(Fancy.isArray(d)&&(f=d,d=f[0]),e.constructor===Object&&(void 0===e.extend?e.constructor=function(){}:e.constructor=function(){this.Super("constructor",arguments)}),void 0===e.extend)a[d]=e.constructor;else{a[d]=e.constructor;var g;switch(typeof e.extend){case"string":g=Fancy.ClassManager.get(e.extend),a[d].prototype.$Super=Fancy.ClassManager.get(e.extend);break;case"function":g=e.extend,a[d].prototype.$Super=e.extend}delete e.extend,a[d].prototype.Super=function(a,b){var c=this;switch(c.$Iam?c.$Iam=Fancy.ClassManager.get(c.$Iam.prototype.$Super.prototype.$name):c.$Iam=Fancy.ClassManager.get(c.$Super.prototype.$name),a){case"const":case"constructor":c.$Iam.apply(c,b);break;default:c.$Iam.prototype[a].apply(c,b)}delete c.$Iam},c(a[d],g)}a[d].prototype.$name=d,e.mixins&&(Fancy.mixin(a[d].prototype,e.mixins),delete a[d].prototype.mixins),void 0!==e.plugins&&(void 0===a[d].prototype.$plugins&&(a[d].prototype.$plugins=[]),a[d].prototype.$plugins=a[d].prototype.$plugins.concat(e.plugins),delete a[d].prototype.plugins);for(var h in e)a[d].prototype[h]=e[h];var i=a[d];!0===e.singleton&&(delete a[d],i=new i(e),a[d]=i),f.length>1?Fancy.each(f,function(a){Fancy.ClassManager.add(a,i)}):Fancy.ClassManager.add(d,i),e.type?(b[e.type]=i,Fancy.addWidgetType(e.type,i)):e.ptype&&(b[e.type]=i,Fancy.addPluginByType(e.ptype,i))},Fancy.getClassByType=function(a){return b[a]}}(),Fancy.MixinClass=function(){},Fancy.MixinClass.prototype={initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},initPlugins:function(){var a,b,c,d=this,e=d;if(d.plugins=d.plugins||[],d._plugins&&(d.plugins=d.plugins.concat(d._plugins)),void 0!==d.plugins&&(d.$plugins=d.plugins,delete d.plugins),void 0!==d.$plugins)for(var f,g=0,h=d.$plugins,i=h.length,j={};g<i;g++){c=h[g],c.widget=e;var k=c.type||c.ptype;if(!0!==j[k]){if(j[k]=!0,void 0===(a=Fancy.getPluginByType(k)))throw new Error("[FancyGrid Error] - some of module was not loaded. Grid plugin does not exist - "+k);b=new a(c),f=c.inWidgetName||b.inWidgetName,void 0!==f&&(e[f]=b)}}}},Fancy.define("Fancy.Data",{constructor:function(a){var b=this;if(b.map={},a)for(var c=0,d=a.length,e=b.map;c<d;c++)e[c]=a[c];b.length=0},add:function(a,b){this.map[a]=b,this.length++},get:function(a){return this.map[a]}}),Fancy.define("Fancy.Model",{constructor:function(a){var b=this,c={},d=b.fields||[],e=0,f=d.length;if(Fancy.isArray(a)){for(;e<f;e++){var g=d[e];c[g]=a[e]}void 0===c.id&&(Fancy.idSeed++,c.id=Fancy.idSeed+1e3),b.data=c,b.id=b.data.id}else{if(a.id?b.id=a.id:(Fancy.idSeed++,b.id=Fancy.idSeed+1e3),void 0===b.fields){d=[];for(var g in a)d.push(g);b.fields=d}for(f=d.length;e<f;e++){var g=d[e];void 0===a[g]?c[g]="":c[g]=a[g]}b.data=c}},get:function(a){var b=this;return void 0===a?b.data:b.data[a]},set:function(a,b){var c=this;if(void 0===b&&Fancy.isObject(a))for(var d in a)c.set(d,a[d]);else c.data[a]=b}}),Fancy.define("Fancy.PluginManager",{singleton:!0,constructor:function(){this.ptypes=new Fancy.Data},addPlugin:function(a,b){this.ptypes.add(a,b)},getPlugin:function(a){return this.ptypes.get(a)}}),Fancy.addPluginByType=function(a,b){Fancy.PluginManager.addPlugin(a,b)},Fancy.getPluginByType=function(a){return Fancy.PluginManager.getPlugin(a)},function(){var a=Fancy;a.define("Fancy.WidgetManager",{singleton:!0,constructor:function(){this.wtypes=new a.Data,this.widgets=new a.Data},addWidgetType:function(a,b){b.prototype.wtype=a,this.wtypes.add(a,b)},getWidgetClassByType:function(a){return this.wtypes.get(a)},addWidget:function(a,b){this.widgets.add(a,b)},getWidget:function(a){return this.widgets.get(a)}});var b=a.WidgetManager;a.addWidgetType=function(a,c){b.addWidgetType(a,c)},a.getWidgetClassByType=function(a){return b.getWidgetClassByType(a)},a.addWidget=function(a,c){b.addWidget(a,c)},a.getWidget=function(a){return b.getWidget(a)}}(),function(){var a=0,b={};Fancy.define(["Fancy.Event","Fancy.Observable"],{mixins:[Fancy.MixinClass],constructor:function(a){var b=this;if(Fancy.applyConfig(b,a||{}),b.$events={},b.listeners||b.events)for(var c=b.listeners||b.events,d=0,e=c.length;d<e;d++){var f=c[d],g=null,h=null,i=null,j=0,k=[];for(var l in f)switch(l){case"scope":i=f[l];break;case"params":k=f[l];break;case"delay":j=f[l];break;default:g=l,h=f[l]}if(null===g)throw new Error("Event was not set");switch(Fancy.typeOf(h)){case"string":h=b[h],f.handler=h,void 0===f.scope&&(i=b),f.scope=i;break;case"function":break;default:throw new Error("Handler has wrong type or not defined")}if(!1===Fancy.isArray(k))throw new Error("params must be array");b.addEvent(g),b.on(g,h,i,k,j)}},on:function(c,d,e,f,g){if(void 0===this.$events[c])throw new Error("Event name is not set: "+c);if(void 0===d)throw new Error("Handler is undefined. Name of event is "+c+".");d.$fancyFnSeed=a,b[a]=d,a++,this.$events[c].push({fn:d,scope:e,params:f||[],delay:g})},un:function(a,b){var c=this,d=c.$events[a];if(!d)return!1;for(var e=0,f=d.length;e<f;e++){var g=d[e];if(g.fn.$fancyFnSeed===b.$fancyFnSeed)return g.toRemove=!0,!0}return!1},once:function(a,b,c){var d=this,e=function(){b.apply(this,arguments),d.un(a,e)};d.on(a,e,c)},unAll:function(){this.$events={}},unAllByType:function(a){this.$events[a]=[]},fire:function(a){var b=this,c=b.$events[a];if(!c)return!1;for(var d=1,e=arguments.length,f=[b];d<e;d++)f.push(arguments[d]);for(var d=0,e=c.length;d<e;d++){var g=c[d],h=[];!0!==g.toRemove?(h=h.concat(f),g.params&&(h=h.concat(g.params)),g.delay?setTimeout(function(){g.fn.apply(g.scope||b,h)},g.delay):g.fn.apply(g.scope||b,h)):(c.splice(d,1),d--,e=c.length)}},addEvent:function(a){return this.addEvents(a)},addEvents:function(a){var b=this;if(arguments.length>1){for(var c=[],d=0,e=arguments.length;d<e;d++)c[d]=arguments[d];a=c}if("string"===Fancy.typeOf(a))b.$events[a]=b.$events[a]||[];else if("array"===Fancy.typeOf(a))for(var d=0,e=a.length;d<e;d++)b.$events[a[d]]=b.$events[a[d]]||[]},has:function(a){var b=this.$events[a];return!!b&&0!==b.length}}),Fancy.define("Fancy.Modules",{extend:Fancy.Event,singleton:!0,constructor:function(){this.Super("const",arguments),this.init()},init:function(){this.addEvents("loaded")}})}(),Fancy.Mixin("Fancy.store.mixin.Paging",{initPaging:function(){var a=this;void 0!==a.paging&&(Fancy.isObject(a.paging)&&Fancy.apply(a,a.paging),a.calcPages(),a.changeDataView())},firstPage:function(){var a=this;a.calcPages(),a.showPage=0,"server"===a.pageType?a.loadPage():a.changeDataView()},prevPage:function(){var a=this;a.calcPages(),a.showPage--,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},nextPage:function(){var a=this;a.calcPages(),a.showPage++,a.showPage===a.pages&&a.showPage--,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},lastPage:function(){var a=this;a.calcPages(),a.showPage=a.pages-1,a.showPage<0&&(a.showPage=0),"server"===a.pageType?a.loadPage():a.changeDataView()},calcPages:function(){var a=this;if("server"===a.pageType){var b=a.pages;if(a.pages=Math.ceil(a.getTotal()/a.pageSize),!isNaN(b)&&b>a.pages)return a.showPage--,a.showPage<0&&(a.showPage=0),"needs reload"}else a.pages=Math.ceil(a.getTotal()/a.pageSize);a.showPage>=a.pages&&(a.showPage=a.pages-1),a.showPage<0&&(a.showPage=0),a.fire("changepages")},setPage:function(a){var b=this;b.showPage=a,b.showPage===b.pages&&b.showPage--,b.showPage<0&&(b.showPage=0),"server"===b.pageType?b.loadPage():b.changeDataView()},refresh:function(){var a=this;"server"===a.pageType?a.loadPage():a.changeDataView()},processPagingData:function(a){var b=this;void 0!==a.totalCount&&(b.totalCount=a.totalCount),b.checkPagingType(a),b.setData(a[b.readerRootProperty]),b.changeDataView({stoppedFilter:!0}),"needs reload"===b.calcPages()&&b.loadPage()},checkPagingType:function(a){var b=this;void 0!==a.totalCount&&a.totalCount!==a[b.readerRootProperty].length&&(b.totalCount=a.totalCount,b.pageType="server",void 0===b.remoteSort&&(b.remoteSort=!0))},loadPage:function(){this.loadData()},setPageSize:function(a){var b=this;b.pageSize=a,b.calcPages(),"server"===b.pageType?b.loadPage():b.changeDataView()}}),Fancy.Mixin("Fancy.store.mixin.Proxy",{pageParam:"page",startParam:"start",limitParam:"limit",sortParam:"sort",directionParam:"dir",keyParam:"key",valueParam:"value",filterParam:"filter",autoLoad:!0,autoSave:!0,saveOrder:["create","update","destroy"],batch:!0,filterOperators:{"<":"lt",">":"gt","<=":"lteq",">=":"gteq","=":"eq","==":"eq","===":"stricteq","!=":"noteq","!==":"notstricteq","":"like","*":"likeor","|":"or"},loadedTimes:0,initProxy:function(){var a=this;a.proxy=a.data.proxy||{};var b=a.proxy;void 0!==b.autoLoad&&(a.autoLoad=b.autoLoad),void 0!==b.autoSave&&(a.autoSave=b.autoSave),void 0!==b.batch&&(a.batch=b.batch),a.initReader(),a.initWriter(),"rest"===a.proxy.type?a.initRest():(a.initServerAPI(),a.initActionMethods(),a.checkProxy()),a.autoLoad&&a.loadData()},checkProxy:function(){if(void 0===this.proxy.api.read)throw new Error("[FancyGrid Error] - in data proxy there is not url")},checkUrl:function(){if(void 0===this.proxy.url)throw new Error("[FancyGrid Error] - in data proxy there is not url")},initServerAPI:function(){var a=this,b=a.proxy;b.api=b.api||{},b.url&&(b.api.read=b.url),(b.api.update||b.api.read||b.api.create&&b.api.destroy)&&(a.proxyType="server")},initActionMethods:function(){var a=this,b=a.proxy,c=b.methods||{},d=b.method||"GET";c.create=c.create||d,c.read=c.read||d,c.update=c.update||d,c.destroy=c.destroy||d,b.methods=c},loadData:function(){var a=this,b=a.proxy,c={},d=b.headers||{};Fancy.apply(c,a.params),Fancy.applyIf(c,b.params),a.fire("beforeload"),"server"===a.pageType&&(c[a.pageParam]=a.showPage,c[a.limitParam]=a.pageSize,c[a.startParam]=a.showPage*a.pageSize),a.loading=!0,Fancy.Ajax({url:b.api.read,method:b.methods.read,params:c,getJSON:!0,headers:d,success:function(b,c,d){a.loadedTimes++,a.loading=!1,a.defineModel(b[a.readerRootProperty]),a.paging?a.processPagingData(b):(a.setData(b[a.readerRootProperty]),a.widget.setSidesHeight()),a.fire("change"),a.fire("load"),a.fire("serversuccess",b,d)},error:function(b,c,d){a.fire("servererror",c,d,b)}})},proxyCRUD:function(a,b,c,d){var e=this;switch(a){case"UPDATE":e.proxyServerUpdate(b,c,d);break;case"DESTROY":e.proxyServerDestroy(b,c);break;case"CREATE":e.proxyServerCreate(b,c)}},proxyServerUpdate:function(a,b,c){var d=this,e=d.proxy,f={},g="json"===d.writerType||!1===d.autoSave;Fancy.apply(f,d.params),Fancy.applyIf(f,e.params),e.api.update&&(g?f=Fancy.isArray(a)&&void 0===b&&void 0===c?a:d.prepareWriterJSONParams(a,b,c):(f.id=a,f[d.keyParam]=b,f[d.valueParam]=c,f.action="update"),d.loading=!0,d.fire("beforeupdate",a,b,c),Fancy.Ajax({url:e.api.update,method:e.methods.update,params:f,sendJSON:g,success:function(e,f,g){d.loading=!1,d.fire("update",a,b,c),d.fire("serversuccess",e,g)},error:function(a,b,c){d.fire("servererror",b,c,a)}}))},proxyServerDestroy:function(a,b){var c=this,d=c.proxy,e={},f="json"===c.writerType||!1===c.autoSave;Fancy.apply(e,c.params),Fancy.applyIf(e,d.params),f&&Fancy.isArray(a)?e=a:b?e=b:e.id=a,c.loading=!0,c.fire("beforedestroy"),Fancy.Ajax({url:d.api.destroy,method:d.methods.destroy,params:e,sendJSON:f,success:function(b,d,e){c.loading=!1,c.fire("destroy",a,b),c.fire("serversuccess",b,e)},error:function(a,b,d){c.fire("servererror",b,d,a)}})},proxyServerCreate:function(a,b){var c=this,d=c.proxy,e={},f="json"===c.writerType||!1===c.autoSave;Fancy.apply(e,c.params),Fancy.applyIf(e,d.params),f&&Fancy.isArray(a)?e=a:b?e=b:(e.id=a,void 0===e.id&&delete e.id),c.loading=!0,c.fire("beforecreate"),Fancy.Ajax({url:d.api.create,method:d.methods.create,params:e,sendJSON:f,success:function(b,d,e){if(c.loading=!1,Fancy.isObject(b.data)&&String(a)!==String(b.data.id))c.changeItemId(a,b.data.id);else if(Fancy.isArray(b.data))for(var f=0,g=a.length;f<g;f++)String(a[f].id)!==String(b.data[f].id)&&c.changeItemId(String(a[f].id),String(b.data[f].id));c.fire("create",b.data),c.fire("serversuccess",b,e)},error:function(a,b,d){c.fire("servererror",b,d,a)}})},save:function(){for(var a=this,b=a.removed,c=a.changed,d=a.inserted,e=0,f=a.saveOrder.length;e<f;e++)switch(a.saveOrder[e]){case"create":a.saveInsertActions(d);break;case"update":a.saveChangeActions(c);break;case"destroy":a.saveRemoveActions(b)}a.changed={length:0},a.removed={length:0},a.inserted={length:0}},saveChangeActions:function(a){var b=this;if(a.length)if(b.batch){var c=[];for(var d in a)if("length"!==d){var e=a[d],f={id:d};if(b.writeAllFields)f=b.getById(d).data;else for(var g in e)"length"!==g&&(f[g]=e[g].value);c.push(f)}1===c.length?(c=c[0],b.proxyCRUD("UPDATE",c.id,c)):b.proxyCRUD("UPDATE",c)}else for(var d in a)if("length"!==d){var e=a[d],c={};if(b.writeAllFields)c=b.getById(d).data;else for(var g in e)"length"!==g&&(c[g]={id:e.id});b.proxyCRUD("UPDATE",d,c)}},saveRemoveActions:function(a){var b=this;if(0!==a.length)if(b.batch){var c=[];for(var d in a)if("length"!==d){var e=a[d],f={id:d};if(b.writeAllFields)f=b.getById(d).data;else for(var g in e)"length"!==g&&(f={id:e.id});c.push(f)}1===c.length?(c=c[0],b.proxyCRUD("DESTROY",c.id,c)):b.proxyCRUD("DESTROY",c)}else for(var d in a)if("length"!==d){var e=a[d],c={};if(b.writeAllFields)c=e;else for(var g in e)"length"!==g&&(c[g]=e[g].value);b.proxyCRUD("DESTROY",d,c)}},saveInsertActions:function(a){var b=this;if(0!==a.length)if(b.batch){var c=[];for(var d in a)if("length"!==d){var e=a[d],f={id:d};if(b.writeAllFields)f=b.getById(d).data;else for(var g in e.data)f[g]=e.data[g];c.push(f)}1===c.length?(c=c[0],b.proxyCRUD("CREATE",c.id,c)):b.proxyCRUD("CREATE",c)}else for(var d in a)if("length"!==d){var e=a[d],c={};if(b.writeAllFields)c=e;else for(var g in e)"length"!==g&&(c[g]=e[g].value);b.proxyCRUD("CREATE",d,c)}}}),Fancy.Mixin("Fancy.store.mixin.Rest",{initRest:function(){var a=this;a.proxyType="server",a.checkUrl(),a.initRestServerAPI(),a.initRestActionMethods()},initRestServerAPI:function(){var a=this,b=a.proxy,c=b.url;b.api=b.api||{},b.api.create=c,b.api.read=c,b.api.update=c,b.api.destroy=c},initRestActionMethods:function(){var a=this,b=a.proxy,c=b.methods||{};c.create=c.create||b.method||"POST",c.read=c.read||b.method||"GET",c.update=c.update||b.method||"PUT",c.destroy=c.destroy||b.method||"DELETE",b.methods=c}}),Fancy.Mixin("Fancy.store.mixin.Reader",{readerType:"json",readerRootProperty:"data",initReader:function(){var a=this,b=a.proxy;b.reader&&a.configReader(b.reader)},configReader:function(a){var b=this;switch(Fancy.typeOf(a)){case"string":switch(a){case"json":b.readerType=a;break;default:throw new Error("[FancyGrid Error] - reader "+a+" does not exist")}break;case"object":switch(a.type){case void 0:b.readerType="json";break;case"json":b.readerType=a.type;break;default:throw new Error("[FancyGrid Error] - reader "+a.type+" does not exist")}a.root&&(b.readerRootProperty=a.root)}}}),Fancy.Mixin("Fancy.store.mixin.Writer",{writerType:"string",writeAllFields:!1,initWriter:function(){var a=this,b=a.proxy;b.writer&&a.configWriter(b.writer)},configWriter:function(a){var b=this;switch(a.allFields&&(b.writeAllFields=a.allFields),Fancy.typeOf(a)){case"string":switch(a){case"json":case"string":b.writerType=a;break;default:throw new Error("[FancyGrid Error] - writer "+a.type+" does not exist")}break;case"object":switch(a.type){case void 0:b.writerType="string";break;case"json":case"string":b.writerType=a.type;break;default:throw new Error("[FancyGrid Error] - writer "+a+" does not exist")}a.writeFields&&(b.writeFields=!0),a.root&&(b.writerRootProperty=a.root)}},prepareWriterJSONParams:function(a,b,c){var d=this,e=d.params||{},f={};return f.id=a,d.writeAllFields?Fancy.applyIf(f,d.getById(a).data):void 0===c&&Fancy.isObject(b)?Fancy.applyIf(f,b):void 0===c&&Fancy.isArray(b)?f=b:f[b]=c,d.rootProperty?(e[d.rootProperty]=f,e):f}}),Fancy.Mixin("Fancy.store.mixin.Sort",{multiSortLimit:3,sort:function(a,b,c,d){var e,f,g=this;switch(g.fire("beforesort",{key:"key",action:a}),g.multiSort&&!0!==g.multiSortInited&&g.initMultiSort(),b){case"number":case"checkbox":case"progressdonut":case"progressbar":case"grossloss":case"date":case"currency":e="sortNumber",f="number";break;case"string":case"combo":case"text":case"color":e="sortString",f="string";break;default:throw new Error("[FancyGrid error] - does not exist sort function for type "+b)}if(g.multiSort&&g.addSorter(c,a.toLocaleUpperCase(),f),g.remoteSort)return void g.serverSort(a,b,c);if(d.type=b,g[e](a,c,d),g.multiSort)for(var h=0,i=g.sorters.length-1;h<i;h++)g.multiSortOrder(h);g.changeDataView(),g.fire("sort",{key:"key",action:a})},serverSort:function(a,b,c){var d=this;d.params=d.params||{},d.multiSort?d.params.sorters=d.sorters:(d.params[d.sortParam]=c,d.params[d.directionParam]=a),d.loadData()},sortNumber:function(a,b,c){var d,e,f,g=this,h=[];if(g.grouping){var i=g.getColumnOriginalValuesByGroup(b,g.grouping.by,c);switch(d=[],e=0,f=i.length,a){case"asc":for(;e<f;e++)h=h.concat(i[e].values),d=d.concat(i[e].values.sort(function(a,b){return a-b}));break;case"desc":for(;e<f;e++)h=h.concat(i[e].values),d=d.concat(i[e].values.sort(function(a,b){return b-a}))}}else{h=g.getColumnOriginalValues(b,c);for(var j=[],k=Fancy.Array.copy(h),e=0,f=k.length;e<f;e++)isNaN(k[e])&&(j.push(k[e]),k.splice(e,1),f--);switch(a){case"asc":d=Fancy.Array.copy(k).sort(function(a,b){return a-b}),d=d.concat(j);break;case"desc":d=Fancy.Array.copy(k).sort(function(a,b){return b-a}),d=j.concat(d)}}g.order=g.getOrder(h,d)},sortString:function(a,b){var c,d,e,f=this,g=[];if(f.grouping){var h=f.getColumnOriginalValuesByGroup(b,f.grouping.by);switch(c=[],d=0,e=h.length,a){case"asc":for(;d<e;d++)g=g.concat(h[d].values),c=c.concat(h[d].values.sort());break;case"desc":for(;d<e;d++)g=g.concat(h[d].values),c=c.concat(h[d].values.sort().reverse())}}else switch(g=f.getColumnOriginalValues(b),a){case"asc":c=Fancy.Array.copy(g).sort();break;case"desc":c=Fancy.Array.copy(g).sort(),c=c.reverse()}f.order=f.getOrder(g,c)},getOrder:function(a,b){for(var c,d={},e=0,f=a.length,g=[];e<f;e++){var h=a[e];void 0===d[h]&&(d[h]=[]),d[h].push(e)}for(e=0;e<f;e++)h=b[e],c=d[h],g.push(c[0]),c.length>1&&c.splice(0,1);return g},changeOrderIndexes:function(a,b){var c=this;if(void 0===b&&(b="-"),void 0!==c.order){var d=0,e=c.order.length;if("-"===b)for(;d<e;d++)c.order[d]>a&&c.order[d]--;else for(;d<e;d++)c.order[d]>=a&&c.order[d]++}},initMultiSort:function(){var a=this;a.multiSortInited=!0,a.sorters||(a.sorters=[])},addSorter:function(a,b,c){for(var d=this,e=0,f=d.sorters.length;e<f;e++)if(d.sorters[e].key===a){d.sorters.splice(e,1);break}d.sorters.push({key:a,dir:b.toLocaleUpperCase(),type:c}),d.sorters.length>d.multiSortLimit&&d.sorters.shift()},multiSortOrder:function(a){for(var b,c,d,e=this,f=e.widget,g=f.store,h=e.sorters[a],i=e.sorters[a+1].key,j=h.key,k=0,l=e.getTotal(),m=[],n=[],o=[];k<l;k++)b=g.get(e.order[k],i,!0),d=g.get(e.order[k],j,!0),b===c?(m[m.length-1].push(d),n[n.length-1].push(e.order[k])):(m.push([d]),n.push([e.order[k]])),c=b;for(k=0,l=n.length;k<l;k++)if(1!==n[k].length){var p;if("number"===h.type)switch(h.dir){case"ASC":p=Fancy.Array.copy(m[k]).sort(function(a,b){return a-b});break;case"DESC":p=Fancy.Array.copy(m[k]).sort(function(a,b){return b-a})}else if("string"===h.type)switch(h.dir){case"ASC":p=Fancy.Array.copy(m[k]).sort();break;case"DESC":p=Fancy.Array.copy(m[k]).sort().reverse()}var q,r=n[k],s=[];q=e.getOrder(m[k],p);for(var t=0,u=q.length;t<u;t++)s.push(r[q[t]]);o=o.concat(s)}else o.push(n[k][0]);e.order=o}}),Fancy.Mixin("Fancy.store.mixin.Edit",{remove:function(a){var b,c,d,e=this,f=a.id;switch(Fancy.typeOf(a)){case"string":case"number":f=a;break;default:f=a.id||a.data.id}if("server"===e.proxyType&&e.autoSave&&e.proxy.api.destroy)return void e.proxyCRUD("DESTROY",f);a.rowIndex?(b=e.dataViewIndexes[a.rowIndex],c=a.rowIndex):(b=e.getDataIndex(f),c=e.getRow(f)),d=e.data.splice(b,1)[0],e.paging&&(c+=e.showPage*e.pageSize),e.order&&e.order.splice(c,1),e.changeOrderIndexes&&e.changeOrderIndexes(b),e.paging&&(0!==e.showPage&&e.showPage*e.pageSize===e.getTotal()&&e.showPage--,e.calcPages()),delete e.map[f],e.fire("remove",f,d),e.changeDataView()},removeAt:function(a){var b=this;b.remove({rowIndex:a,id:b.getId(a)})},removeAll:function(){var a=this;a.data=[],a.dataView=[],delete a.order,a.paging&&(a.showPage=0,a.calcPages()),a.filters&&(delete a.filters,delete a.filteredData,delete a.filterOrder)},add:function(a){var b=this;return b.insert(b.getTotal(),a)},insert:function(a,b){var c=this;if(c.grouping&&!c.bugFixGrouping&&(c.defineModel(b,!0),c.bugFixGrouping=!0),c.addIndex=a,void 0===b.id){Fancy.idSeed++;var d=Fancy.idSeed+1e3;"server"===c.proxyType?b.id="Temp-"+d:b.id=d}if(c.getById(b.id)&&c.remove(b.id),"server"!==c.proxyType||!c.autoSave||!c.proxy.api.create)return c.insertItem(b,a);c.once("create",c.onCreate,c),c.proxyCRUD("CREATE",b)},insertItem:function(a){var b=this,c=b.model,d=new c(a),e=b.addIndex;return b.fire("beforeinsert"),delete b.addIndex,d.$index=e,b.data.splice(e,0,d),b.order&&(b.order.splice(e,0,e),b.changeOrderIndexes(e,"+"),b.order[e]--),b.changeDataView(),b.map[a.id]=d,b.fire("insert",d),d},onCreate:function(a,b){return this.insertItem(b)}}),Fancy.Mixin("Fancy.store.mixin.Grouping",{expand:function(a,b){var c=this,d=c.data,e=0,f=d.length,g=[],h={},i={};for(c.filteredData&&(d=c.filteredData,f=d.length),c.expanded=c.expanded||{},c.expanded[b]=!0;e<f;e++){var j=d[e];c.expanded[j.data[a]]&&(g.push(j),h[j.id]=g.length-1,i[g.length-1]=e)}c.dataView=g,c.dataViewMap=h,c.dataViewIndexes=i},collapse:function(a,b){var c=this,d=c.data,e=0,f=d.length,g=[],h={},i={};for(c.expanded=c.expanded||{},delete c.expanded[b];e<f;e++){var j=d[e];c.expanded[j.data[a]]&&(g.push(j),h[j.id]=g.length-1,i[g.length-1]=e)}c.dataView=g,c.dataViewMap=h,c.dataViewIndexes=i},changeOrderByGroups:function(a,b){var c=this,d={},e=[];Fancy.each(a,function(a){d[a]=[]}),Fancy.isArray(c.data)&&Fancy.each(c.data,function(a){var c=a.data[b];d[c]&&d[c].push(a)}),Fancy.each(a,function(a){e=e.concat(d[a])}),c.grouping={by:b},c.data=e},getColumnOriginalValuesByGroup:function(a,b,c){var d=this,e=d.data,f=0,g=e.length,h=[],i=[],j=e[0].data[b];if(c&&c.format&&"date"===c.type)for(;f<g;f++)e[f].data[b]===j?i.push(Fancy.Date.parse(e[f].data[a],c.format,c.mode)):(h.push({values:i,groupName:j}),i=[],j=e[f].data[b],f--);else for(;f<g;f++)e[f].data[b]===j?i.push(e[f].data[a]):(h.push({values:i,groupName:j}),i=[],j=e[f].data[b],f--);return g>0&&h.push({values:i,groupName:j}),h},initGroups:function(a){var b=this,c=b.widget,d=c.grouping,a=a||"data",e=d.by;if(!e)throw new Error("[FancyGrid Error] - not set by param in grouping");var f=b.getColumnOriginalValues(e,{dataProperty:a,groupMap:!0}),g={};Fancy.each(f,function(a){void 0===g[a]&&(g[a]=0),g[a]++});var h=[];for(var i in g)h.push(i);return{groups:h,_groups:g}},orderDataByGroupOnStart:function(){var a=this,b=a.widget.grouping,c=a.initGroups(),d=c.groups,e={},f=[];Fancy.each(d,function(a){var b=a.toLocaleUpperCase();e[b]=a,f.push(b)}),f=f.sort();for(var g=0,h=d.length;g<h;g++)d[g]=e[f[g]];a.changeOrderByGroups(d,b.by),a.expanded={},b.collapsed?a.collapsed=!0:Fancy.each(d,function(c){b.expanded&&void 0!==b.expanded[c]||(a.expanded[c]=!0)}),a.changeDataView({doNotFired:!0})}}),Fancy.Mixin("Fancy.store.mixin.Filter",{filterCheckItem:function(a){var b=this,c=b.filters,d=!0,e=!1;for(var f in c){var g=c[f],h=a.data[f];if(b.smartIndexes&&b.smartIndexes[f])h=b.smartIndexes[f](a.data);else if(/\./.test(f)){var i=f.split(".");h=a.data[i[0]][i[1]]}"date"===g.type&&(h=Number(Fancy.Date.parse(h,g.format.read,g.format.mode)));for(var j in g){switch(j){case"type":case"format":continue}var k=g[j];switch(j){case"<":d=Number(h)<k;break;case">":d=Number(h)>k;break;case"<=":d=Number(h)<=k;break;case">=":d=Number(h)>=k;break;case"=":case"==":Fancy.isArray(k)?(h=String(h),d=-1!==k.indexOf(h)):d=h==k;break;case"===":Fancy.isArray(k)?(h=String(h),d=-1!==k.indexOf(h)):d=h===k;break;case"!==":d=h!==k;break;case"!=":d=h!=k;break;case"":k=String(k).toLocaleLowerCase(),h=String(h).toLocaleLowerCase(),k=k.replace(/\(/g,"bracketleft"),k=k.replace(/\)/g,"bracketright"),h=h.replace(/\(/g,"bracketleft"),h=h.replace(/\)/g,"bracketright"),d=new RegExp(k).test(h);break;case"*":d=new RegExp(String(k).toLocaleLowerCase()).test(String(h).toLocaleLowerCase()),e=!0;break;case"|":d=!0===k[String(h).toLocaleLowerCase()];break;default:throw new Error("FancyGrid Error 5: Unknown filter "+j)}if(!0===e){if(!0===d)return!0}else if(!1===d)return!1}}return!0!==e||!1!==d},filterData:function(){var a=this,b=a.data,c=[],d=0,e=b.length,f=[],g=[];for(a.remoteFilter&&a.serverFilter();d<e;d++)a.order?(f.push(a.order[d]),g=b[a.order[d]]):(f.push(d),g=b[d]),a.filterCheckItem(g)&&c.push(g);a.filterOrder=f,a.filteredData=c,a.paging&&a.calcPages(),a.fire("filter")},serverFilter:function(){var a=this,b="[",c=a.filters||{};for(var d in c){var e=c[d];for(var f in e){switch(f){case"type":case"format":continue}var g=a.filterOperators[f];if("or"===g){var h=[];for(var i in e[f])h.push(i);b+='{"operator":"'+g+'","value":"'+h.join(", ")+'","property":"'+d+'"},'}else b+='{"operator":"'+g+'","value":"'+e[f]+'","property":"'+d+'"},'}}b=b.replace(/\,$/,""),b+="]",a.params=a.params||{},"[]"===b?(b="",delete a.params[a.filterParam]):a.params[a.filterParam]=encodeURIComponent(b),a.loadData()}}),Fancy.Mixin("Fancy.store.mixin.Dirty",{initTrackDirty:function(){var a=this;a.changed={length:0},a.removed={length:0},a.inserted={length:0},a.on("remove",a.onDirtyRemove,a),a.on("set",a.onDirtySet,a),a.on("insert",a.onDirtyInsert,a)},onDirtySet:function(a,b){var c=this,d=b.id;"$selected"!==b.key&&(void 0===c.changed[d]?(c.changed[d]={length:1},c.changed.length++):c.changed[d].length++,void 0===c.changed[d][b.key]&&(c.changed[d][b.key]={originValue:b.oldValue}),c.changed[d][b.key].value=b.value,c.changed[d][b.key].value===c.changed[d][b.key].originValue&&(delete c.changed[d][b.key],c.changed[d].length--),0===c.changed[d].length&&(delete c.changed[d],c.changed.length--))},onDirtyRemove:function(a,b,c){this.removed[b]=c.data,this.removed.length++},onDirtyInsert:function(a,b){this.inserted[b.id]=b,this.inserted.length++}}),Fancy.define("Fancy.Store",{extend:Fancy.Event,mixins:["Fancy.store.mixin.Paging","Fancy.store.mixin.Proxy","Fancy.store.mixin.Rest","Fancy.store.mixin.Reader","Fancy.store.mixin.Writer","Fancy.store.mixin.Sort","Fancy.store.mixin.Edit","Fancy.store.mixin.Grouping","Fancy.store.mixin.Filter","Fancy.store.mixin.Search","Fancy.store.mixin.Dirty"],pageSize:10,showPage:0,pages:0,dirty:!1,constructor:function(){var a=this;a.Super("const",arguments),a.init(),a.data=a.data||[],a.dataView=a.dataView||[],a.dataViewMap=a.dataViewMap||{},a.map={},a.setModel(),a.data&&(a.data.proxy?a.initProxy():a.setData(a.data)),a.readSmartIndexes(),a.widget.grouping&&a.orderDataByGroupOnStart()},init:function(){var a=this;a.addEvents("add","change","changepages","set","beforeupdate","update","beforeremove","remove","beforedestroy","destroy","beforecreate","create","beforesort","sort","beforeload","load","filter","beforeinsert","insert","servererror","serversuccess"),a.initId(),a.initPlugins(),a.paging&&a.initPaging(),a.initTrackDirty&&a.initTrackDirty()},setModel:function(){var a=this,b=a.model;if(b=void 0===b?Fancy.Model:Fancy.ClassManager.get(a.model),a.model=b,a.fields=b.prototype.fields,void 0===a.fields)throw new Error("needed to set fields in Model of Store")},setData:function(a){var b,c=this,d=0,e=a.length,f=c.model;if(c.data=[],c.dataView=[],c.dataViewMap={},c.dataViewIndexes={},c.collapsed)for(;d<e;d++)b=new f(a[d]),b.$index=d,c.data[d]=b,c.map[b.id]=b;else if(c.expanded)for(;d<e;d++)b=new f(a[d]),b.$index=d,c.data[d]=b,c.map[b.id]=b;else if(c.paging)for(;d<e;d++)b=new f(a[d]),b.$index=d,c.data[d]=b,d<c.pageSize&&(c.dataView[d]=b,c.dataViewMap[b.id]=d,c.dataViewIndexes[d]=d),c.map[b.id]=b;else for(;d<e;d++)b=new f(a[d]),b.$index=d,c.data[d]=b,c.dataView[d]=b,c.dataViewMap[b.id]=d,c.dataViewIndexes[d]=d,c.map[b.id]=b},getItem:function(a){return this.dataView[a]},get:function(a,b,c){var d,e=this;if(void 0===a)return e.data;var f=e.dataView[a];if(f)return void 0===b?(d=f.data,void 0===d.id&&(d.id=e.dataView[a].id),e.dataView[a].data):"none"===b?"":c?e.data[a].data[b]:e.dataView[a].data[b]},getId:function(a){return this.dataView[a].id},getRow:function(a){return this.dataViewMap[a]},set:function(a,b,c,d){var e,f,g=this;if(-1===a?e=g.getById(d):(e=g.dataView[a],d=e.data.id||e.id),void 0===c){var h=b;for(var i in h)if("id"!==i){var j;-1===a?(f=e.get(i),e.set(i,h[i]),j=e.data):(f=g.get(a,i),g.dataView[a].data[i]=h[i],j=g.dataView[a].data),g.fire("set",{id:d,data:j,rowIndex:a,key:i,value:h[i],oldValue:f,item:e})}return void g.proxyCRUD("UPDATE",d,h)}if((f=-1===a?e.get(b):g.get(a,b))!=c){-1===a?e.set(b,c):g.dataView[a].data[b]=c,"server"===g.proxyType&&g.autoSave&&g.proxyCRUD("UPDATE",d,b,c);var j;j=-1===a?e.data:g.dataView[a].data,g.fire("set",{id:d,data:j,rowIndex:a,key:b,value:c,oldValue:f,item:e})}},setItemData:function(a,b){var c=this,d=c.get(a);if(c.writeAllFields&&"server"===c.proxyType)c.set(a,b);else for(var e in b)d[e]!=b[e]&&c.set(a,e,b[e])},getLength:function(){return this.dataView.length},getTotal:function(){var a=this;return"server"===a.pageType?a.totalCount:a.filteredData?a.filteredData.length:void 0===a.data?0:Fancy.isObject(a.data)?0:a.data.length},defineModel:function(a,b){var c=this,d=c.store;if(!c.model||!c.fields||0===c.fields.length||b){var a=a||c.data||d.data,e=c.getFieldsFromData(a),f="Fancy.model."+Fancy.id();Fancy.define(f,{extend:Fancy.Model,fields:e}),c.model=f,c.fields=e,c.setModel()}},getFieldsFromData:function(a){var b=a.items||a;if(a.fields)return a.fields;if(!b)throw new Error("not set fields of data");var c=b[0],d=[];void 0===b.length&&(c=b);for(var e in c)d.push(e);return d},getColumnOriginalValues:function(a,b){var c=this,d=0,e=[],b=b||{},f=b.dataProperty||"data",g=c[f],h=g.length;if(b.smartIndexFn)for(;d<h;d++)e.push(b.smartIndexFn(g[d].data));else if(b.format)if("date"===b.type)for(;d<h;d++)e.push(Fancy.Date.parse(g[d].data[a],b.format,b.mode));else for(;d<h;d++)e.push(g[d].data[a]);else if(b.groupMap)for(c.groupMap={};d<h;d++){var i=g[d],j=i.data[a];e.push(j),c.groupMap[i.id]=j}else for(;d<h;d++)e.push(g[d].data[a]);return e},changeDataView:function(a){var b,c=this,a=a||{},d=[],e={},f=0,g=c.data.length,h=!!c.filters,i=!!c.searches,j=c.data;if(h){if(a.stoppedFilter||a.doNotFired){if(c.paging&&"server"===c.pageType)return}else c.filterData();c.remoteFilter||(j=c.filteredData,g=j.length)}i&&(c.searchData(),j=c.searchedData,g=j.length),c.dataViewIndexes={},c.dataViewMap={},c.paging&&(f="server"===c.pageType?0:c.showPage*c.pageSize,g=f+c.pageSize);var k=c.getTotal();g>c.data.length&&(g=c.data.length),h&&g>k&&(g=k),Fancy.isObject(c.data)&&(g=0);var l;if(c.order)if(c.grouping)for(b=c.grouping.by;f<g;f++)c.expanded[c.data[c.order[f]].data[b]]&&(!0===h?(c.dataViewIndexes[d.length]=c.filterOrder[f],l=j[f]):(c.dataViewIndexes[d.length]=c.order[f],l=j[c.order[f]]),d.push(l),e[l.id]=d.length-1);else for(;f<g;f++)!0===h?(c.dataViewIndexes[d.length]=c.filterOrder[f],l=j[f]):(c.dataViewIndexes[d.length]=c.order[f],l=j[c.order[f]]),d.push(l),e[l.id]=d.length-1;else if(c.grouping)for(b=c.grouping.by;f<g;f++)c.expanded[c.data[f].data[b]]&&(c.dataViewIndexes[d.length]=f,l=j[f],d.push(l),e[l.id]=d.length-1);else for(;f<g;f++)c.dataViewIndexes[d.length]=f,l=j[f],d.push(j[f]),e[l.id]=d.length-1;c.dataView=d,c.dataViewMap=e,a.doNotFired||c.fire("change")},getColumnData:function(a,b){var c=this,d=0,e=c.data.length,f=[];if(b)for(;d<e;d++)f.push(b(c.data[d].data));else for(;d<e;d++)f.push(c.data[d].data[a]);return f},getData:function(){for(var a=this,b=0,c=a.data.length,d=[];b<c;b++)d.push(a.data[b].data);return d},getDataView:function(){for(var a=this,b=0,c=a.dataView.length,d=[];b<c;b++)d.push(a.dataView[b].data);return d},getById:function(a){return this.map[a]},changeItemId:function(a,b){var c=this,d=c.getById(a);if(!d)return!1;d.id=b,void 0!==d.data.id&&(d.data.id=b),delete c.map[a],c.map[b]=d,c.fire("changeitemid",a,b)},find:function(a,b){for(var c,d=this,e=d.dataView,f=0,g=e.length,h=[];f<g;f++)c=e[f],c.data[a]===b&&h.push(f);return h},findItem:function(a,b){for(var c,d=this,e=d.data,f=0,g=e.length,h=[];f<g;f++)c=e[f],c.data[a]===b&&h.push(c);return h},getDataIndex:function(a){for(var b,c,d=this,e=d.data,f=0,g=e.length;f<g;f++)b=e[f],b.data.id===a&&(c=f);return c},each:function(a,b){var c=this,d=c.dataView,e=0,f=d.length;if(b)for(;e<f;e++)a.apply(this,[d[e]]);else for(;e<f;e++)a(d[e])},readSmartIndexes:function(){var a=this,b=a.widget,c=0,d={};Fancy.each(b.columns,function(a){a.smartIndexFn&&(d[a.index]=a.smartIndexFn,c++)}),c&&(a.smartIndexes=d)}}),Fancy.$=window.$||window.jQuery,Fancy.nojQuery=void 0===Fancy.$,Fancy.get=function(a){switch(Fancy.typeOf(a)){case"string":return new Fancy.Element(Fancy.$("#"+a)[0]);case"array":return new Fancy.Elements(a);default:return new Fancy.Element(a)}},Fancy.Element=function(a){var b=this;b.dom=a,b.$dom=Fancy.$(a),b.length=1},Fancy.Element.prototype={last:function(){return Fancy.get(this.$dom)},closest:function(a){return Fancy.get(this.$dom.closest(a)[0])},destroy:function(){this.$dom.remove()},remove:function(){this.$dom.remove()},prev:function(){return Fancy.get(this.$dom.prev()[0])},lastChild:function(){var a=this.$dom.children();return Fancy.get(a[a.length-1])},firstChild:function(){return Fancy.get(this.$dom.children()[0])},on:function(a,b,c,d){var e=this;switch(c&&(b=Fancy.$.proxy(b,c)),d?e.$dom.on(a,d,b):e.$dom.on(a,b),a){case"mouseenter":e.onTouchEnterEvent&&e.onTouchEnterEvent(a,b,c,d);break;case"mouseleave":e.onTouchLeaveEvent&&e.onTouchLeaveEvent(a,b,c,d);break;case"mousemove":e.onTouchMove&&e.onTouchMove("touchmove",b)}},once:function(a,b,c,d){var e=this;c&&(b=Fancy.$.proxy(b,c)),d?e.$dom.one(a,d,b):e.$dom.one(a,b)},prop:function(a){return this.$dom.prop(a)},un:function(a,b,c,d){var e=this;c&&(b=Fancy.$.proxy(b,c)),d?e.$dom.off(a,d,b):e.$dom.off(a,b)},show:function(){this.$dom.show()},hide:function(){this.$dom.hide()},replaceClass:function(a,b){this.$dom.removeClass(a),this.$dom.addClass(b)},getByTag:function(a){return Fancy.get(this.$dom.find(a)[0])},getByClass:function(a){return this.$dom.find("."+a)[0]},addClass:function(a){this.addCls.apply(this,arguments)},addCls:function(a){if(this.$dom.addClass(a),arguments.length>1)for(var b=1,c=arguments.length;b<c;b++)this.addClass(arguments[b])},removeClass:function(a){this.$dom.removeClass(a)},removeCls:function(a){this.$dom.removeClass(a)},hasClass:function(a){return this.$dom.hasClass(a)},hasCls:function(a){return this.$dom.hasClass(a)},toggleClass:function(a){this.$dom.toggleClass(a)},toggleCls:function(a){this.$dom.toggleClass(a)},select:function(a){var b=this,c=b.$dom.find(a);return 1===c.length?Fancy.get(c[0]):c.length>1?Fancy.get(c):0===c.length?{length:0,dom:void 0,addClass:function(){},addCls:function(){},removeClass:function(){},removeCls:function(){},destroy:function(){},remove:function(){},css:function(){},each:function(){},last:function(){},attr:function(){}}:c},css:function(a,b){return void 0===b?this.$dom.css(a):this.$dom.css(a,b)},attr:function(a,b){return void 0===b?this.$dom.attr(a):this.$dom.attr(a,b)},append:function(a){return Fancy.get(this.$dom.append(a)[0])},after:function(a){return Fancy.get(this.$dom.after(a)[0])},next:function(){return Fancy.get(this.$dom.next()[0])},insertAfter:function(a){return Fancy.get(this.$dom.insertAfter(a)[0])},before:function(a){return Fancy.get(this.$dom.before(a)[0])},height:function(a){return a?(this.$dom.height(a),this):this.$dom.height()},width:function(a){return a?(this.$dom.width(a),this):this.$dom.width()},parent:function(a){return Fancy.get(this.$dom.parent(a)[0])},update:function(a){this.dom.innerHTML=a},hover:function(a,b){a&&this.$dom.on("mouseenter",a),a&&this.$dom.on("mouseleave",b)},position:function(){return this.$dom.position()},offset:function(){return this.$dom.offset()},focus:function(){this.$dom.focus()},blur:function(){this.$dom.blur()},within:function(a){var b,c=this,d=!0,e=!1;return a=Fancy.get(a),b=a.attr("id"),void 0!==b&&""!==b||(b=Fancy.id(),e=!0),a.attr("id",b),0===c.select("#"+b).length&&(d=!1),c.dom.id===a.dom.id&&(d=!0),e&&c.removeAttr(b),d},removeAttr:function(a){this.$dom.removeAttr(a)},item:function(){return this},animate:function(a,b,c,d){this.$dom.animate(a,b,c,d)},index:function(){return this.$dom.index()},onTouchEnterEvent:function(a,b,c,d){var e=this,f=Fancy.get(document.body),g=function(a,f){var g=Fancy.id(),h="fancy-tempt-attr";e.attr(h,g);for(var i=a.originalEvent.targetTouches[0],j=[i.pageX,i.pageY],k=Fancy.get(document.elementFromPoint(j[0]-document.body.scrollLeft,j[1]-document.body.scrollTop)),l=!1,m=10,n=k;m>0&&n.dom;){if(n.attr(h)===g){l=!0;break}n=n.parent(),m--}if(!l||e.touchIn||d||(a.pageX=i.pageX,a.pageY=i.pageY,b(a,f),e.touchIn=!0),l&&d){m=10,n=k;for(var o=[],p=0;m>0&&n.dom;){var q=n.select(d);if(0!==q.length){!0;var r=e.getDelegateTarget(d,q,o,p);r&&(a.currentTarget=r,a.delegateTarget=r,a.pageX=i.pageX,a.pageY=i.pageY,e.touchIn=!0,e.touchInDelegate=e.touchInDelegate||{},void 0===e.touchInDelegate[d]?e.touchInDelegate[d]=r:e.touchInDelegate[d]!==r&&(e.touchInDelegate[d]=[e.touchInDelegate[d],r]),b.apply(c,[a,r]));break}if(n.attr(h)===g)break;o.push(n.dom),n,n=n.parent(),m--,p++}}e.removeAttr(h)};f.on("touchmove",g)},onTouchLeaveEvent:function(a,b,c,d){var e=this,f=Fancy.get(document.body),g=[],h=function(a,c){var f=Fancy.id(),h="fancy-tempt-attr";if(e.attr(h,f),!0!==e.touchIn)return void e.removeAttr(h);var i=a.originalEvent.targetTouches[0],j=[i.pageX,i.pageY],k=Fancy.get(document.elementFromPoint(j[0]-document.body.scrollLeft,j[1]-document.body.scrollTop));if(!d){for(var l=!1,m=10,n=k;m>0&&n.dom;){if(n.attr(h)===f){l=!0;break}n=n.parent(),m--}if(!1===l)return a.pageX=i.pageX,a.pageY=i.pageY,e.touchIn=!1,b(a,c),void e.removeAttr(h)}if(g.length>30&&(g=g.slice(g.length-5,g.length-1)),g.push(k.dom),d&&e.touchInDelegate[d]){var o,p=Fancy.id();o=Fancy.isArray(e.touchInDelegate[d])?Fancy.get(e.touchInDelegate[d][0]):Fancy.get(e.touchInDelegate[d]),o.attr(h,p),m=10;var q=!1;for(n=k;m>0&&n.dom;){if(n.attr(h)===p){q=!0;break}n=n.parent(),m--}o.removeAttr(h),q||(delete e.touchInDelegate[d],e.touchIn=!1,a.currentTarget=o.dom,a.delegateTarget=o.dom,a.pageX=i.pageX,a.pageY=i.pageY,b(a,o.dom))}e.removeAttr(h)};f.on("touchmove",h)},getDelegateTarget:function(a,b,c,d){for(var e=c[d-a.match(/\./g).length],f=0,g=b.length;f<g;f++)if(b.item(f).dom===e)return e;return!1},onTouchMove:function(a,b,c){var d=this,e=Fancy.get(document.body),f=function(a,c){var e=Fancy.id(),f="fancy-tempt-attr";d.attr(f,e);for(var g=a.originalEvent.targetTouches[0],h=[g.pageX,g.pageY],i=!1,j=10,k=Fancy.get(document.elementFromPoint(h[0]-document.body.scrollLeft,h[1]-document.body.scrollTop)),l=k;j>0&&l.dom;){if(l.attr(f)===e){i=!0;break}l=l.parent(),j--}d.removeAttr(f),i&&(a.pageX=g.pageX,a.pageY=g.pageY,b(a,c))};e.on("touchmove",f)},each:function(a){a(this,0)}},Fancy.Elements=function(a){var b=this;b.dom=a,b.$dom=a,b.length=a.length},Fancy.Elements.prototype={attr:function(a,b){var c=this,d=c.$dom;return c.length>1&&(d=c.$dom[0]),void 0===b?d.attr(a):d.attr(a,b)},addClass:function(a){this.addCls.apply(this,arguments)},addCls:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).addClass(a);if(arguments.length>1)for(c=1,d=arguments.length;c<d;c++)b.addClass(arguments[c])},removeClass:function(a){this.removeCls.apply(this,arguments)},removeCls:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).removeCls(a)},hover:function(a){this.$dom.on("mouseenter",a)},on:Fancy.Element.prototype.on,once:Fancy.Element.prototype.once,item:function(a){return Fancy.get(this.$dom[a])},css:function(a,b){for(var c=this,d=0,e=c.length;d<e;d++)Fancy.get(c.$dom[d]).css(a,b)},toggleClass:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).toggleClass(a)},toggleCls:function(a){for(var b=this,c=0,d=b.length;c<d;c++)Fancy.get(b.$dom[c]).toggleClass(a)},destroy:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).destroy()},remove:function(){this.destroy()},hide:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).hide()},show:function(){for(var a=this,b=0,c=a.length;b<c;b++)Fancy.get(a.$dom[b]).show()},index:function(){return this.$dom[0].index()},each:function(a){for(var b,c=this,d=0,e=c.length;d<e;d++)b=new Fancy.Element(c.$dom[d]),a(b,d)},last:function(){var a=this;return new Fancy.Element(a.$dom[a.length-1])}},Fancy.select=function(a){return Fancy.get(document.body).select(a)},Fancy.onReady=function(a){$(document).ready(a)},Fancy.Ajax=function(a){var b={};a.url&&(b.url=a.url),a.success&&(b.success=a.success),a.error&&(b.error=a.error),a.method&&(b.type=a.method),a.params&&(b.data=a.params),a.sendJSON&&(b.dataType="json",b.contentType="application/json; charset=utf-8",b.data=JSON.stringify(b.data)),a.getJSON&&(b.dataType="json",b.contentType="application/json; charset=utf-8"),a.headers&&(b.headers=a.headers),Fancy.$.ajax(b)},Fancy.nojQuery&&(Fancy.$=function(){function a(a){return null==a?String(a):W[X.call(a)]||"object"}function b(b){return"function"==a(b)}function c(a){return null!=a&&a==a.window}function d(a){return null!=a&&a.nodeType==a.DOCUMENT_NODE}function e(b){return"object"==a(b)}function f(a){return e(a)&&!c(a)&&Object.getPrototypeOf(a)==Object.prototype}function g(a){return"number"==typeof a.length}function h(a){return E.call(a,function(a){return null!=a})}function i(a){return a.length>0?y.fn.concat.apply([],a):a}function j(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function k(a){return a in I?I[a]:I[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function l(a,b){return"number"!=typeof b||J[j(a)]?b:b+"px"}function m(a){var b,c;return H[a]||(b=G.createElement(a),G.body.appendChild(b),c=getComputedStyle(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),"none"==c&&(c="block"),H[a]=c),H[a]}function n(a){return"children"in a?F.call(a.children):y.map(a.childNodes,function(a){if(1==a.nodeType)return a})}function o(a,b){var c,d=a?a.length:0;for(c=0;c<d;c++)this[c]=a[c];this.length=d,this.selector=b||""}function p(a,b,c){for(x in b)c&&(f(b[x])||_(b[x]))?(f(b[x])&&!f(a[x])&&(a[x]={}),_(b[x])&&!_(a[x])&&(a[x]=[]),p(a[x],b[x],c)):b[x]!==w&&(a[x]=b[x])}function q(a,b){return null==b?y(a):y(a).filter(b)}function r(a,c,d,e){return b(c)?c.call(a,d,e):c}function s(a,b,c){null==c?a.removeAttribute(b):a.setAttribute(b,c)}function t(a,b){var c=a.className||"",d=c&&c.baseVal!==w;if(b===w)return d?c.baseVal:c;d?c.baseVal=b:a.className=b}function u(a){try{return a?"true"==a||"false"!=a&&("null"==a?null:+a+""==a?+a:/^[\[\{]/.test(a)?y.parseJSON(a):a):a}catch(b){return a}}function v(a,b){b(a);for(var c=0,d=a.childNodes.length;c<d;c++)v(a.childNodes[c],b)}var w,x,y,z,A,B,C=[],D=C.concat,E=C.filter,F=C.slice,G=window.document,H={},I={},J={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},K=/^\s*<(\w+|!)[^>]*>/,L=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,M=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,N=/^(?:body|html)$/i,O=/([A-Z])/g,P=["val","css","html","text","data","width","height","offset"],Q=["after","prepend","before","append"],R=G.createElement("table"),S=G.createElement("tr"),T={tr:G.createElement("tbody"),tbody:R,thead:R,tfoot:R,td:S,th:S,"*":G.createElement("div")},U=/complete|loaded|interactive/,V=/^[\w-]*$/,W={},X=W.toString,Y={},Z=G.createElement("div"),$={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},_=Array.isArray||function(a){return a instanceof Array};return Y.matches=function(a,b){if(!b||!a||1!==a.nodeType)return!1;var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=Z).appendChild(a),d=~Y.qsa(e,b).indexOf(a),f&&Z.removeChild(a),d},A=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},B=function(a){return E.call(a,function(b,c){return a.indexOf(b)==c})},Y.fragment=function(a,b,c){var d,e,g;return L.test(a)&&(d=y(G.createElement(RegExp.$1))),d||(a.replace&&(a=a.replace(M,"<$1></$2>")),b===w&&(b=K.test(a)&&RegExp.$1),b in T||(b="*"),g=T[b],g.innerHTML=""+a,d=y.each(F.call(g.childNodes),function(){g.removeChild(this)})),f(c)&&(e=y(d),y.each(c,function(a,b){P.indexOf(a)>-1?e[a](b):e.attr(a,b)})),d},Y.Z=function(a,b){return new o(a,b)},Y.isZ=function(a){return a instanceof Y.Z},Y.init=function(a,c){var d;if(!a)return Y.Z();if("string"==typeof a)if(a=a.trim(),"<"==a[0]&&K.test(a))d=Y.fragment(a,RegExp.$1,c),a=null;else{if(c!==w)return y(c).find(a);d=Y.qsa(G,a)}else{if(b(a))return y(G).ready(a);if(Y.isZ(a))return a;if(_(a))d=h(a);else if(e(a))d=[a],a=null;else if(K.test(a))d=Y.fragment(a.trim(),RegExp.$1,c),a=null;else{if(c!==w)return y(c).find(a);d=Y.qsa(G,a)}}return Y.Z(d,a)},y=function(a,b){return Y.init(a,b)},y.extend=function(a){var b,c=F.call(arguments,1);return"boolean"==typeof a&&(b=a,a=c.shift()),c.forEach(function(c){p(a,c,b)}),a},Y.qsa=function(a,b){var c,d="#"==b[0],e=!d&&"."==b[0],f=d||e?b.slice(1):b,g=V.test(f);return a.getElementById&&g&&d?(c=a.getElementById(f))?[c]:[]:1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType?[]:F.call(g&&!d&&a.getElementsByClassName?e?a.getElementsByClassName(f):a.getElementsByTagName(b):a.querySelectorAll(b))},y.contains=G.documentElement.contains?function(a,b){return a!==b&&a.contains(b)}:function(a,b){for(;b&&(b=b.parentNode);)if(b===a)return!0;return!1},y.type=a,y.isFunction=b,y.isWindow=c,y.isArray=_,y.isPlainObject=f,y.isEmptyObject=function(a){var b;for(b in a)return!1;return!0},y.inArray=function(a,b,c){return C.indexOf.call(b,a,c)},y.camelCase=A,y.trim=function(a){return null==a?"":String.prototype.trim.call(a)},y.uuid=0,y.support={},y.expr={},y.noop=function(){},y.map=function(a,b){var c,d,e,f=[];if(g(a))for(d=0;d<a.length;d++)null!=(c=b(a[d],d))&&f.push(c);else for(e in a)null!=(c=b(a[e],e))&&f.push(c);return i(f)},y.each=function(a,b){var c,d;if(g(a)){for(c=0;c<a.length;c++)if(!1===b.call(a[c],c,a[c]))return a}else for(d in a)if(!1===b.call(a[d],d,a[d]))return a;return a},y.grep=function(a,b){return E.call(a,b)},window.JSON&&(y.parseJSON=JSON.parse),y.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){W["[object "+b+"]"]=b.toLowerCase()}),y.fn={constructor:Y.Z,length:0,forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,splice:C.splice,indexOf:C.indexOf,concat:function(){var a,b,c=[];for(a=0;a<arguments.length;a++)b=arguments[a],c[a]=Y.isZ(b)?b.toArray():b;return D.apply(Y.isZ(this)?this.toArray():this,c)},map:function(a){return y(y.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return y(F.apply(this,arguments))},ready:function(a){return U.test(G.readyState)&&G.body?a(y):G.addEventListener("DOMContentLoaded",function(){a(y)},!1),this},get:function(a){return a===w?F.call(this):this[a>=0?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return C.every.call(this,function(b,c){return!1!==a.call(b,c,b)}),this},filter:function(a){return b(a)?this.not(this.not(a)):y(E.call(this,function(b){return Y.matches(b,a)}))},add:function(a,b){return y(B(this.concat(y(a,b))))},is:function(a){return this.length>0&&Y.matches(this[0],a)},not:function(a){var c=[];if(b(a)&&a.call!==w)this.each(function(b){a.call(this,b)||c.push(this)});else{var d="string"==typeof a?this.filter(a):g(a)&&b(a.item)?F.call(a):y(a);this.forEach(function(a){d.indexOf(a)<0&&c.push(a)})}return y(c)},has:function(a){return this.filter(function(){return e(a)?y.contains(this,a):y(this).find(a).size()})},eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!e(a)?a:y(a)},last:function(){var a=this[this.length-1];return a&&!e(a)?a:y(a)},find:function(a){var b=this;return a?"object"==typeof a?y(a).filter(function(){var a=this;return C.some.call(b,function(b){return y.contains(b,a)})}):1==this.length?y(Y.qsa(this[0],a)):this.map(function(){return Y.qsa(this,a)}):y()},closest:function(a,b){var c=this[0],e=!1;for("object"==typeof a&&(e=y(a));c&&!(e?e.indexOf(c)>=0:Y.matches(c,a));)c=c!==b&&!d(c)&&c.parentNode;return y(c)},parents:function(a){for(var b=[],c=this;c.length>0;)c=y.map(c,function(a){if((a=a.parentNode)&&!d(a)&&b.indexOf(a)<0)return b.push(a),a});return q(b,a)},parent:function(a){return q(B(this.pluck("parentNode")),a)},children:function(a){return q(this.map(function(){return n(this)}),a)},contents:function(){return this.map(function(){return this.contentDocument||F.call(this.childNodes)})},siblings:function(a){return q(this.map(function(a,b){return E.call(n(b.parentNode),function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return y.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=m(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var c=b(a);if(this[0]&&!c)var d=y(a).get(0),e=d.parentNode||this.length>1;return this.each(function(b){y(this).wrapAll(c?a.call(this,b):e?d.cloneNode(!0):d)})},wrapAll:function(a){if(this[0]){y(this[0]).before(a=y(a));for(var b;(b=a.children()).length;)a=b.first();y(a).append(this)}return this},wrapInner:function(a){var c=b(a);return this.each(function(b){var d=y(this),e=d.contents(),f=c?a.call(this,b):a;e.length?e.wrapAll(f):d.append(f)})},unwrap:function(){return this.parent().each(function(){y(this).replaceWith(y(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=y(this);(a===w?"none"==b.css("display"):a)?b.show():b.hide()})},prev:function(a){return y(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return y(this.pluck("nextElementSibling")).filter(a||"*")},html:function(a){return 0 in arguments?this.each(function(b){var c=this.innerHTML;y(this).empty().append(r(this,a,b,c))}):0 in this?this[0].innerHTML:null},text:function(a){return 0 in arguments?this.each(function(b){var c=r(this,a,b,this.textContent);this.textContent=null==c?"":""+c}):0 in this?this.pluck("textContent").join(""):null},attr:function(a,b){var c;return"string"!=typeof a||1 in arguments?this.each(function(c){if(1===this.nodeType)if(e(a))for(x in a)s(this,x,a[x]);else s(this,a,r(this,b,c,this.getAttribute(a)))}):this.length&&1===this[0].nodeType?!(c=this[0].getAttribute(a))&&a in this[0]?this[0][a]:c:w},removeAttr:function(a){return this.each(function(){1===this.nodeType&&a.split(" ").forEach(function(a){s(this,a)},this)})},prop:function(a,b){return a=$[a]||a,1 in arguments?this.each(function(c){this[a]=r(this,b,c,this[a])}):this[0]&&this[0][a]},data:function(a,b){var c="data-"+a.replace(O,"-$1").toLowerCase(),d=1 in arguments?this.attr(c,b):this.attr(c);return null!==d?u(d):w},val:function(a){return 0 in arguments?this.each(function(b){this.value=r(this,a,b,this.value)}):this[0]&&(this[0].multiple?y(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(a){if(a)return this.each(function(b){var c=y(this),d=r(this,a,b,c.offset()),e=c.offsetParent().offset(),f={top:d.top-e.top,left:d.left-e.left};"static"==c.css("position")&&(f.position="relative"),c.css(f)});if(!this.length)return null;if(!y.contains(G.documentElement,this[0]))return{top:0,left:0};var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(b,c){if(arguments.length<2){var d,e=this[0];if(!e)return;if(d=getComputedStyle(e,""),"string"==typeof b)return e.style[A(b)]||d.getPropertyValue(b);if(_(b)){var f={};return y.each(b,function(a,b){f[b]=e.style[A(b)]||d.getPropertyValue(b)}),f}}var g="";if("string"==a(b))c||0===c?g=j(b)+":"+l(b,c):this.each(function(){this.style.removeProperty(j(b))});else for(x in b)b[x]||0===b[x]?g+=j(x)+":"+l(x,b[x])+";":this.each(function(){this.style.removeProperty(j(x))});return this.each(function(){this.style.cssText+=";"+g})},index:function(a){return a?this.indexOf(y(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return!!a&&C.some.call(this,function(a){return this.test(t(a))},k(a))},addClass:function(a){return a?this.each(function(b){if("className"in this){z=[];var c=t(this);r(this,a,b,c).split(/\s+/g).forEach(function(a){y(this).hasClass(a)||z.push(a)},this),z.length&&t(this,c+(c?" ":"")+z.join(" "))}}):this},removeClass:function(a){return this.each(function(b){if("className"in this){if(a===w)return t(this,"");z=t(this),r(this,a,b,z).split(/\s+/g).forEach(function(a){z=z.replace(k(a)," ")}),t(this,z.trim())}})},toggleClass:function(a,b){return a?this.each(function(c){var d=y(this);r(this,a,c,t(this)).split(/\s+/g).forEach(function(a){(b===w?!d.hasClass(a):b)?d.addClass(a):d.removeClass(a)})}):this},scrollTop:function(a){if(this.length){var b="scrollTop"in this[0];return a===w?b?this[0].scrollTop:this[0].pageYOffset:this.each(b?function(){this.scrollTop=a}:function(){this.scrollTo(this.scrollX,a)})}},scrollLeft:function(a){if(this.length){var b="scrollLeft"in this[0];return a===w?b?this[0].scrollLeft:this[0].pageXOffset:this.each(b?function(){this.scrollLeft=a}:function(){this.scrollTo(a,this.scrollY)})}},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),c=this.offset(),d=N.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(y(a).css("margin-top"))||0,c.left-=parseFloat(y(a).css("margin-left"))||0,d.top+=parseFloat(y(b[0]).css("border-top-width"))||0,d.left+=parseFloat(y(b[0]).css("border-left-width"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||G.body;a&&!N.test(a.nodeName)&&"static"==y(a).css("position");)a=a.offsetParent;return a})}},y.fn.detach=y.fn.remove,["width","height"].forEach(function(a){var b=a.replace(/./,function(a){return a[0].toUpperCase()});y.fn[a]=function(e){var f,g=this[0];return e===w?c(g)?g["inner"+b]:d(g)?g.documentElement["scroll"+b]:(f=this.offset())&&f[a]:this.each(function(b){g=y(this),g.css(a,r(this,e,b,g[a]()))})}}),Q.forEach(function(b,c){var d=c%2;y.fn[b]=function(){var b,e,f=y.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:Y.fragment(c)}),g=this.length>1;return f.length<1?this:this.each(function(a,b){e=d?b:b.parentNode,b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null;var h=y.contains(G.documentElement,e);f.forEach(function(a){if(g)a=a.cloneNode(!0);else if(!e)return y(a).remove();e.insertBefore(a,b),h&&v(a,function(a){null==a.nodeName||"SCRIPT"!==a.nodeName.toUpperCase()||a.type&&"text/javascript"!==a.type||a.src||window.eval.call(window,a.innerHTML)})})})},y.fn[d?b+"To":"insert"+(c?"Before":"After")]=function(a){return y(a)[b](this),this}}),Y.Z.prototype=o.prototype=y.fn,Y.uniq=B,Y.deserializeValue=u,y.zepto=Y,y}()),Fancy.nojQuery&&function(a){function b(a){return a._zid||(a._zid=m++)}function c(a,c,f,g){if(c=d(c),c.ns)var h=e(c.ns);return(q[b(a)]||[]).filter(function(a){return a&&(!c.e||a.e==c.e)&&(!c.ns||h.test(a.ns))&&(!f||b(a.fn)===b(f))&&(!g||a.sel==g)})}function d(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function e(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function f(a,b){return a.del&&!s&&a.e in t||!!b}function g(a){return u[a]||s&&t[a]||a}function h(c,e,h,i,k,m,n){var o=b(c),p=q[o]||(q[o]=[]);e.split(/\s/).forEach(function(b){if("ready"==b)return a(document).ready(h);var e=d(b);e.fn=h,e.sel=k,e.e in u&&(h=function(b){var c=b.relatedTarget;if(!c||c!==this&&!a.contains(this,c))return e.fn.apply(this,arguments)}),e.del=m;var o=m||h;e.proxy=function(a){if(a=j(a),!a.isImmediatePropagationStopped()){a.data=i;var b=o.apply(c,a._args==l?[a]:[a].concat(a._args));return!1===b&&(a.preventDefault(),a.stopPropagation()),b}},e.i=p.length,p.push(e),"addEventListener"in c&&c.addEventListener(g(e.e),e.proxy,f(e,n))})}function i(a,d,e,h,i){var j=b(a);(d||"").split(/\s/).forEach(function(b){c(a,b,e,h).forEach(function(b){delete q[j][b.i],"removeEventListener"in a&&a.removeEventListener(g(b.e),b.proxy,f(b,i))})})}function j(b,c){return!c&&b.isDefaultPrevented||(c||(c=b),a.each(y,function(a,d){var e=c[a];b[a]=function(){return this[d]=v,e&&e.apply(c,arguments)},b[d]=w}),(c.defaultPrevented!==l?c.defaultPrevented:"returnValue"in c?!1===c.returnValue:c.getPreventDefault&&c.getPreventDefault())&&(b.isDefaultPrevented=v)),b}function k(a){var b,c={originalEvent:a};for(b in a)x.test(b)||a[b]===l||(c[b]=a[b]);return j(c,a)}var l,m=1,n=Array.prototype.slice,o=Fancy.isFunction,p=function(a){return"string"==typeof a},q={},r={},s="onfocusin"in window,t={focus:"focusin",blur:"focusout"},u={mouseenter:"mouseover",mouseleave:"mouseout"};r.click=r.mousedown=r.mouseup=r.mousemove="MouseEvents",a.event={add:h,remove:i},a.proxy=function(c,d){var e=2 in arguments&&n.call(arguments,2);if(o(c)){var f=function(){return c.apply(d,e?e.concat(n.call(arguments)):arguments)};return f._zid=b(c),f}if(p(d))return e?(e.unshift(c[d],c),a.proxy.apply(null,e)):a.proxy(c[d],c);throw new TypeError("expected function")},a.fn.bind=function(a,b,c){return this.on(a,b,c)},a.fn.unbind=function(a,b){return this.off(a,b)},a.fn.one=function(a,b,c,d){return this.on(a,b,c,d,1)};var v=function(){return!0},w=function(){return!1},x=/^([A-Z]|returnValue$|layer[XY]$)/,y={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(a,b,c){return this.on(b,a,c)},a.fn.undelegate=function(a,b,c){return this.off(b,a,c)},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.on=function(b,c,d,e,f){var g,j,m=this;return b&&!p(b)?(a.each(b,function(a,b){m.on(a,c,d,b,f)}),m):(p(c)||o(e)||!1===e||(e=d,d=c,c=l),e!==l&&!1!==d||(e=d,d=l),!1===e&&(e=w),m.each(function(l,m){f&&(g=function(a){return i(m,a.type,e),e.apply(this,arguments)}),c&&(j=function(b){var d,f=a(b.target).closest(c,m).get(0);if(f&&f!==m)return d=a.extend(k(b),{currentTarget:f,liveFired:m}),(g||e).apply(f,[d].concat(n.call(arguments,1)))}),h(m,b,e,d,c,j||g)}))},a.fn.off=function(b,c,d){var e=this;return b&&!p(b)?(a.each(b,function(a,b){e.off(a,c,b)}),e):(p(c)||o(d)||!1===d||(d=c,c=l),!1===d&&(d=w),e.each(function(){i(this,b,d,c)}))},a.fn.trigger=function(b,c){return b=p(b)||a.isPlainObject(b)?a.Event(b):j(b),b._args=c,this.each(function(){b.type in t&&"function"==typeof this[b.type]?this[b.type]():"dispatchEvent"in this?this.dispatchEvent(b):a(this).triggerHandler(b,c)})},a.fn.triggerHandler=function(b,d){var e,f;return this.each(function(g,h){e=k(p(b)?a.Event(b):b),e._args=d,e.target=h,a.each(c(h,b.type||b),function(a,b){if(f=b.proxy(e),e.isImmediatePropagationStopped())return!1})}),f},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=function(a){return 0 in arguments?this.bind(b,a):this.trigger(b)}}),a.Event=function(a,b){p(a)||(b=a,a=b.type);var c=document.createEvent(r[a]||"Events"),d=!0;if(b)for(var e in b)"bubbles"==e?d=!!b[e]:c[e]=b[e];return c.initEvent(a,d,!0),j(c)}}(Fancy.$),Fancy.nojQuery&&function(a,b){function c(a){return a.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase()}function d(a){return e?e+a:a.toLowerCase()}var e,f,g,h,i,j,k,l,m,n,o="",p={Webkit:"webkit",Moz:"",O:"o"},q=document.createElement("div"),r=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,s={};a.each(p,function(a,c){if(q.style[a+"TransitionProperty"]!==b)return o="-"+a.toLowerCase()+"-",e=c,!1}),f=o+"transform",s[g=o+"transition-property"]=s[h=o+"transition-duration"]=s[j=o+"transition-delay"]=s[i=o+"transition-timing-function"]=s[k=o+"animation-name"]=s[l=o+"animation-duration"]=s[n=o+"animation-delay"]=s[m=o+"animation-timing-function"]="",a.fx={off:e===b&&q.style.transitionProperty===b,speeds:{_default:400,fast:200,slow:600},cssPrefix:o,transitionEnd:d("TransitionEnd"),animationEnd:d("AnimationEnd")},a.fn.animate=function(c,d,e,f,g){return a.isFunction(d)&&(f=d,e=b,d=b),a.isFunction(e)&&(f=e,e=b),a.isPlainObject(d)&&(e=d.easing,f=d.complete,g=d.delay,d=d.duration),d&&(d=("number"==typeof d?d:a.fx.speeds[d]||a.fx.speeds._default)/1e3),g&&(g=parseFloat(g)/1e3),this.anim(c,d,e,f,g)},a.fn.anim=function(d,e,o,p,q){var t,u,v,w={},x="",y=this,z=a.fx.transitionEnd,A=!1;if(e===b&&(e=a.fx.speeds._default/1e3),q===b&&(q=0),a.fx.off&&(e=0),"string"==typeof d)w[k]=d,w[l]=e+"s",w[n]=q+"s",w[m]=o||"linear",z=a.fx.animationEnd;else{u=[];for(t in d)r.test(t)?x+=t+"("+d[t]+") ":(w[t]=d[t],u.push(c(t)));x&&(w[f]=x,u.push(f)),e>0&&"object"==typeof d&&(w[g]=u.join(", "),w[h]=e+"s",w[j]=q+"s",w[i]=o||"linear")}return v=function(b){if(void 0!==b){if(b.target!==b.currentTarget)return;a(b.target).unbind(z,v)}else a(this).unbind(z,v);A=!0,a(this).css(s),p&&p.call(this)},e>0&&(this.bind(z,v),setTimeout(function(){A||v.call(y)},1e3*(e+q)+25)),this.size()&&this.get(0).clientLeft,this.css(w),e<=0&&setTimeout(function(){y.each(function(){v.call(this)})},0),this},q=null}(Fancy.$),Fancy.nojQuery&&function(a,b){function c(c,d,e,f,g){"function"!=typeof d||g||(g=d,d=b);var h={opacity:e};return f&&(h.scale=f,c.css(a.fx.cssPrefix+"transform-origin","0 0")),c.animate(h,d,null,g)}function d(b,d,e,g){return c(b,d,0,e,function(){f.call(a(this)),g&&g.call(this)})}var e=a.fn.show,f=a.fn.hide,g=a.fn.toggle;a.fn.show=function(a,d){return e.call(this),a===b?a=0:this.css("opacity",0),c(this,a,1,"1,1",d)},a.fn.hide=function(a,c){return a===b?f.call(this):d(this,a,"0,0",c)},a.fn.toggle=function(c,d){return c===b||"boolean"==typeof c?g.call(this,c):this.each(function(){var b=a(this);b["none"==b.css("display")?"show":"hide"](c,d)})},a.fn.fadeTo=function(a,b,d){return c(this,a,b,null,d)},a.fn.fadeIn=function(a,b){var c=this.css("opacity");return c>0?this.css("opacity",0):c=1,e.call(this).fadeTo(a,c,b)},a.fn.fadeOut=function(a,b){return d(this,a,null,b)},a.fn.fadeToggle=function(b,c){return this.each(function(){var d=a(this);d[0==d.css("opacity")||"none"==d.css("display")?"fadeIn":"fadeOut"](b,c)})}}(Fancy.$),Fancy.nojQuery&&function(a){function b(b,c,d){var e=a.Event(c);return a(b).trigger(e,d),!e.isDefaultPrevented()}function c(a,c,d,e){if(a.global)return b(c||s,d,e)}function d(b){b.global&&0==a.active++&&c(b,null,"ajaxStart")}function e(b){b.global&&!--a.active&&c(b,null,"ajaxStop")}function f(a,b){var d=b.context;if(!1===b.beforeSend.call(d,a,b)||!1===c(b,d,"ajaxBeforeSend",[a,b]))return!1;c(b,d,"ajaxSend",[a,b])}function g(a,b,d,e){var f=d.context,g="success";d.success.call(f,a,g,b),e&&e.resolveWith(f,[a,g,b]),c(d,f,"ajaxSuccess",[b,d,a]),i(g,b,d)}function h(a,b,d,e,f){var g=e.context;e.error.call(g,d,b,a),f&&f.rejectWith(g,[d,b,a]),c(e,g,"ajaxError",[d,e,a||b]),i(b,d,e)}function i(a,b,d){var f=d.context;d.complete.call(f,b,a),c(d,f,"ajaxComplete",[b,d]),e(d)}function j(){}function k(a){return a&&(a=a.split(";",2)[0]),a&&(a==x?"html":a==w?"json":u.test(a)?"script":v.test(a)&&"xml")||"text"}function l(a,b){return""==b?a:(a+"&"+b).replace(/[&?]{1,2}/,"?")}function m(b){b.processData&&b.data&&"string"!=a.type(b.data)&&(b.data=a.param(b.data,b.traditional)),!b.data||b.type&&"GET"!=b.type.toUpperCase()||(b.url=l(b.url,b.data),b.data=void 0)}function n(b,c,d,e){return a.isFunction(c)&&(e=d,d=c,c=void 0),a.isFunction(d)||(e=d,d=void 0),{url:b,data:c,success:d,dataType:e}}function o(b,c,d,e){var f,g=a.isArray(c),h=a.isPlainObject(c);a.each(c,function(c,i){f=a.type(i),e&&(c=d?e:e+"["+(h||"object"==f||"array"==f?c:"")+"]"),!e&&g?b.add(i.name,i.value):"array"==f||!d&&"object"==f?o(b,i,d,c):b.add(c,i)})}var p,q,r=0,s=window.document,t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,u=/^(?:text|application)\/javascript/i,v=/^(?:text|application)\/xml/i,w="application/json",x="text/html",y=/^\s*$/,z=s.createElement("a");z.href=window.location.href,a.active=0,a.ajaxJSONP=function(b,c){if(!("type"in b))return a.ajax(b);var d,e,i=b.jsonpCallback,j=(a.isFunction(i)?i():i)||"jsonp"+ ++r,k=s.createElement("script"),l=window[j],m=function(b){a(k).triggerHandler("error",b||"abort")},n={abort:m};return c&&c.promise(n),a(k).on("load error",function(f,i){clearTimeout(e),a(k).off().remove(),"error"!=f.type&&d?g(d[0],n,b,c):h(null,i||"error",n,b,c),window[j]=l,d&&a.isFunction(l)&&l(d[0]),l=d=void 0}),!1===f(n,b)?(m("abort"),n):(window[j]=function(){d=arguments},k.src=b.url.replace(/\?(.+)=\?/,"?$1="+j),s.head.appendChild(k),b.timeout>0&&(e=setTimeout(function(){m("timeout")},b.timeout)),n)},a.ajaxSettings={type:"GET",beforeSend:j,success:j,error:j,complete:j,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:x,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},a.ajax=function(b){var c,e,i=a.extend({},b||{}),n=a.Deferred&&a.Deferred();for(p in a.ajaxSettings)void 0===i[p]&&(i[p]=a.ajaxSettings[p]);d(i),i.crossDomain||(c=s.createElement("a"),c.href=i.url,c.href=c.href,i.crossDomain=z.protocol+"//"+z.host!=c.protocol+"//"+c.host),i.url||(i.url=window.location.toString()),(e=i.url.indexOf("#"))>-1&&(i.url=i.url.slice(0,e)),m(i);var o=i.dataType,r=/\?.+=\?/.test(i.url);if(r&&(o="jsonp"),!1!==i.cache&&(b&&!0===b.cache||"script"!=o&&"jsonp"!=o)||(i.url=l(i.url,"_="+Date.now())),"jsonp"==o)return r||(i.url=l(i.url,i.jsonp?i.jsonp+"=?":!1===i.jsonp?"":"callback=?")),a.ajaxJSONP(i,n);var t,u=i.accepts[o],v={},w=function(a,b){v[a.toLowerCase()]=[a,b]},x=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,A=i.xhr(),B=A.setRequestHeader;if(n&&n.promise(A),i.crossDomain||w("X-Requested-With","XMLHttpRequest"),w("Accept",u||"*/*"),(u=i.mimeType||u)&&(u.indexOf(",")>-1&&(u=u.split(",",2)[0]),A.overrideMimeType&&A.overrideMimeType(u)),(i.contentType||!1!==i.contentType&&i.data&&"GET"!=i.type.toUpperCase())&&w("Content-Type",i.contentType||"application/x-www-form-urlencoded"),i.headers)for(q in i.headers)w(q,i.headers[q]);if(A.setRequestHeader=w,A.onreadystatechange=function(){if(4==A.readyState){A.onreadystatechange=j,clearTimeout(t);var b,c=!1;if(A.status>=200&&A.status<300||304==A.status||0==A.status&&"file:"==x){if(o=o||k(i.mimeType||A.getResponseHeader("content-type")),"arraybuffer"==A.responseType||"blob"==A.responseType)b=A.response;else{b=A.responseText;try{"script"==o?(0,eval)(b):"xml"==o?b=A.responseXML:"json"==o&&(b=y.test(b)?null:a.parseJSON(b))}catch(a){c=a}if(c)return h(c,"parsererror",A,i,n)}g(b,A,i,n)}else h(A.statusText||null,A.status?"error":"abort",A,i,n)}},!1===f(A,i))return A.abort(),h(null,"abort",A,i,n),A;if(i.xhrFields)for(q in i.xhrFields)A[q]=i.xhrFields[q];var C=!("async"in i)||i.async;A.open(i.type,i.url,C,i.username,i.password);for(q in v)B.apply(A,v[q]);return i.timeout>0&&(t=setTimeout(function(){A.onreadystatechange=j,A.abort(),h(null,"timeout",A,i,n)},i.timeout)),A.send(i.data?i.data:null),A},a.get=function(){return a.ajax(n.apply(null,arguments))},a.post=function(){var b=n.apply(null,arguments);return b.type="POST",a.ajax(b)},a.getJSON=function(){var b=n.apply(null,arguments);return b.dataType="json",a.ajax(b)},a.fn.load=function(b,c,d){if(!this.length)return this;var e,f=this,g=b.split(/\s/),h=n(b,c,d),i=h.success;return g.length>1&&(h.url=g[0],e=g[1]),h.success=function(b){f.html(e?a("<div>").html(b.replace(t,"")).find(e):b),i&&i.apply(f,arguments)},a.ajax(h),this};var A=encodeURIComponent;a.param=function(b,c){var d=[];return d.add=function(b,c){a.isFunction(c)&&(c=c()),null==c&&(c=""),this.push(A(b)+"="+A(c))},o(d,b,c),d.join("&").replace(/%20/g,"+")}}(Fancy.$),Fancy.i18n.en={paging:{first:"First Page",last:"Last Page",prev:"Previous Page",next:"Next Page",info:"Rows [0] - [1] of [2]",page:"Page",of:"of [0]"},loadingText:"Loading...",thousandSeparator:",",decimalSeparator:".",currencySign:"$",sourceText:"Source",date:{read:"m/d/Y",write:"m/d/Y",edit:"m/d/Y",today:"Today",startDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],am:"am",pm:"pm",AM:"AM",PM:"PM",ok:"OK",cancel:"Cancel"},yes:"Yes",no:"No",dragText:"[0] selected row[1]",update:"Update",cancel:"Cancel",columns:"Columns",sortAsc:"Sort ASC",sortDesc:"Sort DESC"},Fancy.i18n["en-US"]=Fancy.i18n.en,Fancy.controllers={},Fancy.defineController=function(a,b){Fancy.controllers[a]=b},Fancy.getController=function(a){return Fancy.controllers[a]},Fancy.define("Fancy.DD",{extend:Fancy.Event,singleton:!0,constructor:function(a){this.Super("const",arguments),this.init()},init:function(){this.addEvents(),this.els={}},add:function(a){var b=this,c=Fancy.id(a.overEl);b.els[c]=a,a.overEl.on("mousedown",b.onMouseDown,b)},onMouseDown:function(a){var b=this,c=Fancy.get(document),d=Fancy.get(a.currentTarget),e=b.els[d.attr("id")].dragEl;a.preventDefault(),b.clientX=a.clientX,b.clientY=a.clientY,b.startX=parseInt(e.css("left")),b.startY=parseInt(e.css("top")),b.activeId=d.attr("id"),c.once("mouseup",b.onMouseUp,b),c.on("mousemove",b.onMouseMove,b)},onMouseUp:function(){Fancy.get(document).un("mousemove",this.onMouseMove,this)},onMouseMove:function(a){var b=this,c=b.els[b.activeId],d=c.dragEl,e=a.clientX,f=a.clientY,g=b.clientX-e,h=b.clientY-f;d.css({left:b.startX-g,top:b.startY-h})}}),Fancy.define("Fancy.Widget",{extend:Fancy.Event,constructor:function(a){var b=this;Fancy.applyConfig(b,a),b.preInitControls(),b.Super("const",arguments),b.init(),b.initControls()},init:function(){var a=this;a.initId(),a.addEvents("beforerender","afterrender","render","show","beforehide","hide","destroy"),a.initPlugins()},renderItems:function(a){var b=this;Fancy.each(b.items,function(c,d){var e=Fancy.getClassByType(c.type);c.renderTo=a,b.items[d]=new e(c)})},preInitControls:function(){var a=this,b=a.controller||a.controllers;if(b)switch(Fancy.typeOf(b)){case"string":b=Fancy.getController(b);for(var c in b)void 0===a[c]&&(a[c]=b[c]);break;case"array":for(var d=[],e=0,f=b.length;e<f;e++){var g=Fancy.getController(b[e]);for(var c in g)"controls"!==c?void 0===a[c]&&(a[c]=g[c]):d=d.concat(g.controls)}a.controls=d}},initControls:function(){var a=this;if(void 0!==a.controls)for(var b=a.controls,c=0,d=b.length;c<d;c++){var e=b[c];if(void 0===e.event)throw new Error("[FancyGrid Error]: - not set event name for control");if(void 0===e.handler)throw new Error("[FancyGrid Error]: - not set handler for control");var f=e.event,g=e.handler,h=e.scope||a,i=e.selector;Fancy.isString(g)&&(g=a[g]),i?function(b,c,d,e){a.$events[b]?a.on(b,function(a,b){var f=b.e.target,g=Fancy.get(f),h=g.parent(),i=h.select(e);if(1===i.length&&i.within(f))c.apply(d,arguments);else if(i.length>1)for(var j=0,k=i.length;j<k;j++)i.item(j).within(f)&&c.apply(d,arguments)},d):a.on("render",function(){a.el.on(b,c,d,e)})}(f,g,h,i):void 0===i&&void 0===e.widget&&a.on(f,g,h)}},css:function(a,b){return this.el.css(a,b)},addClass:function(a){this.el.addCls(a)},addCls:function(a){this.el.addCls(a)},removeClass:function(a){this.el.removeCls(a)},removeCls:function(a){this.el.removeCls(a)},hasClass:function(a){return this.el.hasCls(a)},hasCls:function(a){return this.el.hasCls(a)},toggleClass:function(a){this.el.toggleCls(a)},toggleCls:function(a){this.el.toggleCls(a)},destroy:function(){this.el&&this.el.destroy()},show:function(){this.el.show()},hide:function(){this.el.hide()},initTpl:function(){var a=this;a.tpl&&(a.tpl=new Fancy.Template(a.tpl))}}),Fancy.define("Fancy.Plugin",{extend:Fancy.Event,constructor:function(a){this.Super("const",arguments),this.init()},init:function(){this.initId(),this.addEvents("beforerender","afterrender","render","show","hide","destroy")},initTpl:function(){var a=this.tpl;a&&(this.tpl=new Fancy.Template(a))}}),function(){var a={},b=Fancy,c=b.GRID_CLS,d=b.BUTTON_CLS,e=b.BUTTON_DISABLED_CLS,f=b.BUTTON_PRESSED_CLS,g=b.BUTTON_IMAGE_CLS,h=b.BUTTON_IMAGE_COLOR_CLS,i=b.BUTTON_TEXT_CLS,j=b.BUTTON_DROP_CLS;b.define("Fancy.Button",{extend:b.Widget,minWidth:30,constructor:function(b,c){var d=this;b.toggleGroup&&(a[b.toggleGroup]=a[b.toggleGroup]||{active:!1,items:[]},a[b.toggleGroup].items.push(d)),d.scope=c,d.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","mousedown","mouseup","mouseover","mouseout","pressedchange"),a.Super("init",arguments),a.style=a.style||{},a.initTpl(),a.render(),a.setOns()},setOns:function(){var a=this,b=a.el;b.on("click",a.onClick,a),b.on("mousedown",a.onMouseDown,a),b.on("mouseup",a.onMouseUp,a),b.on("mouseover",a.onMouseOver,a),b.on("mouseout",a.onMouseOut,a),a.tip&&b.on("mousemove",a.onMouseMove,a)},widgetCls:d,cls:"",extraCls:"",disabledCls:e,pressedCls:f,buttonImageCls:g,buttonImageColorCls:h,textCls:i,dropCls:j,text:"",height:28,paddingTextWidth:5,imageWidth:20,pressed:!1,tpl:['<div class="'+g+'"></div>','<a class="'+i+'">{text}</a>','<div class="'+j+'" style="{dropDisplay}"></div>'],render:function(){var a,c=this,d=b.get(document.createElement("div")),f=0;if(c.fire("beforerender"),c.wrapper&&c.renderWrapper(),a=b.get(c.renderTo||document.body).dom,c.width?f=c.width:!1!==c.text&&(f+=7*c.text.length+14),c.imageColor&&(c.imageCls=h),f<c.minWidth&&(f=(c.text&&c.text.length,c.minWidth)),c.imageCls&&c.text&&(f+=c.imageWidth),d.addCls(b.cls,c.widgetCls,c.cls,c.extraCls),c.disabled&&d.addCls(e),d.css({width:f+"px",height:c.height+"px"}),c.hidden&&d.css("display","none"),d.css(c.style||{}),d.update(c.tpl.getHTML({text:c.text||""})),c.imageCls){var i=d.select("."+g);c.imageColor&&i.css("background-color",c.imageColor),i.css("display","block"),b.isString(c.imageCls)&&i.addCls(c.imageCls)}c.el=b.get(a.appendChild(d.dom)),c.disabled&&c.disable(),c.pressed&&c.setPressed(c.pressed),c.initToggle(),c.width=f,c.fire("afterrender"),c.fire("render")},renderWrapper:function(){var a=this,c=a.wrapper,d=b.get(a.renderTo||document.body).dom,e=b.get(document.createElement("div"));e.css(c.style||{}),e.addCls(c.cls||""),a.wrapper=b.get(d.appendChild(e.dom)),a.renderTo=a.wrapper.dom},initToggle:function(){if(!this.enableToggle)return!1},setPressed:function(b,c){var d=this;if(b){if(d.addCls(f),d.pressed=!0,d.toggleGroup){var e=a[d.toggleGroup].active;e&&e.setPressed(!1),a[d.toggleGroup].active=d}}else d.removeCls(f),d.pressed=!1;!1!==c&&d.fire("pressedchange",d.pressed)},toggle:function(){var a=this,b=!a.pressed;a.setPressed(b),a.pressed=b},onClick:function(){var a=this,c=a.handler;a.fire("click"),!0!==a.disabled&&(c&&(b.isString(c)&&(c=a.getHandler(c)),a.scope?c.apply(a.scope,[a]):c(a)),a.enableToggle&&(a.toggleGroup?a.setPressed(!0):a.toggle()))},getHandler:function(a){var d=this;return b.getWidget(d.el.parent().parent().select("."+c).attr("id"))[a]||function(){throw new Error("[FancyGrid Error] - handler does not exist")}},onMouseDown:function(){this.fire("mousedown")},onMouseUp:function(){this.fire("mouseup")},onMouseOver:function(a){var b=this;b.fire("mouseover"),b.tip&&b.renderTip(a)},renderTip:function(a){var c=this;c.tooltip&&c.tooltip.destroy(),c.tooltip=new b.ToolTip({text:c.tip}),c.tooltip.css("display","block"),c.tooltip.show(a.pageX+15,a.pageY-25)},onMouseOut:function(){var a=this;a.fire("mouseout"),a.tooltip&&(a.tooltip.destroy(),delete a.tooltip)},setText:function(a){var b=this,c=b.el;b.css("width",(parseInt(c.css("font-size"))+2)*a.length+2*parseInt(b.css("padding-right"))+2),c.select("."+i).update(a)},disable:function(){this.disabled=!0,this.addCls(e)},enable:function(){this.disabled=!1,this.removeCls(e)},onMouseMove:function(a){var b=this;b.tip&&b.tooltip&&b.tooltip.show(a.pageX+15,a.pageY-25)}})}(),Fancy.define("Fancy.SegButton",{extend:Fancy.Widget,constructor:function(a,b){this.scope=b,this.Super("const",arguments)},init:function(){var a=this;a.addEvents("toggle"),a.Super("init",arguments),a.style=a.style||{},a.render()},widgetCls:Fancy.SEG_BUTTON_CLS,cls:"",extraCls:"",text:"",render:function(){var a,b=this,c=Fancy.get(document.createElement("div"));b.fire("beforerender"),a=Fancy.get(b.renderTo||document.body).dom,c.addCls(Fancy.cls,b.widgetCls,b.cls,b.extraCls),b.hidden&&c.css("display","none"),b.el=Fancy.get(a.appendChild(c.dom)),Fancy.each(b.style,function(a,c){b.el.css(c,a)}),b.renderButtons(),b.fire("afterrender"),b.fire("render")},renderButtons:function(){for(var a=this,b=a.items,c=0,d=b.length,e=Fancy.id(null,"fancy-toggle-group-");c<d;c++){var f=b[c];f.renderTo=a.el.dom,!1!==a.allowToggle&&(f.enableToggle=!0,!0!==a.multiToggle&&(f.toggleGroup=e)),f.style=0===c?{"border-right-width":0,"border-top-right-radius":0,"border-bottom-right-radius":0}:c>1?{"border-left-width":0,"border-top-left-radius":0,"border-bottom-left-radius":0}:{"border-top-left-radius":0,"border-bottom-left-radius":0},b.length>2&&0!==c&&c!==d-1&&Fancy.apply(f.style,{"border-top-right-radius":0,"border-bottom-right-radius":0,"border-top-left-radius":0,"border-bottom-left-radius":0}),a.items[c]=new Fancy.Button(f),a.items[c].on("pressedchange",function(b,c){a.fire("toggle",b,c,a.getValues())})}},getValues:function(){for(var a=this,b=[],c=a.items,d=0,e=c.length;d<e;d++)b.push(c[d].pressed);return b},clear:function(a){for(var b=this,c=b.items,d=0,e=c.length;d<e;d++)c[d].setPressed(!1,a)}}),Fancy.define("Fancy.toolbar.Tab",{extend:Fancy.Button,constructor:function(a,b){this.Super("const",arguments)},init:function(){this.Super("init",arguments)},cls:Fancy.BUTTON_CLS+" "+Fancy.TAB_TBAR_CLS,render:function(){this.Super("render",arguments)}}),function(){var a=Fancy,b=a.MENU_CLS,c=a.MENU_ITEM_CLS,d=a.MENU_ITEM_IMAGE_CLS,e=a.MENU_ITEM_TEXT_CLS,f=a.MENU_ITEM_ACTIVE_CLS,g=a.MENU_ITEM_RIGHT_IMAGE_CLS,h=a.MENU_ITEM_EXPAND_CLS;Fancy.define("Fancy.Menu",{extend:Fancy.Widget,constructor:function(a,b){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("hide"),a.Super("init",arguments),a.applyDefaults(),a.render(),a.ons()},ons:function(){var a=this,b=a.el;b.on("mousedown",a.onItemMouseDown,a,"."+c),b.on("click",a.onItemClick,a,"."+c),b.on("mouseenter",a.onItemEnter,a,"."+c),b.on("mouseleave",a.onItemLeave,a,"."+c)},widgetCls:b,itemCls:c,itemImageCls:d,cls:"",extraCls:"",width:142,itemHeight:30,rendered:!1,theme:"default",render:function(){var a,b=this,c=Fancy.get(document.createElement("div"));b.fire("beforerender"),"default"!==b.theme&&c.addCls("fancy-theme-"+b.theme),c.addClass(Fancy.cls,b.widgetCls,b.cls,b.extraCls),c.css({width:b.width,height:b.getItemsHeight()}),a=Fancy.get(b.renderTo||document.body),b.el=a.dom.appendChild(c.dom),b.el=Fancy.get(b.el),b.renderItems(),b.fire("afterrender"),b.fire("render"),b.rendered=!0},getItemsHeight:function(){for(var a=0,b=0,c=this.items.length;b<c;b++)a+=this.itemHeight;return a},renderItems:function(){for(var a,b=this,c=0,f=b.items.length;c<f;c++){a=b.items[c];var i=Fancy.get(document.createElement("div"));i.attr("index",c),i.addCls(b.itemCls),i.css("height",b.itemHeight),b.el.dom.appendChild(i.dom),a.el=i;var j=a.imageCls||"";switch(a.cls&&i.addCls(a.cls),i.update([!1===a.image?"":'<div class="'+d+" "+j+'"></div>','<div class="'+e+'"></div>','<div class="'+g+" "+(a.items?h:"")+'"></div>'].join("")),!1===a.image&&i.addCls("fancy-menu-item-no-image"),a.type){case"":break;default:i.select("."+e).item(0).update(a.text||"")}void 0!==a.checked&&(b.items[c].checkbox=new Fancy.CheckBox({label:!1,theme:b.theme,padding:"1px 8px 0px",renderTo:i.select("."+d).item(0).dom,value:a.checked}))}},applyDefaults:function(){var a=this,b=0,c=a.items.length;if(a.defaults)for(;b<c;b++)Fancy.applyIf(a.items[b],a.defaults)},onItemClick:function(a){var b=this,c=Fancy.get(a.currentTarget),d=c.attr("index"),e=b.items[d],f=[b,e];e.handler&&(e.scope?e.handler.apply(e.scope,f):e.handler(b,e))},onItemEnter:function(a){var b=this,c=Fancy.get(a.currentTarget),d=c.attr("index"),e=b.items[d],f=c.offset();if(b.shownSubMenu&&b.shownSubMenu.hide(),b.deActivateItem(),b.activateItem(d),e.items){if(!e.menu){var g=b.items[d];Fancy.apply(g,{parentItem:e,parentMenu:b,defaults:e.defaults,items:e.items,theme:b.theme}),b.items[d].menu=new Fancy.Menu(g)}e.menu.showAt(f.left+parseInt(c.width()),f.top),b.shownSubMenu=e.menu}},onItemLeave:function(a){},showAt:function(a,b){var c=this;c.css("position","absolute"),c.css("left",a),c.css("top",b),c.el.show(),c.parentMenu||Fancy.MenuManager.add(c)},hide:function(){var a=this;a.el.hide(),a.deActivateItem(),a.shownSubMenu&&a.shownSubMenu.hide(),a.fire("hide")},hideAll:function(){var a=this.parentMenu;a&&"none"!==a.el.css("display")&&a.hide(),this.hide()},activateItem:function(a){var b=this.items[a];this.activeItem=b,b.el.addCls(f)},deActivateItem:function(){var a=this.activeItem;a&&(a.el.removeClass(f),delete this.activeItem)},onItemMouseDown:function(a){a.preventDefault()}}),Fancy.define("Fancy.MenuManager",{singleton:!0,inited:!1,constructor:function(){},init:function(){Fancy.get(document).on("click",this.onDocClick,this)},add:function(a){var b=this;b.inited||b.init(),b.activeMenu=a},onDocClick:function(a){var c=this,d=Fancy.get(a.target),e=10,f=d;if(c.activeMenu){for(;e>0&&f.dom;){if(f.hasCls(b))return;f=f.parent(),e--}c.activeMenu.hide(),delete c.activeMenu}}})}(),function(){var a=Fancy,b=a.FOOTER_STATUS_CLS,c=a.STATUS_SOURCE_TEXT_CLS,d=a.STATUS_SOURCE_LINK_CLS,e=a.FOOTER_SOURCE_CLS;Fancy.Mixin("Fancy.panel.mixin.PrepareConfig",{prepareConfigTheme:function(a,b){var c=a.theme||b.theme,d=Fancy.getTheme(c).config;return Fancy.isObject(c)&&(a.theme=c.name),Fancy.applyIf(a,d),a},prepareConfigFooter:function(a){var f=a.footer,g=a.lang;if(f){var h=[];if(Fancy.isString(f.status)&&h.push({type:"text",text:f.status,cls:b}),f.status&&f.source&&h.push("side"),Fancy.isString(f.source))h.push({type:"text",text:f.source,cls:e});else if(Fancy.isObject(f.source)){var i=f.source.text,j=f.source.sourceText||g.sourceText;if(f.source.link){var k=f.source.link;k=k.replace("http://",""),k="http://"+k,i='<span class="'+c+'">'+j+'</span>: <a class="'+d+'" href="'+k+'">'+i+"</a>"}else i="<span>"+j+":</span> "+i;h.push({type:"text",text:i,cls:e})}a.footer=h}return a},prepareConfigLang:function(a,b){var c=b.i18n||a.i18n,d=Fancy.Object.copy(Fancy.i18n[c]);if(a.lang){for(var e in a.lang)!1===Fancy.isObject(a.lang[e])&&(d[e]=a.lang[e]);d.paging={},a.lang.paging&&Fancy.apply(d.paging,a.lang.paging);for(var e in a.lang.paging)"paging"!==e&&(Fancy.isObject(e)||(d[e]=a.lang.paging[e]));d.date={},a.lang.date&&Fancy.apply(d.date,a.lang.date)}return a.lang=d,a}})}(),Fancy.Mixin("Fancy.panel.mixin.methods",{setTitle:function(a){this.panel&&this.panel.setTitle(a)},getTitle:function(){if(this.panel)return this.panel.getTitle()},setSubTitle:function(a){this.panel&&this.panel.setSubTitle(a)},getSubTitle:function(){if(this.panel)return this.panel.getSubTitle()}}),Fancy.Mixin("Fancy.panel.mixin.DD",{ddCls:Fancy.PANEL_DRAGGABLE_CLS,initDD:function(){this.addDDCls(),this.addDD()},addDDCls:function(){this.el.addCls(this.ddCls)},addDD:function(){Fancy.DD.add({dragEl:this.el,overEl:this.el.select("."+Fancy.PANEL_HEADER_CLS).item(0)})}}),Fancy.Mixin("Fancy.panel.mixin.Resize",{cornerResizeCls:"fancy-panel-resize-corner",resizeMaskCls:"fancy-panel-resize-mask",initResize:function(){var a=this;a.addEvents("resize"),a.activeResizeEl=void 0,a.renderResizeEls(),a.onsResizeEls()},renderResizeEls:function(){var a=this,b=a.el,c=Fancy.get(document.createElement("div"));c.addCls(a.cornerResizeCls),a.cornerResizeEl=Fancy.get(b.dom.appendChild(c.dom))},onResize:function(){var a=this;a.tbar&&a._tbar.applyScrollChanges(),a.subTBar&&a._subTBar.applyScrollChanges(),a.bbar&&a._bbar.applyScrollChanges(),a.footer&&a._footer.applyScrollChanges(),a.buttons&&a._buttons.applyScrollChanges()},onsResizeEls:function(a){var b=this;b.cornerResizeEl.on("mousedown",b.onMouseDownResizeEl,b),b.on("resize",b.onResize,b)},onMouseDownResizeEl:function(a){var b=this,c=Fancy.get(document);a.preventDefault(),c.once("mouseup",b.onMouseUpResize,b),c.on("mousemove",b.onMouseMoveResize,b),b.renderResizeMask(),b.startClientX=a.clientX,b.startClientY=a.clientY},onMouseUpResize:function(){var a=this,b=Fancy.get(document);delete a.activeResizeEl,a.resizeMaskEl.destroy(),delete a.startClientX,delete a.startClientY,b.un("mousemove",a.onMouseMoveResize,a),a.setWidth(a.newResizeWidth),a.setHeight(a.newResizeHeight),a.fire("resize",{width:a.newResizeWidth,height:a.newResizeHeight})},onMouseMoveResize:function(a){var b=this,c=a.clientX,d=a.clientY,e=b.startClientX-c,f=b.startClientY-d,g=b.startResizeWidth-e,h=b.startResizeHeight-f;a.preventDefault(),a.stopPropagation(),g<b.minWidth&&(g=b.minWidth),h<b.minHeight&&(h=b.minHeight),b.newResizeWidth=g,b.newResizeHeight=h,b.resizeMaskEl.css({width:g,height:h})},renderResizeMask:function(){var a=this,b=a.el,c=2,d=Fancy.get(document.createElement("div")),e=parseInt(b.css("top")),f=parseInt(b.css("left")),g=parseInt(b.css("width"))-2*c,h=parseInt(b.css("height"))-2*c,i=parseInt(b.css("z-index"));if(a.startResizeWidth=g,a.startResizeHeight=h,!a.window&&"absolute"!==b.css("position")){var j=b.offset();e=j.top,f=j.left}d.addCls(a.resizeMaskCls),d.css({left:f,top:e,width:g,height:h,"z-index":i}),a.resizeMaskEl=Fancy.get(document.body.appendChild(d.dom))}}),function(){var a=Fancy,b=a.HIDDEN_CLS,c=a.MODAL_CLS,d=a.PANEL_CLS,e=a.PANEL_HEADER_CLS,f=a.PANEL_SUB_HEADER_TEXT_CLS,g=a.PANEL_HEADER_TEXT_CLS,h=a.PANEL_HEADER_TOOLS_CLS,i=a.PANEL_SUB_HEADER_CLS,j=a.PANEL_BODY_CLS,k=a.PANEL_BODY_INNER_CLS,l=a.PANEL_TBAR_CLS,m=a.PANEL_SUB_TBAR_CLS,n=a.PANEL_BUTTONS_CLS,o=a.PANEL_BBAR_CLS,p=a.PANEL_HEADER_IMG_CLS,q=a.PANEL_NOFRAME_CLS,r=a.PANEL_SHADOW_CLS,s=a.PANEL_FOOTER_CLS,t=a.FIELD_PICKER_BUTTON_CLS;a.define("Fancy.Panel",{extend:a.Widget,barScrollEnabled:!0,mixins:["Fancy.panel.mixin.DD","Fancy.panel.mixin.Resize"],constructor:function(b){a.apply(this,b),this.Super("constructor",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initTpl(),a.render(),a.draggable&&a.initDD(),a.resizable&&a.initResize(),a.window&&a.setActiveWindowWatcher()},cls:d,value:"",width:300,height:200,titleHeight:30,subTitleHeight:30,barHeight:37,title:void 0,frame:!0,shadow:!0,draggable:!1,minWidth:200,minHeight:200,barContainer:!0,theme:"default",tpl:['<div style="height:{titleHeight}px;" class="'+e+" "+b+'">',"{titleImg}",'<div class="'+g+'">{title}</div>','<div class="'+h+'"></div>',"</div>",'<div style="height:{subTitleHeight}px;" class="'+i+" "+b+'">','<div class="'+f+'">{subTitle}</div>',"</div>",'<div class="'+j+'">','<div class="'+l+" "+b+'" style="height:{barHeight}px;"></div>','<div class="'+m+" "+b+'" style="height:{barHeight}px;"></div>','<div class="'+k+'"></div>','<div class="'+o+" "+b+'" style="height:{barHeight}px;"></div>','<div class="'+n+" "+b+'" style="height:{barHeight}px;"></div>','<div class="'+s+" "+b+'" style="height:{barHeight}px;"></div>',"</div>"],render:function(){var d=this,f=a.get(d.renderTo||document.body),g=a.get(document.createElement("div")),h=d.titleHeight,k=d.subTitleHeight;!0===d.window&&g.css({display:"none",position:"absolute"}),!1===d.frame&&g.addCls(q),g.addCls(a.cls,d.cls),"default"!==d.theme&&g.addCls("fancy-theme-"+d.theme),d.shadow&&g.addCls(r),g.css({width:d.width+"px",height:d.height-0+"px"}),d.style&&g.css(d.style);var t="",u="";a.isObject(d.title)?t=d.title.text:a.isString(d.title)&&(t=d.title),a.isObject(d.subTitle)?u=d.subTitle.text:a.isString(d.subTitle)&&(u=d.subTitle);var v="";a.isObject(d.title)&&d.title.imgCls&&(v='<div class="'+p+" "+d.title.imgCls+'"></div>'),g.update(d.tpl.getHTML({titleImg:v,barHeight:d.barHeight,titleHeight:h,subTitleHeight:k,title:t,subTitle:u})),a.isObject(d.title)&&(d.title.style&&g.select("."+e).css(d.title.style),d.title.cls&&g.select("."+e).addCls(d.title.cls),d.title.tools&&(d.tools=d.title.tools)),a.isObject(d.subTitle)&&(d.subTitle.style&&g.select("."+i).css(d.subTitle.style),d.subTitle.cls&&g.select("."+i).addCls(d.subTitle.cls)),d.title?g.select("."+e).removeCls(b):g.select("."+j).css("border-top-width","0px"),d.subTitle&&(g.select("."+j).css("border-top-width","0px"),g.select("."+i).removeCls(b)),d.tbar&&g.select("."+l).removeCls(b),d.subTBar&&g.select("."+m).removeCls(b),d.bbar&&g.select("."+o).removeCls(b),d.buttons&&g.select("."+n).removeCls(b),d.footer&&g.select("."+s).removeCls(b),d.el=f.dom.appendChild(g.dom),d.el=a.get(d.el),d.modal&&0===a.select(c).length&&a.get(document.body).append('<div class="'+c+'" style="display: none;"></div>'),d.id&&d.el.attr("id",d.id),d.renderTools(),d.renderBars(),d.setHardBordersWidth()},setHardBordersWidth:function(){var a=this.panelBodyBorders;this.el.select("."+j).css({"border-top-width":a[0],"border-right-width":a[1],"border-bottom-width":a[2],"border-left-width":a[3]})},renderTools:function(){var b=this,c=b.tools;void 0!==c&&a.each(c,function(c,d){c.renderTo=b.el.select("."+h).dom,b.tools[d]=new a.Tool(c,b.scope||b)})},renderBars:function(){var b=this,c=!1,d=b.theme,e=this;b.items&&b.items[0]&&("grid"===b.items[0].type&&(c=!0),e=b.items[0]),b.bbar&&(b._bbar=new a.Bar({el:b.el.select("."+o),items:b.bbar,height:b.barHeight,barContainer:b.barContainer,barScrollEnabled:b.barScrollEnabled,scope:e,theme:d}),b.bbar=b._bbar.items),b.buttons&&(b._buttons=new a.Bar({el:b.el.select("."+n),items:b.buttons,height:b.barHeight,barScrollEnabled:b.barScrollEnabled,scope:e,theme:d}),b.buttons=b._buttons.items),b.tbar&&(b._tbar=new a.Bar({el:b.el.select("."+l),items:b.tbar,height:b.barHeight,tabEdit:!b.subTBar&&c,barScrollEnabled:b.barScrollEnabled,scope:e,theme:d}),b.tbar=b._tbar.items),b.subTBar&&(b._subTBar=new a.Bar({el:b.el.select("."+m),items:b.subTBar,height:b.barHeight,tabEdit:c,barScrollEnabled:b.barScrollEnabled,scope:e,theme:d}),b.subTBar=b._subTBar.items),b.footer&&(b._footer=new a.Bar({disableScroll:!0,el:b.el.select("."+s),items:b.footer,height:b.barHeight,barScrollEnabled:b.barScrollEnabled,scope:e,theme:d}),b.footer=b._footer.items)},showAt:function(b,c){this.css({left:b+"px",display:"","z-index":1e3+a.zIndex++}),void 0!==c&&this.css({top:c+"px"})},show:function(){var b=this;if(b.el.show(),!0===b.window){b.buttons&&b._buttons.checkScroll(),b.tbar&&b._tbar.checkScroll(),b.bbar&&b._bbar.checkScroll(),b.subTBar&&b._subTBar.checkScroll();var d=a.getViewSize(),e=b.el.height(),f=b.el.width(),g=[],h=a.getScroll(),i=h[0],j=h[1];g[0]=(d[1]-f)/2,g[1]=(d[0]-e)/2,g[0]<10&&(g[0]=10),g[1]<10&&(g[1]=10),b.css({left:g[0]+j+"px",top:g[1]+i+"px",display:"","z-index":1e3+a.zIndex++}),a.select("."+c).css("display","")}},hide:function(){this.css({display:"none"}),a.select("."+c).css("display","none"),a.each(this.items||[],function(a){"combo"===a.type&&a.hideList()})},setTitle:function(a){this.el.select("."+g).update(a)},getTitle:function(){return this.el.select("."+g).dom.innerHTML},setSubTitle:function(a){this.el.select("."+f).update(a)},getSubTitle:function(){return this.el.select("."+f).dom.innerHTML},getHeight:function(){return parseInt(this.css("height"))},setWidth:function(a){this.items[0].setWidth(a)},setHeight:function(a){this.css("height",a),this.items[0].setHeight(a,!1)},setActiveWindowWatcher:function(){var b=this;b.el.on("click",function(c){a.get(c.target).hasCls(t)||1e3+a.zIndex-1>parseInt(b.css("z-index"))&&b.css("z-index",1e3+a.zIndex++)})}})}(),function(){var a=Fancy,b=a.BUTTON_CLS;a.define("Fancy.Tool",{extend:a.Widget,constructor:function(a,b){this.scope=b,this.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","mousedown","mouseup","mouseover","mouseout"),a.Super("init",arguments),a.style=a.style||{},a.render(),a.ons()},ons:function(){this.on("click",this.onClick,this)},cls:b,text:"",height:28,paddingTextWidth:5,render:function(){var b=this,c=a.get(b.renderTo||document.body).dom,d=document.createElement("div");b.fire("beforerender"),d.className="fancy-tool-button",d.innerHTML=b.text,b.el=a.get(c.appendChild(d)),b.fire("afterrender"),b.fire("render")},onClick:function(){var a=this;a.fire("click"),a.handler&&(a.scope?a.handler.apply(a.scope,[a]):a.handler(a))},setText:function(a){this.el.update(a)}})}(),function(){var a=Fancy,b=a.PANEL_BODY_INNER_CLS,c=a.PANEL_GRID_INSIDE_CLS,d=a.TAB_WRAPPER_CLS,e=a.TAB_ACTIVE_WRAPPER_CLS,f=a.TAB_TBAR_ACTIVE_CLS,g=a.PANEL_TAB_CLS;a.define(["Fancy.panel.Tab","Fancy.Tab","FancyTab"],{extend:a.Panel,constructor:function(a,b){this.prepareConfigTheme(a),this.Super("const",arguments)},init:function(){var a=this;a.prepareTabs(),a.Super("init",arguments),a.setActiveTab(a.activeTab)},activeTab:0,theme:"default",render:function(){var a=this;a.Super("render",arguments),a.panelBodyEl=a.el.select("."+b).item(0),a.setPanelBodySize(),a.renderTabWrappers(),a.wrapped||a.el.addCls(c),a.el.addCls(g),a.rendered=!0},setPanelBodySize:function(){var a=this,b=a.height,c=a.panelBodyBorders;a.title&&(b-=a.titleHeight),a.subTitle&&(b-=a.subTitleHeight,b+=c[2]),a.bbar&&(b-=a.barHeight),a.tbar&&(b-=a.barHeight),a.subTBar&&(b-=a.barHeight),a.buttons&&(b-=a.barHeight),a.footer&&(b-=a.barHeight),b-=c[0]+c[2],a.panelBodyEl.css({height:b}),a.panelBodyHeight=b,a.panelBodyWidth=a.width-c[1]-c[3]},prepareConfigTheme:function(b){var c=this,d=b.theme||c.theme,e=a.getTheme(d).config;(c.wrapped||b.wrapped)&&(b.panelBodyBorders=[0,0,0,0],c.panelBodyBorders=[0,0,0,0]),a.applyIf(b,e),a.apply(c,b)},prepareTabs:function(){for(var a=this,b=[],c=0,d=a.items.length;c<d;c++){var e=a.items[c],f={type:"tab"};e.tabTitle?f.text=e.tabTitle:e.title&&(f.text=e.title,delete e.title),f.handler=function(b){return function(){a.setActiveTab(b)}}(c),b.push(f)}a.tbar=b,a.tabs=b},renderTabWrappers:function(){var b=this;a.each(b.items,function(c){var e=a.get(document.createElement("div"));e.addCls(d),c.renderTo=b.panelBodyEl.dom.appendChild(e.dom)})},setActiveTab:function(a){var b=this,c=b.el.select("."+d),g=b.activeTab;if(0!==b.items.length){c.item(b.activeTab).removeCls(e),b.activeTab=a,c.item(b.activeTab).addCls(e);var h=b.items[b.activeTab];if(h.theme=b.theme,h.wrapped=!0,h.width=b.panelBodyWidth,h.height=b.panelBodyHeight,h.rendered)b.setActiveItemWidth(),b.setActiveItemHeight();else switch(h.type){case"grid":b.items[b.activeTab]=new FancyGrid(h);break;case"tab":b.items[b.activeTab]=new FancyTab(h)}b.tabs&&(b.tbar[g].removeCls(f),b.tbar[b.activeTab].addCls(f))}},setWidth:function(a){var b=this;b.width=a,b.css("width",a),b.setPanelBodySize(),b.setActiveItemWidth()},setHeight:function(a){var b=this;b.height=a,b.css("height",a),b.setPanelBodySize(),b.setActiveItemHeight()},setActiveItemWidth:function(){var a=this;a.items[a.activeTab].setWidth(a.panelBodyWidth)},setActiveItemHeight:function(){var a=this;a.items[a.activeTab].setHeight(a.panelBodyHeight,!1)}}),FancyTab.get=function(b){var c=a.get(b).select("."+g).dom.id;return a.getWidget(c)},!a.nojQuery&&a.$&&(a.$.fn.FancyTab=function(a){return a.renderTo=$(this.selector)[0].id,new FancyTab(a)})}(),Fancy.define("Fancy.toolbar.Tab",{extend:Fancy.Button,constructor:function(a,b){this.Super("const",arguments)},init:function(){this.Super("init",arguments)},cls:Fancy.BUTTON_CLS+" "+Fancy.TAB_TBAR_CLS,render:function(){this.Super("render",arguments)}}),function(){var a=Fancy,b=a.GRID_CLS,c=a.GRID_CELL_CLS,d=a.BAR_CLS,e=a.BAR_CONTAINER_CLS,f=a.BAR_BUTTON_CLS,g=a.BAR_SEG_BUTTON_CLS,h=a.BAR_LEFT_SCROLLER_CLS,i=a.BAR_RIGHT_SCROLLER_CLS,j=a.FIELD_LABEL_CLS,k=a.FIELD_TEXT_CLS,l=a.FIELD_TEXT_INPUT_CLS,m=a.FIELD_SEARCH_CLS,n=a.FIELD_SEARCH_LIST_CLS,o=a.FIELD_SEARCH_PARAMS_LINK_CLS,p=a.FIELD_SEARCH_PARAMED_CLS,q=a.FIELD_SEARCH_PARAMED_EMPTY_CLS,r=a.PICKER_MONTH_ACTION_BUTTONS_CLS,s=a.CLEARFIX_CLS;a.define("Fancy.Bar",{extend:a.Widget,widgetCls:d,containerCls:e,cls:"",text:"",floating:"left",sideRight:0,scrolled:0,tabOffSet:5,barScrollEnabled:!0,constructor:function(b){a.apply(this,b),this.init()},init:function(){var a=this;a.roles={},a.render(),a.barScrollEnabled&&(a.initScroll(),setTimeout(function(){a.checkScroll()},50))},render:function(){var a=this;a.renderEl(),a.renderItems(),a.initTabEdit()},renderEl:function(){var b=this;if(!b.el){var c=a.get(document.createElement("div"));c.addCls(b.widgetCls,b.cls),c.update(b.text),b.el=a.get(b.renderTo.appendChild(c.dom)),b.style&&b.el.css(b.style)}var d=a.get(document.createElement("div"));d.addCls(b.containerCls),b.containerEl=a.get(b.el.dom.appendChild(d.dom))},renderItems:function(){for(var b=this,c=b.containerEl,d=b.items||[],e=0,f=d.length,g=!1,h=[],i=f-1;e<f;e++){var j=d[e];switch(g&&(j=d[i],i--),j.toggleGroup&&(j.enableToggle=!0),a.isObject(j)&&(j.type=j.type||"button"),g&&(b.floating="right"),j.renderTo=c.dom,j){case"|":var k={float:b.floating,"margin-right":"5px","margin-top":"6px","padding-left":"0px"};"right"===b.floating&&a.applyIf(k,{right:"1px",position:"absolute"}),h.push(new a.Separator({renderTo:c.dom,style:k}));continue;case"side":g=!0;continue;default:g?h[i]=b.renderItem(j):h.push(b.renderItem(j))}}b.items=h},renderItem:function(c){var d,e=this,h=e.containerEl,i=e.theme;switch(c.style=c.style||{},c.label=!1,c.padding=!1,a.applyIf(c.style,{float:e.floating}),"right"===e.floating&&a.applyIf(c.style,{right:e.sideRight,position:"absolute"}),!c.scope&&e.items&&(c.scope=e.items[0]),c.type){case"wrapper":c.cls===r&&(h.destroy(),h=e.el);for(var t,u=h.append('<div class="'+(c.cls||"")+'"></div>').select("div").item(0),v=0,w=c.items.length,x=0;v<w;v++){t=c.items[v],a.isObject(t)&&(t.type=t.type||"button"),t.renderTo=u.dom,d=e.renderItem(t);var y=d.el;v===w-1?y.css("margin-right","0px"):x+=parseInt(y.css("margin-right")),a.nojQuery?(x+=parseInt(y.width()),x+=parseInt(y.css("margin-left"))):x+=parseInt(y.$dom.outerWidth()),x+=parseInt(y.css("padding-left")),x+=parseInt(y.css("padding-right"))}u.css("width",x);break;case void 0:case"button":c.extraCls=f,c.scope=e.scope,d=new a.Button(c);break;case"segbutton":c.extraCls=g,a.applyIf(c.style,{"margin-right":"6px"}),d=new a.SegButton(c);break;case"tab":d=new a.toolbar.Tab(c);break;case"text":a.applyIf(c.style,{"margin-right":"10px","padding-left":"0px","padding-top":"11px"}),a.apply(c,{renderTo:h.dom,cls:c.cls||""}),d=new a.bar.Text(c);break;case"combo":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:70}),d=new a.Combo(c);break;case"date":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:100}),d=new a.DateField(c);break;case"number":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:35}),d=new a.NumberField(c);break;case"switcher":a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:35}),d=new a.Switcher(c);break;case"string":c.inputWidth=18,a.applyIf(c.style,{"padding-left":"0px","margin-right":"8px","margin-top":"4px"}),a.applyIf(c,{width:100}),d=new a.StringField(c);break;case"search":c.inputWidth=18,c.events=c.events||[],c.events=c.events.concat([{enter:function(c,d){a.getWidget(c.el.parent().parent().parent().parent().select("."+b).attr("id")).search(d)}},{key:function(c,d){var e=this,f=a.getWidget(c.el.parent().parent().parent().parent().select("."+b).attr("id"));e.autoEnterTime||(e.autoEnterTime=new Date),e.intervalAutoEnter&&clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,e.intervalAutoEnter=setInterval(function(){new Date-e.autoEnterTime>500&&(clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,d=c.getValue(),f.search(d))},200)}},{render:function(c){var d=this,e=!1;c.el.on("mouseenter",function(){e=!0},null,"."+o),c.el.on("mousedown",function(a){a.preventDefault()},null,"."+o),c.el.on("click",function(f){for(var g=!1,h=a.getWidget(c.el.parent().parent().parent().parent().select("."+b).attr("id")),j=h.columns||[],k=h.leftColumns||[],l=h.rightColumns||[],m=j.concat(k).concat(l),o=[],p=0,q=m.length,r=1;p<q;p++){var s=m[p],t=s.title;if(void 0===t&&(t=""),!1!==s.searchable){switch(s.type){case"color":case"combo":case"date":case"number":case"string":case"text":case"currency":break;default:continue}r+=h.fieldHeight,o.push({inputLabel:" &nbsp;&nbsp;"+t,value:!0,name:s.index})}}if(d.list){if("none"!==d.list.el.css("display"))return void d.list.el.css("display","none");g=!0}else d.list=new FancyForm({width:150,height:r,theme:i,defaults:{type:"checkbox",label:!1,style:{padding:"8px 16px 0px"}},items:o,cls:n,events:[{set:function(){h.searching.setKeys(d.list.get())}},{init:function(){setTimeout(function(){var b=d.list.el;b.on("mouseenter",function(){e=!0}),b.on("mouseleave",function(){e=!1,setTimeout(function(){!1===e&&d.list&&b.css("display","none")},750)});var g=a.get(f.target),h=g.offset(),i=parseInt(c.el.css("height"));b.css({position:"absolute",top:h.top+i+20,left:h.left}),d.list.el.css("display","block"),b.animate({duration:200,top:h.top+i-1})},50)}}]});var u=a.get(f.target),v=u.offset(),w=parseInt(c.el.css("height"));d.list&&d.list.el&&(d.list.css({position:"absolute",top:v.top+w+20,left:v.left}),g&&d.list.css("display","block"),d.list.el.animate({duration:200,top:v.top+w-1}))},null,"."+o),c.el.on("mouseleave",function(){e=!1,setTimeout(function(){!1===e&&d.list&&d.list.el.css("display","none")},750)},null,"."+o)}}]),a.applyIf(c.style,{float:e.floating,"padding-left":"0px","margin-right":"8px","margin-top":"4px"});var z=m;c.paramsMenu&&(c.tpl=['<div class="'+j+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+k+'">','<input placeholder="{emptyText}" class="'+l+'" style="{inputWidth}" value="{value}">','<div class="'+o+'" style="">'+(c.paramsText||"&nbsp;")+"</div>","</div>",'<div class="'+s+'"></div>'],z+=" "+p,c.paramsText||(z+=" "+q)),a.applyIf(c,{padding:!1,width:250,cls:z,emptyText:"Search"}),d=new a.StringField(c)}return"right"===e.floating&&(e.sideRight+=d.width,e.sideRight+=7),c.role&&(e.roles[c.role]=d),d},initScroll:function(){var b=this;b.leftScroller=new a.Button({imageCls:!0,renderTo:b.el.dom,cls:h,height:b.height+2,minWidth:20,paddingTextWidth:0,imageWidth:20,width:0,text:!1,id:"my",style:{position:"absolute",left:-1,top:-1,display:"none"},listeners:[{click:b.onPrevScrollClick,scope:b}]}),b.rightScroller=new a.Button({imageCls:!0,renderTo:b.el.dom,cls:i,height:b.height+2,minWidth:20,paddingTextWidth:0,imageWidth:20,width:0,text:!1,style:{position:"absolute",right:-1,top:-1,display:"none"},listeners:[{click:b.onNextScrollClick,scope:b}]})},getBarWidth:function(){return parseInt(this.el.css("width"))},getItemsWidth:function(){var b=0;return a.each(this.items,function(a){b+=a.el.width(),b+=parseInt(a.el.css("margin-left")),b+=parseInt(a.el.css("margin-right")),b+=parseInt(a.el.css("padding-right")),b+=parseInt(a.el.css("padding-left"))}),b},onPrevScrollClick:function(){this.scrolled+=30,this.applyScrollChanges()},onNextScrollClick:function(){this.scrolled-=30,this.applyScrollChanges()},applyScrollChanges:function(){var a=this,b=a.getItemsWidth(),c=a.getBarWidth()-parseInt(a.leftScroller.el.css("width"))-parseInt(a.rightScroller.el.css("width")),d=b-c;if(b<c)return a.scrolled=0,a.leftScroller.el.hide(),a.rightScroller.el.hide(),void a.containerEl.css("margin-left","0px");a.scrolled>0?(a.scrolled=0,a.leftScroller.disable(),a.rightScroller.enable()):a.scrolled<-d&&(a.scrolled=-d,a.leftScroller.enable(),a.rightScroller.disable()),a.leftScroller.el.show(),a.rightScroller.el.show(),a.containerEl.css("margin-left",a.scrolled+a.leftScroller.el.width()+a.tabOffSet+"px")},onDocMouseUp:function(){var a=this;a.scrollInterval&&(clearTimeout(a.scrollInterval),delete a.scrollInterval)},checkScroll:function(){var a=this,b=a.getItemsWidth(),c=a.getBarWidth();a.disableScroll||(b>c?a.enableScroll():(a.leftScroller.el.hide(),a.rightScroller.el.hide()))},enableScroll:function(){var a=this;a.leftScroller.el.show(),a.rightScroller.el.show(),0===a.scrolled&&(a.leftScroller.disable(),a.containerEl.css("margin-left",a.leftScroller.el.width()+a.tabOffSet+"px"))},initTabEdit:function(){var a=this;if(a.tabEdit)for(var b=a.items.length-1;b>-1;b--){var c=a.items[b];switch(c.type){case"number":case"string":case"date":return void c.on("tab",a.onTabLastInput,a)}}},onTabLastInput:function(d,e){var f=this,g=a.getWidget(f.el.parent().select("."+b).attr("id"));e.preventDefault(),g.leftColumns.length?setTimeout(function(){g.leftBody.el.select("."+c).item(0).dom.click()},100):setTimeout(function(){g.body.el.select("."+c).item(0).dom.click()},100)}})}(),Fancy.define("Fancy.Separator",{cls:Fancy.SEPARATOR_CLS,constructor:function(a){Fancy.apply(this,a),this.init()},init:function(){this.render()},render:function(){var a=this,b=Fancy.get(document.createElement("div"));b.addCls(a.cls),b.update("<div></div>"),a.el=Fancy.get(a.renderTo.appendChild(b.dom)),a.style&&a.el.css(a.style)}}),Fancy.define("Fancy.bar.Text",{extend:Fancy.Widget,widgetCls:Fancy.BAR_TEXT_CLS,cls:"",text:"",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.render()},render:function(){var a=this,b=Fancy.get(document.createElement("div"));b.addCls(a.widgetCls,a.cls),b.update(a.text),a.el=Fancy.get(a.renderTo.appendChild(b.dom)),a.style&&a.el.css(a.style),a.hidden&&a.el.css("display","none")},get:function(){return this.el.dom.innerHTML},getValue:function(){return this.get()}}),function(){var a=Fancy,b=a.MODAL_CLS,c=a.FIELD_NOT_VALID_CLS,d=a.FORM_CLS,e=a.FORM_BODY_CLS,f=a.PANEL_BODY_INNER_CLS,g=a.PANEL_GRID_INSIDE_CLS,h=a.PANEL_SHADOW_CLS,i=a.FIELD_BLANK_ERR_CLS,j=a.FIELD_TAB_CLS,k=a.FIELD_TAB_ACTIVE_CLS,l=a.TAB_TBAR_ACTIVE_CLS,m=a.PANEL_TBAR_CLS,n=a.TAB_TBAR_CLS,o=a.FIELD_TEXT_CLS;a.Mixin("Fancy.form.mixin.Form",{init:function(){var b=this;if(b.calcFieldSize(),b.Super("init",arguments),b.addEvents("init","set"),!0!==a.fullBuilt&&!1!==a.MODULELOAD&&!1!==a.MODULESLOAD&&!0!==b.fullBuilt&&!0!==b.neededModules)return void b.loadModules();b.fire("beforerender"),b.applyDefaults(),b.preRender(),b.render(),b.ons(),b.fire("init")},cls:"",widgetCls:d,value:"",width:200,height:300,emptyText:"",tpl:['<div class="'+e+'"></div>'],preRender:function(){var a=this;a.initRenderTo(),(a.title||a.tbar||a.bbar||a.buttons)&&a.renderPanel()},renderPanel:function(){var b=this,c={renderTo:b.renderTo,title:b.title,subTitle:b.subTitle,subTitleHeight:b.subTitleHeight,width:b.width,height:b.height,titleHeight:b.titleHeight,barHeight:b.barHeight,theme:b.theme,shadow:b.shadow,style:b.style||{},window:b.window,modal:b.modal,frame:b.frame,items:[b],tabs:b.tabs,draggable:b.draggable,minWidth:b.minWidth,minHeight:b.minHeight,panelBodyBorders:b.panelBodyBorders,resizable:b.resizable};b.tabs&&(c.tbar=b.generateTabs(),b.height-=b.barHeight),b.bbar&&(c.bbar=b.bbar,b.height-=b.barHeight),b.tbar&&(c.tbar=b.tbar,b.height-=b.barHeight),b.buttons&&(c.buttons=b.buttons,b.height-=b.barHeight,c.buttons=b.buttons),b.footer&&(c.footer=b.footer,b.height-=b.barHeight),b.panel=new a.Panel(c),b.bbar=b.panel.bbar,b.tbar=b.panel.tbar,b.buttons=b.panel.buttons,b.wrapped||b.panel.addCls(g),b.extraCls&&b.panel&&b.panel.addCls(b.extraCls),b.title&&(b.height-=b.titleHeight),b.subTitle&&(b.height-=b.subTitleHeight,b.height+=b.panelBodyBorders[2]),b.height-=b.panelBodyBorders[0],b.renderTo=b.panel.el.select("."+f).dom},initRenderTo:function(){var b=this,c=b.renderTo||document.body;a.isString(c)&&((c=document.getElementById(c))||(c=a.select(c).item(0))),b.renderTo=c},render:function(){var b=this,c=b.renderTo,d=a.get(document.createElement("div"));d.addCls(b.cls,a.cls,b.widgetCls),d.attr("id",b.id),d.css({width:b.width+"px",height:b.height+"px"}),d.update(b.tpl.join(" ")),b.el=a.get(a.get(c).dom.appendChild(d.dom)),void 0===b.panel&&(b.shadow&&d.addCls(h),"default"!==b.theme&&d.addCls("fancy-theme-"+b.theme)),b._items=[],b.renderItems(),b.items=b._items,delete b._items,(b.tabs||b.tabbed)&&b.setActiveTab(),b.fire("afterrender"),b.fire("render")},generateTabs:function(){var b=this,c=[];if(b.tabs)for(var d=0,e=b.tabs.length;d<e;d++){var f={type:"tab"};a.isString(b.tabs[d])?f.text=b.tabs[d]:f=b.tabs[d],b.tabs[d]=f,void 0===b.tabs[d].handler&&(b.tabs[d].handler=function(a){return function(){b.setActiveTab(a)}}(d)),c.push(b.tabs[d])}return c},setActiveTab:function(a){var b=this,c=b.el.select("."+j),d=b.el.select("."+k);if(void 0!==a&&(b.activeTab=a),void 0===b.activeTab&&(b.activeTab=0),d.removeCls(k),c.item(b.activeTab).addCls(k),b.tabs){var e=b.panel.el.select("."+m+" ."+n);e.removeCls(l),e.item(b.activeTab).addCls(l)}},renderItems:function(b,c){var d,f=this,g=0;for(c=c||f.items,d=c.length,b=b||f.el.getByClass(e);g<d;g++){var h,i=c[g];switch(i.theme=f.theme,i.type){case"pass":case"password":h=a.form.field.String,i.type="string",i.isPassword=!0;break;case"hidden":h=a.form.field.String,i.hidden=!0;break;case"line":case"row":h=a.form.field.Line,i=f.applyDefaults(i);break;case"set":case"fieldset":i.form=f,h=a.form.field.Set,i=f.applyDefaults(i);break;case"tab":h=a.form.field.Tab,i=f.applyDefaults(i);break;case"string":case void 0:h=a.form.field.String;break;case"number":h=a.form.field.Number;break;case"textarea":h=a.form.field.TextArea;break;case"checkbox":h=a.form.field.CheckBox;break;case"switcher":h=a.form.field.Switcher;break;case"combo":h=a.form.field.Combo;break;case"html":h=a.form.field.HTML;break;case"radio":h=a.form.field.Radio;break;case"date":h=a.form.field.Date;break;case"recaptcha":h=a.form.field.ReCaptcha;break;case"button":h=a.form.field.Button;break;case"segbutton":h=a.form.field.SegButton;break;default:throw new Error("type "+i.type+" is not set")}i.renderTo=i.renderTo||b;var j=new h(i);switch(i.type){case"line":case"row":case"set":case"fieldset":case"tab":f.renderItems(j.el.select("."+o).dom,j.items);break;default:f._items.push(j)}}},applyDefaults:function(b){var c=this;{if(void 0!==b){var d,e;if(b.defaults)for(d=0,e=b.items.length;d<e;d++)a.applyIf(b.items[d],b.defaults);return b}for(var f=c.items,g=0,h=f.length,i=c.defaults||{};g<h;g++)a.applyIf(f[g],i)}},ons:function(){var b=this;a.each(b.items,function(a){switch(a.type){case"line":case"row":break;case"set":case"fieldset":break;case"tab":case"button":case"segbutton":break;default:a.on("change",b.onChange,b)}})},onChange:function(a,b,c){this.fire("set",{name:a.name,value:b,oldValue:c})},get:function(b){var c=this;if(b){var d;return a.each(c.items,function(a){switch(a.type){case"html":case"button":return}if(a.name===b)return d=a.get(),!0}),d}var e={};return a.each(c.items,function(a){switch(a.type){case"html":case"button":return}void 0!==a.name&&(e[a.name]=a.get())}),e},set:function(b,c){var d=this;if(a.isObject(b))for(var e in b)d.set(e,b[e]);else if(b)return a.each(d.items,function(a){a.name===b&&a.set(c)}),c},clear:function(b){var d=this;a.each(d.items,function(a){switch(a.type){case"html":case"recaptcha":case"button":return}!1!==b&&a.clear(),d.hasCls(c)&&(d.removeCls(c),d.css("height",parseInt(d.css("height"))-6+"px")),d.hasCls(i)&&(d.removeCls(i),d.css("height",parseInt(d.css("height"))-6+"px")),a.name&&d.params&&d.params[a.name]&&delete d.params[a.name]})},submit:function(b){var c=this,b=b||{},d=c.params||{};if(c.params=c.params||{},a.apply(c,b),b.params&&(a.apply(d,c.params),c.params=d),c.clear(!1),!1!==c.valid()){var e=c.get();if(a.apply(c.params,e),"wait"===c.params.recaptcha)return void c.submit(b);""!==c.params.recaptcha&&(c.params["g-recaptcha-response"]=c.params.recaptcha,delete c.params.recaptcha,a.Ajax(c))}},valid:function(){var b=!0;return a.each(this.items,function(a){!0===b?b=a.onBlur():a.onBlur()}),!!b},getItem:function(b){var c=!1;return a.each(this.items,function(a){if(a.name===b)return c=a,!0}),c},showAt:function(){var a=this.panel;a&&a.showAt.apply(a,arguments)},show:function(){var a=this.panel;a?a.show.apply(a,arguments):this.el.show()},hide:function(){var c=this;c.panel?c.panel.css({display:"none"}):c.css({display:"none"});var d=a.select("."+b);d.dom&&d.css("display","none");for(var e=0,f=c.items.length;e<f;e++)"combo"===c.items[e].type&&c.items[e].hideList()},setHeight:function(a){var b=this;b.panel&&(b.panel.css("height",a),b.buttons&&(a-=b.barHeight),b.bbar&&(a-=b.barHeight),(b.tbar||b.tabs)&&(a-=b.barHeight),b.title&&(a-=b.titleHeight),a-=b.panelBodyBorders[0],a-=b.panelBodyBorders[2]),b.css("height",a)},setWidth:function(){},getHeight:function(){var a=this.panel;return a?a.getHeight():parseInt(this.css("height"))},calcFieldSize:function(){var b,c=this,d=c.width,e=c.defaults||{},f=c.maxLabelNumber;e.width=d-2*c.panelBorderWidth,a.each(c.items,function(b){switch(b.type){case"set":case"tab":"tab"===b.type&&(c.tabbed=!0);var e="set"===b.type?62:20;a.each(b.items,function(a){void 0===a.width&&(a.width=d-e),a.label&&a.label.length>f&&(f=a.label.length)}),b.defaults=b.defaults||{},b.defaults.labelWidth=b.defaults.labelWidth||8*(f+1);break;case"line":var g=b.items.length,h=!1,i=(d-8-8-8)/g;a.each(b.items,function(a){a.width=i,(a.labelWidth||a.inputWidth)&&(h=!0)}),!1===h&&a.each(b.items,function(a){"top"===a.labelAlign?a.labelWidth=i:a.labelWidth=100}),b.defaults=b.defaults||{},void 0===b.defaults.labelWidth&&(b.defaults.labelWidth=c.labelWidth);break;default:b.label&&b.label.length>f&&(f=b.label.length)}}),f++,b=6*f,b<80&&(b=80),e.labelWidth=b,c.inputWidth&&(e.inputWidth=c.inputWidth),c.defaults=e},destroy:function(){var a=this;a.el.destroy(),a.panel&&a.panel.el.destroy()},each:function(a,b){var c=this,d=c.items,e=0,f=d.length;if(b)for(;e<f;e++)a.apply(this,[d[e]]);else for(;e<f;e++)a(d[e])},loadModules:function(){var b=this,c=a.modules||{},d={},e=b.items||[];a.modules=c,a.nojQuery&&(d.dom=!0),a.isTouch&&(d.touch=!0);for(var f=0,g=e.length;f<g;f++){var h=e[f];if("date"===h.type&&(d.grid=!0,d.selection=!0,d.date=!0),h.items)for(var i=0,j=h.items.length;i<j;i++){var k=h.items[i];"date"===k.type&&(d.grid=!0,d.selection=!0,d.date=!0)}}b.neededModules={length:0};for(var l in d)void 0===a.modules[l]&&(b.neededModules[l]=!0,b.neededModules.length++);if(0===b.neededModules.length)return b.neededModules=!0,void b.init();var m=function(a){delete b.neededModules[a],0===--b.neededModules.length&&(b.neededModules=!0,b.init())};for(var l in b.neededModules)"length"!==l&&a.loadModule(l,m)},prevTab:function(){var a=this;a.activeTab--,a.activeTab<0&&(a.activeTab=0),a.setActiveTab()},nextTab:function(){var a=this,b=a.el.select("."+j).length;a.activeTab++,a.activeTab>=b&&(a.activeTab=b-1),a.setActiveTab()}})}(),Fancy.Mixin("Fancy.form.mixin.PrepareConfig",{prepareConfig:function(a,b){var c=this;return a=c.prepareConfigTheme(a,b),a=c.prepareConfigLang(a,b),a=c.prepareConfigDefaults(a),a=c.prepareConfigItems(a),a=c.prepareConfigFooter(a)},prepareConfigDefaults:function(a){if(a.defaults)for(var b in a.defaults)Fancy.each(a.items,function(c){void 0===c[b]&&(c[b]=a.defaults[b])});return a},prepareConfigItems:function(a){var b=this,c=function(a){a.theme=b.theme||"",void 0===a.labelWidth&&(a.labelWidth=b.labelWidth),void 0===a.inputWidth&&(a.inputWidth=b.inputWidth),"pass"!==a.type&&"password"!==a.type||(a.type="string",a.isPassword=!0),a.items&&Fancy.each(a.items,c)};return Fancy.each(a.items,c),a}}),Fancy.define("Fancy.Form",{extend:Fancy.Widget,mixins:["Fancy.form.mixin.Form",Fancy.panel.mixin.PrepareConfig,Fancy.panel.mixin.methods,"Fancy.form.mixin.PrepareConfig"],type:"form",theme:"default",i18n:"en",maxLabelNumber:11,minWidth:200,minHeight:200,barScrollEnabled:!0,constructor:function(a){var b=this,a=a||{},c=function(c){c&&Fancy.apply(a,c),a=b.prepareConfig(a,b),Fancy.applyConfig(b,a),b.Super("const",arguments)},d=function(){var d=a.i18n||b.i18n;!0===Fancy.loadLang(d,c)&&c({})};Fancy.modules.form||Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD||!0===b.fullBuilt||!0===b.neededModules?d():Fancy.modules.grid?Fancy.loadModule("form",function(){d()}):b.loadModules(d,a)},loadModules:function(a,b){var c=this,d={form:!0};Fancy.modules=Fancy.modules||{},Fancy.nojQuery&&(d.dom=!0),Fancy.isTouch&&(d.touch=!0),b.url&&(d.ajax=!0);for(var e,f=b.items||[],g=0,h=f.length;g<h;g++)e=f[g],"combo"===e.type&&e.data&&e.data.proxy&&(d.ajax=!0),"date"===e.type&&(d.grid=!0,d.date=!0,d.selection=!0);c.neededModules={length:0};for(var i in d)void 0===Fancy.modules[i]&&(c.neededModules[i]=!0,c.neededModules.length++);if(0===c.neededModules.length)return c.neededModules=!0,void a();var j=function(b){delete c.neededModules[b],0===--c.neededModules.length&&(c.neededModules=!0,a())};if(c.neededModules.dom)Fancy.loadModule("dom",function(){delete c.neededModules.dom,c.neededModules.length--;for(var a in c.neededModules)"length"!==a&&Fancy.loadModule(a,j)});else for(var i in c.neededModules)"length"!==i&&Fancy.loadModule(i,j)}});var FancyForm=Fancy.Form;FancyForm.get=function(a){var b=Fancy.get(a).select(".fancy-form").dom.id;return Fancy.getWidget(b)},FancyForm.defineTheme=Fancy.defineTheme,FancyForm.defineController=Fancy.defineController,FancyForm.addValid=Fancy.addValid,!Fancy.nojQuery&&Fancy.$&&(Fancy.$.fn.FancyForm=function(a){return a.renderTo=$(this.selector)[0].id,new Fancy.Form(a)}),function(){var a=Fancy,b=a.FIELD_NOT_VALID_CLS,c=a.FIELD_LABEL_ALIGN_TOP_CLS,d=a.FIELD_TEXT_CLS,e=a.FIELD_LABEL_CLS,f=a.FIELD_TEXTAREA_TEXT_CLS,g=a.FIELD_LABEL_ALIGN_RIGHT_CLS;a.ns("Fancy.form.field"),a.form.field.Mixin=function(){},a.form.field.Mixin.prototype={padding:"8px 8px 0px 8px",inputHeight:29,labelHeight:18,failedValidCls:b,cls:"",checkValidOnTyping:!1,ons:function(){var a=this,b=a.el,c=a.el.getByTag("input");if(a.input=c,c.on("blur",a.onBlur,a),c.on("focus",a.onFocus,a),c.on("input",a.onInput,a),c.on("keydown",a.onKeyDown,a),b.on("mouseenter",a.onMouseOver,a),b.on("mouseleave",a.onMouseOut,a),a.on("key",a.onKey,a),a.tip&&b.on("mousemove",a.onMouseMove,a),a.format&&a.format.inputFn){switch(a.value){case"":case void 0:break;default:a.formatValue(a.value)}a.on("key",a.onKeyInputFn)}a.stopPropagation&&b.on("mousedown",function(a){a.stopPropagation()})},onKeyInputFn:function(b,c,d){var e=d.keyCode,f=a.key;switch(e){case f.ENTER:case f.ESC:case f.LEFT:case f.RIGHT:return}this.formatValue(c)},formatValue:function(a){a=this.format.inputFn(a),this.input.dom.value=a},onMouseOver:function(a){var b=this;b.fire("mouseover"),b.tip&&b.renderTip(a)},onMouseOut:function(a){var b=this;b.fire("mouseout"),b.tip&&b.tooltip&&(b.tooltipToDestroy=!0,b.tooltip.destroy(),delete b.tooltip)},render:function(){var b=this,h=b.renderTo||document.body,i=b.renderAfter,j=b.renderBefore,k=a.get(document.createElement("div"));a.isString(h)&&((h=document.getElementById(h))||(h=a.select(h).item(0))),b.fire("beforerender"),k.addCls(a.cls,b.cls,b.fieldCls),k.attr("id",b.id);var l="",m="";b.itemsHTML&&(m=b.itemsHTML),"top"===b.labelAlign&&b.label&&b.labelWidth<7*b.label.length&&(b.labelWidth=7*(b.label.length+2)),b.labelWidth&&(l="width:"+b.labelWidth+"px;");var n=b.label;""===b.label?n="&nbsp;":void 0===b.label?n="&nbsp;":"right"!==b.labelAlign&&(n+=":");var o="",p="",q="";if(!1===b.label&&(o="display:none;"),b.inputLabel?q=b.inputLabel:p="display:none;","recaptcha"===b.type?k.update(b.tpl.getHTML({key:b.key})):k.update(b.tpl.getHTML({labelWidth:l,label:n,labelDisplay:o,inputLabelDisplay:p,inputLabel:q,emptyText:b.emptyText,value:b.value,height:b.height,itemsHTML:m,errorTextStyle:"",buttonText:b.buttonText})),b.el=k,b.setStyle(),!0===b.renderId&&k.attr("id",b.id),i?k=i.after(k.dom.outerHTML).next():j?k=j.before(k.dom.outerHTML).prev():h.appendChild(k.dom),b.el=k,"textarea"===b.type?b.input=b.el.getByTag("textarea"):b.input=b.el.getByTag("input"),b.name&&(b.input.name=b.name),b.setSize(),"top"===b.labelAlign)b.el.addCls(c),b.el.select("."+d).css("float","none");else if("right"===b.labelAlign)switch(b.el.addCls(g),b.type){case"radio":$(k.dom).find("."+e).insertAfter($(k.dom).find("."+d+":last"));break;case"textarea":$(k.dom).find("."+e).insertAfter($(k.dom).find("."+f));break;default:$(k.dom).find("."+e).insertAfter($(k.dom).find("."+d))}else b.type;b.acceptedValue=b.value,b.fire("afterrender"),b.fire("render"),"recaptcha"!==b.type&&"chat"!==b.type&&setTimeout(function(){b.input&&b.input.dom&&0===b.input.dom.value.length&&void 0===b.prevColor&&(b.prevColor=b.input.css("color"))},1)},onKeyDown:function(b){var c=this,d=b.keyCode,e=a.key;if("number"===c.type&&!1===a.Key.isNumControl(d,b))return b.preventDefault(),void b.stopPropagation();switch(d){case e.TAB:c.fire("tab",b);break;case e.ENTER:c.fire("enter",c.getValue()),"textarea"!==c.type&&(b.preventDefault(),b.stopPropagation());break;case e.UP:switch(c.type){case"number":case"field.number":c.spinUp()}c.fire("up",c.getValue()),"textarea"!==c.type&&(b.preventDefault(),b.stopPropagation());break;case e.DOWN:switch(c.type){case"number":case"field.number":c.spinDown()}c.fire("down",c.getValue()),"textarea"!==c.type&&(b.preventDefault(),b.stopPropagation());break;case e.LEFT:break;case e.RIGHT:b.stopPropagation();break;default:setTimeout(function(){c.input&&(0===c.input.dom.value.length?(void 0===c.prevColor&&(c.prevColor=c.input.css("color")),c.input.css("color","grey")):c.prevColor?c.input.css("color",c.prevColor):c.input.css("color"," "))},1)}setTimeout(function(){c.fire("key",c.input.dom.value,b)},1)},onKey:function(a,b){a.isValid()&&!a.checkValidOnTyping||a.validate(b)},onBlur:function(){var a=this;return a.fire("blur"),!a.input||a.validate(a.input.dom.value)},validate:function(b){var c=this,d=c.vtype;if(void 0===d)return!0;var e=a.isValid(d,b);return!0!==e?(c.errorText=new a.Template(e.text).getHTML(e),c.failedValid(),!1):(c.successValid(),!0)},isValid:function(){return!this.hasCls(this.failedValidCls)},onFocus:function(){this.fire("focus")},onInput:function(){var a=this,b=(a.input,a.getValue()),c=a.acceptedValue;a.acceptedValue=a.get(),a.fire("input",b),a.fire("change",b,c)},get:function(){var b=this;if(b.format)if(a.isString(b.format));else{if(!a.isObject(b.format))return b.value;if(b.format.inputFn&&("number"===b.type||"field.number"===b.type))return isNaN(parseFloat(b.value))?b.value:Number(b.value)}return b.input.dom.value},getValue:function(){return this.get()},set:function(a,b){var c=this;c.value=a,c.format&&c.format.inputFn?c.formatValue(a):c.input.dom.value=a,!1!==b&&c.onInput(),c.validate(a)},setValue:function(a,b){this.set(a,b)},clear:function(){this.set(""),this.clearValid()},failedValid:function(){var a=this;a.hasCls(a.failedValidCls)?a.tooltip&&a.errorText&&a.tooltip.update(a.errorText):(!a.tooltip&&a.errorText&&(a.showErrorTip(),a.el.on("mousemove",a.onMouseMove,a),a.input.hover(function(b){a.errorText&&(a.showErrorTip(),a.tooltip.show(b.pageX+15,b.pageY-25))},function(){a.hideErrorTip()})),a.addCls(a.failedValidCls))},clearValid:function(){this.removeCls(this.failedValidCls)},successValid:function(){var a=this;a.removeCls(a.failedValidCls),a.hideErrorTip(),delete a.errorText},showErrorTip:function(){var b=this;b.tooltip||(b.tooltip=new a.ToolTip({text:b.errorText}))},hideErrorTip:function(){var a=this;a.tooltip&&(a.tooltip.destroy(),delete a.tooltip)},setInputSize:function(a){var b=this;a.width&&b.input.css("width",a.width),a.height&&b.input.css("height",a.height)},focus:function(){var a=this;a.input.focus(),setTimeout(function(){a.input.dom.selectionStart=a.input.dom.selectionEnd=1e4},0)},hide:function(){var a=this;a.fire("beforehide"),a.css("display","none"),a.fire("hide")},show:function(){var a=this;a.css("display","block")},setSize:function(a,b){var c=this;switch(c.type){case"set":case"line":return}if(void 0===a&&void 0===b)a=c.width,b=c.height;else if(void 0===b){var d=a;a=d.width?d.width:c.width,b=d.height?d.height:c.height}if(c.size)return void c.size({width:a,height:b});void 0!==a&&c.css("width",a),"top"===c.labelAlign?c.css("height",1.5*b):(c.css("height",b),c.label&&c.el.select("."+e).css("height",c.inputHeight)),c.setInputSize({width:c.inputWidth,height:c.inputHeight})},setStyle:function(){var b=this,c=b.style||{},d=b.padding;d?(a.isNumber(d)?d+="px":a.isString(d),void 0===c.padding&&(c.padding=d)):c.padding="0px",b.hidden&&b.css("display","none"),b.css(c)},preRender:function(){var b=this;b.tpl&&!1===a.isObject(b.tpl)&&(b.tpl=new a.Template(b.tpl)),b.calcSize()},calcSize:function(){var b,c,d,e,f,g=this,h=g.inputHeight,i=g.padding;if(a.isString(i))switch(i=i.replace(/px/g,""),i=i.split(" "),i.length){case 1:c=Number(i[0]),i=[c,c,c,c];break;case 2:d=Number(i[0]),e=Number(i[1]),i=[d,e,d,e];break;case 3:d=Number(i[0]),e=Number(i[1]),f=Number(i[2]),i=[d,e,f,d];break;case 4:i=[Number(i[0]),Number(i[1]),Number(i[2]),Number(i[3])]}else a.isNumber(i)?i=[i,i,i,i]:!1===i&&(i=[0,0,0,0]);"top"===g.labelAlign&&(g.height*=1.5),b=g.width,"top"!==g.labelAlign&&g.label&&(b-=g.labelWidth),g.height===g.inputHeight&&!1!==g.padding&&(h-=i[0]+i[2]),"radio"!==g.type||g.column||(g.calcColumns(),1!==g.rows&&(h=(h-i[0]-i[2])*g.rows)),g.inputHeight=h,g.inputWidth=b-i[1]-i[3],g.height=h+i[0]+i[2]},setWidth:function(a){var b=this;b.width=a,b.calcSize(),b.css("width",a),b.setInputSize({width:b.inputWidth})},onMouseMove:function(a){var b=this;delete b.tooltipToDestroy,b.tip?b.renderTip(a):b.tooltip&&b.tooltip.show(a.pageX+15,a.pageY-25)},renderTip:function(b){var c=this,d="",e=new a.Template(c.tip||c.tooltip);c.getValue&&(d=c.getValue());var f=e.getHTML({value:d});c.tooltip?c.tooltip.update(f):c.tooltip=new a.ToolTip({text:f}),c.tooltip.show(b.pageX+15,b.pageY-25)},getInputSelection:function(){var a,b,c,d,e,f=this,g=0,h=0,i=f.input.dom;return"number"==typeof i.selectionStart&&"number"==typeof i.selectionEnd?(g=i.selectionStart,h=i.selectionEnd):(b=document.selection.createRange())&&b.parentElement()==i&&(d=i.value.length,a=i.value.replace(/\r\n/g,"\n"),c=i.createTextRange(),c.moveToBookmark(b.getBookmark()),e=i.createTextRange(),e.collapse(!1),c.compareEndPoints("StartToEnd",e)>-1?g=h=d:(g=-c.moveStart("character",-d),g+=a.slice(0,g).split("\n").length-1,c.compareEndPoints("EndToEnd",e)>-1?h=d:(h=-c.moveEnd("character",-d),h+=a.slice(0,h).split("\n").length-1))),{start:g,end:h}}}}(),Fancy.define(["Fancy.form.field.String","Fancy.StringField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.string",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","tab","change","key"),a.Super("init",arguments),a.preRender(),a.render(),a.ons(),a.isPassword&&a.input.attr({type:"password"}),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:Fancy.FIELD_CLS,value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<input placeholder="{emptyText}" class="fancy-field-text-input" style="{inputWidth}" value="{value}">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),function(){var a=Fancy.CLEARFIX_CLS,b=Fancy.FIELD_CLS,c=Fancy.FIELD_LABEL_CLS,d=Fancy.FIELD_ERROR_CLS,e=Fancy.FIELD_TEXT_CLS,f=Fancy.FIELD_TEXT_INPUT_CLS,g=Fancy.FIELD_SPIN_CLS,h=Fancy.FIELD_SPIN_UP_CLS,i=Fancy.FIELD_SPIN_DOWN_CLS;Fancy.define(["Fancy.form.field.Number","Fancy.NumberField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.number",allowBlank:!0,constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","tab","change","key"),a.Super("init",arguments),a.preRender(),a.render(),a.ons(),a.hidden&&a.css("display","none"),a.initSpin()},fieldCls:b,value:"",width:100,emptyText:"",step:1,tpl:['<div class="'+c+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">','<input placeholder="{emptyText}" class="'+f+'" style="{inputWidth}" value="{value}">','<div class="'+g+'">','<div class="'+h+'"></div>','<div class="'+i+'"></div>',"</div>",'<div class="'+d+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+a+'"></div>'],onInput:function(){var a=this,b=a.input,c=a.get(),d=a.acceptedValue;if(a.isValid()){for(var e=b.dom.value,f="",g=0,h=e.length;g<h;g++)switch(e[g]){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":case"+":case".":f+=e[g]}isNaN(Number(f))||(a.value=f,c=f)}a.acceptedValue=Number(a.get()),a.fire("input",c),a.fire("change",Number(c),Number(d))},isNumber:function(a){return""===a||"-"===a||Fancy.isNumber(+a)},checkMinMax:function(a){var b=this;return""===a||"-"===a||(a=+a)>=b.min&&a<=b.max},setMin:function(a){this.min=a},setMax:function(a){this.max=a},initSpin:function(){var a=this;!0===a.spin&&(a.el.select("."+g).css("display","block"),a.el.select("."+h).on("mousedown",a.onMouseDownSpinUp,a),a.el.select("."+i).on("mousedown",a.onMouseDownSpinDown,a))},onMouseDownSpinUp:function(a){var b=this,c=Fancy.get(document),d=700,e=new Date;a.preventDefault(),b.mouseDownSpinUp=!0,b.spinUp(),b.spinInterval=setInterval(function(){b.mouseDownSpinUp=!1,new Date-e>d&&(700===d&&(d=150),e=new Date,b.spinUp(),--d<20&&(d=20))},20),c.once("mouseup",function(){clearInterval(b.spinInterval)})},onMouseDownSpinDown:function(a){var b=this,c=Fancy.get(document),d=700,e=new Date;a.preventDefault(),b.mouseDownSpinDown=!0,b.spinDown(),b.spinInterval=setInterval(function(){b.mouseDownSpinDown=!1,new Date-e>d&&(700===d&&(d=150),e=new Date,b.spinDown(),--d<20&&(d=20))},20),c.once("mouseup",function(){clearInterval(b.spinInterval)})},spinUp:function(){var a=this,b=+a.get()+a.step;Fancy.Number.isFloat(a.step)&&(b=Fancy.Number.correctFloat(b)),isNaN(b)&&(b=a.min||0),void 0!==a.max&&b>a.max?b=a.max:b<a.min&&(b=a.min),a.set(b)},spinDown:function(){var a=this,b=+a.get()-a.step;Fancy.Number.isFloat(a.step)&&(b=Fancy.Number.correctFloat(b)),isNaN(b)&&(b=a.min||0),void 0!==a.min&&b<a.min?b=a.min:b>a.max&&(b=a.max),a.set(b)}})}(),function(){var a=Fancy,b=a.Date,c=a.CLEARFIX_CLS,d=a.FIELD_CLS,e=a.FIELD_LABEL_CLS,f=a.FIELD_TEXT_CLS,g=a.FIELD_ERROR_CLS,h=a.FIELD_TEXT_INPUT_CLS;a.define(["Fancy.form.field.Date","Fancy.DateField"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.date",picker:!0,i18n:"en",theme:"default",fieldCls:d,value:"",width:100,emptyText:"",tpl:['<div class="'+e+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+f+'">','<input placeholder="{emptyText}" class="'+h+'" style="{inputWidth}" value="{value}">','<div class="fancy-field-picker-button"></div>','<div class="'+g+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+c+'"></div>'],constructor:function(b){a.apply(this,b),this.Super("const",arguments)},init:function(){var b=this;b.addEvents("focus","blur","input","enter","up","down","tab","change","key","showpicker"),b.initFormat(),b.Super("init",arguments),b.preRender(),b.render(),b.ons(),b.hidden&&b.css("display","none"),b.style&&b.css(b.style),a.isDate(b.value)||b.initDate(),b.changeInputValue(),b.initPicker()},initDate:function(c,d){var e=this;if(c){if("date"===a.typeOf(c))return void(e.date=c);var f;if(f=d?b.parse(c,d,e.format.mode):b.parse(c,e.format.read,e.format.mode),"Invalid Date"===f.toString&&(f=b.parse(c,e.format.edit,e.format.mode)),"Invalid Date"===f.toString)return;return void(e.date=f)}switch(a.typeOf(c)){case"date":e.date=e.value;break;case"undefined":case"string":if(!e.value)return void delete e.date;e.date=b.parse(e.value,e.format.read,e.format.mode)}},changeInputValue:function(){var c=this;if("date"!==a.typeOf(c.date)||"Invalid Date"===c.date.toString())return void(c.input.dom.value="");var d=b.format(c.date,c.format.edit,void 0,c.format.mode);c.format&&c.format.inputFn&&(d=c.format.inputFn(d)),void 0===d&&(d=""),c.input.dom.value=d,c.fire("change",d)},initFormat:function(){var b=this;b.format?a.isObject(b.format)&&a.applyIf(b.format,a.i18n[b.i18n].date):b.format=a.i18n[b.i18n].date},formatValue:function(c){var d=this;if(!d.value&&c?d.value=c:!c&&d.value&&(c=d.value),d.value)if("date"===a.typeOf(d.value)){if(d.value=b.format(d.value,d.format.read,void 0,d.format.mode),void 0===c){var e=b.parse(d.value,d.format.edit,d.format.mode);c=b.format(e,d.format.edit,void 0,d.format.mode)}d.acceptedValue=c}else{var f=b.parse(d.value,d.format.read,d.format.mode);d.value=b.format(f,d.format.edit,void 0,d.format.mode)}else;d.format&&d.format.inputFn&&(c=d.format.inputFn(c)),void 0===c&&(c=""),/NaN/.test(c)&&(c=""),d.input.dom.value=c},ons:function(){var a=this,b=a.el.getByTag("input");a.input=b,b.on("blur",a.onBlur,a),b.on("focus",a.onFocus,a),b.on("input",a.onInput,a),b.on("keydown",a.onKeyDown,a),a.on("key",a.onKey,a),a.on("enter",a.onEnter,a),a.on("beforehide",a.onBeforeHide,a),a.format&&a.format.inputFn&&a.on("key",a.onKeyInputFn)},initPicker:function(){var a=this;!1!==a.picker&&(!1===a.dateImage?(a.el.select(".fancy-field-picker-button").css("display","none"),a.input.on("click",a.onInputClick,a)):(a.pickerButton=a.el.select(".fancy-field-picker-button"),a.pickerButton.on("mousedown",a.onPickerButtonMouseDown,a)))},onInputClick:function(a){a.preventDefault(),this.toggleShowPicker()},onPickerButtonMouseDown:function(a){a.preventDefault(),this.toggleShowPicker()},showPicker:function(){var b=this,c=b.el,d=b.input,e=a.get(document);!0===b.picker&&b.renderPicker();var g=d.offset(),h=g.left,i=g.top+c.select("."+f).height(),j=b.date||new Date;"Invalid Date"===j.toString()&&(j=new Date),b.picker.setDate(j),a.datepicker.Manager.add(b.picker),b.picker.showAt(h,i),b.fire("showpicker"),b.docSpy||(b.docSpy=!0,e.on("click",b.onDocClick,b))},onDocClick:function(b){var c=this,d=c.picker,e=d.monthPicker,f=b.target;"input"===f.tagName.toLocaleLowerCase()||a.get(f).hasCls("fancy-field-picker-button")||d.panel.el.within(f)||e&&e.panel.el.within(f)||c.hidePicker()},hidePicker:function(){var b=this;if(!1!==b.picker&&b.picker.hide&&b.picker.hide(),b.docSpy){var c=a.get(document);b.docSpy=!1,c.un("click",b.onDocClick,b)}},toggleShowPicker:function(){var a=this;if(!0===a.picker)return void a.showPicker();"none"===a.picker.panel.el.css("display")?a.showPicker():a.hidePicker()},renderPicker:function(){var b=this;(a.fullBuilt||a.modules.grid||!1===a.MODULELOAD||!1===a.MODULESLOAD)&&(b.picker=new a.DatePicker({window:!0,date:b.date,format:b.format,theme:b.theme,events:[{changedate:b.onPickerChangeDate,scope:b}]}))},get:function(){var a=this;return""===a.input.dom.value?(delete a.date,delete a.value,""):a.date?b.format(a.date,a.format.write,void 0,a.format.mode):""},getDate:function(){return this.date||""},onBeforeHide:function(){this.hidePicker()},onPickerChangeDate:function(a,b,c){var d=this;!1!==c&&d.picker.hide(),d.initDate(b),d.changeInputValue()},onInput:function(){var a=this,c=a.input,d=c.dom.value,e=a.acceptedValue;"Invalid Date"!==b.parse(d,a.format.edit,a.format.mode).toString()&&(a.initDate(d,a.format.edit),a.fire("input",d),a.fire("change",d,e))},isValid:function(){var a=this;return"Invalid Date"!==b.parse(a.get(),a.format.edit,a.format.mode).toString()},set:function(a){var b=this;switch(a){case"":case void 0:return delete b.value,delete b.date,void b.changeInputValue()}b.initDate(a),b.changeInputValue()},isEqual:function(a){var c=this,d=b.parse(a,c.format.read,c.format.mode),e=c.input.dom.value;return(a=b.format(d,c.format.edit,void 0,c.format.mode))===e},onEnter:function(){var a=this,b=a.input,c=b.dom.value,d=a.acceptedValue;""===c&&(a.initDate(),a.fire("input",c),a.fire("change",c,d))}})}(),function(){var a=Fancy,b=a.Date;a.define(["Fancy.form.field.DateRange","Fancy.DateRangeField"],{extend:a.Widget,type:"field.daterange",picker:!0,format:"m/d/Y",dateImage:!0,theme:"default",constructor:function(b){a.apply(this,b),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("changedatefrom","changedateto","change"),a.preRender(),a.render(),a.initDateFields()},fieldCls:a.cls+" fancy-date-range",width:100,render:function(){var b=this,c=b.renderTo||document.body,d=a.get(document.createElement("div"));d.addCls(b.cls),b.el=a.get(a.get(c).dom.appendChild(d.dom))},preRender:function(){},initDateFields:function(){var b=this,c=b.theme;b.dateField1=new a.DateField({renderTo:b.el.dom,label:!1,dateImage:b.dateImage,width:b.width/2,padding:!1,theme:c,style:{position:"absolute",bottom:"2px",left:"3px"},format:b.format,events:[{showpicker:b.onShowPicker1,scope:b},{change:b.onChangeDate1,scope:b},{focus:b.onFocus1,scope:b},{enter:b.onEnter,scope:b}]}),b.dateField1.setInputSize({width:b.width/2}),b.dateField2=new a.DateField({renderTo:b.el.dom,label:!1,dateImage:b.dateImage,width:b.width/2,padding:!1,theme:c,style:{position:"absolute",bottom:"2px",right:"2px"},format:b.format,events:[{showpicker:b.onShowPicker2,scope:b},{change:b.onChangeDate2,scope:b},{focus:b.onFocus2,scope:b},{keydown:b.onEnter,scope:b}]}),b.dateField2.setInputSize({width:b.width/2})},onFocus1:function(){this.dateField2.hidePicker()},onFocus2:function(){this.dateField1.hidePicker()},onShowPicker1:function(){this.dateField2.hidePicker()},onShowPicker2:function(){this.dateField1.hidePicker()},onChangeDate1:function(a,c){var d=this,c=b.parse(c,a.format.edit,a.format.mode);d.fire("changedatefrom",c),d.fire("change")},onChangeDate2:function(a,c){var c=b.parse(c,a.format.edit,a.format.mode);this.fire("changedateto",c),this.fire("change")},onEnter:function(){this.dateField1.hidePicker(),this.dateField2.hidePicker()}})}(),Fancy.define(["Fancy.form.field.Text","Fancy.TextField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.text",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.preRender(),a.render(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:Fancy.FIELD_CLS+" fancy-field-field-text",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-text-value">{value}</div>','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>'],set:function(a){this.el.select(".fancy-field-text-value").item(0).update(a)}}),Fancy.define(["Fancy.form.field.Empty","Fancy.EmptyField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.empty",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents(),a.Super("init",arguments),a.preRender(),a.render(),a.style&&a.css(a.style)},ons:function(){},fieldCls:Fancy.FIELD_CLS+" "+Fancy.FIELD_EMPTY_CLS,width:100,tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">','<div class="fancy-field-error" style="{errorTextStyle}"></div>',"</div>",'<div class="fancy-clearfix"></div>']}),function(){var a=Fancy,b=a.FIELD_CLS,c=a.FIELD_TEXTAREA_CLS,d=a.FIELD_LABEL_CLS,e=a.FIELD_TEXTAREA_TEXT_CLS,f=a.FIELD_TEXTAREA_TEXT_INPUT_CLS,g=a.FIELD_ERROR_CLS,h=a.CLEARFIX_CLS;a.define(["Fancy.form.field.TextArea","Fancy.TextArea"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.textarea",constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.addEvents("change","key"),a.Super("init",arguments),a.preRender(),a.render(),a.ons()},fieldCls:b+" "+c,value:"",width:250,height:100,labelWidth:60,inputWidth:180,minHeight:100,maxHeight:210,lineHeight:12.5,emptyText:"",tpl:['<div class="'+d+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">','<textarea autocomplete="off" placeholder="{emptyText}" type="text" class="'+f+'" style="{inputWidth}height:{inputHeight}px;">{value}</textarea>','<div class="'+g+'" style="{errorTextStyle}"></div>',"</div>",'<div class="'+h+'"></div>'],ons:function(){var a=this,b=a.el.getByTag("textarea");a.input=b,b.on("blur",a.onBlur,a),b.on("focus",a.onFocus,a),b.on("input",a.onInput,a),b.on("keydown",a.onKeyDown,a),a.on("key",a.onKey,a),a.autoHeight&&b.on("input",a.onChange,a)},preRender:function(){var b=this;b.tpl&&(b.tpl=new a.Template(b.tpl)),b.initHeight(),b.calcSize()},initHeight:function(){var a,b=this;if(b.height)a=b.height,b.maxHeight<b.height&&(b.maxHeight=b.height,setTimeout(function(){b.input.css({"overflow-y":"scroll"})},1));else if(b.value){var c=b.value.match(/\n/g);c=c?c.length:1,a=c*b.lineHeight}else a=b.height;a<b.minHeight?a=b.minHeight:a>b.maxHeight&&(a=b.maxHeight,setTimeout(function(){b.input.css({"overflow-y":"scroll"})},1)),b.height=a,b.inputHeight=a},calcSize:function(){var b,c,d,e,f,g=this,h=g.padding;if(a.isString(h))switch(h=h.replace(/px/g,""),h=h.split(" "),h.length){case 1:c=Number(h[0]),h=[c,c,c,c];break;case 2:d=Number(h[0]),e=Number(h[1]),h=[d,e,d,e];break;case 3:d=Number(h[0]),e=Number(h[1]),f=Number(h[2]),h=[d,e,f,d];break;case 4:h=[Number(h[0]),Number(h[1]),Number(h[2]),Number(h[3])]}else a.isNumber(h)?h=[h,h,h,h]:!1===h&&(h=[0,0,0,0]);"top"===g.labelAlign&&(g.inputHeight-=40),b=g.width,"top"!==g.labelAlign&&g.label&&(b-=g.labelWidth),g.height===g.inputHeight&&!1!==g.padding&&(g.inputHeight-=h[0]+h[2]),g.inputWidth=b-h[1]-h[3],g.height=g.inputHeight+h[0]+h[2]},onChange:function(){var a=this,b=a.input.dom.value,c=a.el.getByTag("textarea"),d=b.match(/\n/g).length*a.lineHeight;d<a.minHeight?(d=a.minHeight,c.css({"overflow-y":"hidden"})):d>a.maxHeight?(d=a.maxHeight,c.css({"overflow-y":"scroll"})):c.css({"overflow-y":"hidden"}),a.height=d}})}(),function(){var a=Fancy.CLEARFIX_CLS,b=Fancy.FIELD_CLS,c=Fancy.FIELD_LABEL_CLS,d=Fancy.FIELD_TEXT_CLS,e=Fancy.FIELD_CHECKBOX_CLS,f=Fancy.FIELD_CHECKBOX_INPUT_CLS,g=Fancy.FIELD_INPUT_LABEL_CLS,h=Fancy.FIELD_CHECKBOX_ON_CLS;Fancy.define(["Fancy.form.field.CheckBox","Fancy.CheckBox"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.checkbox",constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","beforechange","change","key"),a.Super("init",arguments),a.preRender(),a.render({labelWidth:a.labelWidth,labelDispay:a.labelText?"":"none",label:a.label}),a.expander&&a.addCls("fancy-checkbox-expander"),a.acceptedValue=a.value,a.set(a.value,!1),a.ons()},labelText:"",labelWidth:60,value:!1,editable:!0,stopIfCTRL:!1,checkedCls:h,fieldCls:b+" "+e,tpl:['<div class="'+c+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+d+'">','<div class="'+f+'"></div>',"</div>",'<div class="'+g+'" style="{inputLabelDisplay}">',"{inputLabel}","</div>",'<div class="'+a+'"></div>'],ons:function(){var a=this,b=a.el;b.on("click",a.onClick,a),b.on("mousedown",a.onMouseDown,a)},onClick:function(a){var b=this,c=b.el;if(b.fire("beforechange"),!(a.ctrlKey&&b.stopIfCTRL||!1===b.editable)){if(!0===b.canceledChange)return void(b.canceledChange=!0);c.toggleCls(b.checkedCls);var d=b.value;b.value=c.hasCls(b.checkedCls),b.fire("change",b.value,d)}},onMouseDown:function(a){a.preventDefault()},set:function(a,b){var c=this,d=c.el;if(""===a&&(a=!1),!0===a||1===a)d.addCls(c.checkedCls),a=!0;else if(!1===a||0===a)d.removeClass(c.checkedCls),a=!1;else{if(void 0!==a)throw new Error("not right value for checkbox "+a);a=!1}c.value=a,!1!==b&&c.fire("change",c.value)},setValue:function(a,b){this.set(a,b)},getValue:function(){return this.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},toggle:function(){me.set(!this.value)}})}(),Fancy.define(["Fancy.form.field.Switcher","Fancy.Switcher"],{extend:Fancy.CheckBox,type:"field.switcher",constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){this.Super("init",arguments)},checkedCls:"fancy-switcher-on",fieldCls:Fancy.FIELD_CLS+" fancy-field-switcher",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"</div>",'<div class="fancy-field-input-label" style="{inputLabelDisplay}">',"{inputLabel}","</div>",'<div class="fancy-clearfix"></div>']}),function(){var a=Fancy,b=a.FIELD_CLS,c=a.FIELD_COMBO_CLS,d=a.FIELD_LABEL_CLS,e=a.FIELD_TEXT_CLS,f=a.CLEARFIX_CLS,g=a.FIELD_ERROR_CLS,h=a.FIELD_TEXT_INPUT_CLS;a.define("Fancy.combo.Manager",{singleton:!0,opened:[],add:function(a){this.hideLists(),this.opened.push(a)},hideLists:function(){a.each(this.opened,function(a){a.hideList(),a.hideAheadList()}),this.opened=[]}}),a.define(["Fancy.form.field.Combo","Fancy.Combo"],{type:"field.combo",mixins:[a.form.field.Mixin],extend:a.Widget,selectedItemCls:"fancy-combo-item-selected",focusedItemCls:"fancy-combo-item-focused",fieldCls:b+" "+c,width:250,labelWidth:60,listRowHeight:25,dropButtonWidth:27,emptyText:"",editable:!0,typeAhead:!0,readerRootProperty:"data",valueKey:"value",displayKey:"text",multiSelect:!1,itemCheckBox:!1,tpl:['<div class="'+d+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">','<div class="fancy-combo-input-container" style="{inputWidth}{inputHeight}">','<input placeholder="{emptyText}" class="'+h+'" style="{inputWidth}{inputHeight}cursor:default;" value="{value}">','<div class="fancy-combo-dropdown-button">&nbsp;</div>',"</div>","</div>",'<div class="'+g+'" style="{errorTextStyle}"></div>','<div class="'+f+'"></div>'],constructor:function(){this.tags=this.tags||[],this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","up","down","change","key","enter","esc","empty","load"),a.Super("init",arguments),a.loadListData()||(a.data=a.configData(a.data)),a.multiSelect&&a.data.length&&a.initMultiSelect(),a.preRender(),a.render(),a.ons(),a.applyStyle(),a.applyTheme(),setTimeout(function(){a.applyTheme()},1)},loadListData:function(){var b=this;if(!a.isObject(b.data))return!1;var c=b.data.proxy,d=b.readerRootProperty;if(!c||!c.url)throw new Error("[FancyGrid Error]: combo data url is not defined");return c.reader&&c.reader.root&&(d=c.reader.root),a.Ajax({url:c.url,params:c.params||{},method:c.method||"GET",getJSON:!0,success:function(a){if(b.data=b.configData(a[d]),b.renderList(),b.onsList(),b.multiSelect)b.initMultiSelect(),b.value&&b.updateInput();else if(b.value){var c=b.getDisplayValue(b.value);c&&(b.input.dom.value=c)}b.fire("load")}}),!0},configData:function(b){if(a.isObject(b)||0===b.length)return b;if(!a.isObject(b[0])){for(var c=[],d=0,e=b.length;d<e;d++)c.push({text:b[d],value:d});return c}return b},applyStyle:function(){var a=this;a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},applyTheme:function(){var a=this;a.theme&&"default"!==a.theme&&(a.addCls("fancy-theme-"+a.theme),a.list.addCls("fancy-theme-"+a.theme))},ons:function(){var a=this,b=a.el.select(".fancy-combo-dropdown-button");a.input=a.el.getByTag("input"),a.inputContainer=a.el.select(".fancy-combo-input-container"),a.drop=b,a.onsList(),a.input.on("mousedown",a.onInputMouseDown,a),a.input.on("click",a.onInputClick,a),b.on("mousedown",a.onDropMouseDown,a),b.on("click",a.onDropClick,a),a.typeAhead&&a.editable&&a.input.on("keydown",a.onKeyDown,a),a.on("esc",a.onEsc,a),a.on("enter",a.onEnter,a),a.on("up",a.onUp,a),a.on("down",a.onDown,a)},onKeyDown:function(b){var c=this,d=b.keyCode,e=a.key;switch(d){case e.ESC:c.fire("esc",b);break;case e.ENTER:c.fire("enter",b);break;case e.UP:c.fire("up",b);break;case e.DOWN:c.fire("down",b);break;case e.TAB:break;case e.BACKSPACE:setTimeout(function(){if(0===c.input.dom.value.length)c.value=-1,c.valueIndex=-1,c.hideAheadList(),c.multiSelect&&(c.values=[],c.clearListActive()),c.fire("empty");else{if(c.multiSelect&&c.input.dom.value.split(",").length!==c.valuesIndex.length){var a=c.getFromInput();c.set(a)}if(0===c.generateAheadData().length)return void c.hideAheadList();c.renderAheadList(),c.showAheadList()}},100);break;default:setTimeout(function(){if(0===c.generateAheadData().length)return void c.hideAheadList();c.renderAheadList(),c.showAheadList()},1)}},onInputClick:function(a){var b=this,c=b.list;!0!==b.editable&&("none"===c.css("display")?b.showList():b.hideList())},onDropClick:function(b){var c=this;"none"===c.list.css("display")?(a.combo.Manager.add(this),c.showList()):c.hideList(),!0===c.editable&&c.input.focus()},showList:function(){var b=this,c=b.list,d=b.input.parent().parent(),e=d.$dom.offset(),f=[e.left,e.top+d.$dom.height()],g=a.get(document),h=b.selectedItemCls,i=b.focusedItemCls;if(b.hideAheadList(),b.list){c.css({display:"",left:f[0]+"px",top:f[1]+3+"px",opacity:0,width:b.getListWidth(),"z-index":2e3+a.zIndex++}),c.animate({opacity:1,top:f[1]},a.ANIMATE_DURATION);var j;b.clearFocused();var k=c.select("."+h);0===k.length?b.multiSelect&&b.values.length?b.valuesIndex.each(function(a,b,d){void 0===j&&(j=a),c.select("li").item(a).addCls(h)}):j=0:(b.multiSelect&&k.length!==b.valuesIndex.length&&(c.select("."+h).removeCls(h),b.valuesIndex.each(function(a,b,d){void 0===j&&(j=a),c.select("li").item(a).addCls(h)})),j=k.item(0).index()),-1===j&&(j=0),c.select("li").item(j).addCls(i),b.scrollToListItem(j),b.docSpy||(b.docSpy=!0,g.on("click",b.onDocClick,b))}},showAheadList:function(){var b=this,c=b.aheadList,d=b.input.parent().parent(),e=d.$dom.offset(),f=[e.left,e.top+d.$dom.height()],g=a.get(document);b.hideList(),c&&(c.css({display:"",left:f[0]+"px",top:f[1]+"px",width:b.getListWidth(),"z-index":2e3+a.zIndex++}),b.docSpy2||(b.docSpy2=!0,g.on("click",b.onDocClick,b)))},onDocClick:function(a){var b=this;if(!1===b.input.parent().parent().within(a.target)){if(!0===b.list.within(a.target))return;b.hideList(),b.hideAheadList()}},hideList:function(){var b=this;if(b.list&&(b.list.css("display","none"),b.docSpy)){var c=a.get(document);b.docSpy=!1,c.un("click",b.onDocClick,b)}},hideAheadList:function(){var b=this;if(b.aheadList&&(b.aheadList.css("display","none"),b.docSpy)){var c=a.get(document);b.docSpy=!1,c.un("click",b.onDocClick,b)}},onInputMouseDown:function(a){!1===this.editable&&a.preventDefault()},onDropMouseDown:function(a){a.preventDefault()},onsList:function(){var a=this;a.list.on("click",a.onListItemClick,a,"li"),a.list.on("mouseenter",a.onListItemOver,a,"li"),a.list.on("mouseleave",a.onListItemLeave,a,"li")},onsAheadList:function(){var a=this;a.aheadList.on("click",a.onListItemClick,a,"li")},onListItemOver:function(b){a.get(b.target).addCls(this.focusedItemCls)},onListItemLeave:function(){this.clearFocused()},onListItemClick:function(b){var c=this,d=a.get(b.currentTarget),e=d.attr("value"),f=c.selectedItemCls,g=c.focusedItemCls;a.nojQuery&&0===e&&(e=""),c.multiSelect?(0===c.values.length&&c.clearListActive(),c.clearFocused(),d.toggleCls(f),d.hasCls(f)?(c.addValue(e),d.addCls(g)):(c.removeValue(e),c.clearFocused()),c.updateInput()):(c.set(e),c.hideList()),c.editable?c.input.focus():c.onBlur()},set:function(b,c){var d,e=this,f="";if(e.multiSelect&&!a.isArray(b)&&(b=-1===b?[]:[b]),a.isArray(b)&&e.multiSelect){var g=[];e.valuesIndex.removeAll(),a.each(b,function(a,c){var d=e.getIndex(a);-1!==d&&(e.valuesIndex.add(d,b[c]),g.push(e.data[d][e.displayKey]),f=g.join(", "))}),e.values=b,d=e.getIndex(b[0]),e.value=b[0],e.valueIndex=d}else d=e.getIndex(b),-1!==d?(e.valueIndex=d,f=e.data[d][e.displayKey],e.selectItem(d)):-1!==b&&b&&b.length>0?(f="",e.value=-1,e.valueIndex=-1):f="",e.value=b;e.input.dom.value=f,!1!==c&&e.onInput()},addValue:function(a){var b=this,c=b.getIndex(a);-1===c||b.valuesIndex.get(c)||(b.value=a,b.values.push(a),b.valuesIndex.add(c,a))},removeValue:function(b){var c=this,d=-1;a.each(c.values,function(a,c){a===b&&(d=c)}),-1!==d&&(c.values.splice(d,1),c.valuesIndex.remove(c.getIndex(b))),c.values.length?c.value=c.values[c.values.length-1]:(c.value=-1,c.valueIndex=-1)},updateInput:function(a){var b=this,c=[];b.valuesIndex.each(function(a,d,e){c.push(b.data[a][b.displayKey])}),b.input.dom.value=c.join(", "),!1!==a&&b.onInput()},selectItem:function(a){var b=this;if(b.list){b.multiSelect||b.clearListActive(),b.clearFocused();b.list.select("li").item(a).addCls(b.focusedItemCls,b.selectedItemCls)}},render:function(){var b=this,c=a.get(b.renderTo||document.body).dom,d=a.get(document.createElement("div")),e=b.value,f=-1;d.attr("id",b.id),void 0===e?e="":b.multiSelect&&a.isArray(b.data)&&b.data.length>0?(e="",b.valuesIndex.each(function(a,c){-1===f&&(f=a,b.valueIndex=a),e+=b.data[a][b.displayKey]+", "}),e=e.replace(/, $/,"")):(f=b.getIndex(e),-1!==f?(b.valueIndex=f,e=b.data[f][b.displayKey]):e=""),b.fire("beforerender"),d.addCls(a.cls,b.cls,b.fieldCls);var g="";b.labelWidth&&(g="width:"+b.labelWidth+"px;");var h=b.label;""===b.label?h="&nbsp;":void 0===b.label?h="&nbsp;":"right"!==b.labelAlign&&(h+=":"),d.update(b.tpl.getHTML({labelWidth:g,labelDisplay:!1===b.label?"display: none;":"",label:!1===h?"":h,emptyText:b.emptyText,inputHeight:"height:"+b.inputHeight+"px;",value:e})),b.el=d,b.setStyle(),b.input=b.el.getByTag("input"),b.inputContainer=b.el.select(".fancy-combo-input-container"),b.drop=b.el.select(".fancy-combo-dropdown-button"),b.setSize(),c.appendChild(d.dom),"top"===b.labelAlign?b.el.addCls("fancy-field-label-align-top"):"right"===b.labelAlign&&(b.el.addCls("fancy-field-label-align-right"),$(d.dom).find(".fancy-field-label").insertAfter($(d.dom).find(".fancy-field-text"))),b.valueIndex&&(b.acceptedValue=b.value),b.editable&&b.input.css("cursor","auto"),b.renderList(),b.fire("afterrender"),b.fire("render")},renderList:function(){var b=this,c=a.get(document.createElement("div")),d=['<ul style="position: relative;">'];b.list&&b.list.destroy(),a.each(b.data,function(c,e){var f="",g=c[b.displayKey],h=c[b.valueKey];if(b.value===h&&(f=b.selectedItemCls),""===g||" "===g)g="&nbsp;";else if(b.listItemTpl){var i=new a.Template(b.listItemTpl);g=i.getHTML(c)}b.multiSelect&&b.itemCheckBox?d.push('<li value="'+h+'" class="'+f+'"><div class="fancy-field-checkbox-input" style=""></div><span class="fancy-combo-list-value">'+g+"</span></li>"):d.push('<li value="'+h+'" class="'+f+'"><span class="fancy-combo-list-value">'+g+"</span></li>")}),d.push("</ul>"),c.addCls("fancy fancy-combo-result-list"),c.update(d.join("")),c.css({display:"none",left:"0px",top:"0px",width:b.getListWidth()}),b.data.length>9&&c.css({height:9*b.listRowHeight+"px",overflow:"auto"}),document.body.appendChild(c.dom),b.list=c},getListWidth:function(){var a,b=this,c=b.inputWidth+14,d=b.minListWidth;return b.input&&(a=b.input.parent().parent(),c=a.width()),d&&d>c&&(c=d),c},generateAheadData:function(){var b=this,c=b.input.dom.value.toLocaleLowerCase(),d=[];if(b.multiSelect){var e=c.split(", "),f=b.getInputSelection(),g=0;a.each(c,function(a,b){if(f.start<=b)return!0;","===c[b]&&g++}),c=e[g]}return a.each(b.data,function(a){new RegExp("^"+c).test(a[b.displayKey].toLocaleLowerCase())&&d.push(a)}),b.data.length===d.length&&(d=[]),b.aheadData=d,d},renderAheadList:function(){var b,c=this,d=['<ul style="position: relative;">'],e=!1;c.aheadList?(c.aheadList.firstChild().destroy(),b=c.aheadList,e=!0):b=a.get(document.createElement("div")),a.each(c.aheadData,function(a,b){var e="",f=a[c.displayKey],g=a[c.valueKey];0===b&&(e=c.selectedItemCls),""!==f&&" "!==f||(f="&nbsp;"),d.push('<li value="'+g+'" class="'+e+'"><span class="fancy-combo-list-value">'+f+"</span></li>")}),d.push("</ul>"),b.update(d.join("")),b.css({display:"none",left:"0px",top:"0px",width:c.getListWidth()}),b.css({"max-height":9*c.listRowHeight+"px",overflow:"auto"}),!1===e&&(b.addClass(a.cls,"fancy-combo-result-list"),document.body.appendChild(b.dom),c.aheadList=b,c.onsAheadList())},hide:function(){var a=this;a.css("display","none"),a.hideList(),a.hideAheadList()},clear:function(){var a=this;a.multiSelect?a.set([],!1):a.set(-1,!1)},clearListActive:function(){var a=this,b=a.selectedItemCls,c=a.focusedItemCls;a.list.select("."+c).removeCls(c),a.list.select("."+b).removeCls(b)},clearFocused:function(){var a=this,b=a.focusedItemCls;a.list&&a.list.select("."+b).removeCls(b),a.aheadList&&a.aheadList.select("."+b).removeCls(b)},onInput:function(){var a=this,b=a.getValue(),c=a.acceptedValue;a.acceptedValue=a.get(),a.fire("change",b,c)},setValue:function(a,b){this.set(a,b)},getDisplayValue:function(a,b){var c=this,d=c.getIndex(a);return b?d:c.data[d][c.displayKey]},getValueKey:function(a,b){for(var c=this,d=0,e=c.data.length;d<e;d++)if(c.data[d][c.displayKey]===a)return b?d:c.data[d][c.valueKey]},get:function(){return this.getValue()},getValue:function(){var a=this;return a.multiSelect?a.values:-1===a.value||void 0===a.value?-1===a.value&&a.input.dom.value?a.input.dom.value:"":(a.valueKey,a.value)},size:function(a){var b=this,c=a.width,d=a.height,e=b.input,f=b.inputContainer,g=b.drop;"top"!==b.labelAlign&&(b.inputHeight=d),void 0!==d&&(b.height=d),void 0!==c&&(b.width=c),b.calcSize(),"top"===b.labelAlign?b.css({height:1.5*b.height,width:b.width}):b.css({height:b.height,width:b.width});var h=b.inputWidth,i=2;"dark"===b.theme&&(i=0),e.css({width:h-i,height:b.inputHeight}),f.css({width:h,height:b.inputHeight}),g.css("height",b.inputHeight)},onEnter:function(a,b){var c,d=this,e=d.getActiveList(),f=d.focusedItemCls,g=d.selectedItemCls;if(d.multiSelect){if(!e)return;var h=e.select("."+f);if(h&&h.dom||(h=e.select("."+g).last()),h&&h.dom){c=h.attr("value"),d.addValue(c);var i=d.getDisplayValue(c,!0);d.selectItem(i),d.updateInput()}}else if(e){var h=e.select("."+f);h&&h.dom||(h=e.select("."+g)),c=h.attr("value"),d.set(c)}else d.set(d.input.dom.value);d.hideList(),d.hideAheadList()},onEsc:function(a,b){var c=this;c.hideList(),c.hideAheadList()},onUp:function(a,b){var c=this,d=c.getActiveList(),e=c.focusedItemCls;if(d){b.preventDefault();var f=d.select("."+e),g=!1;f.dom||(g=!0,f=d.lastChild());var h=f.index(),i=d.select("li"),j=parseInt(d.css("height"));0===h||g?h=i.length-1:h--;var k=i.item(h),l=k.position().top;l-d.dom.scrollTop>j?d.dom.scrollTop=1e4:l-d.dom.scrollTop<0&&(d.dom.scrollTop=l),c.clearFocused(),k.addClass(e)}},onDown:function(a,b){var c=this,d=c.getActiveList(),e=c.focusedItemCls;if(d){b.preventDefault();var f=d.select("."+e),g=!1;f.dom||(g=!0,f=d.firstChild());var h=parseInt(f.css("height")),i=f.index(),j=d.select("li"),k=parseInt(d.css("height"));i===j.length-1||g?i=0:i++;var l=j.item(i),m=l.position().top,n=parseInt(l.css("height"));m-d.dom.scrollTop<0?d.dom.scrollTop=0:m+n+3-d.dom.scrollTop>k&&(d.dom.scrollTop=m-k+h+n),c.clearFocused(),l.addClass(e)}else c.showList()},scrollToListItem:function(a){var b=this,c=b.getActiveList(),d=c.select("li"),e=d.item(a),f=e.position().top;parseInt(c.css("height"));0===a?c.dom.scrollTop=0:a===d.length-1?c.dom.scrollTop=1e4:c.dom.scrollTop=f},getActiveList:function(){var a=this,b=!1;return a.list&&"none"!==a.list.css("display")?b=a.list:a.aheadList&&"none"!==a.aheadList.css("display")&&(b=a.aheadList),b},initMultiSelect:function(){var b=this,c=b.value;b.values=[],b.valuesIndex=new a.Collection,void 0!==b.value&&null!==c&&""!==c&&(a.isArray(c)?(b.values=c,b.value=c[0]):b.values=[b.value],a.each(b.values,function(a){b.valuesIndex.add(b.getIndex(a),a)}))},getIndex:function(a){for(var b=this,c=b.data,d=0,e=c.length,f=-1;d<e;d++)if(c[d][b.valueKey]==a)return d;return f},getFromInput:function(){var b=this,c=b.input.dom.value,d=c.split(","),e=[];return a.each(d,function(a){var c=a.replace(/ $/,"").replace(/^ /,""),d=b.getValueKey(c);d&&e.push(d)}),e}})}(),function(){var a=Fancy,b=a.CLEARFIX_CLS,c=a.FIELD_CLS,d=a.FIELD_LABEL_CLS,e=a.FIELD_TEXT_CLS,f=a.FIELD_BUTTON_CLS;a.define(["Fancy.form.field.Button","Fancy.ButtonField"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.button",pressed:!1,constructor:function(b){a.apply(this,b),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("click"),a.Super("init",arguments),a.preRender(),a.render(),a.renderButton(),a.ons(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:c+" "+f,value:"",width:100,emptyText:"",tpl:['<div class="'+d+'" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="'+e+'">',"</div>",'<div class="'+b+'"></div>'],renderButton:function(){var b=this;new a.Button({renderTo:b.el.select("."+e).item(0).dom,text:b.buttonText,handler:function(){b.handler&&b.handler()}})},ons:function(){},onClick:function(){var a=this;a.fire("click"),a.handler&&a.handler()}})}(),Fancy.define(["Fancy.form.field.SegButton","Fancy.SegButtonField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.button",allowToggle:!0,constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("click","change"),a.Super("init",arguments),a.preRender(),a.render(),a.renderButton(),a.ons(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:"fancy fancy-field fancy-field-button",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-label" style="{labelWidth}{labelDisplay}">',"{label}","</div>",'<div class="fancy-field-text">',"</div>",'<div class="fancy-clearfix"></div>'],renderButton:function(){var a=this;a.button=new Fancy.SegButton({renderTo:a.el.select(".fancy-field-text").item(0).dom,items:a.items,multiToggle:a.multiToggle,allowToggle:a.allowToggle})},ons:function(){var a=this;a.button.on("toggle",function(){a.fire("toggle")})},onClick:function(){var a=this;a.fire("click"),a.handler&&a.handler()},get:function(){var a=this,b=[];return Fancy.each(a.items,function(a,c){a.pressed&&(a.value?b.push(a.value):b.push(c))}),b.toString()},clear:function(a){this.allowToggle&&Fancy.each(this.items,function(b){b.setPressed(!1,a)})}}),Fancy.define(["Fancy.form.field.Line","Fancy.FieldLine"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.line",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents(),a.Super("init",arguments);for(var b,c=0,d=a.items.length;c<d;c++){var e=a.items[c];e.style=e.style||{},"top"===e.labelAlign?b=!0:e.style["padding-top"]="0px",0===c&&(e.style["padding-left"]="0px")}a.preRender(),a.render(),b&&a.css("height","48px")},fieldCls:"fancy fancy-field fancy-field-line",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-text fancy-field-line-items">',"</div>"]}),Fancy.define(["Fancy.form.field.Set","Fancy.SetField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.set",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("beforecollapse","collapse","expanded"),a.Super("init",arguments),Fancy.each(a.items,function(a,b){"top"===a.labelAlign&&0===b&&(a.style={"padding-left":"0px"})}),a.preRender(),a.render(),void 0!==a.checkbox&&a.initCheckBox(),a.on("beforecollapse",a.onBeforeCollapsed,a),a.on("expanded",a.onExpanded,a)},fieldCls:"fancy-field-set",value:"",width:100,emptyText:"",tpl:["<fieldset>","<legend>",'<div class="fancy-field-checkbox-input" style="float:left;margin-top: 4px;display: none;"></div>','<div class="fancy-field-set-label" style="float:left;">{label}</div>','<div class="fancy-clearfix"></div>',"</legend>",'<div class="fancy-field-text fancy-field-set-items">',"</div>","</fieldset>"],initCheckBox:function(){var a=this,b=a.el.select(".fancy-field-checkbox-input");b.css("display",""),!0===a.checkbox&&a.addCls("fancy-checkbox-on");var c=a.el.select(".fancy-field-set-items");setTimeout(function(){!0===a.checkbox||a.fire("collapse")},1),!0===a.checkbox?(c.css("display",""),a.removeCls("fancy-set-collapsed")):(c.css("display","none"),a.addCls("fancy-set-collapsed")),b.on("click",function(){a.toggleCls("fancy-checkbox-on");var b=a.el.hasCls("fancy-checkbox-on"),c=a.el.select(".fancy-field-set-items");b?(a.fire("beforeexpanded"),c.css("display",""),a.removeCls("fancy-set-collapsed"),a.fire("expanded")):(a.fire("beforecollapse"),c.css("display","none"),a.addCls("fancy-set-collapsed"),a.fire("collapse"))})},onBeforeCollapsed:function(){var a=this,b=a.form,c=a.el.select(".fancy-field-set-items"),d=parseInt(c.css("height"));b.setHeight(b.getHeight()-d)},onExpanded:function(){var a=this,b=a.form,c=a.el.select(".fancy-field-set-items"),d=parseInt(c.css("height"));b.setHeight(b.getHeight()+d)}}),Fancy.define(["Fancy.form.field.Tab","Fancy.Tab"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.tab",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("collapsed","expanded"),a.Super("init",arguments);for(var b=0,c=a.items.length;b<c;b++){var d=a.items[b];"top"===d.labelAlign&&(!0,0===b&&(d.style={"padding-left":"0px"}))}a.preRender(),a.render()},fieldCls:"fancy fancy-field-tab",value:"",width:100,emptyText:"",tpl:['<div class="fancy-field-text fancy-field-tab-items">',"</div>"]}),Fancy.define(["Fancy.form.field.HTML","Fancy.HTMLField"],{mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,type:"field.html",constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","change","key"),a.Super("init",arguments),a.preRender(),a.render(),a.hidden&&a.css("display","none"),a.style&&a.css(a.style)},fieldCls:"fancy fancy-field-html",value:"",width:100,emptyText:"",tpl:['<div class="" style="">',"{value}","</div>"],render:function(){var a=this,b=a.renderTo||document.body,c=document.createElement("div");a.fire("beforerender"),c.innerHTML=a.tpl.getHTML({value:a.value,height:a.height}),a.el=b.appendChild(c),a.el=Fancy.get(a.el),a.addCls(a.cls,a.fieldCls),a.acceptedValue=a.value,a.fire("afterrender"),a.fire("render")},set:function(a,b){var c=this;c.el.firstChild().update(a),!1!==b&&c.onInput()},get:function(){return this.el.firstChild().dom.innerHTML}}),Fancy.define(["Fancy.form.field.ReCaptcha","Fancy.ReCaptcha"],{type:"field.recaptcha",mixins:[Fancy.form.field.Mixin],extend:Fancy.Widget,constructor:function(a){Fancy.apply(this,a),this.Super("const",arguments)},init:function(){var a=this;a.addEvents("focus","blur","input","enter","up","down","change","key"),a.Super("init",arguments),a.tpl=new Fancy.Template(a.tpl),a.render(),a.name="recaptcha",a.hidden&&a.css("display","none"),a.style&&a.css(a.style);var b=document.createElement("script");b.type="text/javascript",b.src="https://www.google.com/recaptcha/api.js",Fancy.get(document.head).append(b)},get:function(){var a=this,b=a.el.select("form");return a.value?a.value:(a.value="wait",b.one("submit",function(b){b.preventDefault(),a.value=$(this).serialize().replace("g-recaptcha-response=","")}),b.submit(),a.value)},fieldCls:Fancy.FIELD_CLS,value:"",width:100,tpl:['<form method="POST">','<div class="g-recaptcha" data-sitekey="{key}"></div>',"</form>"]}),function(){var a=Fancy,b=a.CLEARFIX_CLS,c=a.FIELD_CLS,d=a.FIELD_RADIO_CLS,e=a.FIELD_RADIO_COLUMN_CLS,f=a.FIELD_TEXT_CLS,g=a.FIELD_RADIO_ON_CLS,h=a.FIELD_RADIO_INPUT_CLS,i=a.FIELD_LABEL_CLS,j=a.FIELD_ERROR_CLS;a.define(["Fancy.form.field.Radio","Fancy.Radio"],{mixins:[a.form.field.Mixin],extend:a.Widget,type:"field.radio",radioRows:1,constructor:function(){this.Super("const",arguments)},init:function(){var b=this;b.addEvents("focus","blur","input","up","down","change","key"),b.Super("init",arguments);var c="";b.column&&(b.cls+=" "+e,c+='<div style="margin-left: '+b.labelWidth+'px;">'),a.each(b.items,function(a,d){var e="",i=f;b.column||0===d||(e="margin-left:10px;"),a.value===b.value&&(i+=" "+g),c+=['<div class="'+i+'" value='+a.value+">",'<div class="'+h+'" style="float:left;'+e+'"></div>','<div style="float:left;margin:7px 0 0 0;">'+a.text+"</div>","</div>"].join("")}),b.column&&(c+="</div>"),b.itemsHTML=c,b.preRender(),b.render(),b.setColumnsStyle(),b.acceptedValue=b.value,b.set(b.value),b.ons()},labelText:"",labelWidth:60,value:!1,checkedCls:g,fieldCls:c+" "+d,tpl:['<div class="'+i+'" style="{labelWidth}{labelDisplay}">',"{label}",'<div class="'+j+'" style="{errorTextStyle}"></div>',"</div>","{itemsHTML}",'<div class="'+b+'"></div>'],ons:function(){var b=this,c=this.el;c.$dom.delegate("."+f,"click",function(){b.set(a.get(this).attr("value"))}),c.on("mousedown",b.onMouseDown,b)},onClick:function(){var a=this,b=a.checkedCls;a.addCls(b),a.toggleCls(b),a.value=a.hasCls(b),a.fire("change",a.value)},onMouseDown:function(a){a.preventDefault()},set:function(a,b){var c=this,d=c.el,e=c.checkedCls;d.select("."+f).removeCls(e),d.select("[value="+a+"]").addCls(e),c.value=a,!1!==b&&c.fire("change",c.value)},setValue:function(a,b){this.set(a,b)},getValue:function(){return this.value},get:function(){return this.getValue()},clear:function(){this.set(!1)},calcColumns:function(){var b=this,c=0,d=b.width;"top"!==b.labelAlign&&b.label&&(d-=b.labelWidth,d-=20),a.Array.each(b.items,function(a){a.text.length>c&&(c=a.text.length)});var e=Math.floor(d/(7*c+30));b.columns&&b.columns<=e?e=b.columns:b.columns=e,b.columnWidth=Math.ceil(d/e),b.rows=Math.ceil(b.items.length/e)},setColumnsStyle:function(){var a=this;if(a.columns&&1!==a.rows){var b=a.el.select("."+f),c=a.el.select("."+f+" ."+h);b.each(function(b,d){d%a.columns==0&&c.item(d).css("margin-left","0px"),b.css("width",a.columnWidth)})}}})}(),function(){Fancy.vtypes={},Fancy.addValid=function(a,b){Fancy.vtypes[a]=b},Fancy.isValid=function(a,b){var c;if(Fancy.isString(a)?c=Fancy.vtypes[a]:Fancy.isObject(a)&&(a.type?(c=Fancy.vtypes[a.type],Fancy.applyIf(a,c)):c=a),c.before){var d=c.before,e=[a];Fancy.isString(d)?e.push(d):Fancy.isArray(d)&&(e=e.concat(d)),e.reverse();for(var f=0,g=e.length;f<g;f++)if(c=Fancy.isObject(e[f])?e[f]:Fancy.vtypes[e[f]],c.re){if(!1===c.re.test(b))return c}else if(c.fn&&!1===c.fn.apply(c,[b]))return c}else if(c.re){if(!1===c.re.test(b))return c}else if(!1===c.fn.apply(c,[b]))return c;return!0}}(),Fancy.addValid("notempty",{text:"Must be present",fn:function(a){return null!==a&&void 0!==a&&0!==String(a).length}}),Fancy.addValid("notnan",{text:"Must be numeric",fn:function(a){return!isNaN(a)}}),Fancy.addValid("min",{before:["notempty","notnan"],text:"Must be must be at least {param}",fn:function(a){return a>=this.param}}),Fancy.addValid("max",{before:["notempty","notnan"],text:"Must be no more than {param}",fn:function(a){return a<=this.param}}),Fancy.addValid("range",{before:["notempty","notnan"],text:"Must be between {min} and {max}",fn:function(a){return a>=this.min&&a<=this.max}}),Fancy.addValid("email",{before:"notempty",re:/^(")?(?:[^\."])(?:(?:[\.])?(?:[\w\-!#$%&'*+\/=?\^_`{|}~]))*\1@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,text:"Is not a valid email address"}),Fancy.Mixin("Fancy.grid.mixin.PrepareConfig",{prepareConfig:function(a,b){var c=this;return a._plugins=a._plugins||[],a=c.copyColumns(a,b),a=c.prepareConfigScroll(a,b),a=c.prepareConfigData(a,b),a=c.prepareConfigTheme(a,b),a=c.prepareConfigLang(a,b),a=c.prepareConfigSpark(a,b),a=c.prepareConfigPaging(a,b),a=c.prepareConfigTBar(a),a=c.prepareConfigExpander(a),a=c.prepareConfigColumnMinMaxWidth(a),a=c.prepareConfigGrouping(a),a=c.prepareConfigGroupHeader(a),a=c.prepareConfigSorting(a),a=c.prepareConfigEdit(a),a=c.prepareConfigSelection(a),a=c.prepareConfigLoadMask(a,b),a=c.prepareConfigDefaults(a),a=c.prepareConfigFilter(a),a=c.prepareConfigSearch(a),a=c.prepareConfigSummary(a),a=c.prepareConfigExporter(a),a=c.prepareConfigSmartIndex(a),a=c.prepareConfigActionColumn(a),a=c.prepareConfigWidgetColumn(a),a=c.prepareConfigChart(a,b),a=c.prepareConfigCellTip(a),a=c.prepareConfigColumnsWidth(a),a=c.prepareConfigSize(a,b),a=c.prepareConfigColumns(a),a=c.prepareConfigColumnsResizer(a),a=c.prepareConfigFooter(a),a=c.prepareConfigDD(a)},copyColumns:function(a,b){return a.columns&&(a.columns=Fancy.Array.copy(a.columns,!0)),b.columns&&(b.columns=Fancy.Array.copy(b.columns)),a},prepareConfigScroll:function(a,b){return Fancy.isIE&&!1!==b.nativeScroller&&(a.nativeScroller=!0),a},prepareConfigSpark:function(a,b){var c=this;return Fancy.each(a.columns,function(b){var d=b.sparkConfig;if(d&&d.legend)switch(d.legend.type){case"tbar":case"bbar":case"buttons":var e=d.legend.type,f=b.index;a[e]=a[e]||[],a[e]=a[e].concat(c._generateLegendBar(d.title,f,d.legend.style,b))}}),a},_generateLegendBar:function(a,b,c,d){for(var e=0,f=a.length,g=[],h=this,i={length:0},j=function(b){var c,d=h;Fancy.each(h.columns,function(a,b){a.index===h.columns[b].index&&(c=b)}),(b.hasCls("fancy-legend-item-disabled")||a.length-1!==i.length)&&(b.toggleCls("fancy-legend-item-disabled"),b.hasCls("fancy-legend-item-disabled")?(i[b.index]=!0,d.disableLegend(c,b.index),i.length++):(d.enableLegend(c,b.index),delete i[b.index],i.length--))};e<f;e++){var k=b[e];Fancy.isString(d.index)&&(k=d.index+"."+e);var l={handler:j,index:k,imageColor:Fancy.COLORS[e],text:a[e]};0===e&&c&&(l.style=c),g.push(l)}return g},prepareConfigData:function(a,b){if(Fancy.isArray(a.data)&&0===a.data.length&&a.columns){var c=[];Fancy.each(a.columns,function(a){a.index&&c.push(a.index||a.key)}),a.data={fields:c,items:[]}}return a},prepareConfigLoadMask:function(a){return a._plugins.push({type:"grid.loadmask"}),a},reConfigStore:function(a){var b=this,c=b.store,d=b.getFieldsFromData(a),e="Fancy.model."+Fancy.id();Fancy.define(e,{extend:Fancy.Model,fields:d}),b.model=e,c.model=e,b.fields=d,c.fields=d,c.setModel()},prepareConfigDefaults:function(a){return a.defaults=a.defaults||{},void 0===a.defaults.type&&(a.defaults.type="string"),Fancy.each(a.defaults,function(b,c){Fancy.each(a.columns,function(b){switch(b.type){case"select":case"order":case"expand":return}void 0===b[c]&&(b[c]=a.defaults[c])})}),a},prepareConfigColumnMinMaxWidth:function(a){return Fancy.each(a.columns,function(a){void 0===a.width&&a.minWidth&&(a.width=a.minWidth)}),a},prepareConfigCellTip:function(a){return Fancy.each(a.columns,function(b){if(b.cellTip)return a._plugins.push({type:"grid.celltip"}),!0}),a},prepareConfigDD:function(a){if(a.gridToGrid){var b={type:"grid.dragdrop"};Fancy.apply(b,a.gridToGrid),a._plugins.push(b)}return a},prepareConfigColumns:function(a){for(var b=a.columns,c=[],d=[],e=0,f=b.length,g=!1;e<f;e++){var h=b[e];switch(h.draggable&&(g=!0),h.type){case"select":this.checkboxRowSelection=!0,this.multiSelect=!0,b[e].index="$selected",b[e].editable=!0;break;case"order":b[e].editable=!1,b[e].sortable=!1,b[e].cellAlign="right";break;case"checkbox":void 0===h.cellAlign&&(h.cellAlign="center");break;case"currency":void 0===h.format&&(h.format="number")}h.locked?(c.push(h),b.splice(e,1),e--,f--):h.rightLocked&&(d.push(h),b.splice(e,1),e--,f--)}return g&&a._plugins.push({type:"grid.columndrag"}),a.leftColumns=c,a.rightColumns=d,a},prepareConfigColumnsWidth:function(a){var b,c=a.columns,d=a.width,e=[],f=[],g=100,h=50,i=g,j=0,k=!1,l=!1;void 0===d&&a.renderTo&&(d=Fancy.get(a.renderTo).width()),!1!==a.flexScrollSensitive?(d-=a.bottomScrollHeight,d-=2*a.panelBorderWidth):d-=1,Fancy.each(c,function(b,c){switch(b.flex&&(a.hasFlexColumns=!0),b.type){case"select":void 0===b.width&&(b.width=35);break;case"order":void 0===b.width&&(b.width=40);break;case"expand":void 0===b.width&&(b.width=38)}b.locked&&(k=!0),b.rightLocked&&(l=!0),void 0===b.width?(b.flex&&(j+=b.flex,f.push(c)),e.push(c)):Fancy.isNumber(b.width)&&(d-=b.width)}),a.hasFlexColumns&&a._plugins.push({type:"grid.columnresizer"}),k&&l&&(d-=2);var m=d/e.length;m<h&&(m=h),m>g&&(i=g),m<h&&(i=h);var n=!1,o=d;return Fancy.each(e,function(a){b=c[a],void 0===b.flex&&(o-=i)}),j&&Fancy.each(f,function(a){o-=o/j*a.flex}),o<0&&(n=!0),Fancy.each(e,function(a){b=c[a],void 0===b.flex&&(b.width=i,d-=i)}),j&&Fancy.each(f,function(a){b=c[a],b.width=n?i*b.flex:d/j*b.flex}),a},prepareConfigActionRender:function(a){return function(b){return Fancy.each(a.items,function(a){var c=a.text||"",d=Fancy.styleToString(a.style),e=a.cls||"";b.value+=['<div class="fancy-grid-column-action-item '+e+'" style="'+d+'">',c,"</div>"].join(" ")}),b}},prepareConfigSmartIndex:function(a){return Fancy.each(a.columns,function(a){if(/\+|\-|\/|\*|\[|\./.test(a.index)){var b=a.index;switch(b){case"xAxis.categories":case"yAxis.categories":case"zAxis.categories":return}b=b.replace(/(\w+)/g,function(a,a,b,c){return"."===c[b-1]?a:isNaN(Number(a))?"data."+a:a}),b="return "+b+";",a.smartIndexFn=new Function("data",b)}}),a},prepareConfigActionColumn:function(a){for(var b=this,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];if("action"===f.type){f.sortable=!1,f.editable=!1,f.render=b.prepareConfigActionRender(f);var g=f.items;if(void 0!==g&&0!==g.length)for(var h,i=0,j=g.length;i<j;i++)switch(h=g[i],h.action){case"remove":void 0===h.handler&&(h.handler=function(a,b){a.remove(b)});break;case"dialog":!function(a){if(void 0===a.handler){for(var d=[],e=0,f=c.length,g=87;e<f;e++){var h=c[e];switch(h.type){case"action":continue}d.push({label:h.title||"",type:h.type,name:h.index}),g+=38}a.handler=function(c,e){a.dialog?(a.dialog.show(),a.dialog.set(e.data)):a.dialog=new FancyForm({window:!0,draggable:!0,modal:!0,title:{text:"Edit",tools:[{text:"Close",handler:function(){this.hide()}}]},width:300,height:g,items:d,buttons:["side",{text:"Clear",handler:function(){this.clear()}},{text:"Save",handler:function(){var a=this.get();a.id&&(b.getById(a.id).set(a),b.update())}}],events:[{init:function(){this.show(),this.set(e.data)}}]})}}}(h)}}}return a},prepareConfigWidgetColumn:function(a){for(var b=a.columns,c=0,d=b.length;c<d;c++){var e=b[c];e.widget&&(e.render=function(a){var b,c=a.cell.select("."+Fancy.FIELD_CLS),d=a.cell.dom,e=a.column,f={vtype:e.vtype,style:{padding:"0px","margin-top":"-10px","margin-left":"-1px"},label:!1,renderTo:d,value:a.value,emptyText:e.emptyText};if(c.length)b=Fancy.getWidget(c.dom.id),b.get()!=a.value&&b.set(a.value);else{var g=a.column.width,e=a.column,h=e.index;switch(a.column.type){case"number":case"currency":Fancy.apply(f,{spin:e.spin,min:e.min,max:e.max,events:[{change:function(b,c){grid.set(a.rowIndex,h,c),grid.updater.updateRow()}}]}),b=new Fancy.NumberField(f);break;case"string":case"image":Fancy.apply(f,{events:[{change:function(b,c){grid.set(a.rowIndex,h,c),grid.updater.updateRow()}}]}),b=new Fancy.StringField(f);break;case"combo":Fancy.apply(f,{displayKey:a.column.displayKey,valueKey:a.column.displayKey,padding:!1,checkValidOnTyping:!0,data:a.column.data,events:[{change:function(b,c){grid.set(a.rowIndex,h,c),grid.updater.updateRow()}}]}),b=new Fancy.Combo(f)}switch(a.column.type){case"number":case"string":case"currency":case"image":b.setInputSize({width:g+1,height:33});break;case"combo":b.size({width:g+1,height:33})}}return a})}return a},prepareConfigSorting:function(a){return(a.defaults||{}).sortable?(a._plugins.push({type:"grid.sorter"}),a):(Fancy.each(a.columns,function(b){b.sortable&&a._plugins.push({type:"grid.sorter"})}),a)},prepareConfigSelection:function(a){var b=!1,c={type:"grid.selection"};if((a.trackOver||a.columnTrackOver||a.cellTrackOver)&&(b=!0),a.selModel){b=!0;var d=!1,e=!1;if(Fancy.isObject(a.selModel)){if(d=!!a.selModel.checkOnly,!a.selModel.type)throw new Error("FancyGrid Error 5: Type for selection is not set");e=!0===a.selModel.memory,a.selModel=a.selModel.type}"rows"===a.selModel&&(a.multiSelect=!0),a.selection=a.selection||{},a.selection.selModel=a.selModel,a.selection[a.selModel]=!0,a.selection.checkOnly=d,a.selection.memory=e}return a.selection&&(b=!0,Fancy.isObject(a.selection)&&Fancy.apply(c,a.selection)),!0===b&&a._plugins.push(c),a},prepareConfigEdit:function(a){var b=a.defaults||{},c={type:"grid.edit"},d=!1,e=b.editable;return a.clicksToEdit&&(c.clicksToEdit=a.clicksToEdit),e&&(d||a._plugins.push(c),a._plugins.push({type:"grid.celledit"}),d=!0),a.rowEdit&&a._plugins.push({type:"grid.rowedit"}),Fancy.each(a.columns,function(b){switch(void 0===b.index&&void 0===b.key&&(b.editable=!1),b.type){case"image":b.sortable=!1;break;case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinediscrete":case"sparklinebullet":case"sparklinepie":case"sparklinebox":b.editable=!1,b.sortable=!1}b.editable&&!1===d&&(a._plugins.push(c),a._plugins.push({type:"grid.celledit"}))}),a},prepareConfigExpander:function(a){if(a.expander){var b=a.expander;Fancy.apply(b,{type:"grid.expander"}),a.expanded={},a.grouping&&(b.expanded=!1),a._plugins.push(b)}return a},prepareConfigGrouping:function(a){if(a.grouping){var b=a.grouping;Fancy.apply(b,{type:"grid.grouping"}),a.expanded={},a._plugins.push(b)}return a},prepareConfigSummary:function(a){if(a.summary){var b=a.summary;!0===b&&(b={}),Fancy.apply(b,{type:"grid.summary"}),a._plugins.push(b)}return a},prepareConfigExporter:function(a){if(a.exporter){var b=a.exporter;!0===b&&(b={}),Fancy.apply(b,{type:"grid.exporter"}),a._plugins.push(b)}return a},prepareConfigFilter:function(a){var b=a.columns,c=!1,d=!1,e=!1,f={type:"grid.filter"};return a.filter&&(!0===a.filter&&(c=!0,a.filter={}),Fancy.apply(f,a.filter)),Fancy.each(b,function(a){a.filter&&(c=!0,a.filter.header&&(d=!0,a.grouping&&(e=!0)))}),f.header=d,f.groupHeader=e,c&&a._plugins.push(f),a},prepareConfigSearch:function(a){var b={type:"grid.search"},c=!1;return a.searching&&(c=!0),c&&a._plugins.push(b),a},prepareConfigGroupHeader:function(a){var b=a.columns,c=0,d=b.length,e=[],f=!1,g=[];if(Fancy.each(b,function(a){a.columns&&(f=!0,e.push(a))}),f){for(c=0;c<d;c++){var h=b[c];if(h.columns){for(var i=0,j=h.columns.length,k=h.text||h.title||"  ";i<j;i++)h.locked&&(h.columns[i].locked=!0),h.rightLocked&&(h.columns[i].rightLocked=!0),h.columns[i].grouping=k,h.defaults&&Fancy.applyIf(h.columns[i],h.defaults);g=g.concat(h.columns),f=!0,e.push(h)}else g=g.concat(b.slice(c,c+1))}a.columns=g,a._plugins.push({type:"grid.groupheader",groups:e}),a.isGroupedHeader=!0}return a},prepareConfigPaging:function(a,b){var c=this,d=a.lang,e=a.paging,f="bbar";if(!e)return a;if(void 0!==e.barType)switch(e.barType){case"bbar":case"tbar":case"both":f=e.barType;break;case!1:case"none":f="none";break;default:throw new Error("[FancyGrid Error]: - not supported bar type for paging")}return a._plugins.push({i18n:b.i18n,type:"grid.paging",barType:f}),"both"===f?(a.tbar=c.generatePagingBar(e,d),a.bbar=c.generatePagingBar(e,d)):"none"===f||(a[f]=c.generatePagingBar(e,d)),a},generatePagingBar:function(a,b){var c=this,d=[],e="fancy-bar-button-disabled",f={float:"left","margin-right":"5px","margin-top":"3px"};if(d.push({imageCls:"fancy-paging-first",disabledCls:e,role:"first",handler:function(a){c.paging.firstPage()},style:{float:"left","margin-left":"5px","margin-right":"5px","margin-top":"3px"}}),d.push({imageCls:"fancy-paging-prev",disabledCls:e,role:"prev",handler:function(){c.paging.prevPage()},style:f}),d.push("|"),d.push({type:"text",text:b.paging.page}),d.push({type:"number",label:!1,padding:!1,style:{float:"left","margin-left":"-1px","margin-right":"8px","margin-top":"4px"},role:"pagenumber",min:1,width:30,listeners:[{enter:function(a){0===parseInt(a.getValue())&&a.set(1);var b=parseInt(a.getValue())-1,d=c.paging.setPage(b);b!==d&&a.set(d)}},{up:function(a,b){var d=c.store.pages;Number(b)>d&&a.set(d)}}]}),d.push({type:"text",text:"",role:"ofText"}),d.push("|"),d.push({imageCls:"fancy-paging-next",disabledCls:e,role:"next",style:f,handler:function(){c.paging.nextPage()}}),d.push({imageCls:"fancy-paging-last",disabledCls:e,role:"last",style:f,handler:function(){c.paging.lastPage()}}),Fancy.isObject(a)&&!0===a.refreshButton&&(d.push("|"),d.push({imageCls:"fancy-paging-refresh",disabledCls:e,role:"refresh",style:f,handler:function(){c.paging.refresh()}})),a&&Fancy.isArray(a.pageSizeData)){for(var g=a.pageSizeData,h=[],i=0,j=g.length,k=0;i<j;i++)h.push({index:i,value:g[i]}),a.pageSize===g[i]&&(k=i);var l=Fancy.Object.copy(f);l["margin-top"]="4px",d.push({editable:!1,width:50,type:"combo",role:"size",style:l,data:h,displayKey:"value",valueKey:"index",value:k,events:[{change:function(a,b){c.paging.setPageSize(g[b])}}]})}return d.push("side"),d.push({type:"text",role:"info",text:""}),d},prepareConfigColumnsResizer:function(a){if((a.defaults||{}).resizable)return a._plugins.push({type:"grid.columnresizer"}),a;var b=[].concat(a.columns).concat(a.leftColumns).concat(a.rightColumns);return Fancy.each(b,function(b){b.resizable&&a._plugins.push({type:"grid.columnresizer"})}),a},prepareConfigTBar:function(a){var b=this,c=a.tbar;if(c)for(var d=0,e=c.length;d<e;d++)switch("search"===c[d].type&&(a.searching=!0,a.filter=!0),c[d].action){case"add":void 0===c[d].handler&&(c[d].handler=function(){b.insert(0,{})});break;case"remove":void 0===c[d].handler&&(c[d].disabled=!0,c[d].handler=function(){Fancy.each(b.getSelection(),function(a){b.remove(a)}),b.selection.clearSelection()},c[d].events=[{render:function(){var a=this;setTimeout(function(){var b=Fancy.getWidget(a.el.parent().parent().parent().select("."+Fancy.GRID_CLS).dom.id);b.on("select",function(){0===b.getSelection().length?a.disable():a.enable()}),b.on("clearselect",function(){a.disable()})},10)}}])}return a},prepareConfigChart:function(a){var b=a.data,c=b.chart;return Fancy.isObject(c)&&(c=[c]),b&&b.chart&&(a._plugins.push({type:"grid.chartintegration",chart:c,toChart:!!b.items||!!b.proxy}),Fancy.each(c,function(b){var c=b.type;switch(c){case"highchart":case"highcharts":a._plugins.push({type:"grid.highchart"});break;case void 0:throw new Error("[FancyGrid Error] - type of chart is undefined");default:throw new Error("[FancyGrid Error] - type of chart "+c+" does not exist")}})),a},prepareConfigSize:function(a,b){var c,d=a.renderTo,e=!!(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel),f=a.panelBodyBorders,g=a.gridBorders;if(void 0===a.width)d&&(a.responsive=!0,c=Fancy.get(d),a.width=parseInt(c.width()));else if("fit"===a.width){var h=0,i=!1;Fancy.each(a.columns,function(a){h+=a.width,a.locked&&(i=!0)}),a.title||a.subTitle?h+=f[1]+f[3]+g[1]+g[3]:h+=g[1]+g[3],i&&h--,a.width=h}if("fit"===a.height){var j=0,k=1;Fancy.each(a.columns,function(a){a.grouping&&(k<2&&(k=2),a.filter&&a.filter.header&&k<3&&(k=3)),a.filter&&a.filter.header&&k<2&&(k=2)}),Fancy.isArray(a.data)?j=a.data.length:a.data&&Fancy.isArray(a.data.items)&&(j=a.data.items.length);var l=j*a.cellHeight;a.title&&(l+=a.titleHeight),(a.tbar||a.tabs)&&(l+=a.barHeight),a.bbar&&(l+=a.barHeight),a.buttons&&(l+=a.barHeight),a.subTBar&&(l+=a.barHeight),a.footer&&(l+=a.barHeight),!1!==a.header&&(l+=a.cellHeaderHeight*k),l+=e?f[0]+f[2]+g[0]+g[2]:g[0]+g[2],a.minHeight&&l<a.minHeight&&(l=a.minHeight),a.heightFit=!0,a.height=l}return a}}),Fancy.Mixin("Fancy.grid.mixin.ActionColumn",{initActionColumnHandler:function(){var a=this;a.on("cellclick",a.onCellClickColumnAction,a)},onCellClickColumnAction:function(a,b){var c,d,e=this,f=b.column,g=f.items;"action"===f.type&&(c=e.getActiveActionColumnItem(b),g&&void 0!==c&&(d=g[c],d.handler&&d.handler(e,b)))},getActiveActionColumnItem:function(a){for(var b=Fancy.get(a.cell),c=a.e.target,d=b.select("."+Fancy.GRID_COLUMN_ACTION_ITEM_CLS),e=0,f=d.length;e<f;e++)if(d.item(e).within(c))return e}}),Fancy.Mixin("Fancy.grid.mixin.Edit",{remove:function(a,b){var c=this,d=c.store,e="remove";if(!c.store)return void setTimeout(function(){c.remove(a,b)},100);if(b&&(e="removeAt"),Fancy.isArray(a))for(var f=0,g=a.length;f<g;f++)d[e](a[f]);else d[e](a);c.setSidesHeight()},removeAt:function(a){this.remove(a,!0)},removeAll:function(){var a=this;a.store.removeAll(),a.update(),a.scroller.update(),a.paging&&a.paging.updateBar(),a.grouping&&a.grouping.reGroup()},add:function(a){var b=this;if(!b.store)return void setTimeout(function(){b.add(a)},100);if(Fancy.isArray(a))for(var c=0,d=a.length;c<d;c++)b.add(a[c]);else b.store.add(a),b.setSidesHeight()},insert:function(a,b){var c=this,d=c.store;if(!c.store)return void setTimeout(function(){c.insert(a,b)},100);if(Fancy.isArray(b)){for(var e=b.length-1;-1!==e;e--)c.insert(b[e],a);return void c.setSidesHeight()}if(Fancy.isArray(a)){for(var e=a.length-1;-1!==e;e--)c.insert(a[e],0);return void c.setSidesHeight()}if(Fancy.isObject(a)&&void 0===b)b=a,a=0;else if(Fancy.isObject(a)&&Fancy.isNumber(b)){var f=b;b=a,a=f}c.paging&&"server"!==d.proxyType&&(a+=d.showPage*d.pageSize),d.insert(a,b),c.setSidesHeight()},set:function(a,b,c){var d=this,e=d.store;if(!d.store)return void setTimeout(function(){d.set(a,b,c)},100);Fancy.isObject(b)&&void 0===c?e.setItemData(a,b,c):e.set(a,b,c)},setById:function(a,b,c){var d=this,e=d.store,f=e.getRow(a);if(void 0===f){if(void 0===e.getById(a))return!1;f=-1}if(!d.store)return setTimeout(function(){-1===f?d.setById(f,b,c):d.set(f,b,c)},100),f;if(Fancy.isObject(b)&&void 0===c)for(var g in b){var h=d.getColumnByIndex(g);if(h&&"date"===h.type){var i=h.format,j=Fancy.Date.parse(b[g],i.read,i.mode),k=Fancy.Date.parse(e.getById(a).get(g),i.edit,i.mode);+j==+k&&delete b[g]}e.setItemData(f,b,c,a),-1===f&&e.getById(a).set(b)}else e.set(f,b,c,a),-1===f&&e.getById(a).set(b,c);return f}}),function(){var a=Fancy,b=a.TOUCH_CLS,c=a.HIDDEN_CLS,d=a.GRID_CENTER_CLS,e=a.GRID_LEFT_CLS,f=a.GRID_RIGHT_CLS,g=a.GRID_HEADER_CLS,h=a.GRID_BODY_CLS,i=a.PANEL_BODY_INNER_CLS,j=a.GRID_UNSELECTABLE_CLS,k=a.GRID_LEFT_EMPTY_CLS,l=a.GRID_RIGHT_EMPTY_CLS;a.Mixin("Fancy.grid.mixin.Grid",{tpl:['<div class="'+e+" "+k+'"></div>','<div class="'+d+'"></div>','<div class="'+f+" "+l+'"></div>','<div class="fancy-grid-editors"></div>'],initStore:function(){var b,c,d,e=this,f=e.getFieldsFromData(e.data),g="Fancy.model."+a.id(),h=e.data,i=!1,j=e.state;e.data.items&&(h=e.data.items),b=e.data.remoteSort,c=e.data.remoteFilter,d=e.data.remotePage,a.define(g,{extend:a.Model,fields:f}),e.grouping&&void 0!==e.grouping.collapsed&&(i=e.grouping.collapsed);var k={widget:e,model:g,data:h,paging:e.paging,remoteSort:b,remoteFilter:c,pageType:d,collapsed:i,multiSort:e.multiSort};j&&j.filters&&(k.filters=j.filters),h.pageSize&&(k.pageSize=h.pageSize),e.store=new a.Store(k),e.model=g,e.fields=f,e.store.filters&&setTimeout(function(){e.filter.filters=e.store.filters,e.filter.updateStoreFilters()},1)},initTouch:function(){var c=this;a.isTouch&&window.FastClick&&(c.panel?(FastClick.attach(c.panel.el.dom),c.panel.addCls(b)):(FastClick.attach(c.el.dom),c.addCls(b)))},initElements:function(){var b=this;!1!==b.header&&(b.leftHeader=new a.grid.Header({widget:b,side:"left"}),b.header=new a.grid.Header({widget:b,side:"center"}),b.rightHeader=new a.grid.Header({widget:b,side:"right"})),b.leftBody=new a.grid.Body({widget:b,side:"left"}),b.body=new a.grid.Body({widget:b,side:"center"}),b.rightBody=new a.grid.Body({widget:b,side:"right"}),b.leftEl=b.el.select("."+e),b.centerEl=b.el.select("."+d),b.rightEl=b.el.select("."+f)},getFieldsFromData:function(a){var b=a.items||a;if(a.fields)return a.fields;if(!b)throw new Error("FancyGrid Error 4: Data is empty and not set fields of data to build model");var c=b[0],d=[];for(var e in c)d.push(e);return d},render:function(){var b=this,c=b.renderTo||document.body,d=a.get(document.createElement("div")),e=b.panelBodyBorders;d.addCls(a.cls,b.widgetCls,b.cls),d.attr("id",b.id),void 0===b.panel&&b.shadow&&d.addCls("fancy-panel-shadow"),!1===b.columnLines&&d.addCls("fancy-grid-disable-column-lines"),"default"===b.theme||b.panel||d.addCls("fancy-theme-"+b.theme);var f=0;b.panel&&(f=e[1]+e[3]),d.css({width:b.width-f+"px",height:b.height-0+"px"}),b.initTpl(),d.update(b.tpl.getHTML({})),b.el=a.get(a.get(c).dom.appendChild(d.dom)),b.setHardBordersWidth(),b.rendered=!0},setHardBordersWidth:function(){var a=this,b=a.panel?a.gridBorders:a.gridWithoutPanelBorders;a.wrapped&&(b=a.gridBorders),a.css({"border-top-width":b[0],"border-right-width":b[1],"border-bottom-width":b[2],"border-left-width":b[3]})},update:function(){var a=this;a.store.loading||(a.updater.update(),a.fire("update"),a.heightFit&&a.fitHeight(),a.setBodysHeight())},getColumnsWidth:function(a){var b=this;switch(a){case"center":return b.getCenterFullWidth();case"left":return b.getLeftFullWidth();case"right":return b.getRightFullWidth()}},setSides:function(){var a=this,b=a.leftColumns,c=a.rightColumns,i=a.getLeftFullWidth(),j=a.getCenterFullWidth(),m=a.getRightFullWidth(),n=a.gridBorders,o=a.panelBodyBorders,p=a.gridWithoutPanelBorders;b.length>0&&a.leftEl.removeCls(k),c.length>0&&a.rightEl.removeCls(l),j=a.wrapped?a.width-n[1]-n[3]:a.panel?a.width-n[1]-n[3]-o[1]-o[3]:a.width-p[1]-p[3],0===i&&0===m||(0===m?j-=i:0===i?j-=m:a.width>i+j+m?j-=i:j-=i+m),a.leftEl.css({width:i+"px"}),a.centerEl.css({left:i+"px",width:j+"px"}),a.header&&(a.el.select("."+e+" ."+g).css({width:i+"px"}),a.el.select("."+d+" ."+g).css({width:j+"px"})),a.el.select("."+d+" ."+h).css({width:j+"px"}),a.width>i+j+m?a.rightEl.css({right:"0px"}):a.rightEl.css({left:"",right:"0px"}),a.rightEl.css({width:m}),a.header&&a.el.select("."+f+" ."+g).css({width:m+"px"}),a.startWidths={center:j,left:i,right:m}},setColumnsPosition:function(){var a=this;a.body.setColumnsPosition(),a.leftBody.setColumnsPosition(),a.rightBody.setColumnsPosition()},setSidesHeight:function(){var a=this,b=a.store,c=1,d=a.cellHeaderHeight;!1!==a.header&&(c+=d,a.filter&&a.filter.header&&(a.groupheader?a.filter.groupHeader&&(c+=d):c+=d),a.groupheader&&(a.filter&&a.filter.header,c+=d)),a.grouping&&(c+=a.grouping.groups.length*a.groupRowHeight),a.expander&&(c+=a.expander.plusHeight),a.summary&&(c+=a.summary.topOffSet),c+=b.getLength()*a.cellHeight-1,a.paging&&a.summary&&"bottom"===a.summary.position&&(c=a.height),a.leftEl.css({height:c+"px"}),a.centerEl.css({height:c+"px"}),a.rightEl.css({height:c+"px"})},setBodysHeight:function(){var a=this;a.body.setHeight(),a.leftBody.setHeight(),a.rightBody.setHeight()},preRender:function(){var a=this;(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel)&&a.renderPanel()},renderPanel:function(){var b=this,c={renderTo:b.renderTo,title:b.title,subTitle:b.subTitle,width:b.width,height:b.height,titleHeight:b.titleHeight,subTitleHeight:b.subTitleHeight,barHeight:b.barHeight,theme:b.theme,shadow:b.shadow,style:b.style||{},window:b.window,modal:b.modal,frame:b.frame,items:[b],draggable:b.draggable,resizable:b.resizable,minWidth:b.minWidth,minHeight:b.minHeight,panelBodyBorders:b.panelBodyBorders,barContainer:b.barContainer,barScrollEnabled:b.barScrollEnabled},d=b.panelBodyBorders;b.bbar&&(c.bbar=b.bbar,b.height-=b.barHeight),b.tbar&&(c.tbar=b.tbar,b.height-=b.barHeight),b.subTBar&&(c.subTBar=b.subTBar,b.height-=b.barHeight),b.buttons&&(c.buttons=b.buttons,b.height-=b.barHeight),b.footer&&(c.footer=b.footer,b.height-=b.barHeight),b.panel=new a.Panel(c),b.bbar=b.panel.bbar,b.tbar=b.panel.tbar,b.subTBar=b.panel.subTBar,b.buttons=b.panel.buttons,b.wrapped||b.panel.addCls("fancy-panel-grid-inside"),b.title&&(b.height-=b.titleHeight),b.subTitle&&(b.height-=b.subTitleHeight,b.height+=d[2]),b.height-=d[0]+d[2],b.renderTo=b.panel.el.select("."+i).dom},getBodyHeight:function(){var a=this,b=a.height,c=1,d=a.gridBorders,e=a.gridWithoutPanelBorders;return a.groupheader&&(c=2),a.filter&&a.filter.header&&(a.groupheader?a.filter.groupHeader&&c++:c++),!1!==a.header&&(b-=a.cellHeaderHeight*c),a.panel?b-=d[0]+d[2]:b-=e[0]+e[2],a.summary&&(b-=a.summary.topOffSet,b-=a.summary.bottomOffSet),b},ons:function(){var b=this,c=b.store,d=a.get(document);c.on("change",b.onChangeStore,b),c.on("set",b.onSetStore,b),c.on("remove",b.onRemoveStore,b),c.on("beforesort",b.onBeforeSortStore,b),c.on("sort",b.onSortStore,b),c.on("beforeload",b.onBeforeLoadStore,b),c.on("load",b.onLoadStore,b),d.on("mouseup",b.onDocMouseUp,b),d.on("click",b.onDocClick,b),d.on("mousemove",b.onDocMove,b),c.on("servererror",b.onServerError,b),c.on("serversuccess",b.onServerSuccess,b),b.responsive&&a.$(window).bind("resize",function(){b.onWindowResize()}),b.on("activate",b.onActivate,b),b.on("deactivate",b.onDeActivate,b)},onServerError:function(a,b,c,d){this.fire("servererror",b,c,d)},onServerSuccess:function(a,b,c){this.fire("serversuccess",b,c)},onChangeStore:function(){this.update()},onBeforeLoadStore:function(a){this.fire("beforeload")},onRemoveStore:function(a,b,c){this.fire("remove",b,c)},onLoadStore:function(a){this.fire("load")},onSetStore:function(a,b){this.fire("set",b)},onBeforeSortStore:function(a,b){this.fire("beforesort",b)},onSortStore:function(a,b){this.fire("sort",b)},getCellsViewHeight:function(){var a=this,b=a.store,d=0,e=0;return a.grouping&&(d+=a.grouping.plusScroll),a.expander&&(d+=a.expander.plusScroll),!a.scroller.scrollBottomEl||a.scroller.scrollBottomEl.hasCls(c)||(e=a.scroller.cornerSize),a.cellHeight*b.dataView.length+e+d},onDocMouseUp:function(a){this.fire("docmouseup")},onDocClick:function(a){this.fire("docclick",a)},onDocMove:function(a){this.fire("docmove",a)},getCenterViewWidth:function(){var a=this,b=a.centerEl.width();if(0===b){for(var c=0,d=a.columns,e=0,f=d.length;e<f;e++){var g=d[e];g.hidden||(c+=g.width)}return c}return b},getCenterFullWidth:function(){for(var a=this,b=0,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getLeftFullWidth:function(){for(var a=this,b=0,c=a.leftColumns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getRightFullWidth:function(){for(var a=this,b=0,c=a.rightColumns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getColumns:function(a){var b,c=this;switch(a){case"left":b=c.leftColumns;break;case"center":b=c.columns;break;case"right":b=c.rightColumns}return b},setColumns:function(a,b){var c=this;switch(b){case"left":c.leftColumns=a;break;case"center":case void 0:c.columns=a;break;case"right":c.rightColumns=a}},getBody:function(a){var b,c=this;switch(a){case"left":b=c.leftBody;break;case"center":b=c.body;break;case"right":b=c.rightBody}return b},getHeader:function(a){var b,c=this;switch(a){case"left":b=c.leftHeader;break;case"center":b=c.header;break;case"right":b=c.rightHeader}return b},getDomRow:function(a){for(var b=this,c=b.leftBody,d=b.body,e=b.rightBody,f=b.leftColumns,g=b.columns,h=b.rightColumns,i=0,j=f.length,k=[];i<j;i++)k.push(c.getDomCell(a,i));for(i=0,j=g.length;i<j;i++)k.push(d.getDomCell(a,i));for(i=0,j=h.length;i<j;i++)k.push(e.getDomCell(a,i));return k},initTextSelection:function(){var b=this,c=b.body,d=b.leftBody,e=b.rightBody;if(!1===b.textSelection){b.addCls(j);var f=function(b){var c=a.get(b.target);c.hasCls("fancy-field-text-input")||c.hasCls("fancy-textarea-text-input")||b.preventDefault()};c.el.on("mousedown",f),d.el.on("mousedown",f),e.el.on("mousedown",f)}},setTrackOver:function(a,b){var c=this;switch(a){case"cell":c.cellTrackOver=b;break;case"column":c.columnTrackOver=b;break;case"row":c.trackOver=b}},setSelModel:function(a){var b=this,c=b.selection;c.cell=!1,c.cells=!1,c.row=!1,c.rows=!1,c.column=!1,c.columns=!1,c[a]=!0,b.multiSelect="rows"===a,c.clearSelection()},getSelection:function(a){return this.selection.getSelection(a)},clearSelection:function(){this.selection.clearSelection()},destroy:function(){var b=this,c=a.get(document);c.un("mouseup",b.onDocMouseUp,b),c.un("click",b.onDocClick,b),c.un("mousemove",b.onDocMove,b),b.body.destroy(),b.leftBody.destroy(),b.rightBody.destroy(),b.header.destroy(),b.leftHeader.destroy(),b.rightHeader.destroy(),b.scroller.destroy(),b.el.destroy(),b.panel&&b.panel.el.destroy()},showAt:function(){var a=this;a.panel&&a.panel.showAt.apply(a.panel,arguments)},show:function(){var a=this;a.panel?a.panel.show.apply(a.panel,arguments):a.el.show()},hide:function(){var a=this;a.panel?a.panel.hide.apply(a.panel,arguments):a.el.hide()},initDateColumn:function(){var b=this,c=function(c){for(var d=0,e=c.length;d<e;d++){var f=c[d];if("date"===f.type){f.format=f.format||{};var g={type:"date"};a.applyIf(g,b.lang.date),a.applyIf(f.format,g)}}return c};b.columns=c(b.columns),b.leftColumns=c(b.leftColumns),b.rightColumns=c(b.rightColumns)},stopEditor:function(){this.edit.stopEditor()},getById:function(a){return this.store.getById(a)},get:function(a,b){var c=this,d=c.store;return void 0!==b?d.get(a,b):void 0===a?d.get():d.getItem(a)},getTotal:function(){return this.store.getTotal()},getViewTotal:function(){return this.store.getLength()},getDataView:function(){return this.store.getDataView()},getData:function(){return this.store.getData()},selectRow:function(a){this.selection.selectRow(a)},selectColumn:function(a){var b,c,d=this,e=d.leftColumns||[],f=d.columns||[],g=d.rightColumns||[],h=function(b){for(var d=0,e=b.length;d<e;d++){var f=b[d];if(f.index===a||f.key===a)return c=d,!0}return!1};h(e)?b="left":h(f)?b="center":h(g)&&(b="right"),b&&d.selection.selectColumns(c,b)},getColumnByIndex:function(a){for(var b=this,c=b.leftColumns||[],d=b.columns||[],e=b.rightColumns||[],f=c.concat(d).concat(e),g=0,h=f.length;g<h;g++){var i=f[g];if(i.index===a||i.key===a)return i}},load:function(){this.store.loadData()},save:function(){this.store.save()},onWindowResize:function(){var b,c=this,d=c.renderTo;c.panel&&(d=c.panel.renderTo,b=a.get(d),c.setWidth(parseInt(b.width()))),c.setBodysHeight()},setWidth:function(a){var b=this,c=b.el,e=b.gridBorders,f=b.gridWithoutPanelBorders,g=b.panelBodyBorders,h=b.body,i=b.header;b.scroller.scroll(0,0);var j,k=function(a){for(var b=0,c=a.length,d=0;b<c;b++){a[b].hidden||(d+=a[b].width)}return d},l=k(b.leftColumns),m=k(b.rightColumns),n=a-l-m-g[1]-g[3];b.wrapped?(j=a,n=a-l-m,n-=e[1]+e[3],b.css({width:j})):b.panel?(n=a-l-m-g[1]-g[3],b.panel.el.width(a),n-=e[1]+e[3],j=a-g[1]-g[3],b.css({width:j})):(n=a-l-m-f[1]-f[3],c.css("width",a)),n<100&&(n=100),c.select("."+d).css("width",n),i.css("width",n),h.css("width",n),b.hasFlexColumns&&(b.reCalcColumnsWidth(),b.columnresizer.updateColumnsWidth()),b.scroller.setScrollBars()},getWidth:function(){var a=this;return a.panel?parseInt(a.panel.css("width")):parseInt(a.css("width"))},getHeight:function(){var a=this;return a.panel?parseInt(a.panel.css("height")):parseInt(a.css("height"))},setHeight:function(a,b){var c=this,d=c.gridBorders,e=c.panelBodyBorders;c.panel&&!1!==b&&c.panel.setHeight(a),c.title&&(a-=c.titleHeight),c.subTitle&&(a-=c.subTitleHeight),c.footer&&(a-=c.barHeight),c.bbar&&(a-=c.barHeight),c.tbar&&(a-=c.barHeight),c.subTBar&&(a-=c.barHeight),c.buttons&&(a-=c.barHeight);var f=a;c.header&&(f-=c.cellHeaderHeight,c.groupheader&&(f-=c.cellHeaderHeight)),c.panel&&(f-=e[0]+e[2]),f-=d[0]+d[2],c.body&&c.body.css("height",f),c.leftBody&&c.leftBody.css("height",f),c.rightBody&&c.rightBody.css("height",f),c.el.css("height",a),c.height=a,c.scroller.update()},find:function(a,b){return this.store.find(a,b)},findItem:function(a,b){return this.store.findItem(a,b)},each:function(a,b){this.store.each(a,b)},onActivate:function(){var b=this,c=a.get(document);setTimeout(function(){c.on("click",b.onDeactivateClick,b)},100)},onDeActivate:function(){var b=this,c=a.get(document);b.activated=!1,c.un("click",b.onDeactivateClick,b)},onDeactivateClick:function(b){for(var c=this,d=0,e=20,f=a.get(b.target);d<e;d++){if(!f.dom)return;if(!f.dom.tagName||"body"===f.dom.tagName.toLocaleLowerCase())return void c.fire("deactivate");if(f.hasCls(c.widgetCls))return;f=f.parent()}},search:function(a,b){this.searching.search(a,b)},stopSelection:function(){var a=this;a.selection&&a.selection.stopSelection()},enableSelection:function(a){var b=this;b.selection&&b.selection.enableSelection(a)},hideColumn:function(a,b){for(var c,d,e=this,f=e.getBody(a),g=e.getHeader(a),h=e.getColumns(a),i=0,j=h.length,k=e.centerEl,l=e.leftEl,m=e.leftHeader,n=e.rightEl,o=e.rightHeader;i<j;i++)if(d=h[i],d.index===b){c=i,d.hidden=!0;break}switch(g.hideCell(c),f.hideColumn(c),e.rowedit&&e.rowedit.hideField(c,a),a){case"left":l.css("width",parseInt(l.css("width"))-d.width),m.css("width",parseInt(m.css("width"))-d.width),k.css("left",parseInt(k.css("left"))-d.width),k.css("width",parseInt(k.css("width"))+d.width),e.body.css("width",parseInt(e.body.css("width"))+d.width),e.header.css("width",parseInt(e.header.css("width"))+d.width);break;case"right":n.css("width",parseInt(n.css("width"))-d.width),o.css("width",parseInt(o.css("width"))-d.width),k.css("width",parseInt(k.css("width"))+d.width),e.body.css("width",parseInt(e.body.css("width"))+d.width),e.header.css("width",parseInt(e.header.css("width"))+d.width)}e.grouping&&e.grouping.updateGroupRows()},showColumn:function(a,b){for(var c,d,e=this,f=e.getBody(a),g=e.getHeader(a),h=e.getColumns(a),i=0,j=h.length,k=e.centerEl,l=e.leftEl,m=e.leftHeader,n=e.rightEl,o=e.rightHeader;i<j;i++)if(d=h[i],d.index===b){c=i,d.hidden=!1;break}switch(g.showCell(c),f.showColumn(c),e.rowedit&&e.rowedit.showField(c,a),a){case"left":l.css("width",parseInt(l.css("width"))+d.width),m.css("width",parseInt(m.css("width"))+d.width),k.css("left",parseInt(k.css("left"))+d.width),k.css("width",parseInt(k.css("width"))-d.width),e.body.css("width",parseInt(e.body.css("width"))-d.width),e.header.css("width",parseInt(e.header.css("width"))-d.width);break;case"right":n.css("width",parseInt(n.css("width"))+d.width),o.css("width",parseInt(o.css("width"))+d.width),k.css("width",parseInt(k.css("width"))-d.width),e.body.css("width",parseInt(e.body.css("width"))-d.width),e.header.css("width",parseInt(e.header.css("width"))-d.width)}e.grouping&&e.grouping.updateGroupRows()},removeColumn:function(a,b){var c,d=this,e=d.leftEl,f=d.leftHeader,g=d.leftBody,h=d.centerEl,i=d.body,j=d.header,k=d.rightEl,l=d.rightBody,m=d.rightHeader;switch(b){case"left":c=d.leftColumns[a],d.leftColumns.splice(a,1),f.removeCell(a),f.reSetIndexes(),g.removeColumn(a),e.css("width",parseInt(e.css("width"))-c.width),h.css("left",parseInt(h.css("left"))-c.width),h.css("width",parseInt(h.css("width"))+c.width),i.css("width",parseInt(i.css("width"))+c.width),j.css("width",parseInt(j.css("width"))+c.width);break;case"center":c=d.columns[a],d.columns.splice(a,1),j.removeCell(a),j.reSetIndexes(),i.removeColumn(a);break;case"right":c=d.rightColumns[a],d.rightColumns.splice(a,1),m.removeCell(a),m.reSetIndexes(),l.removeColumn(a),k.css("right",parseInt(k.css("right"))-c.width),h.css("width",parseInt(h.css("width"))+c.width),j.css("width",parseInt(j.css("width"))+c.width),i.css("width",parseInt(i.css("width"))+c.width)}return c.grouping&&delete c.grouping,d.summary&&d.summary.removeColumn(a,b),c},insertColumn:function(a,b,c,d){var e=this,f=e.leftEl,g=e.leftBody,h=e.leftHeader,i=e.centerEl,j=e.body,k=e.header,l=e.rightEl,m=e.rightBody,n=e.rightHeader;switch(c=c||"center"){case"center":e.columns.splice(b,0,a),k.insertCell(b,a),k.reSetIndexes(),j.insertColumn(b,a);break;case"left":e.leftColumns.splice(b,0,a),h.insertCell(b,a),h.reSetIndexes(),g.insertColumn(b,a),f.css("width",parseInt(f.css("width"))+a.width),i.css("width",parseInt(i.css("width"))-a.width),i.css("left",parseInt(i.css("left"))+a.width),j.el.css("width",parseInt(j.el.css("width"))-a.width),k.el.css("width",parseInt(k.el.css("width"))-a.width);break;case"right":e.rightColumns.splice(b,0,a),n.insertCell(b,a),n.reSetIndexes(),m.insertColumn(b,a),l.css("width",parseInt(l.css("width"))+a.width),i.css("width",parseInt(i.css("width"))-a.width),j.css("width",parseInt(j.css("width"))-a.width),k.css("width",parseInt(k.css("width"))-a.width)}a.menu&&(a.menu=!0),e.grouping&&(e.grouping.updateGroupRows(),e.grouping.setCellsPosition(b,c)),a.rowEditor&&("left"===c&&b--,e.rowedit.moveEditor(a,b,c,d)),e.summary&&e.summary.insertColumn(b,c),e.header.destroyMenus(),e.leftHeader.destroyMenus(),e.rightHeader.destroyMenus()},disableLegend:function(a,b){var c=this;c.columns[a].disabled=c.columns[a].disabled||{},c.columns[a].disabled[b]=!0,c.body.updateRows(void 0,a)},enableLegend:function(a,b){var c=this;c.columns[a].disabled=c.columns[a].disabled||{},delete c.columns[a].disabled[b],c.body.updateRows(void 0,a)},fitHeight:function(){var a=this,b=a.store,c=a.panelBodyBorders,d=a.gridBorders,e=b.getLength()*a.cellHeight,f=1,g=a.columns.concat(a.leftColumns||[]).concat(a.rightColumns||[]);Fancy.each(g,function(a){a.grouping&&(f<2&&(f=2),a.filter&&a.filter.header&&f<3&&(f=3)),a.filter&&a.filter.header&&f<2&&(f=2)}),a.title&&(e+=a.titleHeight),a.tbar&&(e+=a.barHeight),a.bbar&&(e+=a.barHeight),a.buttons&&(e+=a.barHeight),a.subTBar&&(e+=a.barHeight),a.footer&&(e+=a.barHeight),!1!==a.header&&(e+=a.cellHeaderHeight*f),a.grouping&&(e+=a.grouping.groups.length*a.groupRowHeight),a.panel?e+=c[0]+c[2]+d[0]+d[2]:e+=d[0]+d[2],a.setHeight(e)},addFilter:function(b,c,d){var e=this,f=e.filter.filters[b],d=d||"";if(void 0===f&&(f={}),a.isDate(c)){var g=this.getColumnByIndex(b).format;f.type="date",f.format=g,c=Number(c)}""===c?delete f[d]:f[d]=c,e.filter.filters[b]=f,e.filter.updateStoreFilters(),e.filter.addValuesInColumnFields(b,c,d)},clearFilter:function(a,b){var c=this,d=c.store;void 0===a?(c.filter.filters={},d.filters={}):void 0===b?(c.filter.filters[a]={},d.filters[a]={}):c.filter&&c.filter.filters&&c.filter.filters[a]&&c.filter.filters[a][b]&&(delete c.filter.filters[a][b],delete d.filters[a][b]),d.changeDataView(),c.update(),c.filter&&c.filter.clearColumnsFields(a,b)},showLoadMask:function(a){this.loadmask.showLoadMask(a)},hideLoadMask:function(){this.loadmask.hideLoadMask()},prevPage:function(){this.paging.prevPage()},nextPage:function(){this.paging.nextPage()},setPage:function(a){a--,a<0&&(a=0),this.paging.setPage(a)},firstPage:function(){this.paging.firstPage()},lastPage:function(){this.paging.lastPage()},setPageSize:function(a){this.paging.setPageSize(a)},getPage:function(){return this.store.showPage+1},getPages:function(){return this.store.pages},getPageSize:function(){return this.store.pageSize},refresh:function(){this.paging.refresh()},scroll:function(a,b){var c=this,d=c.scroller;d.scroll(a,b),d.scrollBottomKnob(),d.scrollRightKnob()},getDataFiltered:function(){return this.store.filteredData},reCalcColumnsWidth:function(){var a=this;if(a.hasFlexColumns){var b,c=a.scroller,d=a.getCenterViewWidth(),e=a.columns,f=0,g=0,h=e.length,i=d;for(!1!==a.flexScrollSensitive&&c.isRightScrollable()&&!c.nativeScroller&&(i-=a.bottomScrollHeight);g<h;g++){var j=e[g];j.flex?f+=j.flex:i-=j.width}if(0!==f)for(b=i/f,g=0;g<h;g++){var j=e[g];j.flex&&(j.width=Math.floor(j.flex*b),j.minWidth&&j.width<j.minWidth?j.width=j.minWidth:j.width<a.minColumnWidth&&(j.width=a.minColumnWidth))}}},getDisplayedData:function(){for(var b=this,c=b.getViewTotal(),d=[],e=0,f=b.leftColumns,g=b.columns,h=b.rightColumns;e<c;e++){var i=[];a.each(f,function(a){void 0!==a.index&&i.push(b.get(e,a.index))}),a.each(g,function(a){void 0!==a.index&&i.push(b.get(e,a.index))}),a.each(h,function(a){void 0!==a.index&&i.push(b.get(e,a.index))}),d.push(i)}return d},exportToExcel:function(){var a=this;a.exporter&&a.exporter.exportToExcel()}})}(),Fancy.define(["Fancy.Grid","FancyGrid"],{extend:Fancy.Widget,mixins:["Fancy.grid.mixin.Grid",Fancy.panel.mixin.PrepareConfig,Fancy.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn",Fancy.grid.mixin.Edit],plugins:[{type:"grid.updater"},{type:"grid.scroller"},{type:"grid.licence"}],type:"grid",theme:"default",i18n:"en",emptyText:"",prefix:"fancy-grid-",cls:"",widgetCls:Fancy.GRID_CLS,header:!0,shadow:!0,striped:!0,columnLines:!0,textSelection:!1,width:200,height:200,minWidth:200,minHeight:200,minColumnWidth:30,emptyValue:"&nbsp;",frame:!0,keyNavigation:!1,draggable:!1,activated:!1,multiSort:!1,tabEdit:!0,dirtyEnabled:!0,barScrollEnabled:!0,constructor:function(a){var b=this,a=a||{},c=function(c){c&&Fancy.apply(a,c),a=b.prepareConfig(a,b),Fancy.applyConfig(b,a),b.Super("const",arguments)},d=function(){var d=a.i18n||b.i18n;!0===Fancy.loadLang(d,c)&&c({})};Fancy.modules.grid||Fancy.fullBuilt||!1===Fancy.MODULELOAD||!1===Fancy.MODULESLOAD?d():Fancy.loadModule("grid",function(){d()})},init:function(){var a=this;if(a.initId(),a.addEvents("beforerender","afterrender","render","show","hide","destroy"),a.addEvents("headercellclick","headercellmousemove","headercellmousedown","docmouseup","docclick","docmove","init","columnresize","columnclick","columndblclick","columnenter","columnleave","columnmousedown","cellclick","celldblclick","cellenter","cellleave","cellmousedown","beforecellmousedown","rowclick","rowdblclick","rowenter","rowleave","rowtrackenter","rowtrackleave","columndrag","scroll","nativescroll","remove","set","update","beforesort","sort","beforeload","load","servererror","serversuccess","select","clearselect","activate","deactivate","beforeedit","startedit","changepage","dropitems","collapse","expand","lockcolumn","rightlockcolumn","unlockcolumn","filter"),!0!==Fancy.fullBuilt&&!1!==Fancy.MODULELOAD&&!1!==Fancy.MODULESLOAD&&!0!==a.fullBuilt&&!0!==a.neededModules&&"datepicker"!==a.wtype&&"monthpicker"!==a.wtype)return void a.loadModules();a.initStore(),a.initPlugins(),a.ons(),a.initDateColumn(),a.fire("beforerender"),a.preRender(),a.render(),a.initElements(),a.initActionColumnHandler(),a.fire("render"),a.fire("afterrender"),a.setSides(),a.setSidesHeight(),a.setColumnsPosition(),a.update(),a.initTextSelection(),a.initTouch(),setTimeout(function(){a.inited=!0,a.fire("init"),a.setBodysHeight()},1)},loadModules:function(){var a=this,b={},c=a.columns||[],d=a.leftColumns||[],e=a.rightColumns||[];Fancy.modules=Fancy.modules||{},Fancy.nojQuery&&(b.dom=!0),Fancy.isTouch&&(b.touch=!0),a.summary&&(b.summary=!0),a.exporter&&(b.exporter=!0,b.excel=!0),a.paging&&(b.paging=!0),(a.filter||a.searching)&&(b.filter=!0),a.data&&a.data.proxy&&(b.edit=!0),a.clicksToEdit&&(b.edit=!0),Fancy.isObject(a.data)&&(a.data.proxy&&(b["server-data"]=!0,Fancy.nojQuery&&(b.ajax=!0)),a.data.chart&&(b["chart-integration"]=!0)),a.expander&&(b.expander=!0),a.isGroupedHeader&&(b["grouped-header"]=!0),a.grouping&&(b.grouping=!0),a.summary&&(b.summary=!0),a.exporter&&(b.exporter=!0,b.excel=!0),(a.trackOver||a.columnTrackOver||a.cellTrackOver||a.selection)&&(b.selection=!0);var f=c.concat(d).concat(e);Fancy.each(f,function(c){switch(!0===c.draggable&&(b["column-drag"]=!0),!0===c.sortable&&(b.sort=!0),!0===c.editable&&(b.edit=!0),!0===c.menu&&(b.menu=!0),c.filter&&(b.filter=!0),c.type){case"select":a.checkboxRowSelection=!0,b.selection=!0;break;case"combo":c.data&&c.data.proxy&&(b.ajax=!0);break;case"progressbar":case"progressdonut":case"grossloss":case"hbar":b.spark=!0;break;case"date":b.date=!0,b.selection=!0}}),Fancy.isArray(a.tbar)&&Fancy.each(a.tbar,function(a){switch(a.action){case"add":case"remove":b.edit=!0}}),a.gridToGrid&&(b.dd=!0),a.neededModules={length:0};for(var g in b)void 0===Fancy.modules[g]&&(a.neededModules[g]=!0,a.neededModules.length++);if(0===a.neededModules.length)return a.neededModules=!0,void a.init();var h=function(b){delete a.neededModules[b],0===--a.neededModules.length&&(a.neededModules=!0,a.init())};for(var g in a.neededModules)"length"!==g&&Fancy.loadModule(g,h)},lockColumn:function(a,b){var c=this;if(1===c.columns.length)return!1;var d=c.removeColumn(a,b);c.insertColumn(d,c.leftColumns.length,"left"),c.fire("lockcolumn")},rightLockColumn:function(a,b){var c=this;if(1===c.columns.length)return!1;var d=c.removeColumn(a,b);c.insertColumn(d,0,"right"),c.fire("rightlockcolumn")},unLockColumn:function(a,b){var c,d=this;switch(b){case"left":c=d.removeColumn(a,b),d.insertColumn(c,0,"center","left");break;case"right":c=d.removeColumn(a,b),d.insertColumn(c,d.columns.length,"center","right")}"left"===b&&d.grouping&&0===d.leftColumns.length&&d.grouping.insertGroupEls(),d.fire("unlockcolumn")},moveColumn:function(a,b,c,d,e){var f,g=this;if(e){for(var h=0,i=e.end-e.start+1,j=e.cell.attr("index"),k=g.getHeader(b),l=e.cell.dom.outerHTML;h<i;h++)g.moveColumn(a,b,e.end-h,d);var m=g.getColumns(b),n=k.el.select("."+Fancy.GRID_HEADER_CELL_CLS);for(h=d,i=h+(e.end-e.start+1);h<i;h++){var o=m[h],p=n.item(h);o.grouping=j,p.attr("group-index",j)}return k.el.append(l),void k.fixGroupHeaderSizing()}if("center"===a)switch(f=g.removeColumn(c,"center"),b){case"left":g.insertColumn(f,d,"left","center");break;case"right":g.insertColumn(f,d,"right","center")}else if("left"===a)switch(f=g.removeColumn(c,"left"),b){case"center":g.insertColumn(f,d,"center","left");break;case"right":g.insertColumn(f,d,"right","left")}else if("right"===a)switch(f=g.removeColumn(c,"right"),b){case"center":g.insertColumn(f,d,"center","right");break;case"left":g.insertColumn(f,d,"left","right")}g.groupheader&&(g.header.fixGroupHeaderSizing(),g.leftColumns&&g.leftHeader.fixGroupHeaderSizing(),g.rightColumns&&g.rightHeader.fixGroupHeaderSizing())}}),FancyGrid.get=function(a){var b=Fancy.get(a).select("."+Fancy.GRID_CLS).dom.id;return Fancy.getWidget(b)},FancyGrid.defineTheme=Fancy.defineTheme,FancyGrid.defineController=Fancy.defineController,FancyGrid.addValid=Fancy.addValid,!Fancy.nojQuery&&Fancy.$&&(Fancy.$.fn.FancyGrid=function(a){return a.renderTo=$(this.selector)[0].id,new Fancy.Grid(a)}),Fancy.define("Fancy.grid.plugin.Updater",{extend:Fancy.Plugin,ptype:"grid.updater",inWidgetName:"updater",constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){},update:function(){var a=this.widget;a.leftBody.update(),a.body.update(),a.rightBody.update()},updateRow:function(a){var b=this.widget;b.leftBody.updateRows(a),b.body.updateRows(a),b.rightBody.updateRows(a)}}),function(){var a=Fancy,b="fancy-scroll-right-inner",c="fancy-scroll-bottom-inner",d="fancy-scroll-right-hover",e="fancy-scroll-bottom-hover",f="fancy-scroll-right-active",g="fancy-scroll-bottom-active",h=a.HIDDEN_CLS,i=a.GRID_COLUMN_CLS,j=a.GRID_CENTER_CLS;a.define("Fancy.grid.plugin.Scroller",{extend:a.Plugin,ptype:"grid.scroller",inWidgetName:"scroller",rightKnobDown:!1,bottomKnobDown:!1,minRightKnobHeight:35,minBottomKnobWidth:35,cornerSize:12,scrollLeft:0,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var b=this,c=b.widget,d=a.getMouseWheelEventName();c.once("render",function(){b.render(),c.leftBody.el.on(d,b.onMouseWheel,b),c.nativeScroller&&(c.leftBody.el.on(d,b.onMouseWheelLeft,b),c.rightBody.el.on(d,b.onMouseWheelRight,b)),c.body.el.on(d,b.onMouseWheel,b),c.rightBody.el.on(d,b.onMouseWheel,b),c.once("init",b.onGridInit,b),c.nativeScroller&&(c.body.el.on("scroll",b.onNativeScrollBody,b),c.leftBody.el.on("scroll",b.onNativeScrollLeftBody,b),c.rightBody.el.on("scroll",b.onNativeScrollRightBody,b))}),b.on("render",b.onRender,b),c.store.on("change",b.onChangeStore,b)},destroy:function(){var b=this,c=b.widget,d=c.leftBody,e=c.body,f=c.rightBody,g=a.get(document),h=a.getMouseWheelEventName();g.un("mouseup",b.onMouseUpDoc,b),g.un("mousemove",b.onMouseMoveDoc,b),d.el.un(h,b.onMouseWheel,b),e.el.un(h,b.onMouseWheel,b),f.el.un(h,b.onMouseWheel,b),b.scrollBottomEl.un("mousedown",b.onMouseDownBottomSpin,b),b.scrollRightEl.un("mousedown",b.onMouseDownRightSpin,b),a.isTouch&&(d.el.un("touchstart",b.onBodyTouchStart,b),d.el.un("touchmove",b.onBodyTouchMove,b),e.el.un("touchstart",b.onBodyTouchStart,b),e.el.un("touchmove",b.onBodyTouchMove,b),f.el.un("touchstart",b.onBodyTouchStart,b),f.el.un("touchmove",b.onBodyTouchMove,b),g.un("touchend",b.onMouseUpDoc,b))},onGridInit:function(){var b=this,c=b.widget,d=a.get(document);b.setScrollBars(),d.on("mouseup",b.onMouseUpDoc,b),d.on("mousemove",b.onMouseMoveDoc,b),c.on("columnresize",b.onColumnResize,b),c.on("lockcolumn",b.onLockColumn,b),c.on("rightlockcolumn",b.onRightLockColumn,b),c.on("unlockcolumn",b.onUnLockColumn,b),setTimeout(function(){b.update()},1)},render:function(){var d=this,e=d.widget,f=e.body,g=a.get(document.createElement("div")),i=a.get(document.createElement("div"));e.nativeScroller?e.el.addCls("fancy-grid-native-scroller"):(g.addCls("fancy-scroll-right"),i.addCls("fancy-scroll-bottom",h),g.update(['<div class="'+b+'"></div>'].join(" ")),g.select("."+b).css("margin-top",e.knobOffSet),i.update(['<div class="'+c+'"></div>'].join(" ")),a.get(f.el.append(g.dom)),d.scrollRightEl=f.el.select(".fancy-scroll-right"),a.get(f.el.append(i.dom)),d.scrollBottomEl=f.el.select(".fancy-scroll-bottom")),d.fire("render")},onMouseWheel:function(b){var c=this,d=c.widget,e=a.getWheelDelta(b.originalEvent||b);0!=c.isRightScrollable()&&(d.stopProp&&b.stopPropagation(),d.nativeScroller||(c.scrollDelta(e)&&b.preventDefault(),c.scrollRightKnob()))},onRender:function(){var b=this;!0!==b.widget.nativeScroller&&(b.scrollRightEl.hover(function(){!0!==b.bottomKnobDown&&b.scrollRightEl.addCls(d)},function(){b.scrollRightEl.removeCls(d)}),b.scrollBottomEl.hover(function(){!0!==b.rightKnobDown&&b.scrollBottomEl.addCls(e)},function(){b.scrollBottomEl.removeCls(e)}),b.initRightScroll(),b.initBottomScroll()),a.isTouch&&b.initTouch()},initTouch:function(){var b=this,c=b.widget,d=c.leftBody,e=c.body,f=c.rightBody,g=a.get(document);d.el.on("touchstart",b.onBodyTouchStart,b),d.el.on("touchmove",b.onBodyTouchMove,b),e.el.on("touchstart",b.onBodyTouchStart,b),e.el.on("touchmove",b.onBodyTouchMove,b),f.el.on("touchstart",b.onBodyTouchStart,b),f.el.on("touchmove",b.onBodyTouchMove,b),g.on("touchend",b.onMouseUpDoc,b)},onBodyTouchStart:function(a){var b=this,a=a.originalEvent||a,c=a.changedTouches[0];b.rightKnobDown=!0,b.bottomKnobDown=!0,b.mouseDownXY={x:c.pageX,y:c.pageY},b.rightKnobTop=parseInt(b.rightKnob.css("margin-top")),b.scrollRightEl.addCls(f),b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addCls(g)},onBodyTouchEnd:function(){this.onMouseUpDoc()},onBodyTouchMove:function(a){var b=this,a=a.originalEvent,c=a.changedTouches[0];!0===b.rightKnobDown&&a.preventDefault(),!0===b.bottomKnobDown&&a.preventDefault(),b.onMouseMoveDoc({pageX:c.pageX,pageY:c.pageY})},initRightScroll:function(){var a=this;a.rightKnob=a.scrollRightEl.select("."+b),a.scrollRightEl.on("mousedown",a.onMouseDownRightSpin,a)},initBottomScroll:function(){var a=this;a.bottomKnob=a.scrollBottomEl.select("."+c),a.scrollBottomEl.on("mousedown",a.onMouseDownBottomSpin,a)},onMouseDownRightSpin:function(b){var c=this;a.isTouch||(b.preventDefault(),c.rightKnobDown=!0,c.mouseDownXY={x:b.pageX,y:b.pageY},c.rightKnobTop=parseInt(c.rightKnob.css("margin-top")),c.scrollRightEl.addCls(f))},onMouseDownBottomSpin:function(a){var b=this;a.preventDefault(),b.bottomKnobDown=!0,b.mouseDownXY={x:a.pageX,y:a.pageY},b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addCls(g)},onMouseUpDoc:function(){var a=this;!1===a.rightKnobDown&&!1===a.bottomKnobDown||(a.scrollRightEl.removeCls(f),a.scrollBottomEl.removeCls(g),a.rightKnobDown=!1,a.bottomKnobDown=!1)},onMouseMoveDoc:function(b){var c,d,e,f,g=this,h=g.widget,i=!1,j=!1,k=h.knobOffSet,l=b.pageX,m=b.pageY;g.rightKnobDown&&(a.isTouch?(d=g.mouseDownXY.y-m,e=d+g.rightKnobTop):(d=m-g.mouseDownXY.y,e=d+g.rightKnobTop),e<g.knobOffSet&&(e=g.knobOffSet),g.bodyViewHeight<e+g.rightKnobHeight&&(e=g.bodyViewHeight-g.rightKnobHeight),e<g.rightScrollScale&&(e=0),g.rightKnob.css("margin-top",e+k+"px"),i=g.rightScrollScale*e,g.scroll(i)),g.bottomKnobDown&&(a.isTouch?(c=g.mouseDownXY.x-l,d=g.mouseDownXY.y-m,f=c+g.bottomKnobLeft):(c=l-g.mouseDownXY.x,d=m-g.mouseDownXY.y,f=c+g.bottomKnobLeft),f<1&&(f=1),g.bodyViewWidth-2<f+g.bottomKnobWidth&&(f=g.bodyViewWidth-g.bottomKnobWidth-2),g.bottomScrollScale<0&&f<0&&(f=0,g.bottomScrollScale=0),g.bottomKnob.css("margin-left",f+"px"),j=Math.ceil(g.bottomScrollScale*(f-1)),g.scroll(!1,j))},setScrollBars:function(){var a=this,b=a.widget;setTimeout(function(){a.checkRightScroll()},1),a.checkBottomScroll()||a.scrollTop&&b.scroll(!1,0),b.nativeScroller||(a.checkCorner(),a.setRightKnobSize(),a.setBottomKnobSize())},checkRightScroll:function(){var a=this,b=a.widget,c=b.body,d=b.gridBorders,e=b.getBodyHeight(),f=b.getCellsViewHeight()-d[0]-d[2];b.nativeScroller?e>=f?c.el.css("overflow-y","hidden"):c.el.css("overflow-y","scroll"):e>=f?a.scrollRightEl.addCls(h):a.scrollRightEl.removeCls(h)},isRightScrollable:function(){var a=this.widget;return a.nativeScroller?"scroll"===a.body.el.css("overflow-y"):!this.scrollRightEl.hasCls(h)},setRightKnobSize:function(){var b=this,c=b.widget;if(!c.nativeScroller){var d=c.getBodyHeight()-(b.corner?b.cornerSize:0)-2,e=c.getCellsViewHeight()-(b.corner?b.cornerSize:0),f=e-d,g=100-f/(d/100),h=d*(g/100),i=c.knobOffSet;h<b.minRightKnobHeight&&(h=b.minRightKnobHeight),!1===b.corner&&(d-=i),b.rightKnob.animate({height:h},a.ANIMATE_DURATION),b.rightKnobHeight=h,b.bodyViewHeight=d,b.rightScrollScale=(e-d)/(d-h)}},checkBottomScroll:function(){var a,b=this,c=b.widget,d=c.body,e=c.getCenterViewWidth(),f=c.getCenterFullWidth()-2;return c.nativeScroller?e>f?(a=!1,d.el.css("overflow-x","hidden")):(a=!0,d.el.css("overflow-x","scroll")):e>f?(a=!1,b.scrollBottomEl.addCls(h)):(a=!0,b.scrollBottomEl.removeCls(h)),a},checkCorner:function(){var a=this;a.widget.nativeScroller||(a.corner=!a.scrollRightEl.hasCls(h)&&!a.scrollBottomEl.hasCls(h))},setBottomKnobSize:function(){var b=this,c=b.widget;if(!c.nativeScroller){var d=c.getCenterViewWidth()-(b.corner?b.cornerSize:0),e=c.getCenterFullWidth()-(b.corner?b.cornerSize:0),f=e-d,g=100-f/(e/100),h=d*(g/100)-2;h<b.minBottomKnobWidth&&(h=b.minBottomKnobWidth),b.bottomKnob.animate({width:h},a.ANIMATE_DURATION),b.bottomKnobWidth=h,b.bodyViewWidth=d,b.bottomScrollScale=(d-e)/(d-h-2-1)}},scroll:function(a,b){var c,d=this,e=d.widget;if(e.nativeScroller)return null!==a&&void 0!==a&&(e.body.el.dom.scrollTop=a),null!==b&&void 0!==b&&(e.body.el.dom.scrollLeft=b,e.header&&e.header.scroll(b)),void e.fire("scroll");e.leftBody.scroll(a),c=e.body.scroll(a,b),e.rightBody.scroll(a),void 0!==c.scrollTop&&(d.scrollTop=Math.abs(c.scrollTop)),void 0!==c.scrollLeft&&(d.scrollLeft=Math.abs(c.scrollLeft)),e.fire("scroll")},scrollDelta:function(a){var b,c=this,d=c.widget;return d.leftBody.wheelScroll(a),b=d.body.wheelScroll(a),d.rightBody.wheelScroll(a),c.scrollTop=Math.abs(b.newScroll),d.fire("scroll"),b.scrolled},scrollRightKnob:function(){var a=this,b=a.widget,c=a.getScroll(),d=c/a.rightScrollScale+b.knobOffSet;a.rightKnob&&a.rightKnob.css("margin-top",d+"px")},scrollBottomKnob:function(){var a=this,b=a.widget,c=a.getBottomScroll(),d=c/a.bottomScrollScale+b.knobOffSet;0===c&&(d=-1),a.bottomKnob&&a.bottomKnob.css("margin-left",-d+"px")},getScroll:function(){return Math.abs(parseInt(this.widget.body.el.select("."+i).item(0).css("top")))},getBottomScroll:function(){return Math.abs(parseInt(this.widget.body.el.select("."+i).item(0).css("left")))},update:function(){this.setScrollBars(),this.checkScroll()},onChangeStore:function(){this.update()},onColumnResize:function(){this.setScrollBars()},checkScroll:function(){var a=this,b=a.widget,c=a.getScroll(),d=b.getBodyHeight()-(a.corner?a.cornerSize:0),e=b.getCellsViewHeight()-(a.corner?a.cornerSize:0);c&&e<d&&(a.scroll(0),b.nativeScroller||a.scrollRightKnob())},scrollToCell:function(b){var c=this,d=c.widget,e=d.cellHeight,f=a.get(b),g=f.parent(),h=Number(f.attr("index")),i=Number(g.attr("index")),k=c.getScroll(),l=e*(h+1),m=d.getBodyHeight(),n=c.getBottomScroll(),o=parseInt(d.body.el.css("width")),p=0,q=g.parent().parent().hasCls(j);if(!d.nativeScroller){if(0===h&&0===i)return c.scroll(0,0),c.scrollBottomKnob(),void c.scrollRightKnob();if(l-k>m&&(k+=e,c.scroll(k)),q){for(var r=d.columns,s=0;s<=i;s++)p+=r[s].width;p-n>o?r[s]?c.scroll(k,-(n+r[s-1].width)):c.scroll(k,-(p-n-o)):0!==n&&0===i&&c.scroll(k,0),c.scrollBottomKnob()}c.scrollRightKnob()}},onNativeScrollBody:function(){var a=this,b=a.widget,c=b.body.el.dom.scrollTop,d=b.body.el.dom.scrollLeft;b.header&&b.header.scroll(-d),b.leftBody&&(b.leftBody.el.dom.scrollTop=c),b.rightBody&&(b.rightBody.el.dom.scrollTop=c),b.leftColumns.length&&b.leftBody.el.dom.scrollTop!==b.body.el.dom.scrollTop?b.body.el.dom.scrollTop=b.leftBody.el.dom.scrollTop:b.rightColumns.length&&b.rightBody.el.dom.scrollTop!==b.body.el.dom.scrollTop&&(b.body.el.dom.scrollTop=b.rightBody.el.dom.scrollTop),b.fire("nativescroll")},onNativeScrollLeftBody:function(){var a=this.widget;a.leftBody.el.dom.scrollTop!==a.body.el.dom.scrollTop&&this.onNativeScrollBody()},onNativeScrollRightBody:function(){var a=this.widget;a.rightBody.el.dom.scrollTop!==a.body.el.dom.scrollTop&&this.onNativeScrollBody()},onMouseWheelLeft:function(b){var c=this.widget,d=a.getWheelDelta(b.originalEvent||b),e=d*c.cellHeight;c.leftBody.el.dom.scrollTop-=e,c.body.el.dom.scrollTop-=e,c.rightBody.el.dom.scrollTop-=e},onMouseWheelRight:function(b){var c=this.widget,d=a.getWheelDelta(b.originalEvent||b),e=d*c.cellHeight;c.leftBody.el.dom.scrollTop-=e,c.body.el.dom.scrollTop-=e,c.rightBody.el.dom.scrollTop-=e},onLockColumn:function(){this.update(),this.widget.setColumnsPosition()},onRightLockColumn:function(){this.update(),this.widget.setColumnsPosition()},onUnLockColumn:function(){this.update(),this.widget.setColumnsPosition()}})}(),function(){var a=Fancy,b=a.GRID_COLUMN_SORT_ASC,c=a.GRID_COLUMN_SORT_DESC,d=a.GRID_COLUMN_RESIZER_CLS,e=a.FIELD_CLS,f=a.GRID_CENTER_CLS,g=a.GRID_LEFT_CLS,h=a.GRID_RIGHT_CLS;a.define("Fancy.grid.plugin.Sorter",{extend:a.Plugin,ptype:"grid.sorter",inWidgetName:"sorter",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("render",function(){a.onsHeaders()})},onsHeaders:function(){var a=this;a.widget.on("headercellclick",a.onHeaderCellClick,a)},onHeaderCellClick:function(f,g){var h,i,j,k,l=this,m=l.widget,n=a.get(g.cell),o=g.side,p=g.index,q=g.e,r=q.target;if("input"!==r.tagName.toLocaleLowerCase()){var s=n.select("."+e);s.length>0&&!0===s.item(0).within(r)||n.hasCls(d)||m.startResizing||(i=m.getColumns(o),h=n.hasCls(b)?"desc":(n.hasCls(c),"asc"),j=i[p],k=j.index||j.key,l.sort(h,k,o,j,n))}},sort:function(d,e,f,g,h){var i,j=this,k=j.widget,l=k.store,m=k.getColumns(f),n=0,o=m.length,p=k.getHeader(f);if(!g||!h)for(;n<o;n++)if(m[n].index===e){g=m[n],h=p.getCell(n);break}if(!0===g.sortable){switch(k.multiSort?j.clearHeaderMultiSortCls(d,h):j.clearHeaderSortCls(),d){case"asc":h.addCls(b);break;case"desc":h.addCls(c)}i=g.type;var q,r;if(g.format)if(a.isString(g.format))switch(g.format){case"date":q=k.lang.date.read,g.format.mode&&(r=g.format.mode)}else switch(g.type){case"date":q=g.format.read,g.format.mode&&(r=g.format.mode)}k.grouping&&l.remoteSort&&l.once("load",function(){k.grouping.reGroup()}),l.sort(d,i,e,{smartIndexFn:g.smartIndexFn,format:q,mode:r})}},clearHeaderMultiSortCls:function(a,d){var e,i,j=this,k=j.widget,l=k.store;switch(a.toLocaleUpperCase()){case"ASC":d.removeCls(c);break;case"DESC":d.removeCls(b)}if(e=k.el.select("."+b),i=k.el.select("."+c),!(e.length+i.length<3)){for(var m,n=0,o=e.length;n<o;n++){var p,q,r,s=e.item(n),t=s.parent().parent(),u=s.attr("index");t.hasCls(f)?p="center":t.hasCls(g)?p="left":t.hasCls(h)&&(p="right"),q=k.getColumns(p),r=q[u].index;var v=l.sorters[0];v.key===r&&(m=s)}for(var n=0,o=i.length;n<o;n++){var p,q,r,s=i.item(n),t=s.parent().parent(),u=s.attr("index");t.hasCls(f)?p="center":t.hasCls(g)?p="left":t.hasCls(h)&&(p="right"),q=k.getColumns(p),r=q[u].index;var v=l.sorters[0];v.key===r&&(m=s)}m.removeCls(b),m.removeCls(c)}},clearHeaderSortCls:function(){var a=this.widget.el;a.select("."+b).removeCls(b),a.select("."+c).removeCls(c)}})}(),Fancy.define("Fancy.grid.plugin.Paging",{extend:Fancy.Plugin,ptype:"grid.paging",inWidgetName:"paging",barType:"bbar",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget,c=b.store;c.on("change",a.onChangeStore,a),c.on("remove",a.onChangeStore,a),c.on("filter",a.onChangeStore,a),b.on("render",a.onRenderGrid,a),b.on("docmove",a.onDocMouseMove,a)},setPageSize:function(a){this.widget.store.setPageSize(a)},nextPage:function(){this.widget.store.nextPage()},lastPage:function(){this.widget.store.lastPage()},prevPage:function(){this.widget.store.prevPage()},firstPage:function(){this.widget.store.firstPage()},onChangeStore:function(a){var b,c=this,d=c.widget,e=d.store,f=d.panel;switch(c.barType){case"both":b=f._bbar.roles.pagenumber,b.setValue(e.showPage+1),b=f._tbar.roles.pagenumber,b.setValue(e.showPage+1),c.updateBar("tbar"),c.updateBar("bbar");break;case"none":case!1:break;default:b=f["_"+c.barType].roles.pagenumber,b.setValue(e.showPage+1),c.updateBar()}d.setSidesHeight(),d.fire("changepage")},setPage:function(a){var b=this,c=b.widget,d=c.store;return a<0?a=0:a>d.pages&&(a=d.pages),d.setPage(a),a},refresh:function(){var a=this,b=a.widget,c=b.store;b.showLoadMask(),setTimeout(function(){c.refresh(),"server"!==c.pageType&&b.hideLoadMask()},200)},updateBar:function(a){var b=this,c=b.widget,d=c.store,e=d.showPage,f=d.pageSize,g=d.pages,h=c.panel,a=a||b.barType,i=h["_"+a].roles,j=i.pagenumber,k=i.ofText,l=i.info,m=i.first,n=i.prev,o=i.next,p=i.last,q=e*f+1,r=q+f,s=d.getTotal()||0,t=c.lang;r>s&&(r=s),0===r&&(q=0),j.setValue(d.showPage+1),k.el.update(Fancy.String.format(t.paging.of,[g||1])),l.el.update(Fancy.String.format(t.paging.info,[q,r,s])),0===e?(m.disable(),n.disable()):(m.enable(),n.enable()),g-1===e||0===g?(p.disable(),o.disable()):(p.enable(),o.enable())},onRenderGrid:function(){var a=this;switch(a.barType){case"both":a.updateBar("tbar"),a.updateBar("bbar");break;case"none":case!1:break;default:a.updateBar()}},onDocMouseMove:function(){var a=this,b=a.widget;"none"===b.el.css("display")||b.panel&&b.panel.el&&"none"===b.panel.el.css("display")?a.wasHidden||(Fancy.combo.Manager.hideLists(),a.wasHidden=!0):a.wasHidden=!1}}),Fancy.define("Fancy.grid.plugin.LoadMask",{extend:Fancy.Plugin,ptype:"grid.loadmask",inWidgetName:"loadmask",cls:"fancy-loadmask",innerCls:"fancy-loadmask-inner",imageCls:"fancy-loadmask-image",textCls:"fancy-loadmask-text",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.render(),c.loading&&a.onBeforeLoad(),b.on("beforeload",a.onBeforeLoad,a),b.on("load",a.onLoad,a)})},render:function(){var a,b,c=this,d=c.widget,e=d.el,f=e,g=Fancy.get(document.createElement("div")),h=d.lang;d.panel&&(f=d.panel.el),a=f.width(),b=f.height(),g.addCls(c.cls),"default"!==d.theme&&g.addCls("fancy-theme-"+d.theme),g.css({width:a,height:b,opacity:0}),g.update(['<div class="'+c.innerCls+'"><div class="'+c.imageCls+'"></div><div class="'+c.textCls+'">'+h.loadingText+"</div></div>"].join(" ")),c.el=Fancy.get(f.dom.appendChild(g.dom)),c.innerEl=c.el.select("."+c.innerCls),c.textEl=c.el.select("."+c.textCls);var i=c.innerEl.width(),j=c.innerEl.height();c.innerEl.css({left:a/2-i/2,top:b/2-j/2}),!0!==d.store.loading?g.css("display","none"):(g.css("display","block"),c.showLoadMask()),g.css("opacity",1)},onBeforeLoad:function(){this.showLoadMask()},onLoad:function(){this.hideLoadMask()},showLoadMask:function(a){var b=this,c=b.widget,d=c.lang;if(a)return b.textEl.update(a),void b.el.css("display","block");b.loaded=!1,setTimeout(function(){!0!==b.loaded&&(b.textEl.update(d.loadingText),b.el.css("display","block"))},50)},hideLoadMask:function(){this.loaded=!0,this.el.css("display","none")}}),function(){var a=Fancy,b=a.get,c=a.FIELD_CLS,d=a.GRID_RESIZER_LEFT_CLS,e=a.GRID_RESIZER_RIGHT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_CLS,i=a.GRID_COLUMN_RESIZER_CLS,j=a.GRID_COLUMN_CLS,k=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,l=a.GRID_STATE_RESIZE_COLUMN_CLS,m=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.ColumnResizer",{extend:a.Plugin,ptype:"grid.columnresizer",inWidgetName:"columnresizer",constructor:function(a){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.render(),a.ons()})},ons:function(){var a=this,b=a.widget;b.on("headercellmousemove",a.onCellMouseMove,a),b.on("headercellmousedown",a.onHeaderCellMouseDown,a),b.on("docclick",a.onDocClick,a),b.on("docmove",a.onDocMove,a),b.on("docmouseup",a.onDocMouseUp,a)},onCellMouseMove:function(a,d){var e=this,h=e.widget,i=d.e,j=b(d.cell),k=i.offsetX,l=j.width(),m=b(i.target),n=m.hasCls(f),o=m.hasCls(g),p=j.select("."+f).item(0),q=j.select("."+g).item(0),r=b(i.target).closest("."+c).hasCls(c),s=parseInt(p.css("width")),t=parseInt(q.css("width")),u=l,v=7;if(n&&(u=s),o&&(u=t),!h.startResizing)if("left"===d.side&&d.index===h.leftColumns.length-1&&u-k<v+2&&(v+=2),!n&&!o&&"right"===d.side&&0===d.index&&k<v)e.isColumnResizable(d)&&(r||e.addCellResizeCls(d.cell));else if(!n&&!o&&k<v&&"center"===d.side&&0===d.index&&h.leftColumns.length)d.side="left",d.index=h.leftColumns.length-1,e.isColumnResizable(d)&&(r||e.addCellResizeCls(d.cell));else if(n||o||!(u-k<v||k<v)||0===d.index)u-k<v?o?t-k>2?e.removeCellResizeCls(d.cell):e.addCellResizeCls(d.cell):e.isColumnResizable(d)&&e.addCellResizeCls(d.cell):e.removeCellResizeCls(d.cell);else{var w=k<v;e.isColumnResizable(d,w)&&(r||e.addCellResizeCls(d.cell))}},addCellResizeCls:function(a){var c=this,d=c.widget,e=d.columndrag;e&&"dragging"===e.status||(b(a).addCls(i),b(a).select("."+f).addCls(i))},removeCellResizeCls:function(a){b(a).removeClass(i),b(a).select("."+f).item(0).removeClass(i)},onHeaderCellMouseDown:function(d,e){var h=this,i=h.widget,d=e.e,j=b(d.target),k=b(e.cell),l=d.offsetX,m=k.width(),n=k.select("."+c),o=j.hasCls(f),p=j.hasCls(g),q=k.select("."+f).item(0),r=k.select("."+g).item(0),s=parseInt(q.css("width")),t=parseInt(r.css("width")),u=m,v=7;if(o&&(u=s),p)return void(u=t);n.length>0&&n.item(0).within(j.dom)||("left"===e.side&&e.index===i.leftColumns.length-1&&u-l<v+2&&(v+=2),!o&&!p&&"right"===e.side&&0===e.index&&l<v?(i.startResizing=!0,a.apply(h,{cell:e.cell,activeSide:e.side,clientX:d.clientX,columnIndex:e.index,moveLeftResizer:!0})):l<7&&"center"===e.side&&0===e.index&&i.leftColumns.length?(i.startResizing=!0,e.side="left",e.index=i.leftColumns.length-1,a.apply(h,{cell:h.getCell(e),activeSide:e.side,clientX:d.clientX,columnIndex:e.index})):!o&&!p&&l<v&&0!==e.index?(i.startResizing=!0,a.apply(h,{cell:h.getPrevCell(e),activeSide:e.side,clientX:d.clientX,columnIndex:e.index-1})):u-l<v&&(i.startResizing=!0,a.apply(h,{cell:e.cell,activeSide:e.side,clientX:d.clientX,columnIndex:e.index})),i.startResizing&&h.isColumnResizable())},isColumnResizable:function(a,b){var c,d,e,f=this,g=f.widget;if(a){if(c=g.getColumns(a.side),e=a.index,b&&e--,isNaN(e))return;return d=c[e],!0===d.resizable}c=g.getColumns(f.activeSide),!0!==c[f.columnIndex].resizable&&(g.startResizing=!1,delete f.cell,delete f.activeSide,delete f.clientX,delete f.columnIndex)},getMinColumnWidth:function(){var a,b,c=this,d=c.widget,e=d.minCellWidth;return void 0===c.columnIndex?e:(a=d.getColumns(c.activeSide),b=a[c.columnIndex],b.minWidth?b.minWidth:e)},getMaxColumnWidth:function(){var a,b,c=this,d=c.widget;return void 0!==c.columnIndex&&(a=d.getColumns(c.activeSide),b=a[c.columnIndex],!!b.maxWidth&&b.maxWidth)},onDocClick:function(){this.widget.startResizing=!1},onDocMove:function(a,b){this.widget.startResizing&&this.moveResizeEls(b)},render:function(){var a=this,c=a.widget,f=b(document.createElement("div")),g=b(document.createElement("div"));f.addCls(d),g.addCls(e),a.leftEl=b(c.el.dom.appendChild(f.dom)),a.rightEl=b(c.el.dom.appendChild(g.dom))},moveResizeEls:function(c){var d=this,e=d.widget,f=b(d.cell),g=parseInt(f.css("left")),h=d.getMinColumnWidth(),i=d.getMaxColumnWidth();switch(e.header.hideMenu&&(e.header.hideMenu(),e.el.addCls(l),a.get(document.body).addCls(l)),d.activeSide){case"left":break;case"center":g+=parseInt(e.leftEl.css("width"));break;case"right":g+=parseInt(e.leftEl.css("width")),g+=parseInt(e.centerEl.css("width"))}var j=c.clientX,k=j-d.clientX,m=f.width()+k;m<h&&(m=h),i&&m>i&&(m=i),d.deltaWidth=f.width()-m,d.moveLeftResizer?(k=j-d.clientX,m=f.width()-k,m<h&&(m=h),d.deltaWidth=f.width()-m,d.leftEl.css({display:"block",left:g+k+"px"}),d.rightEl.css({display:"block",left:g+f.width()-1+"px"})):(d.leftEl.css({display:"block",left:g+"px"}),d.rightEl.css({display:"block",left:g+m+"px"})),d.cellWidth=m},onDocMouseUp:function(){var b=this,c=b.widget;!1!==c.startResizing&&(c.el.removeCls(l),a.get(document.body).removeCls(l),b.leftEl.css({display:"none"}),b.rightEl.css({display:"none"}),b.fixSidesWidth(),c.startResizing=!1,b.moveLeftResizer=!1,delete b.cellWidth)},fixSidesWidth:function(){var c,d,e,f,g=this,i=g.widget,l=g.cellWidth,n=g.columnIndex,o=g.deltaWidth,p=i.leftEl,q=i.centerEl,r=i.rightEl,s=i.leftHeader.el,t=i.header.el,u=i.rightHeader.el,v=i.body.el,w={},x={},y=g.minCenterWidth;if(void 0!==l){var z=1;switch(a.nojQuery&&(z=0),g.activeSide){case"left":if((f=parseInt(q.css("width"))+o+z)<y)return;e=i.leftColumns[n],i.leftColumns[g.columnIndex].width=l,c=i.leftBody.el.select("."+j),d=i.leftHeader.el.select("."+h),c.item(n).animate({width:l},m);for(var A=g.columnIndex+1,B=d.length,C=0,D=A;C<D;C++){var E=d.item(C),F=E.attr("group-index");F&&(x[F]=!0)}for(;A<B;A++){var G=c.item(A),E=d.item(A);G.animate({left:parseInt(G.css("left"))-o-z},m),E.hasCls(k)&&x[E.attr("index")]||E.animate({left:parseInt(E.css("left"))-o-z},m)}p.animate({width:parseInt(p.css("width"))-o-z},m),s.animate({width:parseInt(s.css("width"))-o-z+"px"},m),i.columns.length&&(q.animate({left:parseInt(q.css("left"))-o-z,width:f},m),t.animate({width:parseInt(t.css("width"))+o+z},m),v.animate({width:parseInt(v.css("width"))+o+z},m));break;case"center":e=i.columns[n],i.columns[g.columnIndex].width=l,c=i.body.el.select("."+j),d=i.header.el.select("."+h),c.item(n).animate({width:l},m);for(var A=g.columnIndex+1,B=d.length,C=0,D=A;C<D;C++){var E=d.item(C),F=E.attr("group-index");F&&(x[F]=!0)}for(;A<B;A++){var G=c.item(A),E=d.item(A),H=parseInt(G.css("left"))-o-z,I=parseInt(E.css("left"))-o-z;E.attr("group-index")&&(w[E.attr("group-index")]={}),G.animate({left:H},m),E.hasCls(k)&&x[E.attr("index")]||E.animate({left:I},m)}break;case"right":if((f=parseInt(q.css("width"))+o+z)<y)return;e=i.rightColumns[n],i.rightColumns[g.columnIndex].width=l,c=i.rightBody.el.select("."+j),d=i.rightHeader.el.select("."+h),c.item(n).animate({width:l+"px"},m);for(var A=g.columnIndex+1,B=d.length,C=0,D=A;C<D;C++){var E=d.item(C),F=E.attr("group-index");F&&(x[F]=!0)}for(;A<B;A++){var G=c.item(A),E=d.item(A);G.animate({left:parseInt(G.css("left"))-o-z},m),E.hasCls(k)&&x[E.attr("index")]||E.animate({left:parseInt(E.css("left"))-o-z},m)}r.animate({width:parseInt(r.css("width"))-o-z},m),u.animate({width:parseInt(u.css("width"))-o-z+"px"},m),i.columns.length&&(q.animate({width:f},m),t.animate({width:parseInt(t.css("width"))+o+z},m),v.animate({width:parseInt(v.css("width"))+o+z},m))}var J,K=b(g.cell),L=K.attr("group-index");if(K.animate({width:l+"px"},m),L)J=i.el.select("[index='"+L+"']"),J.animate({width:parseInt(J.css("width"))-o-z},m);else for(var M in w)J=i.el.select("[index='"+M+"']"),J.css("left",parseInt(J.css("left"))-(w[M].delta||0)-z);if(i.fire("columnresize",{cell:K.dom,width:l}),/sparkline/.test(e.type))switch(g.activeSide){case"left":i.leftBody.updateRows(void 0,n);break;case"center":i.body.updateRows(void 0,n);break;case"right":i.rightBody.updateRows(void 0,n)}}},getPrevCell:function(a){var b,c=this,d=c.widget;switch(a.side){case"left":b=d.leftHeader;break;case"center":b=d.header;break;case"right":b=d.rightHeader}return b.el.select("."+h).item(a.index-1).dom},getCell:function(a){var b,c=this,d=c.widget;switch(a.side){case"left":b=d.leftHeader;break;case"center":b=d.header;break;case"right":b=d.rightHeader}return b.el.select("."+h).item(a.index).dom},updateColumnsWidth:function(a){for(var b=this,c=b.widget,a=a||"center",d=c.getHeader(a),e=c.getColumns(a),f=0,g=e.length;f<g;f++){var h=e[f];b.setColumnWidth(f,h.width,a)}d.setCellsPosition()},setColumnWidth:function(a,c,d){var e,f,g=this,h=g.widget,i=h.getColumns(d),j=h.getHeader(d),k=h.getBody(d),l=b(k.getDomColumn(a)),m=j.getCell(a),n=parseInt(l.css("left"));l.css("width",c),m.css("width",c),i[a+1]&&(n+=c,f=b(k.getDomColumn(a+1)),f.css("left",n),e=j.getCell(a+1),e.css("left",n))}})}(),function(){var a=Fancy,b=a.get(document),c=a.HIDDEN_CLS,d=a.GRID_HEADER_CELL_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,j=a.GRID_STATE_DRAG_COLUMN_CLS;a.define("Fancy.grid.plugin.ColumnDrag",{extend:a.Plugin,ptype:"grid.columndrag",inWidgetName:"columndrag",activeSide:void 0,activeCell:void 0,activeIndex:void 0,activeColumn:void 0,inCell:void 0,inIndex:void 0,inSide:void 0,ok:!1,status:"none",constructor:function(a){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.ons(),a.initHint()})},ons:function(){var a=this;a.widget.el.on("mousedown",a.onMouseDownCell,a,"div."+d)},onMouseDownCell:function(c){var e=this,j=e.widget,k=Fancy.get(c.currentTarget),l=Number(k.attr("index")),m=e.getSideByCell(k),n=j.getColumns(m),o=n[l],p=a.get(c.target);p.hasCls(f)||p.hasCls(g)||(k.hasCls(i)&&(e.activeCellTopGroup=e.getGroupStartEnd(k,m),e.activeCellTopGroup.cell=k),j.startResizing||(e.activeCellTopGroup||!1!==o.draggable)&&(k.hasCls(h)&&(e.activeUnderGroup=!0),e.activeSide=m,e.inSide=m,e.activeCell=k,e.inCell=k,e.activeIndex=Number(k.attr("index")),e.inIndex=e.activeIndex,e.activeColumn=n[e.activeIndex],e.mouseDownX=c.pageX,e.mouseDownY=c.pageY,b.once("mouseup",e.onMouseUp,e),b.on("mousemove",e.onMouseMove,e),j.el.on("mouseleave",e.onMouseLeave,e),j.el.on("mouseenter",e.onMouseEnterCell,e,"div."+d),j.el.on("mousemove",e.onMouseMoveCell,e,"div."+d)))},onMouseLeave:function(){this.hideHint()},onMouseUp:function(){var c=this,e=c.widget,f=!1;if(b.un("mousemove",c.onMouseMove,c),e.el.un("mouseleave",c.onMouseLeave,c),e.el.un("mouseenter",c.onMouseEnterCell,c,"div."+d),e.el.un("mousemove",c.onMouseMoveCell,c,"div."+d),c.ok){if(c.inSide===c.activeSide)c.dragColumn(c.inSide);else if("center"===c.activeSide){var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}else{var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}f=!0}delete c.inUpGroupCell,delete c.inUnderGroup,delete c.activeCellTopGroup,delete c.activeUnderGroup,delete c.activeSide,delete c.activeCell,delete c.activeIndex,delete c.activeIndex,delete c.activeColumn,delete c.mouseDownX,delete c.mouseDownY,c.ok=!1,delete c.okPosition,a.tip.hide(),c.removeDragState(),"dragging"===c.status&&setTimeout(function(){c.status="none",f&&(e.fire("columndrag"),e.scroller.update())},10),c.hideHint()},onMouseMove:function(b){var c=this,d=c.widget,h=d.header,i=d.leftHeader,j=d.rightHeader,k=b.pageX,l=b.pageY,m=d.getColumns(c.activeSide),n=a.get(b.target);if(!n.hasCls(f)&&!n.hasCls(g)&&(Math.abs(k-c.mouseDownX)>10||Math.abs(l-c.mouseDownY))){if(c.activeCellTopGroup?(a.tip.update(c.activeCellTopGroup.cell.select("."+e).item(0).dom.innerHTML||"&nbsp;"),c.addDragState()):(a.tip.update(c.activeColumn.title||"&nbsp;"),c.addDragState()),1===m.length&&"center"===c.activeSide)return a.tip.hide(),void c.removeDragState();a.tip.show(b.pageX+15,b.pageY+15),h.hideMenu&&(h.hideMenu(),d.leftColumns&&i.hideMenu()&&i.hideMenu(),d.rightColumns&&j.hideMenu()&&j.hideMenu())}},addDragState:function(){this.widget.el.addClass(j)},removeDragState:function(){this.widget.el.removeClass(j)},onMouseEnterCell:function(a){var b=this,c=Fancy.get(a.currentTarget),d=b.getSideByCell(c);b.hideHint(),c.hasCls(h)?b.inUnderGroup=!0:delete b.inUnderGroup,c.hasCls(i)?b.inUpGroupCell=c:delete b.inUpGroupCell,b.inSide=d,b.inCell=c,b.inIndex=Number(c.attr("index"))},onMouseMoveCell:function(a){var b=this,c=b.widget,d=b.inCell,e=parseInt(d.css("width")),g=d.select("."+f),h=Fancy.get(a.target),i=g.within(h)||h.hasClass(f),j=b.activeUnderGroup!==b.inUnderGroup&&!0===b.inUnderGroup,k=b.activeUnderGroup!==b.inUnderGroup&&!0===b.activeUnderGroup;if(1===c.getColumns(b.activeSide).length&&"center"===b.activeSide)return b.ok=!1,void b.hideHint();if(b.activeCellTopGroup)if(b.inUpGroupCell);else{var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end;b.activeSide!==b.inSide?(b.ok=!0,b.status="dragging",a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):isNaN(b.inIndex)?b.hideHint():b.inIndex<l?a.offsetX>e/2?b.inIndex+1===l?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("right")):(b.ok=!0,b.status="dragging",b.showHint("left")):b.inIndex>m?a.offsetX<e/2?b.inIndex===m+1?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("left")):(b.ok=!0,b.status="dragging",b.showHint("right")):b.hideHint()}else if(b.inUpGroupCell){var n=b.getGroupStartEnd(),l=n.start,m=n.end;b.activeSide!==b.inSide?(b.ok=!0,b.status="dragging",a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):a.offsetX>e/2?b.activeIndex>m&&b.activeIndex-1===m?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("right")):b.activeIndex<l&&b.activeIndex+1===l?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("left"))}else b.activeSide!==b.inSide?(b.ok=!0,b.status="dragging",a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):b.activeIndex===b.inIndex?b.ok=!1:b.activeIndex<b.inIndex?a.offsetX>e/2||i?(b.ok=!0,b.status="dragging",b.showHint("right")):a.offsetX<e/2&&b.activeIndex+1!==b.inIndex?(b.ok=!0,b.status="dragging",b.showHint("left")):b.activeIndex+1===b.inIndex&&(j||k)?(b.ok=!0,b.status="dragging",b.showHint("left")):(b.ok=!1,b.hideHint()):b.activeIndex>b.inIndex&&(a.offsetX<e/2?i?j||k?(b.ok=!0,b.status="dragging",b.showHint("right")):b.activeIndex-1===b.inIndex||b.inUpGroupCell?(b.ok=!1,b.hideHint()):(b.ok=!0,b.status="dragging",b.showHint("right")):(b.ok=!0,b.status="dragging",b.showHint("left")):a.offsetX>e/2?b.activeIndex-1===b.inIndex&&(j||k)?(b.ok=!0,b.status="dragging",b.showHint("right")):b.activeIndex-1!==b.inIndex||b.activeUnderGroup?(b.ok=!0,b.status="dragging",b.showHint("right")):(b.ok=!1,b.hideHint()):(b.ok=!1,b.hideHint()))},showHint:function(a){var b=this,d=b.widget,e=d.cellHeaderHeight,f=b.inCell,g=b.topEl,h=b.bottomEl,i=f.offset(),j=parseInt(f.css("width")),k=parseInt(f.css("height"));b.okPosition=a,g.removeCls(c),h.removeCls(c);var l=0;"right"===a&&(l+=j),g.css({left:i.left+l-Math.ceil(parseInt(g.css("width"))/2),top:i.top-parseInt(g.css("height"))});var m=i.top+k;if(b.inUpGroupCell){var n=d.header.calcRows();m=i.top+n*e}h.css({left:i.left+l-Math.ceil(parseInt(h.css("width"))/2),top:m})},hideHint:function(){var a=this;a.topEl.addCls(c),a.bottomEl.addCls(c)},initHint:function(){var b=this,d=b.widget,e="fancy-theme-"+d.theme,f=a.get(document.body).dom,g=a.get(document.createElement("div")),h=a.get(document.createElement("div"));g.addCls("fancy-drag-hint-top",c,e),h.addCls("fancy-drag-hint-bottom",c,e),b.topEl=a.get(f.appendChild(g.dom)),b.bottomEl=a.get(f.appendChild(h.dom))},dragColumn:function(a){var b=this,c=b.widget,d=c.getHeader(a),e=c.getBody(a),f=b.activeIndex,g=b.inIndex,h=b.okPosition,i=c.getColumns(a),j=i[f],k=d.calcRows();if(b.activeCellTopGroup){var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end,n=i.splice(l,m-l+1),g=b.inIndex;"right"===h&&g++,i=b.inIndex<l?Fancy.Array.insert(i,g,n):Fancy.Array.insert(i,g-n.length,n),c.setColumns(i,a)}else if(b.inUpGroupCell){var o=b.getGroupStartEnd();g=o.start,"right"===h&&(g=o.end+1)}else if("right"===h)if(b.inUnderGroup){var p=i[g].grouping,q=i[g+1];q&&q.grouping===p&&g++}else g++;if(c.groupheader&&!b.activeCellTopGroup){var r=i[g];r&&r.grouping&&b.inUnderGroup?(j.grouping=r.grouping,j.filter&&j.filter.header&&k<3&&delete j.filter):delete j.grouping}b.activeCellTopGroup||(i.splice(f,1),f<g&&g--,i.splice(g,0,j)),e.clearColumnsStyles(),d.updateTitles(),d.updateCellsSizes(),c.groupheader&&(c.header.fixGroupHeaderSizing(),c.leftColumns&&c.leftHeader.fixGroupHeaderSizing(),c.rightColumns&&c.rightHeader.fixGroupHeaderSizing(),d.reSetGroupIndexes()),d.reSetColumnsAlign(),d.reSetColumnsCls(),e.reSetColumnsAlign(),e.reSetColumnsCls(),e.updateColumnsSizes(),c.update()},getSideByCell:function(a){var b,c=this,d=c.widget;return d.centerEl.within(a)?b="center":d.leftEl.within(a)?b="left":d.rightEl.within(a)&&(b="right"),b},getGroupStartEnd:function(b,c){var d=this,e=d.widget,f=e.getHeader(c||d.inSide),g=(b||d.inUpGroupCell).attr("index"),h=f.el.select('[group-index="'+g+'"]'),i=[];return h.each(function(a){i.push(Number(a.attr("index")))}),{start:a.Array.min(i),end:a.Array.max(i)}}})}(),Fancy.define("Fancy.grid.plugin.ChartIntegration",{extend:Fancy.Plugin,ptype:"grid.chartintegration",inWidgetName:"chartintegration",constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initKeys(),a.initBind(),a.ons()},initKeys:function(){for(var a=this,b=a.chart,c=0,d=b.length;c<d;c++){var e,f=b[c],g=f.fields,h=0,i={};if(Fancy.isString(g))i=g;else for(e=g.length;h<e;h++)i[g[h]]=!0;b[c].keys=i}},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.toChart?a.renderToChart():a.readDataFromChart(),c.on("set",a.onSet,a),c.on("sort",a.onSort,a)})},renderToChart:function(){for(var a=this,b=a.widget,c=a.chart,d=0,e=c.length;d<e;d++){var f=c[d];switch(f.type){case"highchart":case"highcharts":b.highchart.setData(f)}}},onSet:function(a,b){for(var c=this,d=c.widget,e=c.chart,f=0,g=e.length,h=b.key;f<g;f++){var i=e[f],j=i.type;if(!0===i.keys[h])switch(j){case"highchart":case"highcharts":d.highchart.set(i,b)}}},onSort:function(a,b){for(var c=this,d=c.widget,e=c.chart,f=0,g=e.length;f<g;f++){var h=e[f];switch(h.type){case"highchart":case"highcharts":if(!1!==h.sortBind){var i=d.highchart.sort(h,b);e[f].categories=i.original}}}},readDataFromChart:function(){var a,b=this,c=b.widget,d=c.store,e=b.chart,f=e[0],g=f.type;switch(g){case"highchart":case"highcharts":a=c.highchart.getData(f)}c.reConfigStore(a),d.setData(a)},initBind:function(){for(var a,b=this,c=b.chart,d=0,e=c.length;d<e;d++)a=c[d],a.bind&&b.chartBind(a)},chartBind:function(a){var b=this,c=b.widget,d=a.bind;c.on(d.event,b.onBindEvent,{chart:a})},onBindEvent:function(a,b){var c=this,d=a,e=c.chart,f=e.bind,g=f.series,h=b.data,i=e.id;switch(f.action){case"add":var j=d.highchart.doesSeriesExist(i,h[g.name]),k=d.highchart.getNumberSeries(i);if(!1!==j&&1!==k)return void d.highchart.removeSeries(i,j);e.maxToShow&&e.maxToShow<=k&&d.highchart.removeLastSeries(i),d.highchart.isTreeMap(i)?d.highchart.setSeriesData(i,{data:h[g.data]}):d.highchart.addSeries(i,{name:h[g.name],data:h[g.data]})}}}),Fancy.define("Fancy.grid.plugin.HighChart",{extend:Fancy.Plugin,ptype:"grid.highchart",inWidgetName:"highchart",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){},setData:function(a){var b=this,c=b.widget,d=c.store,e=d.getDataView(),f=a.fields,g=0,h=e.length,i=0,j=f.length,k=b.getChart(a.id),l=k.series,m=a.read;if(m&&void 0!==m.rowIndex&&(e=[e[m.rowIndex]],j=1),Fancy.isString(f))for(;i<j;i++){var n=e[i][f],o=l[i],p=[],g=0,h=n.length;if(a.names)for(;g<h;g++){var q={name:a.names[g],value:n[g]};p.push(q)}else for(;g<h;g++)p.push(n[g]);if(!o)break;o.setData(p),a.name&&o.update({name:e[i][a.name]})}else for(;i<j;i++){var r=f[i],o=l[i],p=[];for(g=0;g<h;g++)p.push(e[g][r]);o.setData(p)}},setSeriesData:function(a,b){this.getChart(chartConfig.id).series[0].setData(b.data)},set:function(a,b){var c,d=this.getFieldsMap(a),e=this.getChart(a.id),f=e.series;c=f[d[b.key]],c.data[b.rowIndex].update(Number(b.value))},sort:function(a){for(var b=this,c=b.widget,d=c.store,e=b.getChart(a.id),f=a.categories?a.categories:e.xAxis[0].categories,g=d.order,h=[],i=0,j=g.length;i<j;i++)h.push(f[g[i]]);return e.xAxis[0].update({categories:h},!0),b.update(a),{original:f,newCategories:h}},update:function(a){for(var b,c=this,d=c.widget,e=d.store,f=e.getDataView(),g=a.fields,h=0,i=f.length,j=0,k=c.getChart(a.id),l=k.series,m=[],n=0,o=g.length;n<o;n++){var p=g[n];h=0;for(var q=[];h<i;h++)q.push(f[h][p]);m.push(q)}for(b=l.length;j<b;j++){l[j].setData(m[j],!1)}k.redraw()},getData:function(a){for(var b=this,c=b.getChart(a.id),d=d=a.fields,e=0,f=d.length,g=c.series,h=g[0].data.length,i=[];e<f;e++)for(var j=d[e],k=0,l=g[e];k<h;k++)void 0===i[k]&&(i[k]={}),i[k][j]=l.data[k].y;var m=b.getColumnsChartIndexes();for(e=0,f=m.length;e<f;e++){var n=m[e],o=n.split("."),p=c[o[0]][0][o[1]];for(k=0,h=p.length;k<h;k++)i[k][n]=p[k]}return i},getColumnsChartIndexes:function(){for(var a=this.widget,b=[],c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d].index;/xAxis\../.test(f)&&b.push(f)}return b},getFieldsMap:function(a){for(var b={},c=a.fields,d=0,e=c.length;d<e;d++)b[c[d]]=d;return b},addSeries:function(a,b){this.getChart(a).addSeries(b)},getNumberSeries:function(a){return this.getChart(a).series.length},removeLastSeries:function(a){var b=this.getChart(a);b.series[b.series.length-1].remove()},removeSeries:function(a,b){this.getChart(a).series[b].remove()},doesSeriesExist:function(a,b){for(var c=this,d=c.getChart(a),e=0,f=d.series.length;e<f;e++)if(d.series[e].name===b)return e;return!1},isTreeMap:function(a){var b=this.getChart(a);return void 0!==b.series[0]&&"treemap"===b.series[0].type},getChart:function(a){var b,c=Highcharts.charts;return c.forEach(function(c,d){c.renderTo.id===a&&(b=c)}),b}}),Fancy.define("Fancy.grid.plugin.Edit",{extend:Fancy.Plugin,ptype:"grid.edit",inWidgetName:"edit",clicksToEdit:2,tabColumnsSupport:{date:!0,combo:!0,image:!0,number:!0,string:!0,text:!0},constructor:function(a){this.Super("const",arguments)},init:function(){var a=this,b=a.widget,c=b.store;a.addEvents("tab"),a.Super("init",arguments),b.once("render",function(){a.ons(),c.on("beforeupdate",a.onStoreCRUDBeforeUpdate,a),c.on("update",a.onStoreCRUDUpdate,a),c.on("beforedestroy",a.onStoreCRUDBeforeDestroy,a),c.on("destroy",a.onStoreCRUDDestroy,a),c.on("create",a.onCreate,a)})},ons:function(){var a=this,b=a.widget,c=b.store,d="cell"+a.getClickEventName();b.on("cellclick",a.onClickCell,a),c.on("set",a.onStoreSet,a),a.on("tab",a.onTab,a),b.once("init",function(){b.on(d,a.onClickCellToEdit,a)}),b.on("activate",a.onGridActivate,a),b.on("deactivate",a.onGridDeActivate,a)},onGridActivate:function(){Fancy.get(document).on("keydown",this.onKeyDown,this)},onGridDeActivate:function(){Fancy.get(document).un("keydown",this.onKeyDown,this)},onKeyDown:function(a){var b=a.keyCode,c=Fancy.key;switch(b){case c.TAB:this.fire("tab",a)}},onTab:function(a,b){var a=this,c=a.widget;if(a.activeCellEditParams){b.preventDefault();var d=a.getNextCellEditParam();c.celledit&&(c.celledit.hideEditor(),!1!==c.tabEdit&&setTimeout(function(){c.celledit.edit(d)},100))}},getNextCellEditParam:function(){for(var a,b,c,d,e=this,f=e.widget,g=f.store,h=e.activeCellEditParams,i=f.leftColumns,j=h.columnIndex,k=h.rowIndex,l=h.side,m=f.getColumns(l),n=m[j+1],o=0,p=20;o<p;o++){var q=e.getNextCellInfo({side:l,columnIndex:j,rowIndex:k});if(l=q.side,j=q.columnIndex,k=q.rowIndex,m=f.getColumns(l),n=m[q.columnIndex],e.tabColumnsSupport[n.type]&&!0===n.editable)break}return a=f.getBody(l),b=a.getCell(k,j).dom,b||(l="center",i.length&&(l="left"),k=0,j=0,a=f.getBody(l),b=a.getCell(k,j).dom),c=n.index||n.key,d=g.getId(k),{id:g.getId(k),side:l,column:n,cell:b,columnIndex:j,rowIndex:k,value:g.get(k,c),data:g.get(k),item:g.getById(d)}},getNextCellInfo:function(a){var b=this,c=b.widget,d=a.side,e=c.getColumns(d),f=a.columnIndex,g=a.rowIndex,h=e[f+1],i=c.rightColumns,j=c.leftColumns;if(h)f++;else switch(d){case"left":d="center",f=0;break;case"center":i.length?(d="right",f=0):j.length?(d="left",f=0,g++):(f=0,g++);break;case"right":j.length?(d="left",f=0,g++):(d="center",f=0,g++)}return{side:d,rowIndex:g,columnIndex:f}},getClickEventName:function(){switch(this.clicksToEdit){case 1:return"click";case 2:return"dblclick"}},stopEditor:function(){this.stopped=!0},onClickCell:function(a,b){var c=this.widget,d=b.column;d.editable&&"checkbox"===d.type&&c.celledit&&c.celledit.onCheckBoxChange(b)},onClickCellToEdit:function(a,b){var c=this,d=c.widget,e=b.column;if(d.rowedit||d.celledit&&d.celledit.hideEditor(),c.fire("beforedit"),!0===c.stopped)return void(c.stopped=!1);d.rowedit?d.rowedit.edit(b):e.editable&&"checkbox"!==e.type&&d.celledit&&d.celledit.edit(b)},onStoreSet:function(a,b){this.widget.updater.updateRow(b.rowIndex)},onStoreCRUDBeforeUpdate:function(){var a=this,b=a.widget,c=a.activeCellEditParams;c&&b.updater.updateRow(c.rowIndex)},onStoreCRUDUpdate:function(a,b,c,d){delete a.changed[b],this.clearDirty()},onStoreCRUDBeforeDestroy:function(){},onStoreCRUDDestroy:function(){this.widget.store.loadData(),this.clearDirty()},clearDirty:function(){var a=this.widget;setTimeout(function(){a.leftBody.clearDirty(),a.body.clearDirty(),a.rightBody.clearDirty()},500)},onCreate:function(a,b){this.widget.updater.update(),this.clearDirty()}}),function(){var a=Fancy,b=a.Date,c=a.GRID_CELL_CLS;a.define("Fancy.grid.plugin.CellEdit",{extend:a.Plugin,ptype:"grid.celledit",inWidgetName:"celledit",editorsCls:"fancy-grid-editors",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.initEditorContainer(),a.checkAutoInitEditors(),b.on("scroll",a.onScroll,a),b.on("nativescroll",a.onNativeScroll,a),b.on("docclick",a.onDocClick,a),b.on("headercellmousedown",a.onHeaderCellMouseDown,a)})},onDocClick:function(b,d){var e=this,f=e.activeCellEditParams,g=e.activeEditor,h=!0,i=d.target,j=a.get(i);if(void 0!==g&&"date"!==f.column.type){if("combo"!==f.column.type){return void(j.closest("."+c).dom||g.el.within(i)||g.hide())}!1===g.el.within(i)&&!1===g.list.within(i)&&!0!==ezboClick&&(h=!1),!1===h&&g.hide(),e.comboClick=!1}},initEditorContainer:function(){var a=this,b=a.widget;a.editorsContainer=b.el.select("."+a.editorsCls)},edit:function(a){var b=this,c=b.widget,d=a.column;"$selected"!==d.index&&(b.activeCellEditParams=a,c.edit.activeCellEditParams=a,d.editor=b.generateEditor(d),c.scroller.scrollToCell(a.cell),b.showEditor(a))},generateEditor:function(b){var c,d,e=this,f=e.widget,g={position:"absolute",left:"0px",top:"0px",display:"none",padding:"0px"},h=b.type,i=b.vtype,j=f.theme;if(b.editor)return b.editor;d=e.editorsContainer.dom;var k={renderTo:d,label:!1,style:g,checkValidOnTyping:!0};switch(h){case"combo":var l="text",m="text",n=b.data,o=[{change:e.onComboChange,scope:e}];if(b.editorEvents)for(var p=0,q=b.editorEvents.length;p<q;p++)o.push(b.editorEvents[p]);void 0!==b.displayKey&&(l=b.displayKey,m=l),"default"===j&&(j=void 0),c=new a.Combo({theme:j,renderTo:d,label:!1,style:g,data:n,displayKey:l,valueKey:m,value:0,padding:!1,vtype:i,events:o,checkValidOnTyping:!0});break;case"text":c=new a.TextArea({renderTo:d,label:!1,style:g,vtype:i,checkValidOnTyping:!0,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]});break;case"image":case"string":case"color":c=new a.StringField({renderTo:d,label:!1,style:g,vtype:i,format:b.format,checkValidOnTyping:!0,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]});break;case"number":case"currency":a.apply(k,{vtype:i,format:b.format,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]}),void 0!==b.spin&&(k.spin=b.spin),void 0!==b.step&&(k.step=b.step),void 0!==b.min&&(k.min=b.min),void 0!==b.max&&(k.max=b.max),c=new a.NumberField(k);break;case"date":c=new a.DateField({renderTo:d,label:!1,style:g,format:b.format,lang:f.lang,vtype:i,theme:j,checkValidOnTyping:!0,events:[{enter:e.onEditorEnter,scope:e},{beforehide:e.onEditorBeforeHide,scope:e},{blur:e.onBlur,scope:e}]});break;default:throw new Error("[FancyGrid error] - type "+h+" editor does not exit")}return c},showEditor:function(a){var b=this,c=b.widget,d=a.column,e=d.type,f=d.editor,g=a.cell,h=b.getCellPosition(g),i=b.getCellSize(g);"combo"===e&&(b.comboClick=!0),b.activeEditor=f,b.setEditorValue(a),b.setEditorSize(i),f.show(),f.el.css(h),f.focus(),"combo"===e&&void 0!==a.value&&f.set(a.value,!1),c.fire("startedit",a)},setEditorSize:function(a){var b=this;"field.combo"===b.activeEditor.wtype?b.activeEditor.size(a):b.activeEditor.setInputSize({width:a.width,height:a.height})},hideEditor:function(){var a,b,c,d=this,e=d.widget,f=e.store,g=d.activeCellEditParams,h=d.activeEditor;h&&(c=g.column,b=h.get(),"server"===f.proxyType&&"combo"!==c.type&&(a=d.getActiveColumnKey(),b=d.prepareValue(b),f.set(g.rowIndex,a,b)),h.hide(),h.hideErrorTip()),delete d.activeEditor,e.el.dom.scrollTop&&(e.el.dom.scrollTop=0)},getCellPosition:function(b){var c=this,d=c.widget,e=d.gridBorders,f=a.get(b),g=f.offset(),h=d.el.offset();return{left:parseInt(g.left)-parseInt(h.left)-2+"px",top:parseInt(g.top)-parseInt(h.top)-(e[0]+e[2])+"px"}},getCellSize:function(b){var c=this,d=c.widget,e=a.get(b),f=e.width(),g=e.height(),h=2;return a.nojQuery&&2===d.panelBorderWidth&&(h=1),f+=parseInt(e.css("border-right-width"))*h,g+=parseInt(e.css("border-bottom-width"))*h,{width:f,height:g}},setEditorValue:function(a){var c=this,d=c.activeEditor;switch(a.column.type){case"combo":-1!==d.valueIndex&&d.set(d.getValueKey(a.value),!1);break;case"date":var e=a.column.format,f=b.parse(a.value,e.read,e.mode);d.set(f);break;default:d.set(a.value)}},onEditorEnter:function(a,b){this.hideEditor()},onHeaderCellMouseDown:function(){this.hideEditor()},onKey:function(a,b){},setValue:function(a){var b,c=this,d=c.widget,e=d.store,f=c.activeCellEditParams,g=c.activeEditor;void 0!==g&&!1!==g.isValid()&&"server"!==e.proxyType&&(b=c.getActiveColumnKey(),a=c.prepareValue(a),"field.date"===g.type&&g.isEqual(e.get(f.rowIndex,b))||e.set(f.rowIndex,b,a))},onEditorBeforeHide:function(a){a.isValid()&&this.setValue(a.getValue())},onScroll:function(){this.hideEditor()},onNativeScroll:function(){this.hideEditor()},onBlur:function(a){var b=this;if(!b.activeEditor||a.id===b.activeEditor.id){if(!0===a.mouseDownSpinUp||a.mouseDownSpinDown)return;b.hideEditor()}},prepareValue:function(c){var d=this,e=d.getActiveColumnType(),f=d.activeCellEditParams,g=f.column,h=g.format;switch(e){case"number":case"currency":if(h&&h.inputFn){var i="",j=0,k=c.length;if(a.isNumber(c))return c;for(;j<k;j++)isNaN(Number(c[j]))||(i+=c[j]);c=i}else""!==c&&(c=Number(c));break;case"date":if(g.format&&g.format.read){var l=g.editor.getDate();c=b.format(l,g.format.read,void 0,g.format.mode)}}return c},getActiveColumnType:function(){return this.activeCellEditParams.column.type},getActiveColumnKey:function(){var a=this.activeCellEditParams,b=a.column;return b.key||b.index},onCheckBoxChange:function(a){var b=this,c=b.widget,d=a.column,e=d.key||d.index,f=c.store,g=b.checkBoxChangedValue;b.activeEditor&&b.hideEditor(),void 0!==b.checkBoxChangedValue&&(delete b.checkBoxChangedValue,b.activeCellEditParams=a,c.edit.activeCellEditParams=a,f.set(a.rowIndex,e,g))},onComboChange:function(a,b){var c=this,d=c.widget,e=d.store,f=c.activeCellEditParams,g=c.getActiveColumnKey(),h=a.getDisplayValue(b);e.set(f.rowIndex,g,h),c.hideEditor()},checkAutoInitEditors:function(){var b=this,c=b.widget;a.each(c.columns,function(a){a.editorAutoInit&&(a.editor=b.generateEditor(a))})}})}(),function(){var a=Fancy,b=a.each,c=a.GRID_CELL_CLS,d=a.FIELD_CLS,e=a.GRID_ROW_EDIT_CLS,f=a.GRID_ROW_EDIT_BUTTONS_CLS,g=a.GRID_ROW_EDIT_BUTTON_UPDATE_CLS,h=a.GRID_ROW_EDIT_BUTTON_CANCEL_CLS,i=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.RowEdit",{extend:a.Plugin,ptype:"grid.rowedit",inWidgetName:"rowedit",rendered:!1,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.on("scroll",a.onScroll,a),b.on("columnresize",a.onColumnResize,a),b.on("columndrag",a.onColumnDrag,a),b.grouping&&(b.on("collapse",a.onCollapse,a),b.on("expand",a.onExpand,a))},onCollapse:function(){this.hide()},onExpand:function(){this.hide()},edit:function(a){var b=this,c=b.widget;"$selected"!==a.column.index&&(c.scroller.scrollToCell(a.cell),b.showEditor(a))},showEditor:function(a){var b=this;if(b.changed={},b.rendered){var c="none"===b.el.css("display");b.show(),b.changePosition(a.rowIndex,!c),b.setValues(a)}else b.render(),b.changePosition(a.rowIndex,!1),b.setValues(a);b.setSizes()},render:function(){var a=this,b=a.widget;b.leftColumns&&(a.leftEl=a.renderTo(b.leftBody.el,b.leftColumns)),b.columns&&(a.el=a.renderTo(b.body.el,b.columns)),b.rightColumns&&(a.rightEl=a.renderTo(b.rightBody.el,b.rightColumns)),a.renderButtons(),a.rendered=!0},renderTo:function(b,c,f,g,h){var i,j,k,l,m=this,n=m.widget,o=a.get(document.createElement("div")),p=0,q=c.length,r=n.theme,s={float:"left",margin:"0px",padding:"0px"};if(g){var t=b.select("."+d);switch(p=f,q=f+1,g){case"right":l=t.item(f);break;case"left":k=t.item(f);break;case"center":switch(h){case"left":l=t.item(0);break;case"right":k=t.item(t.length-1)}}}else o.addCls(e),i=a.get(b.dom.appendChild(o.dom));for(;p<q;p++){j=c[p];var u=j.width,v={index:j.index,label:!1,style:s,width:u,vtype:j.vtype,format:j.format,stopPropagation:!0,theme:r,checkValidOnTyping:!0,events:[{change:m.onFieldChange,delay:100,scope:m},{enter:m.onFieldEnter,scope:m}]};switch(g){case"left":v.renderAfter=k;break;case"right":v.renderBefore=l;break;case"center":switch(h){case"left":v.renderBefore=t.item(0);break;case"right":v.renderAfter=t.item(t.length-1)}break;default:v.renderTo=i.dom}var w;if(!1===j.editable)switch(j.type){case"string":case"number":w=new a.TextField(v);break;default:w=new a.EmptyField(v)}else switch(j.type){case"date":j.format&&(v.format=j.format),w=new a.DateField(v);break;case"image":case"string":case"color":w=new a.StringField(v);break;case"number":j.spin&&(v.spin=j.spin),j.step&&(v.step=j.step),j.min&&(v.min=j.min),j.max&&(v.max=j.max),w=new a.NumberField(v);break;case"combo":a.apply(v,{data:j.data,value:-1,padding:!1}),j.displayKey?(v.displayKey=j.displayKey,v.valueKey=j.displayKey):(v.displayKey="text",v.valueKey="text"),w=new a.Combo(v);break;case"checkbox":var x;switch(j.cellAlign){case"left":x=7;break;case"center":x=(j.width-20-2)/2;break;case"right":x=(j.width-20)/2+11}a.apply(v,{renderId:!0,value:!1,style:{padding:"0px",display:"inline-block","padding-left":x,float:"left",margin:"0px"}}),w=new a.CheckBox(v);break;default:w=new a.EmptyField(v)}j.rowEditor=w}return i},renderButtons:function(){var b,c=this,d=c.widget,e=a.get(document.createElement("div"));e.addCls(f),b=a.get(d.body.el.dom.appendChild(e.dom)),c.buttonsEl=b,c.buttonUpdate=new a.Button({cls:g,renderTo:b.dom,text:"Update",events:[{click:c.onClickUpdate,scope:c}]}),c.buttonCancel=new a.Button({cls:h,renderTo:b.dom,text:"Cancel",events:[{click:c.onClickCancel,scope:c}]})},setSizes:function(){var a=this,b=a.widget;b.leftColumns&&a._setSizes(b.leftBody.el.select("."+c+'[index="0"]'),b.leftColumns,"left"),b.columns&&a._setSizes(b.body.el.select("."+c+'[index="0"]'),b.columns),b.rightColumns&&a._setSizes(b.rightBody.el.select("."+c+'[index="0"]'),b.rightColumns,"right"),a.setElSize()},setElSize:function(){var a=this.widget,b=a.getCenterViewWidth(),c=a.getCenterFullWidth();b<c&&this.el.css("width",c)},_setSizes:function(b,c,d){for(var e,f,g,h,i=this,j=0,k=c.length,l=1,m=2;j<k;j++)e=c[j],g=b.item(j).dom,a.get(g),f=i.getCellSize(g),(h=e.rowEditor)&&("left"!==d&&"right"!==d||j!==k-1||f.width--,f.height-=2,j===k-1?h.el.css("width",f.width-2):h.el.css("width",f.width-1),h.el.css("height",f.height),f.width-=2*l,f.width-=2*m,f.height-=2*m,i.setEditorSize(h,f))},getCellSize:function(b){var c=this.widget,d=a.get(b),e=d.width(),f=d.height(),g=2;return a.nojQuery&&2===c.panelBorderWidth&&(g=1),e+=parseInt(d.css("border-right-width"))*g,f+=parseInt(d.css("border-bottom-width"))*g,{width:e,height:f}},setEditorSize:function(a,b){"field.combo"===a.wtype?(a.size(b),a.el.css("width",b.width+5)):a.setInputSize({width:b.width,height:b.height})},changePosition:function(a,b){var c=this,d=c.widget,e=d.scroller.getScroll(),f=d.scroller.getBottomScroll(),g=d.cellHeight*a-1-e,h=0;d.grouping&&(h+=d.grouping.getOffsetForRow(a),g+=h),c.leftEl&&(!1!==b?c.leftEl.animate({top:g},i):c.leftEl.css("top",g)),c.el&&(!1!==b?c.el.animate({top:g},i):c.el.css("top",g)),c.rightEl&&(!1!==b?c.rightEl.animate({top:g},i):c.rightEl.css("top",g));var j=d.getViewTotal()-3<a,k=g;a<3&&(j=!1),j?d.grouping?d.getViewTotal()-3<a-d.grouping.getSpecialRowsUnder(a)?k=g-parseInt(c.buttonsEl.css("height"))+1:(k=g+d.cellHeight,j=!1):k=g-parseInt(c.buttonsEl.css("height"))+1:k=g+d.cellHeight,!1!==b?c.buttonsEl.animate({top:k},i):c.buttonsEl.css("top",k),c.el.css("left",-f),c.changeButtonsLeftPos(),c.activeRowIndex=a},changeButtonsLeftPos:function(){var a=this,b=a.widget,c=b.getCenterViewWidth(),d=parseInt(a.buttonsEl.css("width"));a.buttonsEl.css("left",(c-d)/2)},setValues:function(a){var b=this,c=b.widget;c.leftColumns&&b._setValues(a.data,c.leftColumns),c.columns&&b._setValues(a.data,c.columns),c.rightColumns&&b._setValues(a.data,c.rightColumns),b.activeId=a.id,b.activeRowIndex=a.rowIndex},_setValues:function(a,c){b(c,function(b){var c=b.rowEditor;if(c)switch(b.type){case"action":case"button":case"order":case"select":break;default:c.set(a[b.index],!1)}})},onScroll:function(){var a=this;!1!==a.rendered&&void 0!==a.activeRowIndex&&a.changePosition(a.activeRowIndex,!1)},onColumnResize:function(){var a=this;!1!==a.rendered&&setTimeout(function(){a.setSizes()},i)},onClickUpdate:function(){var a=this,b=a.widget,c=b.store,d=a.prepareChanged(),e=c.getRow(a.activeId);c.setItemData(e,d),b.update(),a.hide()},prepareChanged:function(){var b=this,c=b.widget,d=b.changed;for(var e in d){var f=c.getColumnByIndex(e);switch(f.type){case"date":var g=a.Date.parse(d[e],f.format.edit,f.format.mode),h=a.Date.format(g,f.format.read,f.format.mode);d[e]=h}}return d},onClickCancel:function(){this.hide()},hide:function(){var a=this;a.el&&(a.leftEl&&a.leftEl.hide(),a.el.hide(),a.rightEl&&a.rightEl.hide(),a.buttonsEl.hide())},show:function(){var a=this;a.leftEl&&("none"===a.leftEl.css("display")&&a.leftEl.css("opacity",0),a.leftEl.show(),a.leftEl.animate({opacity:1},i)),"none"===a.el.css("display")&&a.el.css("opacity",0),a.el.show(),a.el.animate({opacity:1},i),a.rightEl&&("none"===a.rightEl.css("display")&&a.rightEl.css("opacity",0),a.rightEl.show(),a.rightEl.animate({opacity:1},i)),"none"===a.buttonsEl.css("display")&&a.buttonsEl.css("opacity",0),a.buttonsEl.show(),a.buttonsEl.animate({opacity:1},i)},onFieldChange:function(a,b,c){var d=this;a.isValid()?d.changed[a.index]=b:delete d.changed[a.index]},onFieldEnter:function(){var a=this,b=a.widget,c=b.store,d=c.getRow(a.activeId);c.setItemData(d,a.changed),b.update(),a.hide()},hideField:function(a,b){var c=this.widget,d=c.getColumns(b),e=d[a];e.rowEditor&&e.rowEditor.hide()},showField:function(a,b){var c=this.widget,d=c.getColumns(b),e=d[a];e.rowEditor&&e.rowEditor.show()},moveEditor:function(a,b,c,d){var f,g=this,h=g.widget,i=h.store,j=h.getColumns(c),k=a.rowEditor,l=h.getBody(c),m=l.el.select("."+e),n=i.getById(g.activeId),o=n.get(a.index);void 0===g.activeId&&(o=i.get(g.activeRowIndex)[a.index]),k.destroy(),g.renderTo(m,j,b,c,d),f=g.getField(b,c),a.rowEditor=f,f.set(o),g.setSizes(),g.changeButtonsLeftPos(),g.reSetColumnsEditorsLinks()},getField:function(b,c){var e=this.widget,f=e.getBody(c);switch(c){case"left":b++}return a.getWidget(f.el.select("."+d).item(b).attr("id"))},reSetColumnsEditorsLinks:function(){var c=me.widget,e=c.body.el.select("."+d);b(c.columns,function(b,c){b.rowEditor=a.getWidget(e.item(c).attr("id"))}),e=c.leftBody.el.select("."+d),b(c.leftColumns,function(b,c){b.rowEditor=a.getWidget(e.item(c).attr("id"))}),e=c.rightBody.el.select("."+d),b(c.rightColumns,function(b,c){b.rowEditor=a.getWidget(e.item(c).attr("id"))})},onColumnDrag:function(){var a=this;a.destroyEls(),a.hide()},destroyEls:function(){var b=this,c=b.widget;b.rendered&&(b.rendered=!1,c.leftColumns&&(b.leftEl.destroy(),a.each(c.leftColumns,function(a){a.rowEditor.destroy()})),c.columns&&(b.el.destroy(),a.each(c.columns,function(a){a.rowEditor.destroy()})),c.rightColumns&&(b.rightEl.destroy(),a.each(c.rightColumns,function(a){a.rowEditor.destroy()})))}})}(),function(){var a=Fancy,b=a.FIELD_CHECKBOX_CLS,c=a.GRID_CELL_CLS,d=a.GRID_CELL_OVER_CLS,e=a.GRID_CELL_SELECTED_CLS,f=a.GRID_COLUMN_CLS,g=a.GRID_COLUMN_OVER_CLS,h=a.GRID_COLUMN_SELECT_CLS,i=a.GRID_COLUMN_SELECTED_CLS,j=a.GRID_ROW_OVER_CLS,k=a.GRID_HEADER_CELL_SELECT_CLS;a.define("Fancy.grid.plugin.Selection",{extend:a.Plugin,ptype:"grid.selection",inWidgetName:"selection",mixins:["Fancy.grid.selection.mixin.Navigation"],enabled:!0,checkboxRow:!1,checkOnly:!1,memory:!1,constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.memory&&a.initMemory(),a.ons()},ons:function(){var b=this,c=b.widget;c.once("render",function(){b.initTrackOver(),b.initColumnTrackOver(),b.initCellTrackOver(),b.initCellSelection(),b.initRowSelection(),b.initColumnSelection(),c.keyNavigation&&b.initNavigation(),c.on("changepage",b.onChangePage,b),a.nojQuery&&b.initFixTrackOver()}),c.on("sort",b.onSort,b),c.on("columndrag",b.onColumnDrag,b),c.on("lockcolumn",b.onColumnLock,b),c.on("rightlockcolumn",b.onColumnRightLock,b),c.on("unlockcolumn",b.onUnColumnLock,b)},initMemory:function(){var b=this;b.memory={all:!1,except:{},selected:{},setAll:function(){a.apply(b.memory,{all:!0,except:{},selected:{}})},clearAll:function(){a.apply(b.memory,{all:!1,except:{},selected:{}})}}},initTrackOver:function(){var a=this,b=a.widget;b.on("rowenter",a.onRowEnter,a),b.on("rowleave",a.onRowLeave,a)},initCellTrackOver:function(){var a=this,b=a.widget;b.on("cellenter",a.onCellEnter,a),b.on("cellleave",a.onCellLeave,a)},initColumnTrackOver:function(){var a=this,b=a.widget;b.on("columnenter",a.onColumnEnter,a),b.on("columnleave",a.onColumnLeave,a)},onCellEnter:function(b,c){var e=this.widget;e.cellTrackOver&&!e.startResizing&&a.get(c.cell).addCls(d)},onCellLeave:function(b,c){var e=this.widget;e.cellTrackOver&&!e.startResizing&&a.get(c.cell).removeCls(d)},onColumnEnter:function(b,c){var d=this.widget,e=d.scroller;d.startResizing||!d.columnTrackOver||e.bottomKnobDown||e.rightKnobDown||!1===c.column.trackOver||a.get(c.columnDom).addCls(g)},onColumnLeave:function(b,c){var d=this.widget;d.startResizing||d.columnTrackOver&&a.get(c.columnDom).removeCls(g)},onRowEnter:function(b,c){var d=this.widget,e=d.scroller;if(!d.startResizing&&!1!==this.enabled&&d.trackOver&&!e.bottomKnobDown&&!e.rightKnobDown){var f=d.getDomRow(c.rowIndex);a.each(f,function(b){a.get(b).addCls(j)}),d.fire("rowtrackenter",c)}},onRowLeave:function(b,c){var d=this.widget;if(!d.startResizing&&!1!==this.enabled&&d.trackOver){var e=d.getDomRow(c.rowIndex);a.each(e,function(b){a.get(b).removeCls(j)}),d.fire("rowtrackleave",c)}},onChangePage:function(){this.memory||this.clearSelection()},initCellSelection:function(){var a=this,b=a.widget;b.on("cellclick",a.onCellClick,a),b.on("cellmousedown",a.onCellMouseDownCells,a),b.on("cellenter",a.onCellEnterSelection,a)},initRowSelection:function(){var a=this,b=a.widget;b.checkboxRowSelection&&(a.checkboxRow=!0,setTimeout(function(){"rows"===a.selModel&&a.renderHeaderCheckBox()},1)),b.on("rowclick",a.onRowClick,a),b.on("cellmousedown",a.onCellMouseDownRows,a),b.on("cellclick",a.onCellClickRows,a),b.on("rowenter",a.onRowEnterSelection,a)},onCellMouseDownRows:function(c,d){var f=this,g=f.widget;if(f.rows&&f.enabled&&(!f.checkOnly||"$selected"===d.column.index)){var h=d.e,i=h.target,j=h.ctrlKey,k=d.rowIndex,l=g.getDomRow(k);if(j&&g.multiSelect)a.get(l[0]).hasCls(e)?(f.domDeSelectRow(k),f.checkboxRow&&f.deSelectCheckBox(k)):(f.domSelectRow(k),f.checkboxRow&&f.selectCheckBox(k));else if("$selected"===d.column.index){var m=a.getWidget(a.get(d.cell).select("."+b).attr("id"));m.el.within(i)?(f.domSelectRow(k),!0===m.get()?f.domDeSelectRow(k):f.domSelectRow(k)):(f.clearSelection(),f.domSelectRow(k),f.checkboxRow&&f.selectCheckBox(k))}else f.clearSelection(),f.domSelectRow(k),f.checkboxRow&&f.selectCheckBox(k);f.isMouseDown=!0,f.startRowSelection=k,a.$(document).one("mouseup",function(){delete f.isMouseDown,delete f.startCellSelection}),g.fire("select")}},selectCheckBox:function(d){var e=this,f=e.widget;f.el.select("."+h+" ."+c+'[index="'+d+'"] .'+b).each(function(b){a.getWidget(b.attr("id")).set(!0)}),"rows"===f.selModel&&e.clearHeaderCheckBox()},deSelectCheckBox:function(d){var e=this,f=e.widget,g=f.store,i=f.el.select("."+h+" ."+c+'[index="'+d+'"] .'+b),j=g.get(d,"id");j&&(e.memory&&(e.memory.except[j]=!0,delete e.memory.selected[j]),i.each(function(b){a.getWidget(b.attr("id")).set(!1)}),e.clearHeaderCheckBox())},domSelectRow:function(b){var c=this,d=c.widget,f=d.store,g=d.getDomRow(b),h=f.get(b,"id");d.startResizing||(c.memory&&(delete c.memory.except[h],c.memory.selected[h]=!0),a.each(g,function(b){a.get(b).addCls(e)}))},domDeSelectRow:function(b){var c=this.widget,d=c.getDomRow(b);a.each(d,function(b){a.get(b).removeCls(e)})},onColumnEnterSelection:function(a,b){var c=this,d=c.widget;if(c.columns&&!0===c.isMouseDown){var e={columnIndex:c.startColumnColumnIndex,side:c.startColumnSide},f={columnIndex:b.columnIndex,side:b.side};if(e.side===f.side){switch(e.side){case"center":c.clearSelection("right"),c.clearSelection("left");break;case"left":c.clearSelection("center"),c.clearSelection("right");break;case"right":c.clearSelection("center"),c.clearSelection("left")}c.selectColumns(e.columnIndex,f.columnIndex,e.side)}else"center"===e.side&&"right"===f.side?(c.selectColumns(e.columnIndex,d.columns.length,"center"),c.selectColumns(0,f.columnIndex,"right")):"center"===e.side&&"left"===f.side?(c.selectColumns(0,e.columnIndex,"center"),c.selectColumns(f.columnIndex,d.leftColumns.length,"left")):"left"===e.side&&"center"===f.side?(c.clearSelection("right"),c.selectColumns(e.columnIndex,d.leftColumns.length,"left"),c.selectColumns(0,f.columnIndex,"center")):"left"===e.side&&"right"===f.side?(c.selectColumns(e.columnIndex,d.leftColumns.length,"left"),c.selectColumns(0,d.columns.length,"center"),c.selectColumns(0,f.columnIndex,"right")):"right"===e.side&&"center"===f.side?(c.clearSelection("left"),c.selectColumns(0,e.columnIndex,"right"),c.selectColumns(f.columnIndex,d.columns.length,"center")):"right"===e.side&&"left"===f.side&&(c.selectColumns(0,e.columnIndex,"right"),c.selectColumns(0,d.columns.length,"center"),c.selectColumns(f.columnIndex,d.leftColumns.length,"left"))}},onRowEnterSelection:function(a,b){var c=this,d=c.widget;if(!d.startResizing&&!1!==c.enabled&&c.rows&&!0===c.isMouseDown){var e=c.startRowSelection,f=b.rowIndex,g={};e>f&&(e=b.rowIndex,f=c.startRowSelection);for(var h=e,i=f+1;h<i;h++)g[h]=!0;var j=c.getSelectedRowByColumn(b.columnIndex,b.side),k={},l={};for(var m in g)!0!==j[m]&&(k[m]=!0);for(var m in j)!0!==g[m]&&(l[m]=!0);for(var m in k)c.domSelectRow(m),c.checkboxRow&&c.selectCheckBox(m);for(var m in l)c.domDeSelectRow(m),c.checkboxRow&&c.deSelectCheckBox(m);d.fire("select")}},getSelectedRowByColumn:function(a,b){var c,d=this.widget;switch(b){case"left":c=d.leftBody;break;case"center":c=d.body;break;case"right":c=d.rightBody}var g=c.el.select("."+f+'[index="'+a+'"][grid="'+d.id+'"]'),h=g.select("."+e),i={};return h.each(function(a){i[Number(a.attr("index"))]=!0}),i},getSelectedRow:function(){var a=this.widget,b=a.body,c=b.el.select("."+e);return 0===c.length?-1:Number(c.item(0).attr("index"))},getSelectedRows:function(){var a=this.widget,b=a.body,c=b.el.select("."+f+'[index="0"][grid="'+a.id+'"]'),d=c.select("."+e),g=[];return d.each(function(a){g.push(Number(a.attr("index")))}),g},initColumnSelection:function(){var a=this,b=a.widget;a.selectedColumns=[],b.on("columnclick",a.onColumnClick,a),b.on("columnmousedown",a.onColumnMouseDown,a),b.on("columnenter",a.onColumnEnterSelection,a)},onColumnClick:function(b,c){var d=this;if(d.column&&!1!==c.column.selectable){var e=a.get(c.columnDom);d.column&&(d.selectedColumns[0]=c),d.clearSelection(),e.addCls(i)}},onRowClick:function(c,d){var f=this,g=f.widget,h=d.rowIndex;if(f.row&&!1!==d&&(!f.checkOnly||"$selected"===d.column.index)){var i=d.column,j=!0;"action"===i.type&&i.items&&a.each(i.items,function(a){"remove"===a.action&&(j=!1)}),f.clearSelection();var k=g.getDomRow(h);if("$selected"===d.column.index){!0===a.getWidget(a.get(d.cell).select("."+b).attr("id")).get()?(f.selectCheckBox(h),a.each(k,function(b){a.get(b).addCls(e)})):f.deSelectCheckBox(h)}else j&&(a.each(k,function(b){a.get(b).addCls(e)}),f.selectCheckBox(h),g.fire("select"))}},onCellClickRows:function(c,d){var e=this,f=e.widget;if(e.rows&&e.enabled&&(!e.checkOnly||"$selected"===d.column.index)){var g=d.e,h=g.ctrlKey,i=d.rowIndex;if(h&&f.multiSelect);else if("$selected"===d.column.index){var j=a.getWidget(a.get(d.cell).select("."+b).attr("id"));!0===j.get()?e.selectCheckBox(i):e.deSelectCheckBox(i)}}},selectRow:function(b){var c=this,d=c.widget;if(!d.startResizing){if(!c.row&&!c.rows)throw new Error("[FancyGrid Error] - row selection was not enabled");c.clearSelection();var f=d.getDomRow(b);a.each(f,function(b){a.get(b).addCls(e)}),d.fire("select")}},onCellClick:function(b,c){var d=this,f=d.widget;d.cell&&(d.clearSelection(),a.get(c.cell).addCls(e),f.fire("select"))},clearSelection:function(a){var b=this,c=b.widget;if(b.checkboxRow){c.body.el.select("."+f+'[index="0"] .'+e).each(function(a){var c=a.attr("index");b.deSelectCheckBox(c)}),b.memory&&b.memory.clearAll()}if(a)switch(a){case"left":c.leftBody.el.select("."+e).removeCls(e),c.leftBody.el.select("."+i).removeCls(i),c.leftBody.el.select("."+d).removeCls(d);break;case"center":c.body.el.select("."+e).removeCls(e),c.body.el.select("."+i).removeCls(i),c.body.el.select("."+d).removeCls(d);break;case"right":c.rightBody.el.select("."+e).removeCls(e),c.rightBody.el.select("."+i).removeCls(i),c.rightBody.el.select("."+d).removeCls(d)}else c.el.select("."+e).removeCls(e),c.el.select("."+i).removeCls(i),c.el.select("."+d).removeCls(d);c.fire("clearselect")},onSort:function(){this.memory||this.clearSelection()},onCellEnterSelection:function(a,b){var c=this,d=c.widget,e=0;if(c.cells&&!0===c.isMouseDown){c.prevCellsSelection=b.cell,c.prevCellRowIndex=b.rowIndex,c.prevCellColumnIndex=b.columnIndex,c.prevCellSide=b.side;var f={rowIndex:c.startCellRowIndex,columnIndex:c.startCellColumnIndex,side:c.startCellSide},g={rowIndex:b.rowIndex,columnIndex:b.columnIndex,side:b.side};b.rowIndex<c.startCellRowIndex&&(f.rowIndex=b.rowIndex,g.rowIndex=c.startCellRowIndex),c.startCellSide===b.side?(b.columnIndex<c.startCellColumnIndex&&(f.columnIndex=b.columnIndex,g.columnIndex=c.startCellColumnIndex),e=c.selectCells(f,g,f.side),"left"===c.startCellSide?(c.clearSelection("center"),c.clearSelection("right")):"center"===c.startCellSide?(c.clearSelection("left"),c.clearSelection("right")):"right"===c.startCellSide&&(c.clearSelection("left"),c.clearSelection("center"))):"left"===c.startCellSide?(e=c.selectCells(f,{rowIndex:b.rowIndex,columnIndex:d.leftColumns.length-1},"left"),"center"===b.side?(e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},g,"center"),c.clearSelection("right")):"right"===b.side&&(e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},{columnIndex:d.columns.length-1,rowIndex:g.rowIndex},"center"),e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},g,"right"))):"center"===c.startCellSide?"left"===b.side?(e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},{rowIndex:g.rowIndex,columnIndex:f.columnIndex},"center"),e+=c.selectCells({columnIndex:g.columnIndex,rowIndex:f.rowIndex},{rowIndex:g.rowIndex,columnIndex:d.leftColumns.length-1},"left")):"right"===b.side&&(e+=c.selectCells({columnIndex:f.columnIndex,rowIndex:f.rowIndex},{columnIndex:d.columns.length-1,rowIndex:g.rowIndex},"center"),e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},{columnIndex:g.columnIndex,rowIndex:g.rowIndex},"right")):"right"===c.startCellSide&&(e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},{columnIndex:f.columnIndex,rowIndex:g.rowIndex},"right"),"center"===b.side?(e+=c.selectCells({columnIndex:g.columnIndex,rowIndex:f.rowIndex},{columnIndex:d.columns.length-1,rowIndex:g.rowIndex},"center"),c.clearSelection("left")):"left"===b.side&&(e+=c.selectCells({columnIndex:0,rowIndex:f.rowIndex},{columnIndex:d.columns.length-1,rowIndex:g.rowIndex},"center"),e+=c.selectCells({columnIndex:g.columnIndex,rowIndex:f.rowIndex},{columnIndex:d.leftColumns.length-1,rowIndex:g.rowIndex},"left"))),c.endCellRowIndex=g.rowIndex,d.fire("select")}},onColumnMouseDown:function(b,c){var d=this,e=d.widget;if(d.columns&&!1!==c.column.selectable&&d.enabled){var f=a.get(c.columnDom);d.isMouseDown=!0,d.startColumnColumnIndex=c.columnIndex,d.startColumnSide=c.side,d.clearSelection(),f.addCls(i),a.$(document).one("mouseup",function(){delete d.isMouseDown}),e.fire("select")}},onCellMouseDownCells:function(b,c){var d=this,f=d.widget;if(f.celledit&&f.celledit.hideEditor(),d.cells&&d.enabled){var g=a.get(c.cell);d.clearSelection(),g.addCls(e),d.isMouseDown=!0,d.startCellSelection=c.cell,d.startCellRowIndex=c.rowIndex,d.startCellColumnIndex=c.columnIndex,d.startCellSide=c.side,a.$(document).one("mouseup",function(){delete d.isMouseDown,delete d.startCellSelection}),f.fire("select")}},selectCells:function(a,b,c){var d,f,g,h=this,i=h.widget,j=i.body,k=i.leftBody,l=i.rightBody,m=a.rowIndex,n=b.rowIndex+1,o=h.getSelectedCells(c||"center"),p={},q={},r={};for(m=a.rowIndex,n=b.rowIndex+1;m<n;m++)for(p[m]=p[m]||{},f=a.columnIndex,g=b.columnIndex+1;f<g;f++)p[m][f]=!0;for(var s in p)if(void 0===o[s])q[s]=p[s];else for(var t in p[s])!0!==o[s][t]&&(q[s]=q[s]||{},q[s][t]=!0);for(var s in o)if(void 0===p[s])r[s]=o[s];else for(var t in o[s])!0!==p[s][t]&&(r[s]=r[s]||{},r[s][t]=!0);switch(c){case"left":d=k;break;case"center":d=j;break;case"right":d=l;break;default:d=j}for(var s in q)for(var t in q[s]){var u=d.getCell(s,t);u.addCls(e)}for(var s in r)for(var t in r[s]){var u=d.getCell(s,t);u.removeCls(e)}},getSelectedCells:function(a){for(var b=this,c=b.widget,d=c.getBody(a||"center"),f=d.el.select("."+e),g={},h=0,i=f.length;h<i;h++){var j=f.item(h),k=Number(j.parent().attr("index")),l=Number(j.attr("index"));g[l]=g[l]||{},g[l][k]=!0}return g},getNumberSelectedCells:function(){return this.widget.el.select("."+e).length},getSelectedColumns:function(a){for(var b=this.widget,c=b.getBody(a),d={},e=c.el.select("."+i),f=0,g=e.length;f<g;f++)d[e.item(f).attr("index")]=!0;return d},selectColumns:function(a,b,c){var d=this,e=d.getSelectedColumns(c||"center"),f={},g={},h={},i=a,j=b;for(j<i&&(i=b,j=a),j++;i<j;i++)f[i]=!0;for(var k in f)!0!==e[k]&&(g[k]=!0);for(var k in e)!0!==f[k]&&(h[k]=!0);for(var k in g)d.selectColumn(k,c);for(var k in h)d.deselectColumn(k,c)},selectColumn:function(b,c){var d=this.widget,e=d.getBody(c||"center");a.get(e.getDomColumn(b)).addCls(i)},deselectColumn:function(b,c){var d=this.widget,e=d.getBody(c||"center");a.get(e.getDomColumn(b)).removeCls(i)},getSelection:function(a){var b=this,c=b.widget,d=c.store,e={};switch(b.selModel){case"row":e.row=b.getSelectedRow(),-1!==e.row?(e.items=[d.get(e.row)],e.rows=[e.row]):(e.items=[],e.rows=[]);break;case"rows":if(e.rows=b.getSelectedRows(),b.memory&&b.memory.all)e.items=d.data;else if(e.items=[],b.memory&&!Fancy.Object.isEmpty(b.memory.selected)){var f=b.memory.selected;for(var g in f)e.items.push(d.getById(g))}else for(var h=0,i=e.rows.length;h<i;h++)e.items.push(d.get(e.rows[h]))}return a?e:e.items},renderHeaderCheckBox:function(){var a=this,b=this.widget;a._renderHeaderCheckBox(b.leftHeader,b.leftColumns),a._renderHeaderCheckBox(b.header,b.columns),a._renderHeaderCheckBox(b.rightHeader,b.rightColumns)},_renderHeaderCheckBox:function(b,c){var d=this,e=d.memory;a.each(c,function(c,f){if("$selected"===c.index){var g=b.getCell(f).firstChild();c.headerCheckBox=new a.CheckBox({renderTo:g.dom,renderId:!0,value:!1,label:!1,style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){b?(d.selectAll(),e&&e.setAll()):(d.deSelectAll(),e&&e.clearAll())}}]})}})},selectAll:function(){for(var d=this,e=d.widget,f=e.el.select("."+k+" ."+b),g=0,i=e.getViewTotal();g<i;g++){for(var j=e.el.select("."+h+" ."+c+'[index="'+g+'"] .'+b),l=0,m=j.length;l<m;l++){a.getWidget(j.item(l).attr("id")).setValue(!0)}d.domSelectRow(g)}f.each(function(b){a.getWidget(b.attr("id")).setValue(!0,!1)})},deSelectAll:function(){for(var d=this,e=d.widget,f=0,g=e.getViewTotal();f<g;f++){e.el.select("."+h+" ."+c+'[index="'+f+'"] .'+b).each(function(b){a.getWidget(b.attr("id")).setValue(!1)}),d.domDeSelectRow(f)}d.clearHeaderCheckBox()},clearHeaderCheckBox:function(){this.widget.el.select("."+k+" ."+b).each(function(b){a.getWidget(b.attr("id")).setValue(!1,!1)})},stopSelection:function(){this.enabled=!1},enableSelection:function(a){if(void 0!==a)return void(this.enabled=a);this.enabled=!0},initFixTrackOver:function(){var a=this,b=a.widget;b.columns&&(b.body.el.on("mouseleave",a.onBodyMouseLeave,a),b.body.el.on("mouseenter",a.onBodyMouseEnter,a)),b.leftColumns&&(b.leftBody.el.on("mouseleave",a.onLeftBodyMouseLeave,a),b.leftBody.el.on("mouseenter",a.onLeftBodyMouseEnter,a)),b.rightColumns&&(b.rightBody.el.on("mouseleave",a.onRightBodyMouseLeave,a),b.rightBody.el.on("mouseenter",a.onRightBodyMouseEnter,a))},onBodyMouseLeave:function(){var a=this,b=a.widget;a.clearBodyTrackCls(b.body)},onBodyMouseEnter:function(){var a=this;a.rowTrackFixInBody=!0,setTimeout(function(){a.rowTrackFixInBody=!1},30)},onLeftBodyMouseLeave:function(){var a=this,b=a.widget;a.clearBodyTrackCls(b.leftBody)},onLeftBodyMouseEnter:function(){var a=this;a.rowTrackFixInBody=!0,setTimeout(function(){a.rowTrackFixInBody=!1},30)},onRightBodyMouseLeave:function(){var a=this,b=a.widget;a.clearBodyTrackCls(b.rightBody)},onRightBodyMouseEnter:function(){var a=this;a.rowTrackFixInBody=!0,setTimeout(function(){a.rowTrackFixInBody=!1},30)},clearBodyTrackCls:function(a){var b=this,c=b.widget;c.cellTrackOver&&a.el.select("."+d).removeCls(d),c.trackOver&&(delete a.prevCellOver,b.rowTrackFixInterval&&(clearInterval(b.rowTrackFixInterval),delete b.rowTrackFixInterval),b.rowTrackFixInterval=setTimeout(function(){b.rowTrackFixInBody||c.el.select("."+j).removeCls(j)},20))},onColumnDrag:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();b=c.getSelection(!0),a.each(b,function(a){d.selectRow(a)})},onColumnLock:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();b=c.getSelection(!0),a.each(b,function(a){d.selectRow(a)})},onColumnRightLock:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();b=c.getSelection(!0),a.each(b,function(a){d.selectRow(a)})},onUnColumnLock:function(){var b,c=this,d=c.widget;if(c.cells||c.cell||c.column||c.columns)return void c.clearSelection();b=c.getSelection(!0),a.each(b,function(a){d.selectRow(a)})}})}(),function(){var a=Fancy,b=a.get,c=a.GRID_CELL_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_ROW_EXPAND_CLS,f=a.GRID_ROW_EXPAND_OVER_CLS,g=a.GRID_ROW_EXPAND_SELECTED_CLS,h=a.GRID_ROW_OVER_CLS;a.define("Fancy.grid.plugin.Expander",{extend:a.Plugin,ptype:"grid.expander",inWidgetName:"expander",plusScroll:0,constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a._expanded={},a._expandedIds={},a.expandedGroups={},a.initTpl(),a.ons()},ons:function(){var a=this,b=a.widget,c=b.store;b.on("scroll",a.onScroll,a),b.on("beforesort",a.onBeforeSort,a),b.on("changepage",a.onChangePage,a),b.on("filter",a.onFilter,a),b.on("columnresize",a.onColumnReSize,a),b.on("rowdblclick",a.onRowDBlClick,a),b.on("rowtrackenter",a.onRowTrackOver,a),b.on("rowtrackleave",a.onRowTrackLeave,a),b.on("collapse",a.onGroupCollapse,a),b.on("expand",a.onGroupExpand,a),b.on("remove",a.onRemove,a),b.on("render",function(){b.el.on("mouseenter",a.onExpandRowMouseEnter,a,"div."+e),b.el.on("mouseleave",a.onExpandRowMouseLeave,a,"div."+e)}),b.on("select",a.onSelect,a),b.on("clearselect",a.onClearSelect,a),c.on("beforeinsert",a.onBeforeInsert,a),b.on("columndrag",a.onColumnDrag,a),b.on("lockcolumn",a.onLockColumn,a),b.on("rightlockcolumn",a.onRightLockColumn,a),b.on("unlockcolumn",a.onUnLockColumn,a),a.expanded&&(c.proxyType?b.once("load",function(){a.expandAll()}):b.on("init",function(){a.expandAll()}))},expand:function(b){var e=this,f=e.widget,g=f.get(b).id;void 0===e._expandedIds[g]?(e._expandedIds[g]={},e.expandRow(Number(b),g),e.addMargin(Number(b)+1,g)):e.showRow(Number(b),g),delete e._expandedIds[g].hidden,e.reSetTop(),e.reSetPlusScroll();for(var h=f.el.select("."+d+'[grid="'+f.id+'"] .'+c+'[index="'+b+'"] .fancy-checkbox-expander'),i=0,j=h.length;i<j;i++){var k=a.getWidget(h.item(i).attr("id"));!1===k.get()&&k.set(!0,!1)}e.changeSidesSize(),e.onSelect()},collapse:function(a){var b=this,c=b.widget,d=c.scroller,e=c.get(a).id;b.collapseRow(Number(a),e),b.clearMargin(Number(a)+1,e),b.reSetTop(),b.reSetPlusScroll(),b.changeSidesSize(),d.scrollDelta(1),d.scrollRightKnob()},collapseRow:function(b,e){var f=this,g=f.widget,h=f._expandedIds[e];h.el.hide(),h.hidden=!0,g.leftColumns&&h.leftEl.hide(),g.rightColumns&&h.rightEl.hide();for(var i=g.el.select("."+d+'[grid="'+g.id+'"] .'+c+'[index="'+b+'"] .fancy-checkbox-expander'),j=0,k=i.length;j<k;j++){var l=a.getWidget(i.item(j).attr("id"));!0===l.get()&&(l.set(!1,!1),l.collapsedTime=new Date)}},_hideAllSideExpandedRow:function(){var a=this,b=a.widget;for(var c in a._expandedIds){var d=a._expandedIds[c];d.el.hide(),d.hidden=!0,b.leftColumns&&d.leftEl.hide(),b.rightColumns&&d.rightEl.hide()}},expandAll:function(){for(var a=this.widget,b=a.getViewTotal(),c=0;c<b;c++)this.expand(c)},expandRow:function(a,c){var d,f,g=this,h=g.widget,i=b(document.createElement("div")),j=h.getById(c),k=g.prepareData(j),l=-h.scroller.scrollLeft||0,m=h.getCenterFullWidth();if(g.tpl&&(d=g.tpl.getHTML(k),i.update(d)),i.addCls(e),i.css({left:l,width:m}),i.attr("index",a),h.body.el.dom.appendChild(i.dom),g.render&&g.render(i.dom,k,h.getCenterFullWidth()),f=parseInt(i.css("height")),g._expandedIds[c].rowIndex=a,g._expandedIds[c].el=i,g._expandedIds[c].height=f,g._expandedIds[c].width=m,h.leftColumns){var n=b(document.createElement("div"));n.css("left","0px"),n.css("height",f),n.css("width",h.getLeftFullWidth()),n.attr("index",a),n.addCls(e),h.leftBody.el.dom.appendChild(n.dom),g._expandedIds[c].leftEl=n}if(h.rightColumns){var o=b(document.createElement("div"));o.css("left","0px"),o.css("height",f),o.css("width",h.getRightFullWidth()),o.attr("index",a),o.addCls(e),h.rightBody.el.dom.appendChild(o.dom),g._expandedIds[c].rightEl=o}},addMargin:function(a,b){var e=this,f=e.widget,g=e._expandedIds[b].height;f.el.select("."+d+'[grid="'+f.id+'"] .'+c+'[index="'+a+'"]').css("margin-top",g)},clearMargin:function(a){var b=this.widget;b.el.select("."+d+'[grid="'+b.id+'"] .'+c+'[index="'+a+'"]').css("margin-top","0")},onBeforeSort:function(){this.reSet()},onChangePage:function(){this.reSet()},onFilter:function(){this.reSet()},onRemove:function(){this.reSet()},reSet:function(){var a=this,b=a.widget;for(var c in a._expandedIds){var d=a._expandedIds[c];d.el.destroy(),a.clearMargin(Number(d.rowIndex)+1,c)}a._hideAllSideExpandedRow(),a._expandedIds={},a.reSetTop(),a.reSetPlusScroll(),a.changeSidesSize(),b.scroller.scrollDelta(1)},showRow:function(a,b){var c=this,d=c.widget,e=c._expandedIds[b];e.el.show(),d.leftColumns&&e.leftEl.show(),d.rightColumns&&e.rightEl.show(),c.addMargin(a+1,b)},getBeforeHeight:function(a){var b=0;for(var c in this._expandedIds){var d=this._expandedIds[c];d.rowIndex<a&&!d.hidden&&"none"!==d.el.css("display")&&(b+=d.height)}return b},reSetTop:function(a){var b=this,c=b.widget,d=c.cellHeight,e=-c.scroller.scrollTop||0,f=-c.scroller.scrollLeft||0;if(c.grouping){b.expandedGroups={};var g=c.grouping.expanded;for(var h in g)b.expandedGroups[h]=b.expandedGroups[h]||{}}for(var h in b._expandedIds){var i=b._expandedIds[h];if("none"!==i.el.css("display")){var j=b.getBeforeHeight(i.rowIndex),k=b.getDisplayedRowsBefore(i,h),l=e+k*d+j;if(c.grouping){var m=h,n=c.grouping.getGroupById(m),o=c.grouping.getGroupOrderIndex(n);"none"!==i.el.css("display")&&(b.expandedGroups[n]=b.expandedGroups[n]||{},b.expandedGroups[n][h]=i,l+=(o+1)*c.groupRowHeight)}i.el.css({top:l,left:f}),c.leftColumns&&i.leftEl.css("top",l),c.rightColumns&&i.rightEl.css("top",l)}}c.grouping&&!1!==a&&(c.grouping.setPositions(),c.grouping.setExpanderCellsPosition())},getDisplayedRowsBefore:function(a,b){var c=this.widget;if(c.grouping){var d=0;return"none"!==a.el.css("display")&&(d=c.store.getRow(b)),d+1}return a.rowIndex+1},onScroll:function(){this.reSetTop()},reSetPlusScroll:function(){var a=this,b=a.widget;a.plusScroll=a.getPlusHeight(),b.scroller.setRightKnobSize(),setTimeout(function(){!1===b.scroller.isRightScrollable()&&b.scroller.scroll(0)},1)},getPlusHeight:function(){var a=this,b=0;for(var c in a._expandedIds){var d=a._expandedIds[c];d.hidden||"none"===d.el.css("display")||(b+=d.height)}return a.plusHeight=b,a.plusHeight},onColumnReSize:function(){var a=this,b=a.widget;for(var c in a._expandedIds){var d=a._expandedIds[c],e=b.getCenterFullWidth();d.el.css("width",e)}},prepareData:function(a){var b=this,c=b.widget,d=a.data;return b.dataFn&&(d=b.dataFn(c,d)),d},changeSidesSize:function(){var a=this.widget;a.setSidesHeight(),a.scroller.checkRightScroll()},onRowDBlClick:function(a,b){var c=this,d=c.widget,e=Number(b.rowIndex),f=b.id,g=c._expandedIds[f];if(d.edit)return void d.un("rowdblclick",c.onRowDBlClick,c);void 0===g?c.expand(e):!0===g.hidden&&"none"===g.el.css("display")?c.expand(e):c.collapse(e)},onRowTrackOver:function(a,b){var c=this,d=c.widget,e=c._expandedIds[b.id];e&&(e.el.addCls(f),d.leftColumns&&e.leftEl.addCls(f),d.rightColumns&&e.rightEl.addCls(f))},onRowTrackLeave:function(a,b){var c=this,d=c.widget,e=c._expandedIds[b.id];e&&(e.el.removeCls(f),d.leftColumns&&e.leftEl.removeCls(f),d.rightColumns&&e.rightEl.removeCls(f))},onExpandRowMouseEnter:function(a){var g=this,i=g.widget,j=i.scroller,k=b(a.currentTarget),l=k.attr("index");i.el.select("."+e+'[index="'+l+'"]').addCls(f),!i.trackOver||j.bottomKnobDown||j.rightKnobDown||i.el.select("."+d+'[grid="'+i.id+'"] .'+c+'[index="'+l+'"]').addCls(h)},onExpandRowMouseLeave:function(a){var g=this,i=g.widget,j=i.scroller,k=b(a.currentTarget),l=k.attr("index");i.el.select("."+e+'[index="'+l+'"]').removeCls(f),!i.trackOver||j.bottomKnobDown||j.rightKnobDown||i.el.select("."+d+'[grid="'+i.id+'"] .'+c+'[index="'+l+'"]').removeCls(h)},onSelect:function(){var a=this,b=a.widget,c=b.selection;if(c&&(c.row||c.rows)){a.onClearSelect(),c=b.getSelection(!0);for(var d=c.rows,f=0,h=d.length;f<h;f++){var i=d[f];b.el.select("."+e+'[index="'+i+'"]').addCls(g)}}},onClearSelect:function(){var a=this,b=a.widget,c=b.selection;if(c.row||c.rows){c=b.getSelection(!0);for(var d={},f=c.rows,h=0,i=f.length;h<i;h++)d[f[h]]=!0;for(var j=b.el.select("."+g),h=0,i=j.length;h<i;h++){var k=j.item(h).attr("index");d[k]||b.el.select("."+e+'[index="'+k+'"]').removeCls(g)}}},onGroupCollapse:function(a,b,c){var d=this,e=d.widget,f=d.expandedGroups;if(f[c]){var g=f[c];for(var h in g){var i=g[h];d._expandedIds[h]&&delete d._expandedIds[h],i.el.hide(),i.leftEl.dom&&i.leftEl.hide(),i.rightEl.dom&&i.rightEl.hide()}}d.reSetTop(!1),d.reSetIndexes(),setTimeout(function(){e.grouping.setExpanderCellsPosition()},1)},onGroupExpand:function(a,b,c){var d=this,e=d.widget;d.reSetTop(!1),d.reSetIndexes(),setTimeout(function(){e.grouping.setExpanderCellsPosition()},1)},reSetIndexes:function(){var a=this,b=a.widget,c=b.store;for(var d in a._expandedIds)a._expandedIds[d].rowIndex=c.getRow(d)},onAdd:function(){this.reSet()},onBeforeInsert:function(){this.reSet()},onColumnDrag:function(){this.reSet(),this.clearExpandedCheckBoxes()},onLockColumn:function(){this.reSet(),this.clearExpandedCheckBoxes()},onRightLockColumn:function(){this.reSet(),this.clearExpandedCheckBoxes()},onUnLockColumn:function(){this.reSet(),this.clearExpandedCheckBoxes()},clearExpandedCheckBoxes:function(){this.widget.el.select(".fancy-checkbox-expander.fancy-checkbox-on").each(function(a){var b=a.attr("id");Fancy.getWidget(b).setValue(!1,!1)})}})}(),Fancy.define("Fancy.grid.plugin.GroupHeader",{extend:Fancy.Plugin,ptype:"grid.groupheader",inWidgetName:"groupheader",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){}}),function(){var a=Fancy,b=Fancy.each,c=a.GRID_ROW_GROUP_INNER_CLS,d=a.GRID_ROW_GROUP_CLS,e=a.GRID_ROW_GROUP_COLLAPSED_CLS,f=a.GRID_CELL_CLS;a.define("Fancy.grid.plugin.Grouping",{extend:a.Plugin,ptype:"grid.grouping",inWidgetName:"grouping",tpl:"{text}:{number}",_renderFirstTime:!0,constructor:function(a){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),a._expanded={},a.initTpl(),a.initGroups(),a.initOrder(),a.calcPlusScroll(),a.configParams(),a.ons(),!a.collapsed&&b.store.data&&setTimeout(function(){b.store.changeDataView({doNotFired:!0}),b.update()},100)},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.renderGroupedRows(),a.update(),b.el.on("click",a.onClick,a,"div."+d),b.el.on("mousedown",a.onMouseDown,a,"div."+d),b.on("scroll",a.onScroll,a),b.on("columnresize",a.onColumnResize,a),c.on("insert",a.onInsert,a),c.on("remove",a.onRemove,a),b.on("columndrag",a.onColumnDrag,a)})},onInsert:function(){this.reGroup()},onRemove:function(){var a=this,c=a.widget,d=c.store,e=a.groups;if(a.initGroups(),a.update(),a.updateGroupRowsText(),e.length>a.groups.length){var f;b(e,function(b,c){if(b!==a.groups[c])return f=b,!0}),delete d.expanded[f],delete a.expanded[f],delete a._expanded[f]}},initGroups:function(a){var b=this,c=b.widget,d=c.store,e=d.initGroups(a);b.groups=e.groups,b.groupsCounts=e._groups},getGroupById:function(a){return this.widget.store.groupMap[a]},getGroupOrderIndex:function(a){for(var b=this.groups,c=0,d=b.length;c<d;c++)if(b[c]===a)return c},initOrder:function(){var c,d,e=this,f=e.widget,g=f.store,h=[],i={},j=[];if(e.order&&0!==e.order.length)a.typeOf(e.order);else for(h=e.groups,c=0,d=h.length,b(h,function(a){var b=a.toLocaleUpperCase();i[b]=a,j.push(b)}),j=j.sort();c<d;c++)h[c]=i[j[c]];e.groups=h,g.changeOrderByGroups(h,e.by)},calcPlusScroll:function(){var a=this.widget;this.plusScroll=this.groups.length*a.groupRowHeight},configParams:function(){var a=this,c=a.widget,d=c.store;a.expanded=a.expanded||{},d.expanded=d.expanded||{},a.collapsed?d.collapsed=!0:b(a.groups,function(b){void 0===a.expanded[b]&&(d.expanded[b]=!0,a.expanded[b]=!0,a._expanded[b]=!0)})},renderGroupedRows:function(){var a,c=this,d=c.widget,e=d.body,f=d.leftBody,g=d.rightBody,h=d.getCenterFullWidth(),i=d.getLeftFullWidth(),j=d.getRightFullWidth(),k=0;b(c.groups,function(b){var l=c.groupsCounts[b];i?(a=c.generateGroupRow(b,l,!0,k),a.css("width",i),f.el.dom.appendChild(a.dom),a=c.generateGroupRow(b,l,!1,k),a.css("width",h),e.el.dom.appendChild(a.dom)):(a=c.generateGroupRow(b,l,!0,k),a.css("width",h),e.el.dom.appendChild(a.dom)),j&&(a=c.generateGroupRow(b,l,!1,k),a.css("width",j),g.el.dom.appendChild(a.dom)),c.collapsed&&(k+=d.groupRowHeight)})},removeGroupRows:function(){var a=this,b=a.widget,c=b.columns,e=b.leftColumns,f=b.rightColumns,g=b.body,h=b.leftBody,i=b.rightBody;c.length&&g.el.select("."+d).remove(),e.length&&h.el.select("."+d).remove(),f.length&&i.el.select("."+d).remove()},removeLastGroupRow:function(){var a=this,b=a.widget,c=b.columns,e=a.groups,f=e.length,g=b.leftColumns,h=b.rightColumns,i=b.body,j=b.leftBody,k=b.rightBody;if(c.length){i.el.select("."+d).item(f).remove()}g.length&&j.el.select("."+d).item(f).remove(),h.length&&k.el.select("."+d).item(f).remove()},removeCells:function(){var a=this,b=a.widget,c=b.columns,d=b.leftColumns,e=b.rightColumns,g=b.body,h=b.leftBody,i=b.rightBody;c.length&&g.el.select("."+f).remove(),d.length&&h.el.select("."+f).remove(),e.length&&i.el.select("."+f).remove()},generateGroupRow:function(b,f,g,h){var i=this,j=a.get(document.createElement("div"));if(j.addCls(d),j.attr("group",b),g){var k=i.tpl.getHTML({text:b,number:f});j.update('<div class="'+c+'"> '+k+"</div>")}return i.collapsed?(j.css("top",h+"px"),j.addCls(e)):j.css("top","0px"),j},insertGroupEls:function(){var a=this,b=a.widget,e=b.leftBody,f=b.body;b.leftColumns.length?e.el.select("."+d).each(function(b){var d=a.groups[i];b.update('<div class="'+c+'">'+d+"</div>")}):f.el.select("."+d).each(function(b,d){var e=a.groups[d],f=a.groupsCounts[e],g=a.tpl.getHTML({text:e,number:f});b.update('<div class="'+c+'">'+g+"</div>")})},onClick:function(b){var c,f=this,g=f.widget,h=a.get(b.currentTarget),i=h.attr("group");g.el.select("."+d+'[group="'+i+'"]').toggleCls(e),c=h.hasCls(e),c?f.collapse(f.by,i):f.expand(f.by,i),f.update()},fastCollapse:function(){},onMouseDown:function(a){a.preventDefault()},onScroll:function(){this.setPositions()},collapse:function(a,b){var c=this,d=c.widget;d.store.collapse(a,b),delete c._expanded[b],delete c.expanded[b],d.fire("collapse",a,b)},expand:function(a,b){var c=this,d=c.widget;d.store.expand(a,b),c._expanded[b]=!0,c.expanded[b]=!0,d.fire("expand",a,b)},setPositions:function(){var a=this,c=a.widget,e=-c.scroller.scrollTop||0,f=c.leftBody.el.select("."+d),g=c.body.el.select("."+d),h=c.rightBody.el.select("."+d);b(a.groups,function(b,d){if(f.length&&f.item(d).css("top",e+"px"),g.length&&g.item(d).css("top",e+"px"),h.length&&h.item(d).css("top",e+"px"),c.expander){var i=c.expander.expandedGroups[b];for(var j in i){var k=i[j];e+=parseInt(k.el.css("height"))}}e+=c.groupRowHeight,!0===a._expanded[b]&&(e+=a.groupsCounts[b]*c.cellHeight)})},setCellsPosition:function(a,c){for(var d,e,f=this,g=f.widget,h=0,i=f.groups.length,j=0,k=g.body,l=g.leftBody,m=g.rightBody,n=0,o=g.groupRowHeight,p=[],q={},r={},s=f.by;h<i;h++){var t=f.groups[h];if(!0===f._expanded[t]){if(p.push(n),q[n]=!0,void 0===c||"center"===c)if(j=0,d=g.columns.length,void 0!==a&&(j=a,d=a+1),g.expander){var u=g.get(n),v=u.get(s),w=g.expander.expandedGroups,x=f.getGroupOrderIndex(t),y=0;for(var z in w){var A=f.getGroupOrderIndex(z);if(!(x<=A)){var B=w[z];for(var C in B){var D=B[C];if("none"!==D.el.css("display")&&!r[C]){var E=n-1;n<0&&(n=0),E=g.get(E);var F=E.get(s);v!==F?E.id===C&&(r[C]=!0,y+=parseInt(D.el.css("height"))):(r[C]=!0,y+=parseInt(D.el.css("height")))}}}}for(o+=y,e=k.getCell(n,j);j<d;j++)e=k.getCell(n,j),e.css("margin-top",o+"px")}else for(;j<d;j++)e=k.getCell(n,j),e.css("margin-top",o+"px");if(void 0===c||"left"===c)for(j=0,d=g.leftColumns.length,void 0!==a&&(j=a,d=a+1);j<d;j++)e=l.getCell(n,j),e.css("margin-top",o+"px");if(void 0===c||"right"===c)for(j=0,d=g.rightColumns.length,void 0!==a&&(j=a,d=a+1);j<d;j++)e=m.getCell(n,j),e.css("margin-top",o+"px");n+=f.groupsCounts[t],o=g.groupRowHeight}else o+=g.groupRowHeight}if(f._renderFirstTime)f._renderFirstTime=!1;else{var G=[];b(f.prevRows,function(a){!0!==q[a]&&G.push(a)}),f.clearMargins(G)}f.prevRows=p},setExpanderCellsPosition:function(){var a,c,d=this,e=d.widget,f=e.store,g=f.dataView,h=e.body,i=e.leftBody,j=e.rightBody,k=e.expander.expandedGroups,l=d.groupsCounts,m=e.groupRowHeight,n=0,o=0;b(d.groups,function(f){if(!0===d._expanded[f]){for(var p=n+l[f];n<p;n++)if(c=g[n]){var q=c.id,r=k[f][q];o&&(m+=o,o=0),r&&(o=parseInt(r.el.css("height"))),b(e.columns,function(b,c){a=h.getCell(n,c),a.css("margin-top",m+"px")}),b(e.leftColumns,function(b,c){a=i.getCell(n,c),a.css("margin-top",m+"px")}),b(e.rightColumns,function(b,c){a=j.getCell(n,c),a.css("margin-top",m+"px")}),m=0}m=e.groupRowHeight}else m+=e.groupRowHeight})},clearMargins:function(a){var c=this,a=a||c.prevRows;if(void 0!==a){var d,e=c.widget,f=e.body,g=e.leftBody,h=e.rightBody;b(a,function(a){b(e.columns,function(b,c){if(d=f.getCell(a,c),void 0===d.dom)return!0;d.css("margin-top","0px")}),b(e.leftColumns,function(b,c){if(d=g.getCell(a,c),void 0===d.dom)return!0;d.css("margin-top","0px")}),b(e.rightColumns,function(b,c){if(d=h.getCell(a,c),void 0===d.dom)return!0;d.css("margin-top","0px")})})}},onColumnResize:function(){this.updateGroupRows()},updateGroupRows:function(){var a=this,b=a.widget,c=b.leftColumns,e=b.rightColumns,f=b.body,g=b.leftBody,h=b.rightBody,i=0;i+=b.getCenterFullWidth(),f.el.select("."+d).css("width",i+"px"),i+=b.getLeftFullWidth(),c.length&&g.el.select("."+d).css("width",i+"px"),i+=b.getRightFullWidth(),e.length&&h.el.select("."+d).css("width",i+"px")},update:function(a){var b=this,c=b.widget,d=c.store;a||!0!==d.loading&&!1!==d.autoLoad||d.data.length?a&&d.data.length&&d.loadedTimes>1?b.reGroup():(b.setPositions(),c.update(),c.scroller.update(),b.setCellsPosition(),c.setSidesHeight()):d.on("load",function(){b.initGroups(),b.initOrder(),b.calcPlusScroll(),b.configParams(),d.changeDataView({doNotFired:!0}),b.renderGroupedRows(),b.update(!0)},b)},getOffsetForRow:function(a){var c=this,d=c.widget,e=0,f=0;return b(c.groups,function(b){if(e+=d.groupRowHeight,!0===c._expanded[b]&&(f+=c.groupsCounts[b]),a<f)return!0}),e},getSpecialRowsUnder:function(a){var c=this,d=c.widget,e=0,f=0,g=0;return b(c.groups,function(b){a<f&&g++,e+=d.groupRowHeight,!0===c._expanded[b]&&(f+=c.groupsCounts[b])}),g},reGroup:function(){var a=this,b=a.widget,c=b.store,d="data";a.expanded={},a._expanded={},b.store.expanded={},b.store.dataView=[],a.collapsed=!0,b.store.filteredData&&(d="filteredData"),a.removeGroupRows(),a.removeCells(),a.initGroups(d),c.remoteFilter&&a.initOrder(),a.calcPlusScroll(),a.configParams(),a.renderGroupedRows(),b.setSidesHeight()},scrollLeft:function(a){this.widget.body.el.select("."+d).css("left",a)},updateGroupRowsText:function(){var a=this,f=a.widget,g=a.groups,h=f.leftBody,i=f.body,j=f.rightBody,k=h.el.select("."+c),l=i.el.select("."+c),m=h.el.select("."+d),n=i.el.select("."+d),o=j.el.select("."+d);b(g,function(b,c){var d,g=a.groupsCounts[b],h=a.tpl.getHTML({text:b,number:g});f.leftColumns.length?(k.item(c).update(h),d=m.item(c),d.attr("group",b),a.expanded[b]?d.removeClass(e):d.addClass(e)):(l.item(c).update(h),d=n.item(c),a.expanded[b]?d.removeClass(e):d.addClass(e)),n.item(c).attr("group",b),f.rightColumns.length&&o.item(c).attr("group",b)}),g.length<i.el.select("."+d).length&&setTimeout(function(){a.removeLastGroupRow()},10)},onColumnDrag:function(){var a=this,b=a.widget,c=b.el.select("."+d),f=b.el.select("."+d+":not(."+e+")"),g={};if(f.each(function(a){g[a.attr("group")]=!0}),!b.leftColumns.length&&c.length){c.destroy(),a.renderGroupedRows(),a.update();for(var h in g){b.el.select("."+d+'[group="'+h+'"]').removeCls(e)}}}})}(),function(){var a=Fancy,b=a.get(document),c=a.HIDDEN_CLS,d=a.GRID_HEADER_CELL_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,j=a.GRID_STATE_DRAG_COLUMN_CLS;a.define("Fancy.grid.plugin.ColumnDrag",{extend:a.Plugin,ptype:"grid.columndrag",inWidgetName:"columndrag",activeSide:void 0,activeCell:void 0,activeIndex:void 0,activeColumn:void 0,inCell:void 0,inIndex:void 0,inSide:void 0,ok:!1,status:"none",constructor:function(a){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.ons(),a.initHint()})},ons:function(){var a=this;a.widget.el.on("mousedown",a.onMouseDownCell,a,"div."+d)},onMouseDownCell:function(c){var e=this,j=e.widget,k=Fancy.get(c.currentTarget),l=Number(k.attr("index")),m=e.getSideByCell(k),n=j.getColumns(m),o=n[l],p=a.get(c.target);p.hasCls(f)||p.hasCls(g)||(k.hasCls(i)&&(e.activeCellTopGroup=e.getGroupStartEnd(k,m),e.activeCellTopGroup.cell=k),j.startResizing||(e.activeCellTopGroup||!1!==o.draggable)&&(k.hasCls(h)&&(e.activeUnderGroup=!0),e.activeSide=m,e.inSide=m,e.activeCell=k,e.inCell=k,e.activeIndex=Number(k.attr("index")),e.inIndex=e.activeIndex,e.activeColumn=n[e.activeIndex],e.mouseDownX=c.pageX,e.mouseDownY=c.pageY,b.once("mouseup",e.onMouseUp,e),b.on("mousemove",e.onMouseMove,e),j.el.on("mouseleave",e.onMouseLeave,e),j.el.on("mouseenter",e.onMouseEnterCell,e,"div."+d),j.el.on("mousemove",e.onMouseMoveCell,e,"div."+d)))},onMouseLeave:function(){this.hideHint()},onMouseUp:function(){var c=this,e=c.widget,f=!1;if(b.un("mousemove",c.onMouseMove,c),e.el.un("mouseleave",c.onMouseLeave,c),e.el.un("mouseenter",c.onMouseEnterCell,c,"div."+d),e.el.un("mousemove",c.onMouseMoveCell,c,"div."+d),c.ok){if(c.inSide===c.activeSide)c.dragColumn(c.inSide);else if("center"===c.activeSide){var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}else{var g=c.inIndex;"right"===c.okPosition&&g++,e.moveColumn(c.activeSide,c.inSide,c.activeIndex,g,c.activeCellTopGroup)}f=!0}delete c.inUpGroupCell,delete c.inUnderGroup,delete c.activeCellTopGroup,delete c.activeUnderGroup,delete c.activeSide,delete c.activeCell,delete c.activeIndex,delete c.activeIndex,delete c.activeColumn,delete c.mouseDownX,delete c.mouseDownY,c.ok=!1,delete c.okPosition,a.tip.hide(),c.removeDragState(),"dragging"===c.status&&setTimeout(function(){c.status="none",f&&(e.fire("columndrag"),e.scroller.update())},10),c.hideHint()},onMouseMove:function(b){var c=this,d=c.widget,h=d.header,i=d.leftHeader,j=d.rightHeader,k=b.pageX,l=b.pageY,m=d.getColumns(c.activeSide),n=a.get(b.target);if(!n.hasCls(f)&&!n.hasCls(g)&&(Math.abs(k-c.mouseDownX)>10||Math.abs(l-c.mouseDownY))){if(c.activeCellTopGroup?(a.tip.update(c.activeCellTopGroup.cell.select("."+e).item(0).dom.innerHTML||"&nbsp;"),c.addDragState()):(a.tip.update(c.activeColumn.title||"&nbsp;"),c.addDragState()),1===m.length&&"center"===c.activeSide)return a.tip.hide(),void c.removeDragState();a.tip.show(b.pageX+15,b.pageY+15),h.hideMenu&&(h.hideMenu(),d.leftColumns&&i.hideMenu()&&i.hideMenu(),d.rightColumns&&j.hideMenu()&&j.hideMenu())}},addDragState:function(){this.widget.el.addClass(j)},removeDragState:function(){this.widget.el.removeClass(j)},onMouseEnterCell:function(a){var b=this,c=Fancy.get(a.currentTarget),d=b.getSideByCell(c);b.hideHint(),c.hasCls(h)?b.inUnderGroup=!0:delete b.inUnderGroup,c.hasCls(i)?b.inUpGroupCell=c:delete b.inUpGroupCell,b.inSide=d,b.inCell=c,b.inIndex=Number(c.attr("index"))},onMouseMoveCell:function(a){var b=this,c=b.widget,d=b.inCell,e=parseInt(d.css("width")),g=d.select("."+f),h=Fancy.get(a.target),i=g.within(h)||h.hasClass(f),j=b.activeUnderGroup!==b.inUnderGroup&&!0===b.inUnderGroup,k=b.activeUnderGroup!==b.inUnderGroup&&!0===b.activeUnderGroup;if(1===c.getColumns(b.activeSide).length&&"center"===b.activeSide)return b.ok=!1,void b.hideHint();if(b.activeCellTopGroup)if(b.inUpGroupCell);else{var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end;b.activeSide!==b.inSide?(b.ok=!0,b.status="dragging",a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):isNaN(b.inIndex)?b.hideHint():b.inIndex<l?a.offsetX>e/2?b.inIndex+1===l?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("right")):(b.ok=!0,b.status="dragging",b.showHint("left")):b.inIndex>m?a.offsetX<e/2?b.inIndex===m+1?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("left")):(b.ok=!0,b.status="dragging",b.showHint("right")):b.hideHint()}else if(b.inUpGroupCell){var n=b.getGroupStartEnd(),l=n.start,m=n.end;b.activeSide!==b.inSide?(b.ok=!0,b.status="dragging",a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):a.offsetX>e/2?b.activeIndex>m&&b.activeIndex-1===m?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("right")):b.activeIndex<l&&b.activeIndex+1===l?b.hideHint():(b.ok=!0,b.status="dragging",b.showHint("left"))}else b.activeSide!==b.inSide?(b.ok=!0,b.status="dragging",a.offsetX>e/2||i?b.showHint("right"):b.showHint("left")):b.activeIndex===b.inIndex?b.ok=!1:b.activeIndex<b.inIndex?a.offsetX>e/2||i?(b.ok=!0,b.status="dragging",b.showHint("right")):a.offsetX<e/2&&b.activeIndex+1!==b.inIndex?(b.ok=!0,b.status="dragging",b.showHint("left")):b.activeIndex+1===b.inIndex&&(j||k)?(b.ok=!0,b.status="dragging",b.showHint("left")):(b.ok=!1,b.hideHint()):b.activeIndex>b.inIndex&&(a.offsetX<e/2?i?j||k?(b.ok=!0,b.status="dragging",b.showHint("right")):b.activeIndex-1===b.inIndex||b.inUpGroupCell?(b.ok=!1,b.hideHint()):(b.ok=!0,b.status="dragging",b.showHint("right")):(b.ok=!0,b.status="dragging",b.showHint("left")):a.offsetX>e/2?b.activeIndex-1===b.inIndex&&(j||k)?(b.ok=!0,b.status="dragging",b.showHint("right")):b.activeIndex-1!==b.inIndex||b.activeUnderGroup?(b.ok=!0,b.status="dragging",b.showHint("right")):(b.ok=!1,b.hideHint()):(b.ok=!1,b.hideHint()))},showHint:function(a){var b=this,d=b.widget,e=d.cellHeaderHeight,f=b.inCell,g=b.topEl,h=b.bottomEl,i=f.offset(),j=parseInt(f.css("width")),k=parseInt(f.css("height"));b.okPosition=a,g.removeCls(c),h.removeCls(c);var l=0;"right"===a&&(l+=j),g.css({left:i.left+l-Math.ceil(parseInt(g.css("width"))/2),top:i.top-parseInt(g.css("height"))});var m=i.top+k;if(b.inUpGroupCell){var n=d.header.calcRows();m=i.top+n*e}h.css({left:i.left+l-Math.ceil(parseInt(h.css("width"))/2),top:m})},hideHint:function(){var a=this;a.topEl.addCls(c),a.bottomEl.addCls(c)},initHint:function(){var b=this,d=b.widget,e="fancy-theme-"+d.theme,f=a.get(document.body).dom,g=a.get(document.createElement("div")),h=a.get(document.createElement("div"));g.addCls("fancy-drag-hint-top",c,e),h.addCls("fancy-drag-hint-bottom",c,e),b.topEl=a.get(f.appendChild(g.dom)),b.bottomEl=a.get(f.appendChild(h.dom))},dragColumn:function(a){var b=this,c=b.widget,d=c.getHeader(a),e=c.getBody(a),f=b.activeIndex,g=b.inIndex,h=b.okPosition,i=c.getColumns(a),j=i[f],k=d.calcRows();if(b.activeCellTopGroup){var l=b.activeCellTopGroup.start,m=b.activeCellTopGroup.end,n=i.splice(l,m-l+1),g=b.inIndex;"right"===h&&g++,i=b.inIndex<l?Fancy.Array.insert(i,g,n):Fancy.Array.insert(i,g-n.length,n),c.setColumns(i,a)}else if(b.inUpGroupCell){var o=b.getGroupStartEnd();g=o.start,"right"===h&&(g=o.end+1)}else if("right"===h)if(b.inUnderGroup){var p=i[g].grouping,q=i[g+1];q&&q.grouping===p&&g++}else g++;if(c.groupheader&&!b.activeCellTopGroup){var r=i[g];r&&r.grouping&&b.inUnderGroup?(j.grouping=r.grouping,j.filter&&j.filter.header&&k<3&&delete j.filter):delete j.grouping}b.activeCellTopGroup||(i.splice(f,1),f<g&&g--,i.splice(g,0,j)),e.clearColumnsStyles(),d.updateTitles(),d.updateCellsSizes(),c.groupheader&&(c.header.fixGroupHeaderSizing(),c.leftColumns&&c.leftHeader.fixGroupHeaderSizing(),c.rightColumns&&c.rightHeader.fixGroupHeaderSizing(),d.reSetGroupIndexes()),d.reSetColumnsAlign(),d.reSetColumnsCls(),e.reSetColumnsAlign(),e.reSetColumnsCls(),e.updateColumnsSizes(),c.update()},getSideByCell:function(a){var b,c=this,d=c.widget;return d.centerEl.within(a)?b="center":d.leftEl.within(a)?b="left":d.rightEl.within(a)&&(b="right"),b},getGroupStartEnd:function(b,c){var d=this,e=d.widget,f=e.getHeader(c||d.inSide),g=(b||d.inUpGroupCell).attr("index"),h=f.el.select('[group-index="'+g+'"]'),i=[];return h.each(function(a){i.push(Number(a.attr("index")))}),{start:a.Array.min(i),end:a.Array.max(i)}}})}(),function(){var a=Fancy,b=Fancy.GRID_CELL_CLS,c=Fancy.GRID_CELL_INNER_CLS,d=Fancy.GRID_ROW_SUMMARY_CLS,e=Fancy.GRID_ROW_SUMMARY_CONTAINER_CLS,f=Fancy.GRID_ROW_SUMMARY_BOTTOM_CLS,g=a.GRID_COLUMN_SPARKLINE_CLS,h=a.GRID_COLUMN_SPARKLINE_BULLET_CLS,i=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,j=a.GRID_COLUMN_GROSSLOSS_CLS,k=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.Summary",{extend:a.Plugin,ptype:"grid.summary",inWidgetName:"summary",position:"top",sumDisplayed:!0,topOffSet:0,bottomOffSet:0,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.calcOffSets()}),b.once("init",function(){a.render(),a.update(),b.on("update",function(){a.update()}),b.on("set",function(){a.update()})}),b.on("columnresize",a.onColumnResize,a),a.sumDisplayed&&b.on("changepage",a.onChangePage,a),b.on("columndrag",a.onColumnDrag,a)},render:function(){var a,b=this,c=b.widget,d=c.body,e=c.leftBody,f=c.rightBody,g=c.getCenterFullWidth(),h=c.getLeftFullWidth(),i=c.getRightFullWidth(),j="top"===b.position?"before":"after";a=b.generateRow("center"),a.css("width",c.startWidths.center),a.firstChild().css("width",g),a.css("height",c.cellHeight),a.firstChild().css("height",c.cellHeight),b.el=a,d.el[j](a.dom),h&&(a=b.generateRow("left"),a.css("width",h-2),a.firstChild().css("width",h),a.css("height",c.cellHeight),b.leftEl=a,e.el[j](a.dom)),i&&(a=b.generateRow("right"),a.css("width",i-1),a.firstChild().css("width",i),a.css("height",c.cellHeight),b.rightEl=a,f.el[j](a.dom))},generateRow:function(g){var h=this,i=h.widget,j=i.cellHeight,k=i.getColumnsWidth(g),l=a.get(document.createElement("div")),m="";a.each(i.getColumns(g),function(a){m+=['<div style="width:'+a.width+"px;height:"+j+"px;"+(a.cellAlign?"text-align:"+a.cellAlign+";":"")+'" class="'+b+'">','<div class="'+c+'"></div>',"</div>"].join("")});var n=['<div style="position: relative;" class="'+d+'">',m,"</div>"].join("");return l.update(n),l.css("width",k+"columnsWidth"),l.addCls(e),"bottom"===h.position&&l.addCls(f),l},calcPlusScroll:function(){var a=this,b=a.widget;a.plusScroll=a.groups.length*b.groupRowHeight},scrollLeft:function(a){this.el.firstChild().css("left",a)},update:function(){var a=this,b=a.widget;a.updateSide("center"),b.leftColumns.length&&a.updateSide("left"),b.rightColumns.length&&a.updateSide("right")},getEl:function(a){var b=this;switch(a){case"center":return b.el;case"left":return b.leftEl;case"right":return b.rightEl;default:return b.el}},updateSide:function(b){var d=this,e=d.widget,f=e.body,k=e.store,l=d.getEl(b).select("."+c),m="data";d.sumDisplayed&&(m="dataView"),a.each(e.getColumns(b),function(b,c){if(b.summary){var d=b.index,n=k.getColumnOriginalValues(d,{smartIndexFn:b.smartIndexFn,dataProperty:m}),o="",p=l.item(c).parent();switch(a.typeOf(b.summary)){case"string":o=a.Array[b.summary](n);break;case"object":o=a.Array[b.summary.type](n),b.summary.fn&&(o=b.summary.fn(o));break;case"function":o=b.summary(n)}switch(b.type){case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinebullet":case"sparklinebox":case"sparklinepie":case"sparklinediscrete":p.addCls(g);var q,r=b.width,s=e.cellHeight-1,t=r-20,u=b.type.replace("sparkline","");switch(u){case"line":case"pie":case"box":q="width";break;case"bullet":q="width",s-=11,p.addCls(h);break;case"discrete":q="width",t=r,s-=2;break;case"bar":case"tristate":q="barWidth"}var v=b.sparkConfig||{},w={type:u,fillColor:"transparent",height:s};a.apply(w,v),"bar"!==u&&"tristate"!==u||(t=r-20,t/=o.length),w[q]=t,l.item(c).$dom.sparkline(o,w);break;case"progressdonut":p.addCls(i);var w=b.sparkConfig||{};a.apply(w,{renderTo:l.item(c).dom,value:o}),w.size||w.height||w.width||(w.size=e.cellHeaderHeight-6),a.get(w.renderTo).update(""),new a.spark.ProgressDonut(w);break;case"grossloss":p.addCls(j);var w=b.sparkConfig||{};w.showOnMax&&(w.maxValue=Math.max.apply(Math,n)),o>50&&(o=50),a.apply(w,{renderTo:l.item(c).dom,value:o,column:b}),new a.spark.GrossLoss(w);break;default:b.format&&(o=f.format(o,b.format)),l.item(c).update(o)}}})},onColumnResize:function(){var a=this,b=a.widget;a.updateSizes("center"),b.leftColumns.length&&a.updateSizes("left"),b.rightColumns.length&&a.updateSizes("right")},updateSizes:function(c){var d=this,e=d.widget,f=d.getEl(c),g=f.select("."+b),h=0;switch(a.each(e.getColumns(c),function(a,b){h+=a.width,g.item(b).animate({width:a.width},k)}),f.firstChild().animate({width:h},k),c){case"center":d.el.animate({width:parseInt(e.centerEl.css("width"))},k);break;case"left":d.leftEl.animate({width:parseInt(e.leftEl.css("width"))-2},k);break;case"right":d.rightEl.animate({width:parseInt(e.rightEl.css("width"))-1},k)}},calcOffSets:function(){var a=this,b=a.widget;switch(a.position){case"top":a.topOffSet=b.cellHeight;break;case"bottom":a.bottomOffSet=b.cellHeight;break;case"both":a.topOffSet=b.cellHeight,a.bottomOffSet=b.cellHeight}},removeColumn:function(a,c){this.getEl(c).select("."+b).item(a).destroy(),this.updateSizes(c)},insertColumn:function(d,e){var f=this,g=f.widget,h=g.getColumns(e),i=h[d],j=f.getEl(e),k=j.select("."+b),l=k.item(d-1),m=a.get(document.createElement("div"));0===d&&(l=k.item(0)),m.css({width:i.width,height:g.cellHeight}),m.addCls(b),m.update('<div class="'+c+'"></div>'),0===d?l.before(m.dom):l.after(m.dom),f.updateSizes(e),f.updateSide(e)},onChangePage:function(){this.update()},onColumnDrag:function(){var a=this,b=a.widget;a.updateSizes("center"),b.leftColumns.length&&a.updateSizes("left"),b.rightColumns.length&&a.updateSizes("right")}})}(),function(){var a=Fancy;a.define("Fancy.grid.plugin.CellTip",{extend:a.Plugin,ptype:"grid.celltip",inWidgetName:"celltip",cellTip:"{value}",stopped:!0,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var b=this,c=b.widget,d=a.get(document);c.on("cellenter",b.onCellEnter,b),c.on("cellleave",b.onCellLeave,b),d.on("touchend",b.onTouchEnd,b),d.on("mousemove",b.onDocMove,b)},onCellEnter:function(b,c){var d=this,e=c.column,f=d.cellTip,g=c.e;if(e.cellTip){if(a.isString(e.cellTip))f=e.cellTip;else if(a.isFunction(e.cellTip)&&!1===(f=e.cellTip(c)))return;var h=new a.Template(f),i={title:e.title,value:c.value,columnIndex:0,rowIndex:0};d.stopped=!1,a.apply(i,c.data),a.tip.update(h.getHTML(i)),a.tip.show(g.pageX+15,g.pageY-25)}},onCellLeave:function(b,c){this.stopped=!0,a.tip.hide(1e3)},onTouchEnd:function(b,c){this.stopped=!0,a.tip.hide(1e3)},onDocMove:function(b){if(!0!==this.stopped){var c=this,d=c.widget;("none"===d.el.css("display")||d.panel&&d.panel.el&&"none"===d.panel.el.css("display"))&&(c.stopped=!0,a.tip.hide(1e3)),a.tip.show(b.pageX+15,b.pageY-25)}}})}(),function(){var a=Fancy,b=Fancy.Date,c=a.FIELD_CLS,d=a.GRID_HEADER_CELL_DOUBLE_CLS,e=a.GRID_HEADER_CELL_TRIPLE_CLS,f=a.GRID_HEADER_CELL_FILTER_CLS,g=a.GRID_HEADER_CELL_FILTER_FULL_CLS,h=a.GRID_HEADER_CELL_FILTER_SMALL_CLS;a.define("Fancy.grid.plugin.Filter",{extend:a.Plugin,ptype:"grid.filter",inWidgetName:"filter",autoEnterDelay:500,constructor:function(a){this.filters={},this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget;b.once("render",function(){a.render()}),b.on("columnresize",a.onColumnResize,a),b.on("filter",a.onFilter,a),b.on("lockcolumn",a.onLockColumn,a),b.on("rightlockcolumn",a.onRightLockColumn,a),b.on("unlockcolumn",a.onUnLockColumn,a),b.on("columndrag",a.onColumnDrag,a)},render:function(){var a=this,b=a.widget;a._renderSideFields(b.header,b.columns),a._renderSideFields(b.leftHeader,b.leftColumns),a._renderSideFields(b.rightHeader,b.rightColumns)},_renderSideFields:function(a,b){for(var c,g,h=this,i=0,j=b.length;i<j;i++)g=b[i],c=a.getCell(i),g.filter&&g.filter.header?(h.renderFilter(g.type,g,c),h.groupHeader&&!g.grouping&&c.addCls(e),c.addCls(f)):h.header&&(h.groupHeader&&!g.grouping?c.addCls(e):g.grouping&&h.groupHeader?c.addCls(d):g.grouping||c.addCls(d))},_clearColumnsFields:function(b,d,e,f){for(var g,h=0,i=b.length;h<i;h++)if(g=b[h],g.filter&&g.filter.header){if(e&&g.index!==e)continue;switch(g.type){case"date":var j=d.getCell(h).select("."+c),k=a.getWidget(j.item(0).attr("id")),l=a.getWidget(j.item(1).attr("id"));k.clear(),l.clear();break;default:var m=d.getCell(h).select("."+c).attr("id"),n=a.getWidget(m);if(f){var o=n.get().split(",");if(o.length<2&&!f)n.clear();else{for(var p=0,q=o.length,r="";p<q;p++){var s=o[p];new RegExp(f).test(s)||(r+=s)}n.set(r)}}else n.clear()}}},clearColumnsFields:function(a,b){var c=this,d=c.widget;c._clearColumnsFields(d.columns,d.header,a,b),c._clearColumnsFields(d.leftColumns,d.leftHeader,a,b),c._clearColumnsFields(d.rightColumns,d.rightHeader,a,b)},_addValuesInColumnFields:function(b,d,e,f,g){for(var h,i=0,j=b.length;i<j;i++)if(h=b[i],h.index===e&&h.filter&&h.filter.header)switch(h.type){case"date":var k=d.getCell(i).select("."+c),l=a.getWidget(k.item(0).attr("id")),m=a.getWidget(k.item(1).attr("id"));l.clear(),m.clear();break;default:var n=d.getCell(i).select("."+c).attr("id"),o=a.getWidget(n),p=o.get(),q=o.get().split(",");if(1===q.length&&""===q[0])o.set((g||"")+f);else if(1===q.length)new RegExp(g).test(p)?o.set((g||"")+f):o.set(p+","+(g||"")+f);else{for(var r=0,s=q.length,t="";r<s;r++){var u=q[r];new RegExp(g).test(u)?(0!==t.length&&(t+=","),t+=(g||"")+f):(0!==t.length&&(t+=","),t+=u)}o.set(t)}}},addValuesInColumnFields:function(a,b,c){var d=this,e=d.widget;d._addValuesInColumnFields(e.columns,e.header,a,b,c),d._addValuesInColumnFields(e.leftColumns,e.leftHeader,a,b,c),d._addValuesInColumnFields(e.rightColumns,e.rightHeader,a,b,c)},renderFilter:function(b,c,d){var e,f=this,g=f.widget,h={position:"absolute",bottom:"3px"},i=c.filter,j=g.theme,k=i.tip;switch(b){case"date":var l=[];l.push({change:f.onDateChange,scope:f});if(a.isString(c.format))switch(c.format){case"date":c.format}e=new a.DateRangeField({renderTo:d.dom,value:new Date,format:c.format,label:!1,padding:!1,style:h,events:l,width:c.width-8,emptyText:i.emptyText,dateImage:!1,theme:j});break;case"string":var l=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&l.push({key:f.onKey,scope:f}),e=new a.StringField({renderTo:d.dom,label:!1,padding:!1,style:h,events:l,emptyText:i.emptyText,tip:k});break;case"number":case"grossloss":case"progressbar":case"progressdonut":var l=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&l.push({key:f.onKey,scope:f}),e=new a.NumberField({renderTo:d.dom,label:!1,padding:!1,style:h,emptyText:i.emptyText,events:l,tip:k});break;case"combo":var m,n="text",o="text";void 0!==c.displayKey&&(n=c.displayKey,o=n),m=a.isObject(c.data)||a.isObject(c.data[0])?c.data:f.configComboData(c.data),e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:h,width:c.width-8,displayKey:n,valueKey:o,value:"",height:28,emptyText:i.emptyText,theme:j,tip:k,multiSelect:c.multiSelect,itemCheckBox:c.itemCheckBox,minListWidth:c.minListWidth,events:[{change:f.onEnter,scope:f},{empty:function(){this.set(-1)}}],data:m});break;case"checkbox":e=new a.Combo({renderTo:d.dom,label:!1,padding:!1,style:h,displayKey:"text",valueKey:"value",width:c.width-8,emptyText:i.emptyText,value:"",editable:!1,events:[{change:f.onEnter,scope:f}],data:[{value:"",text:""},{value:"false",text:g.lang.no},{value:"true",text:g.lang.yes}]});break;default:var l=[{enter:f.onEnter,scope:f}];!1!==f.autoEnterDelay&&l.push({key:f.onKey,scope:f}),e=new a.StringField({renderTo:d.dom,label:!1,style:h,padding:!1,emptyText:i.emptyText,events:l})}switch(e.filterIndex=c.index,e.column=c,"date"!==b&&(e.el.css("padding-left","4px"),e.el.css("padding-top","0px")),b){case"checkbox":case"combo":case"date":break;default:e.setInputSize({width:c.width-8})}c.filterField=e},onEnter:function(b,c,d){var e=this,f=e.widget,g=f.store,h=b.filterIndex;if(d=d||{},e.intervalAutoEnter&&(clearInterval(e.intervalAutoEnter),e.intervalAutoEnter=!1),delete e.intervalAutoEnter,0===c.length)return e.filters[b.filterIndex]={},e.updateStoreFilters(),void(f.grouping&&f.grouping.reGroup());var i=e.processFilterValue(c,b.column.type),j=0,k=i.length;for(e.filters[h]={};j<k;j++){var l=i[j];""===l.operator&&b.column.filter&&b.column.filter.operator&&(l.operator=b.column.filter.operator),e.filters[h][l.operator]=l.value,l.operator,"date"===b.column.type&&a.apply(e.filters[h],d)}g.remoteFilter?(g.filters=e.filters,g.serverFilter()):e.updateStoreFilters(),f.grouping&&(g.remoteSort?g.once("load",function(){f.grouping.reGroup(),f.fire("filter",e.filters)}):f.grouping.reGroup()),f.setSidesHeight()},processFilterValue:function(b,c){var d,e,f,g,h,i={"<":!0,">":!0,"!":!0,"=":!0,"|":!0},j=0,k=3,l=[];if(a.isArray(b))return e={},a.Array.each(b,function(a,b){e[String(a).toLocaleLowerCase()]=!0}),l.push({operator:"|",value:e}),l;for(f=b.split(","),g=0,h=f.length;g<h;g++){for(j=0,d="",e=f[g];j<k;j++)i[e[j]]&&(d+=e[j]);if(e=e.replace(new RegExp("^"+d),""),!(e.length<1)){switch(c){case"number":e=Number(e);break;case"combo":d="="}l.push({operator:d,value:e})}}return l},updateStoreFilters:function(){var a=this,b=a.widget,c=b.store,d=!1;c.filters=a.filters;for(var e in c.filters){if(c.filters[e]){d=!0;break}}d||delete c.filteredData,c.changeDataView(),b.update(),b.fire("filter",a.filters),b.setSidesHeight(),d||delete c.filteredData},onColumnResize:function(b,d){var e,f=a.get(d.cell),g=d.width,h=f.select("."+c);0===h.length||(2===h.length?(e=a.getWidget(h.item(0).dom.id),e.setWidth((g-8)/2),e=a.getWidget(h.item(1).dom.id),e.setWidth((g-8)/2)):(e=a.getWidget(h.dom.id),"field.combo"===e.wtype?(e.size({width:g-8}),e.el.css("width",g-8+5)):e.setInputSize({width:g-8})))},onKey:function(b,c,d){var e=this;d.keyCode!==a.key.ENTER&&(e.autoEnterTime=+new Date,e.intervalAutoEnter||(e.intervalAutoEnter=setInterval(function(){var a=new Date;e.intervalAutoEnter&&a-e.autoEnterTime>e.autoEnterDelay&&(clearInterval(e.intervalAutoEnter),delete e.intervalAutoEnter,c=b.getValue(),e.onEnter(b,c))},200)))},onDateChange:function(c,d){var e,f,g,h=this,i=h.widget,j=c.format,k=i.store,l=c.dateField1.getDate(),m=c.dateField2.getDate(),n="Invalid Date"!==l.toString()&&a.isDate(l),o="Invalid Date"!==m.toString()&&a.isDate(m),p=k.remoteFilter;n&&(l=new Date(l.getFullYear(),l.getMonth(),l.getDate())),o&&(m=new Date(m.getFullYear(),m.getMonth(),m.getDate())),n&&o?(!0!==p?(f=Number(l),g=Number(m)):(f=b.format(l,j.edit,j.mode),g=b.format(m,j.edit,j.mode)),e=">="+f+",<="+g):n?(e=!0!==p?">="+Number(l):">="+b.format(l,j.edit,j.mode),h.clearFilter(c.filterIndex,"<=",!1)):o?(e=!0!==p?"<="+Number(m):"<="+b.format(l,j.edit,j.mode),h.clearFilter(c.filterIndex,">=",!1)):h.clearFilter(c.filterIndex),e&&h.onEnter(c,e,{type:"date",format:c.format})},clearFilter:function(a,b,c){var d=this;void 0===b?delete d.filters[a]:d.filters[a]&&delete d.filters[a][b],!1!==c&&d.updateStoreFilters()},onFilter:function(){this.widget.scroll(0)},configComboData:function(b){var c=0,d=b.length,e=[];if(a.isObject(b))return b;for(;c<d;c++)e.push({value:c,text:b[c]});return e},destroyFields:function(){var b=this,c=b.widget;a.each(c.columns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),a.each(c.leftColumns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),a.each(c.rightColumns,function(a){a.filterField&&(a.filterField.destroy(),delete a.filterField)}),c.el.select("."+f).removeCls(f),c.el.select("."+g).removeCls(g),c.el.select("."+h).removeCls(h),c.el.select("."+d).removeCls(d),c.el.select("."+e).removeCls(e)},onLockColumn:function(){this.render()},onUnLockColumn:function(){this.render()},onRightLockColumn:function(){this.render()},onColumnDrag:function(){var a=this;a.destroyFields(),a.render()}})}(),Fancy.define("Fancy.grid.plugin.Search",{extend:Fancy.Plugin,ptype:"grid.search",inWidgetName:"searching",autoEnterDelay:500,constructor:function(a){this.searches={},this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("init",function(){a.generateKeys()})},search:function(a,b){var c=this,d=c.widget,e=d.store;if(c.searches={},!a&&!b)return c.clear(),c.updateStoreSearches(),void(d.grouping&&d.grouping.reGroup());!1!==Fancy.isArray(a)||b||(c.searches=a),c.setFilters(),e.remoteSort?e.serverFilter():c.updateStoreSearches(),d.grouping&&(e.remoteSort?e.once("load",function(){d.grouping.reGroup()}):d.grouping.reGroup())},updateStoreSearches:function(){var a=this.widget;a.store.changeDataView(),a.update()},setKeys:function(a){var b=this;b.keys=a,b.setFilters(),b.updateStoreSearches()},generateKeys:function(){var a=this,b=a.widget;if(!a.keys){a.keys={};var c=[];b.columns&&(c=c.concat(b.columns)),b.leftColumns&&(c=c.concat(b.leftColumns)),b.rightColumns&&(c=c.concat(b.rightColumns));var d=[];Fancy.each(c,function(a){var b=a.index||a.key;if(!1!==a.searchable){switch(a.type){case"color":case"combo":case"date":case"number":case"string":case"text":case"currency":break;default:return}b&&d.push(b)}}),Fancy.each(d,function(b){"$selected"!==b&&(a.keys[b]=!0)})}return a.keys},setFilters:function(){var a=this,b=a.widget,c=b.store,d=c.filters||{};if(void 0===a.searches||Fancy.isObject(a.searches))return void a.clear();for(var e in a.keys)!1!==a.keys[e]?(d[e]=d[e]||{},d[e]["*"]=a.searches):d[e]&&delete d[e]["*"];a.filters=d,c.filters=d},clear:function(){var a=this,b=a.widget,c=b.store,d=c.filters||{};for(var e in a.keys)void 0!==d[e]&&delete d[e]["*"];a.filters=d,c.filters=d,delete a.searches}}),function(){var a=Fancy,b=a.GRID_BODY_CLS,c=a.GRID_CLS,d=a.GRID_CELL_CLS;a.define("Fancy.grid.plugin.GridToGrid",{extend:a.Plugin,ptype:"grid.dragdrop",inWidgetName:"dragdrop",dropOK:!1,cellMaskCls:"fancy-drop-cell-mask",dropZoneCls:"fancy-drop-zone-active",dropOkCls:"fancy-drop-ok",dropNotOkCls:"fancy-drop-not-ok",dropHeaderMaskCls:"fancy-drop-header-mask",droppable:!0,dropZoneOverClass:b,constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.addEvents("drop"),a.Super("init",arguments),a.initDropCls(),a.initEnterLeave(),a.ons()},initDropCls:function(){var a=this,b="."+a.dropGroup;b+=" ."+a.dropZoneOverClass,a.dropCls=b},addDragDropCls:function(){this.widget.el.addCls(this.dragGroup)},ons:function(){var a=this,b=a.widget;b.on("render",function(){a.addDragDropCls()}),a.dropGroup&&(b.on("beforecellmousedown",a.onBeforeCellMouseDown,a),b.on("cellmousedown",a.onCellMouseDown,a),b.on("cellleave",a.onCellLeave,a),b.on("cellenter",a.onCellEnter,a)),a.on("drop",a.onDropItems,a)},onDropItems:function(a,b){var c=this,d=c.widget,e=c.dropGrid,f=void 0===e.activeRowEnterIndex?e.getViewTotal():e.activeRowEnterIndex;d.fire("dropitems",b,f),c.onDrop&&c.onDrop.apply(d,[b,f])},onBeforeCellMouseDown:function(b,c){var d=this,e=d.widget,f=e.lang,g=a.get(document),h=e.getSelection();if((!c.e.ctrlKey||!0!==e.multiSelect)&&h.length>1){var i=!1;if(a.each(h,function(a){if(a.id===c.id)return i=!0,!0}),!1===i)return;e.stopSelection(),g.once("mouseup",d.onDocMouseUp,d),g.on("mousemove",d.onDocMouseMove,d),g.once("mouseup",function(){e.enableSelection()},d),h=e.getSelection();var j=a.String.format(f.dragText,[h.length,h.length>1?"s":""]);d.initTip(j),d.dragItems=e.getSelection(),d.cellMouseDown=!0}},onCellMouseDown:function(b,c){var d=this,e=d.widget,f=a.get(document);if(!1!==e.selection.enabled){c.e.ctrlKey&&!0===e.multiSelect||("$selected"===c.column.index||e.clearSelection(),f.once("mouseup",d.onDocMouseUp,d),f.on("mousemove",d.onDocMouseMove,d),d.cellMouseDown=!0,d.activeRowIndex=c.rowIndex)}},initEnterLeave:function(){var b=this,c=a.select(b.dropCls);if(0===c.length)return void setTimeout(function(){b.initEnterLeave()},500);c.on("mouseenter",b.onMouseEnterDropGroup,b),c.on("mouseleave",b.onMouseLeaveDropGroup,b)},onMouseEnterDropGroup:function(b){var d=this;if(d.cellMouseDown){var e=a.get(b.currentTarget);if(d.dropGrid=a.getWidget(e.closest("."+c).attr("id")),d.dropGrid&&d.dropGrid.dragdrop&&!1===d.dropGrid.dragdrop.droppable)return d.dropOK=!1,void(d.tip&&d.tip.el.replaceClass(d.dropOkCls,d.dropNotOkCls));d.setDropGridCellsMask(),d.dropGridEventInited||d.onsDropGrid(),e.addCls(d.dropZoneCls),d.dropOK=!0,d.tip&&d.tip.el.replaceClass(d.dropNotOkCls,d.dropOkCls)}},onMouseLeaveDropGroup:function(b){var c=this;c.cellMouseDown&&(a.get(b.currentTarget).removeCls(c.dropZoneCls),c.dropOK=!1,c.tip.el.replaceClass(c.dropOkCls,c.dropNotOkCls),c.clearCellsMask())},setDropGridCellsMask:function(){var a,b=this,c=b.dropGrid;c&&b.cellMouseDown&&(a=c.getTotal(),0===a?c.el.addCls(b.dropHeaderMaskCls):c.el.select("."+d+'[index="'+(a-1)+'"]').addCls(b.cellMaskCls))},onsDropGrid:function(){var a=this;a.dropGrid.on("rowenter",a.onDropGridRowEnter,a),a.dropGrid.on("rowleave",a.onDropGridRowLeave,a),a.dropGridEventInited=!0},onDropGridRowEnter:function(a,b){var c=this;!1===c.cellMouseDown&&(c.dropGrid.un("rowenter",c.onDropGridRowEnter),c.dropGrid.un("rowleave",c.onDropGridRowLeave)),c.clearCellsMask(),0===b.rowIndex?a.el.addCls(c.dropHeaderMaskCls):a.el.select("."+d+'[index="'+(b.rowIndex-1)+'"]').addCls(c.cellMaskCls),!1===c.cellMouseDown&&c.clearCellsMask(),c.dropGrid&&(c.dropGrid.activeRowEnterIndex=b.rowIndex)},onDropGridRowLeave:function(a,b){var c=this;c.clearCellsMask(),c.setDropGridCellsMask(),c.dropGrid&&delete c.dropGrid.activeRowEnterIndex},clearCellsMask:function(){var a=this,b=a.cellMaskCls;a.dropGrid&&(a.dropGrid.el.removeCls(a.dropHeaderMaskCls),a.dropGrid.el.select("."+b).removeCls(b))},onDocMouseUp:function(b){var c=this,d=c.widget,e=a.get(document);c.cellMouseDown=!1,c.tip&&c.tip.hide(),d.enableSelection(),e.un("mousemove",c.onDocMouseMove),!0===c.dropOK&&(d.clearSelection(),c.dropGrid.clearSelection(),c.fire("drop",c.dragItems)),delete c.dragItems,c.dropOK=!1,a.select("."+c.dropZoneCls).removeCls(c.dropZoneCls),c.clearCellsMask(),c.dropGrid&&(c.dropGrid.un("rowenter",c.onDropGridRowEnter),c.dropGrid.un("rowleave",c.onDropGridRowLeave)),delete c.dropGridEventInited},onDocMouseMove:function(a){this.dragItems&&this.tip.show(a.pageX+20,a.pageY+20)},onCellLeave:function(b,c){var d=this,e=d.widget,f=e.lang;setTimeout(function(){if(d.onceStopDrag)return void(d.onceStopDrag=!1);if(!0===d.cellMouseDown&&!d.dragItems){var b=e.getSelection(),g=a.String.format(f.dragText,[b.length,b.length>1?"s":""]);e.stopSelection(),d.initTip(g,c.e),d.tip.show(),d.tip.el.css("display","block"),d.dragItems=b}},1)},onCellEnter:function(a,b){var c=this;!0!==c.cellMouseDown||c.dragItems||b.rowIndex!==c.activeRowIndex&&(c.onceStopDrag=!0,c.activeRowIndex=b.rowIndex)},initTip:function(b,c){var d=this,e=d.dropNotOkCls;d.tip||(d.tip=new a.ToolTip({cls:e,text:b})),c&&d.tip.show(c.pageX+20,c.pageY+20),d.tip.update(b),d.tip.el.replaceClass(d.dropOkCls,e)}})}(),Fancy.define("Fancy.grid.plugin.Exporter",{extend:Fancy.Plugin,ptype:"grid.exporter",inWidgetName:"exporter",constructor:function(a){this.Super("const",arguments)},init:function(){},exportToExcel:function(){function a(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b}var b=this,c=b.widget,d=b.getColumnsData(),e=b.getData(),f=[d].concat(e),g=function(){if(!(this instanceof g))return new g;this.SheetNames=[],this.Sheets={}},h=new g,i=b.sheet_from_array_of_arrays(f);i["!cols"]=[],Fancy.each(b.widths,function(a){i["!cols"].push({wch:a})});var j=c.title||"grid_data";h.SheetNames.push(j),h.Sheets[j]=i;var k=XLSX.write(h,{bookType:"xlsx",bookSST:!0,type:"binary"});saveAs(new Blob([a(k)],{type:"application/octet-stream"}),j+".xlsx")},getColumnsData:function(){var a=this,b=a.widget,c=[].concat(b.leftColumns).concat(b.columns).concat(b.rightColumns),d=[];return a.widths=[],Fancy.each(c,function(b){a.widths.push(b.width),d.push(b.title||"")}),d},getData:function(){var a=this,b=a.widget,c=[],d=b.getDisplayedData();return Fancy.each(d,function(a){var b=[];Fancy.each(a,function(a){b.push(a)}),c.push(b)}),c},sheet_from_array_of_arrays:function(a,b){for(var c={},d={s:{c:1e7,r:1e7},e:{c:0,r:0}},e=0,f=a.length,g=function(a,b){return b&&(a+=1462),(Date.parse(a)-new Date(Date.UTC(1899,11,30)))/864e5};e!=f;++e)for(var h=0;h!=a[e].length;++h){d.s.r>e&&(d.s.r=e),d.s.c>h&&(d.s.c=h),d.e.r<e&&(d.e.r=e),d.e.c<h&&(d.e.c=h);var i={v:a[e][h]};if(null!=i.v){var j=XLSX.utils.encode_cell({c:h,r:e});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=XLSX.SSF._table[14],i.v=g(i.v)):i.t="s",c[j]=i}}return d.s.c<1e7&&(c["!ref"]=XLSX.utils.encode_range(d)),c}}),Fancy.define("Fancy.grid.plugin.Licence",{extend:Fancy.Plugin,ptype:"grid.licence",inWidgetName:"licence",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("render",function(){a.render()})},render:function(){var a=this,b=a.widget,c=b.body,d=Fancy.get(document.createElement("div"));/fancygrid/.test(location.host)&&!b.watermark||(!0!==a.checkLicence()||b.watermark)&&(d.css({position:"absolute","z-index":2,width:"30px",height:"30px"}),b.nativeScroller?d.css({top:"2px",left:"2px"}):d.css({right:"4px",bottom:"0px"}),Fancy.get(c.el.append(d.dom)),a.licenceEl=d,b.watermark&&a.configWatermark(),a.showConsoleText())},showConsoleText:function(){},configWatermark:function(){var a=this,b=a.widget,c=b.watermark;if(c.text){var d=a.licenceEl.firstChild();d.css("background-image","none"),d.css("font-size","11px"),d.update(c.text),a.licenceEl.css("width","initial")}c.style&&a.licenceEl.css(c.style)},checkLicence:function(){var a=this,b="FancyGrid";if(!Fancy.LICENSE&&!FancyGrid.LICENSE)return!1;var c,d,e=String(a.md5(location.host.replace(/^www\./,""),b)),f=Fancy.LICENSE||FancyGrid.LICENSE||[],g=a.md5("UNIVERSAL",b),h=a.md5("SAAS",b),i=a.md5("INTERNAL",b),j=a.md5("OEM",b),k=a.md5("ENTERPRISE",b);for(c=0,d=f.length;c<d;c++)switch(String(f[c])){case e:case g:case h:case i:case j:case k:return!0}return!1},md5:function(a,b,c){var d=function(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c},e=function(a,b){return a<<b|a>>>32-b},f=function(a,b,c,f,g,h){return d(e(d(d(b,a),d(f,h)),g),c)},g=function(a,b,c,d,e,g,h){return f(b&c|~b&d,a,b,e,g,h)},h=function(a,b,c,d,e,g,h){return f(b&d|c&~d,a,b,e,g,h)},i=function(a,b,c,d,e,g,h){return f(b^c^d,a,b,e,g,h)},j=function(a,b,c,d,e,g,h){return f(c^(b|~d),a,b,e,g,h)},k=function(a,b){a[b>>5]|=128<<b%32,a[14+(b+64>>>9<<4)]=b;var c,e,f,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(c=0;c<a.length;c+=16)e=m,f=n,k=o,l=p,m=g(m,n,o,p,a[c],7,-680876936),p=g(p,m,n,o,a[c+1],12,-389564586),o=g(o,p,m,n,a[c+2],17,606105819),n=g(n,o,p,m,a[c+3],22,-1044525330),m=g(m,n,o,p,a[c+4],7,-176418897),p=g(p,m,n,o,a[c+5],12,1200080426),o=g(o,p,m,n,a[c+6],17,-1473231341),n=g(n,o,p,m,a[c+7],22,-45705983),m=g(m,n,o,p,a[c+8],7,1770035416),p=g(p,m,n,o,a[c+9],12,-1958414417),o=g(o,p,m,n,a[c+10],17,-42063),n=g(n,o,p,m,a[c+11],22,-1990404162),m=g(m,n,o,p,a[c+12],7,1804603682),p=g(p,m,n,o,a[c+13],12,-40341101),o=g(o,p,m,n,a[c+14],17,-1502002290),n=g(n,o,p,m,a[c+15],22,1236535329),m=h(m,n,o,p,a[c+1],5,-165796510),p=h(p,m,n,o,a[c+6],9,-1069501632),o=h(o,p,m,n,a[c+11],14,643717713),n=h(n,o,p,m,a[c],20,-373897302),m=h(m,n,o,p,a[c+5],5,-701558691),p=h(p,m,n,o,a[c+10],9,38016083),o=h(o,p,m,n,a[c+15],14,-660478335),n=h(n,o,p,m,a[c+4],20,-405537848),m=h(m,n,o,p,a[c+9],5,568446438),p=h(p,m,n,o,a[c+14],9,-1019803690),o=h(o,p,m,n,a[c+3],14,-187363961),n=h(n,o,p,m,a[c+8],20,1163531501),m=h(m,n,o,p,a[c+13],5,-1444681467),p=h(p,m,n,o,a[c+2],9,-51403784),o=h(o,p,m,n,a[c+7],14,1735328473),n=h(n,o,p,m,a[c+12],20,-1926607734),m=i(m,n,o,p,a[c+5],4,-378558),p=i(p,m,n,o,a[c+8],11,-2022574463),o=i(o,p,m,n,a[c+11],16,1839030562),n=i(n,o,p,m,a[c+14],23,-35309556),m=i(m,n,o,p,a[c+1],4,-1530992060),p=i(p,m,n,o,a[c+4],11,1272893353),o=i(o,p,m,n,a[c+7],16,-155497632),n=i(n,o,p,m,a[c+10],23,-1094730640),m=i(m,n,o,p,a[c+13],4,681279174),p=i(p,m,n,o,a[c],11,-358537222),o=i(o,p,m,n,a[c+3],16,-722521979),n=i(n,o,p,m,a[c+6],23,76029189),m=i(m,n,o,p,a[c+9],4,-640364487),p=i(p,m,n,o,a[c+12],11,-421815835),o=i(o,p,m,n,a[c+15],16,530742520),n=i(n,o,p,m,a[c+2],23,-995338651),m=j(m,n,o,p,a[c],6,-198630844),p=j(p,m,n,o,a[c+7],10,1126891415),o=j(o,p,m,n,a[c+14],15,-1416354905),n=j(n,o,p,m,a[c+5],21,-57434055),m=j(m,n,o,p,a[c+12],6,1700485571),p=j(p,m,n,o,a[c+3],10,-1894986606),o=j(o,p,m,n,a[c+10],15,-1051523),n=j(n,o,p,m,a[c+1],21,-2054922799),m=j(m,n,o,p,a[c+8],6,1873313359),p=j(p,m,n,o,a[c+15],10,-30611744),o=j(o,p,m,n,a[c+6],15,-1560198380),n=j(n,o,p,m,a[c+13],21,1309151649),m=j(m,n,o,p,a[c+4],6,-145523070),p=j(p,m,n,o,a[c+11],10,-1120210379),o=j(o,p,m,n,a[c+2],15,718787259),n=j(n,o,p,m,a[c+9],21,-343485551),m=d(m,e),n=d(n,f),o=d(o,k),p=d(p,l);return[m,n,o,p]},l=function(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c},m=function(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c},n=function(a){return l(k(m(a),8*a.length))},o=function(a,b){var c,d,e=m(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=k(e,8*a.length)),c=0;c<16;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=k(f.concat(m(b)),512+8*b.length),l(k(g.concat(d),640))},p=function(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e},q=function(a){return unescape(encodeURIComponent(a))},r=function(a){return n(q(a))},s=function(a){return p(r(a))},t=function(a,b){return o(q(a),q(b))},u=function(a,b){return p(t(a,b))};return function(a,b,c){return b?c?t(b,a):u(b,a):c?r(a):s(a)}(a,b,c)}}),function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_EVEN_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_COLUMN_TEXT_CLS,f=a.GRID_COLUMN_ELLIPSIS_CLS,g=a.GRID_COLUMN_ORDER_CLS,h=a.GRID_COLUMN_SELECT_CLS,i=a.GRID_CELL_INNER_CLS,j=a.GRID_CELL_DIRTY_CLS,k=a.GRID_CELL_DIRTY_EL_CLS,l=a.GRID_PSEUDO_CELL_CLS,m=a.GRID_EMPTY_CLS,n=a.GRID_COLUMN_SPARKLINE_CLS,o=a.GRID_COLUMN_SPARKLINE_BULLET_CLS,p=a.GRID_COLUMN_CHART_CIRCLE_CLS,q=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,r=a.GRID_COLUMN_GROSSLOSS_CLS,s=a.GRID_COLUMN_PROGRESS_CLS,t=a.GRID_COLUMN_PROGRESS_BAR_CLS,u=a.GRID_COLUMN_H_BAR_CLS;a.ns("Fancy.grid.body.mixin"),a.grid.body.mixin.Updater=function(){},a.grid.body.mixin.Updater.prototype={update:function(){var a=this,b=a.widget,c=b.store;a.checkDomColumns(),c.loading||(a.checkDomCells(),a.updateRows(),a.showEmptyText())},checkDomColumns:function(){var b=this,c=b.widget,i=b.el.select("."+d).length,j=b.getColumns(),k=0,l=j.length;if(!(l<=i)){for(;k<l;k++){var m=j[k],n=m.width,o=a.get(document.createElement("div"));if(m.hidden&&o.css("display","none"),o.addCls(d),o.attr("grid",c.id),"$selected"===m.index)o.addCls(h);else switch(m.type){case"order":o.addCls(g)}if(m.cls&&o.addCls(m.cls),"text"===m.type&&o.addCls(e),o.css({width:n+"px"}),o.attr("index",k),m.cellAlign&&o.css("text-align",m.cellAlign),!0===m.ellipsis)switch(m.type){case"string":case"text":case"number":o.addCls(f)}b.el.dom.appendChild(o.dom)}b.fire("adddomcolumns")}},checkDomCells:function(e){var f,g,h=this,i=h.widget,j=i.store,k=0,m=j.dataView.length,n=0;switch(h.side){case"left":g=i.leftColumns;break;case"center":g=i.columns;break;case"right":g=i.rightColumns}f=g.length;var o=h.el.select("."+d),p=j.getLength(),q=h.cellTpl;for(i.cellWrapper&&(q=h.cellWrapperTpl),void 0!==e&&(n=e,f=e);n<f;n++){g[n];var r=o.item(n);k=0;var s=p-r.select("."+b).length;for(k=m-s;k<m;k++){var t=q.getHTML({}),u=a.get(document.createElement("div"));u.css({height:i.cellHeight+"px"}),u.addCls(b),u.attr("index",k),k%2!=0&&i.striped&&u.addCls(c),u.update(t),r.dom.appendChild(u.dom)}if(i.nativeScroller&&("left"===h.side||"right"===h.side)){r.select("."+l).destroy();var t=q.getHTML({cellValue:"&nbsp;"}),u=a.get(document.createElement("div"));u.css({height:i.cellHeight+"px"}),u.addCls(l),u.update(t),r.dom.appendChild(u.dom)}}},updateRows:function(a,b){var c,d,e=this,f=e.widget,g=0;switch(void 0===a?e.clearDirty():e.clearDirty(a),e.side){case"left":c=f.leftColumns;break;case"center":c=f.columns;break;case"right":c=f.rightColumns}for(d=c.length,void 0!==b&&(g=b,d=b+1);g<d;g++){var h=c[g];switch(h.type){case"string":case"number":case"combo":case"action":case"text":case"date":case"currency":e.renderUniversal(g,a);break;case"order":e.renderOrder(g,a);break;case"expand":e.renderExpand(g,a);break;case"select":e.renderSelect(g,a);break;case"color":e.renderColor(g,a);break;case"checkbox":e.renderCheckbox(g,a);break;case"image":e.renderImage(g,a);break;case"sparklineline":e.renderSparkLine(g,a,"line");break;case"sparklinebar":e.renderSparkLine(g,a,"bar");break;case"sparklinetristate":e.renderSparkLine(g,a,"tristate");break;case"sparklinediscrete":e.renderSparkLine(g,a,"discrete");break;case"sparklinebullet":e.renderSparkLine(g,a,"bullet");break;case"sparklinepie":e.renderSparkLine(g,a,"pie");break;case"sparklinebox":e.renderSparkLine(g,a,"box");break;case"circle":e.renderCircle(g,a);break;case"progressdonut":e.renderProgressDonut(g,a);break;case"progressbar":e.renderProgressBar(g,a);break;case"hbar":e.renderHBar(g,a);break;case"grossloss":e.renderGrossLoss(g,a);break;default:throw new Error("[FancyGrid error] - not existed column type "+h.type)}}e.removeNotUsedCells()},renderUniversal:function(a,c){var e,f,g,h=this,j=h.widget,k=j.lang,l=j.emptyValue,m=j.store,n=h.getColumns(),o=n[a],p=h.el.select("."+d),q=p.item(a),r=q.select("."+b),s=q.select("."+b+" ."+i),t=k.currencySign;for(e=void 0!==o.key?o.key:void 0!==o.index?o.index:"action"===o.type?"none":void 0,void 0!==c?(f=c,g=c+1):(f=0,g=m.getLength());f<g;f++){var u,v=m.get(f),w=m.getId(f),x=s.item(f),y=r.item(f),z={rowIndex:f,data:v,style:{},column:o,id:w,item:m.getItem(f),inner:x,cell:y},A=!1;switch(m.changed[z.id]&&m.changed[z.id][o.index]&&(A=!0),u=o.smartIndexFn?o.smartIndexFn(v):m.get(f,e),z.value=u,o.format&&(z.value=h.format(z.value,o.format),u=z.value),o.type){case"currency":""!==u&&(u=t+u),z.value=u}switch(o.render&&(z=o.render(z),u=z.value),u){case"":case void 0:u=l}j.cellStylingCls&&h.clearCls(y),z.cls&&y.addCls(z.cls),A&&j.dirtyEnabled&&h.enableCellDirty(y),y.css(z.style),z.column.widget||x.update(u)}},renderOrder:function(a){var c=this,e=c.widget,f=e.store,g=c.getColumns(),h=g[a],j=c.el.select("."+d),k=j.item(a),l=k.select("."+b),m=k.select("."+b+" ."+i),n=0,o=f.getLength(),p=0;for(e.paging&&(p+=f.showPage*f.pageSize);n<o;n++){var q=f.get(n),r=f.getId(n),s={rowIndex:n,data:q,style:{},column:h,id:r,item:f.getItem(n)},t=n+1+p;s.value=t,h.render&&(s=h.render(s),t=s.value);var u=l.item(n);e.cellStylingCls&&c.clearCls(u),s.cls&&u.addCls(s.cls),u.css(s.style),m.item(n).update(t)}},renderExpand:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.el.select("."+d),m=l.item(c),n=m.select("."+b+" ."+i);for(void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var o,p=n.item(f),q=p.select(".fancy-field-checkbox"),r=0!==q.length,s=j.get(f),t=s.id;!1===r?(n.item(f).update(""),new a.CheckBox({renderTo:n.item(f).dom,renderId:!0,value:!1,label:!1,expander:!0,style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){e=a.el.parent().parent().attr("index"),b?j.expander.expand(e):j.expander.collapse(e)}}]})):(o=q.dom.id,q=a.getWidget(o),j.expander._expandedIds[t]?q.set(!0,!1):q.set(!1,!1))}},clearCls:function(b){var c=this.widget;a.each(c.cellStylingCls,function(a){b.removeCls(a)})},renderColor:function(a,c){var e,f,g=this,h=g.widget,j=h.store,k=g.getColumns(),l=k[a],m=l.key||l.index,n=g.el.select("."+d),o=n.item(a),p=o.select("."+b);for(void 0!==c?(e=c,f=c+1):(e=0,f=j.getLength());e<f;e++){var q,r=j.get(e),s={rowIndex:e,data:r,style:{},column:l};q=l.smartIndexFn?l.smartIndexFn(r):j.get(e,m),l.render&&(s=l.render(s),q=s.value),s.value=q;var t=p.item(e);t.css(s.style);t.select("."+i).update('<div class="fancy-grid-color-cell" style="background: '+q+';"></div>')}},renderCombo:function(a,c){var e,f,g=this,h=g.widget,j=h.store,k=g.getColumns(),l=k[a],m=l.key||l.index,n=g.el.select("."+d),o=n.item(a),p=o.select("."+b),q=o.select("."+b+" ."+i);for(void 0!==c?(e=c,f=c+1):(e=0,f=j.getLength());e<f;e++){var r=j.get(e,m),s={rowIndex:e,value:r,style:{}};l.render&&(s=l.render(s),r=s.value),p.item(e).css(s.style),q.item(e).update(r)}},renderCheckbox:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+i);for(void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var s,t=k.get(f),u=k.get(f,n),v=r.item(f),w=v.select(".fancy-field-checkbox"),x=0!==w.length,y=!1,z=k.getId(f),A={rowIndex:f,data:t,style:{},column:m,id:z,item:k.getItem(f),value:u};if(k.changed[A.id]&&k.changed[A.id][m.index]&&(y=!0),m.render&&(A=m.render(A),u=A.value),!1===x)if(A.stopped)r.item(f).update(u);else{var B=!0;j.rowEdit&&(B=!1),r.item(f).update(""),new a.CheckBox({renderTo:r.item(f).dom,renderId:!0,value:u,label:!1,editable:B,style:{padding:"0px",display:"inline-block"},events:[{beforechange:function(a){"$selected"!==m.index&&!0!==m.editable&&(a.canceledChange=!0)}},{change:function(a,b){"$selected"!==m.index&&(j.celledit.checkBoxChangedValue=b)}}]})}else s=w.dom.id,w=a.getWidget(s),A.stopped?(w.destroy(),r.item(f).update(u)):w.set(u,!1);if(y){var C=q.item(f);h.enableCellDirty(C)}}},renderSelect:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b+" ."+i);for(void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var r,s=k.get(f,n),t=k.get(f,"id"),u=q.item(f),v=u.select(".fancy-field-checkbox"),w=0!==v.length;j.selection.memory&&(j.selection.memory.all&&!j.selection.memory.except[t]?(s=!0,j.selection.domSelectRow(f)):j.selection.memory.selected[t]?(s=!0,j.selection.domSelectRow(f)):(s=!1,j.selection.domDeSelectRow(f))),!1===w?new a.CheckBox({renderTo:q.item(f).dom,renderId:!0,value:s,label:!1,stopIfCTRL:!0,style:{padding:"0px",display:"inline-block"}}):(r=v.dom.id,v=a.getWidget(r),v.set(s,!1))}},renderImage:function(a,c){var e,f,g=this,h=g.widget,j=h.store,k=g.getColumns(),l=k[a],m=l.key||l.index,n=g.el.select("."+d),o=n.item(a),p=o.select("."+b),q=o.select("."+b+" ."+i);for(void 0!==c?(e=c,f=c+1):(e=0,f=j.getLength());e<f;e++){var r=j.get(e,m),s=j.get(e),t={rowIndex:e,value:r,data:s,style:{}},u="";if(l.render&&(t=l.render(t),r=t.value),t.attr)for(var v in t.attr)u+=v+'="'+t.attr[v]+'"';r="<img "+u+' src="'+t.value+'">',p.item(e).css(t.style),q.item(e).update(r)}},renderSparkLine:function(c,e,f){var g,h,j=this,k=j.widget,l=k.cellHeight,m=k.store,p=j.getColumns(),q=p[c],r=q.width,s=q.key||q.index,t=j.el.select("."+d),u=t.item(c),v=u.select("."+b),w=u.select("."+b+" ."+i),x=q.sparkConfig||{};u.addCls(n),void 0!==e?(g=e,h=e+1):(g=0,h=m.getLength());var y,z=l-1,A=r-20;switch(f){case"line":case"pie":case"box":y="width";break;case"bullet":y="width",z-=11,u.addCls(o);break;case"discrete":y="width",A=r,z-=2;break;case"bar":case"tristate":y="barWidth"}for(;g<h;g++){var B=m.get(g,s),C=m.get(g),D={rowIndex:g,value:B,data:C,style:{}};if(q.render&&(D=q.render(D),B=D.value),a.isArray(q.values)){var E=0,F=q.values.length;for(B=[];E<F;E++)B.push(m.get(g,q.values[E]))}v.item(g).css(D.style);var G=w.item(g).dom,H={type:f,fillColor:"transparent",height:z};a.apply(H,x),"bar"!==f&&"tristate"!==f||(A=r-20,A/=B.length),H[y]=A,a.$(G).sparkline(B,H)}},renderProgressDonut:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),r=p.select("."+b),s=p.select("."+b+" ."+i);for(p.addCls(q),void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var t,u=k.get(f),v={rowIndex:f,data:u,style:{},column:m};t=m.smartIndexFn?m.smartIndexFn(u):k.get(f,n),v.value=t,m.format&&(v.value=h.format(v.value,m.format),t=v.value),m.render&&(v=m.render(v),t=v.value),r.item(f).css(v.style);var w=m.sparkConfig||{},x=s.item(f).dom;a.apply(w,{renderTo:x,value:t}),w.size||w.height||w.width||(w.size=j.cellHeaderHeight-6),a.get(x).update(""),new a.spark.ProgressDonut(w)}},renderGrossLoss:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),s=p.select("."+b+" ."+i);p.addCls(r),void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());var t=m.sparkConfig||{};for(t.showOnMax&&(t.maxValue=Math.max.apply(Math,k.getColumnData(n,m.smartIndexFn)));f<g;f++){var u,v=k.get(f),w={rowIndex:f,data:v,style:{},column:m};u=m.smartIndexFn?m.smartIndexFn(v):k.get(f,n),w.value=u,m.format&&(w.value=h.format(w.value,m.format),u=w.value),m.render&&(w=m.render(w),u=w.value),q.item(f).css(w.style),a.apply(t,{renderTo:s.item(f).dom,value:u,column:m}),new a.spark.GrossLoss(t)}},renderProgressBar:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+i),u=100;p.addCls(s),void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());var v=m.sparkConfig||{};for(!1===v.percents&&(u=Math.max.apply(Math,k.getColumnData(n)));f<g;f++){var w,x=k.get(f),y={rowIndex:f,data:x,style:{},column:m};w=m.smartIndexFn?m.smartIndexFn(x):k.get(f,n),y.value=w,m.format&&(y.value=h.format(y.value,m.format),w=y.value),m.render&&(y=m.render(y),w=y.value),q.item(f).css(y.style);var z=a.get(r.item(f).dom);if(z.select("."+t).length){var A=a.getWidget(z.select("."+t).item(0).attr("id"));A.value=w,A.maxValue=u,A.update()}else a.apply(v,{renderTo:r.item(f).dom,value:w,column:m,maxValue:u}),new a.spark.ProgressBar(v)}},renderHBar:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+i),s=m.sparkConfig||{},t=m.disabled||{};p.addCls(u);var v,w,x={},c=0,y=Number.MIN_VALUE;if(a.isArray(m.index))for(v=m.index.length;c<v;c++){var z=m.index[c];if(!t[z]){x[z]=k.getColumnData(z);var A=Math.max.apply(Math,x[z]);A>y&&(y=A),w=x[z].length}}else{var B=k.getColumnData(m.index),C=[];for(v=B.length;c<v;c++)for(var D=0,E=B[c].length;D<E;D++)t[D]||(x[D]=x[D]||[],x[D].push(B[c][D]));for(var F in x){var A=Math.max.apply(Math,x[F]);C.push(F),A>y&&(y=A),w=x[F].length}m.fields||(m.fields=C)}for(var G=[],H=0;H<w;H++){G[H]=0;for(var F in x)m.fields&&t[m.index+"."+F]||t[F]||(G[H]+=x[F][H])}for(maxValue=Math.max.apply(Math,G),s.maxItemValue=y,void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var I,B=k.get(f),J={rowIndex:f,data:B,style:{},column:m};I=m.smartIndexFn?m.smartIndexFn(B):k.get(f,n),J.value=I,m.format&&(J.value=h.format(J.value,m.format),I=J.value),m.render&&(J=m.render(J),I=J.value),q.item(f).css(J.style);var K=a.get(r.item(f).dom);if(K.select(".fancy-spark-hbar").length){var L=a.getWidget(K.select(".fancy-spark-hbar").item(0).attr("id"));L.maxValue=maxValue,L.maxItemValue=y,L.update(B)}else a.apply(s,{renderTo:r.item(f).dom,value:I,data:B,column:m,maxValue:maxValue,height:j.cellHeight-1}),new a.spark.HBar(s)}},renderCircle:function(a,c){function e(a,b){var c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg:svg");d.setAttribute("width",b),d.setAttribute("height",b),d.setAttribute("viewBox","0 0 "+b+" "+b);var e=document.createElementNS(c,"circle");e.setAttributeNS(null,"cx",b/2),e.setAttributeNS(null,"cy",b/2),e.setAttributeNS(null,"r",b/2);var f="#F0F0F0";b>50&&(f="F0F0F0"),a<0&&(f="#F9DDE0"),e.setAttributeNS(null,"fill",f),d.appendChild(e);var g=document.createElementNS(c,"path"),h=2*Math.PI/100,i=0,j=a*h-.001,k=b/2+b/2*Math.sin(i),l=b/2-b/2*Math.cos(i),m=b/2+b/2*Math.sin(j),n=b/2-b/2*Math.cos(j),o=0;j-i>Math.PI&&(o=1);var p="M "+b/2+","+b/2+" L "+k+","+l+" A "+b/2+","+b/2+" 0 "+o+" 1 "+m+","+n+" Z";g.setAttribute("d",p),a<0?g.setAttribute("fill","#EA7369"):g.setAttribute("fill","#44A4D3"),d.appendChild(g);var q=document.createElementNS(c,"circle");return q.setAttributeNS(null,"cx",b/2),q.setAttributeNS(null,"cy",b/2),q.setAttributeNS(null,"r",.25*b),q.setAttributeNS(null,"fill","#fff"),d.appendChild(q),d}var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[a],n=m.key||m.index,o=h.el.select("."+d),q=o.item(a),r=q.select("."+b+" ."+i),s=j.cellHeight-4;for(q.addCls(p),void 0!==c?(f=c,g=c+1):(f=0,g=k.getLength());f<g;f++){var t,u=k.get(f),v={rowIndex:f,data:u,style:{}};t=m.smartIndexFn?m.smartIndexFn(u):k.get(f,n),v.value=t,m.render&&(v=m.render(v),t=v.value);var w=r.item(f).dom;""===w.innerHTML&&w.appendChild(e(t,s))}},removeNotUsedCells:function(){for(var a=this,c=a.widget,e=c.store,f=a.el.select("."+d),g=0,h=f.length;g<h;g++)for(var i=f.item(g),j=i.select("."+b),k=e.getLength(),l=j.length;k<l;k++)j.item(k).remove()},getFormat:function(b){var c=this,d=c.widget,e=d.lang;switch(b){case"number":return function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e.thousandSeparator)};case"date":return function(c){var d=a.Date.parse(c,e.date.read,b.mode);return c=a.Date.format(d,e.date.write,b.mode)}}switch(b.type){case"date":return function(c){if(0===c.length)return"";var d=a.Date.parse(c,b.read,b.mode);return c=a.Date.format(d,b.write,void 0,b.mode)}}if(b.inputFn)return b.inputFn},format:function(b,c){switch(a.typeOf(c)){case"string":b=this.getFormat(c)(b);break;case"function":b=c(b);break;case"object":b=c.inputFn?c.inputFn(b):this.getFormat(c)(b)}return b},enableCellDirty:function(a){a.hasCls(j)||(a.addCls(j),a.append('<div class="'+k+'"></div>'))},clearDirty:function(a){var c=this;if(void 0!==a)return c.el.select("."+b+'[index="'+a+'"] .'+k).destroy(),void c.el.select("."+j+'[index="'+a+'"]').removeCls(j);c.el.select("."+k).destroy(),c.el.select("."+j).removeCls(j)},showEmptyText:function(){var b=this,c=b.widget,d=c.store;if("center"===b.side&&(b.emptyTextEl&&(b.emptyTextEl.destroy(),delete b.emptyTextEl),0===d.dataView.length)){var e=a.get(document.createElement("div"));e.addCls(m),e.update(c.emptyText),b.emptyTextEl=a.get(b.el.dom.appendChild(e.dom))}}}}(),function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_INNER_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_BODY_CLS,f=a.GRID_CELL_WRAPPER_CLS,g=a.GRID_COLUMN_SELECT_CLS,h=a.GRID_COLUMN_ELLIPSIS_CLS,i=a.GRID_COLUMN_ORDER_CLS,j=a.GRID_COLUMN_TEXT_CLS,k=a.GRID_COLUMN_SPARKLINE_CLS,l=(a.GRID_COLUMN_SPARKLINE_BULLET_CLS,a.GRID_COLUMN_CHART_CIRCLE_CLS),m=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,n=a.GRID_COLUMN_GROSSLOSS_CLS,o=a.GRID_COLUMN_PROGRESS_CLS,p=(a.GRID_COLUMN_PROGRESS_BAR_CLS,a.GRID_COLUMN_H_BAR_CLS),q=a.ANIMATE_DURATION;a.define("Fancy.grid.Body",{extend:a.Widget,mixins:[a.grid.body.mixin.Updater],cls:e,cellTpl:['<div class="'+c+'">{cellValue}</div>'],cellWrapperTpl:['<div class="'+f+'">','<div class="'+c+'">{cellValue}</div>',"</div>"],constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.addEvents("adddomcolumns"),a.initTpl(),a.render(),a.ons()},initTpl:function(){var b=this;b.cellTpl=new a.Template(b.cellTpl),b.cellWrapperTpl=new a.Template(b.cellWrapperTpl)},ons:function(){var a=this,c=a.widget,e=c.id;c.on("afterrender",a.onAfterRender,a);var f="."+d+'[grid="'+e+'"]',g=f+" div."+b;a.el.on("click",a.onCellClick,a,g),a.el.on("dblclick",a.onCellDblClick,a,g),a.el.on("mouseenter",a.onCellMouseEnter,a,g),a.el.on("mouseleave",a.onCellMouseLeave,a,g),a.el.on("mousedown",a.onCellMouseDown,a,g),a.el.on("mouseenter",a.onColumnMouseEnter,a,f),a.el.on("mouseleave",a.onColumnMouseLeave,a,f)},render:function(){var b,c=this,d=c.widget,f=a.get(document.createElement("div"));f.addCls(e),b=d.el.select(".fancy-grid-"+c.side).dom,c.el=a.get(b.appendChild(f.dom))},onAfterRender:function(){this.update(),this.setHeight()},setColumnsPosition:function(a){var b=this,c=b.widget,e=b.getColumns(),f=0,g=e.length,h=0,i=b.el.select("."+d+'[grid="'+c.id+'"]'),a=a||b.scrollLeft||0;for(h+=a;f<g;f++){var j=e[f];i.item(f).css({left:h+"px"}),j.hidden||(h+=j.width)}},wheelScroll:function(a){var b=this,c=b.widget,e=c.knobOffSet,f=b.el.select("."+d+'[grid="'+c.id+'"]');if(0!==f.length){for(var g=parseInt(f.item(0).css("top")),h=0,i=f.length,j=c.getBodyHeight(),k=c.getCellsViewHeight(),l=k-j+e,m={oldScroll:parseInt(f.item(0).css("top")),newScroll:parseInt(f.item(0).css("top"))+30*a,deltaScroll:30*a};h<i;h++){var n=f.item(h),o=parseInt(n.css("top"))+30*a;o>0?(o=0,m.newScroll=0):Math.abs(o)>l&&(o=-l-e,m.newScroll=o),n.css("top",o+"px")}return m.scrolled=g!==parseInt(f.item(0).css("top")),m}},scroll:function(a,b){var c=this,e=c.widget,f=c.el.select("."+d+'[grid="'+e.id+'"]'),g=0,h=f.length,i={};if(!1!==a&&null!==a&&void 0!==a)for(i.scrollTop=a;g<h;g++){var j=f.item(g);j.css("top",-a+"px")}return!1!==b&&null!==b&&void 0!==b&&(i.scrollLeft=b,e.header&&e.header.scroll(b),c.scrollLeft=b,e.body.setColumnsPosition(b),"center"===c.side&&(e.grouping&&e.grouping.scrollLeft(b),e.summary&&e.summary.scrollLeft(b))),i},setHeight:function(){var a=this.widget.getBodyHeight();this.css("height",a+"px")},onCellClick:function(a){var b=this,c=b.widget;c.fire("cellclick",b.getEventParams(a)),c.fire("rowclick",b.getEventParams(a)),c.fire("columnclick",b.getColumnEventParams(a)),!1===c.activated&&(c.activated=!0,c.fire("activate"))},onCellDblClick:function(a){var b=this,c=b.widget;c.fire("celldblclick",b.getEventParams(a)),c.fire("rowdblclick",b.getEventParams(a)),c.fire("columndblclick",b.getColumnEventParams(a))},getEventParams:function(b){var c=this,d=c.widget,e=d.store,f=c.getColumns(),g=b.currentTarget,h=a.get(b.currentTarget),i=h.parent();if(void 0===h.parent().dom)return!1;if(0===e.getLength())return!1;var j=parseInt(i.attr("index")),k=parseInt(h.attr("index")),l=f[j],m=l.index||l.key,n=e.get(k,m),o=e.getId(k),p=e.get(k),q=e.getById(o);return l.smartIndexFn&&(n=l.smartIndexFn(p)),{e:b,id:o,side:c.side,cell:g,column:l,rowIndex:k,columnIndex:j,value:n,data:p,item:q}},getColumnEventParams:function(b){var c=this,d=c.widget,e=d.store,f=a.get(b.currentTarget),g=f.parent(),h=parseInt(g.attr("index")),i=c.getColumns(),j=i[h],k={e:b,side:c.side,columnIndex:h,column:j,columnDom:g.dom};return d.columnClickData&&(k.data=e.getColumnData(j.index,j.smartIndexFn)),k},getColumnHoverEventParams:function(b){var c=this,d=a.get(b.currentTarget),e=parseInt(d.attr("index")),f=c.getColumns(),g=f[e];return{e:b,side:c.side,columnIndex:e,column:g,columnDom:d.dom}},getColumns:function(){return this.widget.getColumns(this.side)},onCellMouseEnter:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;a.nojQuery&&f&&c.fixZeptoBug&&(e.rowIndex===f.rowIndex&&e.columnIndex===f.columnIndex&&e.side===f.side||(d.fire("cellleave",f),e.rowIndex!==f.rowIndex&&d.fire("rowleave",f))),f?e.rowIndex!==c.prevCellOver.rowIndex&&d.fire("rowenter",e):d.fire("rowenter",e),d.fire("cellenter",e),c.prevCellOver=e},onCellMouseDown:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f={e:e.e,side:e.side,columnDom:a.get(e.cell).parent().dom,column:e.column,columnIndex:e.columnIndex};d.fire("beforecellmousedown",e),d.fire("cellmousedown",e),d.fire("columnmousedown",f)},onCellMouseLeave:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;if(a.nojQuery){if(void 0===f)return;return void(c.fixZeptoBug=e)}d.fire("rowleave",f),d.fire("cellleave",f),delete c.prevCellOver},onColumnMouseEnter:function(a){var b=this,c=b.widget,d=b.getColumnHoverEventParams(a);b.prevColumnOver?b.prevCellOver&&d.rowIndex!==b.prevCellOver.rowIndex&&c.fire("rowenter",d):c.fire("columnenter",d),b.prevColumnOver=d},onColumnMouseLeave:function(a){var b=this;b.widget.fire("columnleave",b.prevColumnOver),delete b.prevColumnOver},getCell:function(a,c){var e=this,f=e.widget;return this.el.select("."+d+'[index="'+c+'"][grid="'+f.id+'"] .'+b+'[index="'+a+'"]')},getDomCell:function(a,c){var e=this,f=e.widget;return e.el.select("."+d+'[index="'+c+'"][grid="'+f.id+'"] .'+b+'[index="'+a+'"]').dom},getDomColumn:function(a){var b=this,c=b.widget;return b.el.select("."+d+'[index="'+a+'"][grid="'+c.id+'"]').dom},destroy:function(){var a=this,c=a.el,e="div."+b,f="div."+d;c.un("click",a.onCellClick,a,e),c.un("dblclick",a.onCellDblClick,a,e),c.un("mouseenter",a.onCellMouseEnter,a,e),c.un("mouseleave",a.onCellMouseLeave,a,e),c.un("mousedown",a.onCellMouseDown,a,e),c.un("mouseenter",a.onColumnMouseEnter,a,f),c.un("mouseleave",a.onColumnMouseLeave,a,f)},hideColumn:function(a){var b=this,c=b.el.select("."+d),e=c.item(a),f=parseInt(e.css("width")),g=a+1,h=c.length;for(e.hide();g<h;g++){var i=c.item(g),j=parseInt(i.css("left"))-f;i.css("left",j)}},showColumn:function(a){var b,c=this,e=c.el.select("."+d),f=e.item(a),g=a+1,h=e.length;for(f.show(),b=parseInt(f.css("width"));g<h;g++){var i=e.item(g),j=parseInt(i.css("left"))+b;i.css("left",j)}},removeColumn:function(a){var b=this,c=b.el.select("."+d),e=c.item(a),f=parseInt(e.css("width")),g=a+1,h=c.length;for(e.destroy();g<h;g++){var i=c.item(g),j=parseInt(i.css("left"))-f;i.attr("index",g-1),i.css("left",j)}},insertColumn:function(b,c){var e,f=this,k=f.widget,l=f.getColumns(),m=f.el.select("."+d),n=c.width,o=a.get(document.createElement("div")),p=b,q=m.length,r=0,s=0,t=b;for("center"===f.side&&(r=-k.scroller.scrollLeft);s<t;s++)r+=l[s].width;for(e=r;p<q;p++){var u=m.item(p);r=parseInt(u.css("left"))+c.width,u.css("left",r),u.attr("index",p+1)}if(o.addCls(d),o.attr("grid",k.id),"$selected"===c.index)o.addCls(g);else switch(c.type){case"order":o.addCls(i)}if(c.cls&&o.addCls(c.cls),"text"===c.type&&o.addCls(j),o.css({width:n+"px"}),o.attr("index",b),c.cellAlign&&o.css("text-align",c.cellAlign),!0===c.ellipsis)switch(c.type){case"string":case"text":case"number":o.addCls(h)}var v=k.scroller.getScroll();o.css("top",-v),0===b&&m.length?(o.css("left","0px"),f.el.dom.insertBefore(o.dom,m.item(b).dom)):0!==b&&m.length&&(b===m.length?(o.css("left",r+"px"),f.el.dom.appendChild(o.dom)):(o.css("left",e+"px"),f.el.dom.insertBefore(o.dom,m.item(b).dom))),f.checkDomCells(),f.updateRows(void 0,b)},reSetIndexes:function(){var b=this,c=b.getColumns();a.each(c,function(a,c){b.el.select("."+d+'[index="'+c+'"]').attr("index",c)})},clearColumnsStyles:function(){this.el.select("div."+b).each(function(a){a.css("color",""),a.css("background-color","")})},updateColumnsSizes:function(){var b=this,c=b.widget,e=b.getColumns(),f=0;"center"===b.side&&(f=-c.scroller.scrollLeft),a.each(e,function(a,c){b.el.select("."+d+'[index="'+c+'"]').animate({width:a.width,left:f},q),f+=a.width})},reSetColumnsAlign:function(){var a=this,b=a.getColumns();this.el.select("."+d).each(function(a,c){var d=b[c];a.css("text-align",d.cellAlign||"")})},reSetColumnsCls:function(){var b=this,c=b.getColumns();this.el.select("."+d).each(function(b,e){var f=c[e],g=b.attr("class").split(" ");a.each(g,function(a){switch(a){case d:case f.cls:case r[f.type]:break;default:b.removeCls(a)}}),f.cls&&b.addCls(f.cls),"order"===f.type&&b.addCls(i),f.menu})}});var r={sparklineline:k,sparklinebar:k,sparklinetristate:k,sparklinediscrete:k,sparklinebullet:k,sparklinepie:k,sparklinebox:k,circle:l,progressdonut:m,grossloss:n,progressbar:o,hbar:p}}(),function(){var a=Fancy,b=a.GRID_HEADER_COLUMN_TRIGGERED_CLS,c=a.GRID_HEADER_CELL_TRIGGER_UP_CLS,d=a.GRID_HEADER_CELL_TRIGGER_DOWN_CLS;a.Mixin("Fancy.grid.header.mixin.Menu",{triggeredColumnCls:b,triggerUpCls:c,triggerDownCls:d,showMenu:function(c,d,e,f){var g=this,h=g.widget,i=c.offset();g.hideMenu(),c.addCls(b),e.menu.rendered?g.updateColumnsMenu(e,f):(e.menu=g.generateMenu(e,f),e.menu=new a.Menu({column:e,items:e.menu,theme:h.theme,events:[{hide:g.onMenuHide,scope:g}]})),e.menu.showAt(i.left+parseInt(c.css("width"))-26,i.top+parseInt(c.css("height"))-1),g.activeMenu=e.menu,g.activeCell=c},hideMenu:function(){var a=this,c=a.widget,d=c.header,e=c.rightHeader,f=c.leftHeader;switch(a.side){case"left":d.activeMenu&&(d.activeMenu.hide(),d.activeCell.removeCls(b),delete d.activeMenu,delete d.activeCell),e.activeMenu&&(e.activeMenu.hide(),e.activeCell.removeCls(b),delete e.activeMenu,delete e.activeCell);break;case"center":f.activeMenu&&(f.activeMenu.hide(),f.activeCell.removeCls(b),delete f.activeMenu,delete f.activeCell),e.activeMenu&&(e.activeMenu.hide(),e.activeCell.removeCls(b),delete e.activeMenu,delete e.activeCell);break;case"right":f.activeMenu&&(f.activeMenu.hide(),f.activeCell.removeCls(b),delete f.activeMenu,delete f.activeCell),d.activeMenu&&(d.activeMenu.hide(),d.activeCell.removeCls(b),delete d.activeMenu,delete d.activeCell)}a.activeMenu&&(a.activeMenu.hide(),a.activeCell.removeCls(b)),delete a.activeMenu,delete a.activeCell},generateMenu:function(a,b){for(var e,f=this,g=f.widget,h=g.lang,i=[],j="",k=0,l=b.length;k<l;k++)if(a.index===b[k].index){e=k;break}switch(!1===a.sortable&&(j="fancy-menu-item-disabled"),a.sortable&&(i.push({text:h.sortAsc,cls:j,imageCls:c,handler:function(){g.sorter.sort("asc",a.index,f.side),a.menu.hide()}}),i.push({text:h.sortDesc,cls:j,imageCls:d,handler:function(){g.sorter.sort("desc",a.index,f.side),a.menu.hide()}})),i.push({text:h.columns,index:"columns",items:f.prepareColumns(b)}),f.side){case"left":case"right":!1!==a.lockable&&i.push({text:"Unlock",handler:function(){a.menu.hide(),g.unLockColumn(e,f.side)}});break;case"center":b.length>1&&g.leftColumns.length&&!1!==a.lockable&&i.push({text:"Lock",handler:function(){a.menu.hide(),g.lockColumn(e,f.side)}}),b.length>1&&g.rightColumns.length&&!1!==a.lockable&&i.push({text:"Right Lock",handler:function(){a.menu.hide(),g.rightLockColumn(e,f.side)}})}return i},prepareColumns:function(a){for(var b,c=this,d=c.widget,e=[],f=0,g=a.length,h=[];f<g;f++){var i=!0,j=a[f];j.hidden&&(i=!1);var k={text:j.title,checked:i,index:j.index,handler:function(a,b){if(!0!==b.checked||b.checkbox.get()||b.checkbox.set(!0),b.checked&&1===a.el.select(".fancy-checkbox-on").length)return void b.checkbox.set(!0);b.checked=!b.checked,b.checkbox.set(b.checked),b.checked?d.showColumn(c.side,b.index):d.hideColumn(c.side,b.index)}};j.grouping?(h=h||[],h.push(k),b=j.grouping):(h.length&&(e.push({text:b,items:h}),b=void 0,h=[]),e.push(k))}return h.length&&e.push({text:b,items:h}),e},onMenuHide:function(){this.el.select("."+b).removeCls(b)},updateColumnsMenu:function(a,b,c){for(var d,e,f=this,g=a.menu,h=0,i=g.items.length;h<i;h++)if(e=g.items[h],"columns"===e.index){d=e;break}h=0,i=d.items.length;for(var j=!1;h<i;h++){e=d.items[h];var k=b[h];e.checkbox&&(e.checkbox.set(!k.hidden,!1),j=!0)}j||c||(d.items=f.prepareColumns(b))},destroyMenus:function(){for(var b,c=this,d=c.widget,e=d.getColumns(c.side),f=0,g=e.length;f<g;f++)b=e[f],a.isObject(b.menu)&&b.menu.destroy()}})}(),function(){var a=Fancy,b=a.GRID_HEADER_CLS,c=a.GRID_HEADER_CELL_CLS,d=a.GRID_HEADER_CELL_CONTAINER_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_TRIGGER_DISABLED_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,j=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,k=a.GRID_HEADER_CELL_SELECT_CLS,l=a.GRID_HEADER_CELL_FILTER_FULL_CLS,m=a.GRID_HEADER_CELL_FILTER_SMALL_CLS,n=a.GRID_HEADER_CELL_TRIPLE_CLS,o=a.ANIMATE_DURATION;a.define("Fancy.grid.Header",{extend:a.Widget,cls:b,mixins:["Fancy.grid.header.mixin.Menu"],cellTpl:['<div class="'+c+' {cls}" style="display:{display};width:{columnWidth}px;height: {height};left: {left};" {groupIndex} index="{index}">','<div class="'+d+'" style="height: {height};">','<span class="'+e+'">{columnName}</span>','<span class="'+f+'">','<div class="'+g+'"></div>',"</span>","</div>","</div>"],constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initTpl(),a.render(),a.renderHeaderCheckBox(),a.setAlign(),a.setCellsPosition(),a.ons()},initTpl:function(){this.cellTpl=new a.Template(this.cellTpl)},ons:function(){var a=this,b=a.widget,d=a.el,e="div."+c;b.on("render",a.onAfterRender,a),b.on("docmove",a.onDocMove,a),d.on("click",a.onTriggerClick,a,"span."+f),d.on("click",a.onCellClick,a,e),d.on("mousemove",a.onCellMouseMove,a,e),d.on("mousedown",a.onCellMouseDown,a,e),d.on("mousedown",a.onMouseDown,a)},render:function(){var b,c=this,d=c.widget,e=c.getColumns(),f=a.get(document.createElement("div")),g="",j=0,n=e.length,o=1,p={},q=0,r=d.filter&&d.filter.header,s="full",t=d.cellHeaderHeight;for(d.groupheader&&(r&&!d.filter.groupHeader?s="small":o=2),r&&o++;j<n;j++){var u=e[j],v=u.title||u.header,w=t,x="",y="";if(1!==o&&(u.grouping?(p[u.grouping]||(p[u.grouping]={width:0,title:u.grouping,left:q}),w=r&&d.filter.groupHeader?2*t+"px":t+"px",u.hidden||(p[u.grouping].width+=u.width),y='group-index="'+u.grouping+'"',x=i):w=o*t+"px"),q+=u.width,"$selected"===u.index&&(x+=" "+k),u.menu||(x+=" "+h),u.filter&&u.filter.header)switch(s){case"small":x+=" "+m;break;case"full":x+=" "+l}g+=c.cellTpl.getHTML({cls:x,columnName:v,columnWidth:u.width,index:j,height:w,left:"initial",groupIndex:y,display:u.hidden?"none":""})}f.css({height:t*o+"px",width:c.getColumnsWidth()}),f.addCls(c.cls),d.groupheader&&(f.addCls("fancy-grid-header-grouped"),g+=c.getGroupingCellsHTML(p)),f.update(g),b=d.el.select(".fancy-grid-"+c.side).dom,c.el=a.get(b.appendChild(f.dom))},insertCell:function(b,d){var e=this,f=e.widget,g=e.el.select("."+c+":not(."+j+")"),i=e.getColumns(),l="",m=d.title||d.header,n=parseInt(g.item(0).css("height")),o="",p=0;if("center"===e.side&&(p=-f.scroller.scrollLeft),f.groupheader){n=2*f.cellHeight;var q=e.el.select("."+j);b!==f.columns.length-1&&q.each(function(a){var b=parseInt(a.css("left")||0)+d.width;a.css("left",b)})}"$selected"===d.index&&(l+=" "+k),d.menu||(l+=" "+h);for(var r=0,s=b;r<s;r++)p+=i[r].width;for(var t=b,u=i.length-1;t<u;t++){var v=g.item(t),w=parseInt(v.css("left")||0)+d.width;v.css("left",w)}var x=e.cellTpl.getHTML({cls:l,columnName:m,columnWidth:d.width,index:b,height:String(n)+"px",left:String(p)+"px",groupIndex:o});0===b&&g.length?a.get(g.item(0).before(x)):0!==b&&g.length&&(b===g.length?e.el.append(x):a.get(g.item(b).before(x))),e.css("width",parseInt(e.css("width"))+d.width)},setAlign:function(){for(var a=this,b=a.getColumns(),c=0,d=b.length;c<d;c++){var e=b[c];e.align&&a.getDomCell(c).css("text-align",e.align)}},onAfterRender:function(){},setCellsPosition:function(){var b=this,d=b.widget,e=b.getColumns(),f=0,g=b.el.select("."+c);if(f+=b.scrollLeft||0,a.each(e,function(a,b){var c=g.item(b),e="0px";a.grouping&&(e=d.cellHeaderHeight+"px"),c.css({top:e,left:f+"px"}),a.hidden||(f+=a.width)}),d.groupheader){b.el.select("."+j).each(function(c){var d=c.attr("index"),f=b.el.select('[group-index="'+d+'"]'),g=f.item(0).css("left"),h=0;a.each(e,function(a){a.grouping!==d||a.hidden||(h+=a.width)}),c.css("left",g),c.css("width",h)})}},fixGroupHeaderSizing:function(){var b=this,d=b.widget,e=d.cellHeaderHeight,f=b.getColumns(),g=b.el.select("."+c),h=0,k={},n={},o={},p=b.calcRows();"center"===b.side&&(h=d.scroller.scrollLeft),a.each(f,function(a,b){var c=g.item(b),f=a.grouping,j="0px",q=e*p;k[f]=!0,f?(void 0===n[f]?(n[f]=a.width,o[f]=h):n[f]+=a.width,c.addCls(i),j=e+"px",q=e,a.filter&&a.filter.header&&(q=2*e,setTimeout(function(){c.addCls(l)},30))):(c.removeCls(i),a.filter&&a.filter.header&&(setTimeout(function(){c.addCls(m)},30),c.addCls(m))),!d.groupheader||q!==e||f||a.filter||(q=2*e),c.css({top:j,height:q}),h+=a.width});for(var q in n){b.el.select('[index="'+q+'"]').css({left:o[q],width:n[q]})}b.el.select("."+j).each(function(a){var b=a.attr("index");k[b]||a.destroy()})},getColumnsWidth:function(){for(var a=this,b=a.getColumns(),c=0,d=0,e=b.length;d<e;d++){c+=b[d].width}return c},getColumns:function(){var a,b=this,c=b.widget;switch(b.side){case"left":a=c.leftColumns;break;case"center":a=c.columns;break;case"right":a=c.rightColumns}return a},getDomCell:function(a){return this.el.select("."+c).item(a)},onCellClick:function(b){var c=this,d=c.widget,e=d.columndrag,h=b.currentTarget,i=a.get(b.target),k=parseInt(a.get(h).attr("index"));e&&"dragging"===e.status||i.hasCls(f)||i.hasCls(g)||a.get(h).hasCls(j)||d.fire("headercellclick",{e:b,side:c.side,cell:h,index:k})},onCellMouseMove:function(b){var c=this,d=c.widget,e=b.currentTarget,f=a.get(e),g=f.hasCls(j),h=parseInt(a.get(e).attr("index"));g||d.fire("headercellmousemove",{e:b,side:c.side,cell:e,index:h})},onMouseDown:function(b){"INPUT"===a.get(b.target).prop("tagName")||b.preventDefault()},onCellMouseDown:function(b){var c=this.widget,d=b.currentTarget,e=parseInt(a.get(d).attr("index"));c.fire("headercellmousedown",{e:b,side:this.side,cell:d,index:e})},scroll:function(a){this.scrollLeft=a,this.setCellsPosition()},getGroupingCellsHTML:function(b){var c=this,d=c.widget,e="";return a.each(b,function(a,b){e+=c.cellTpl.getHTML({cls:j,columnName:a.title,columnWidth:a.width,index:b,height:d.cellHeaderHeight+"px",left:a.left+"px",groupIndex:""})}),e},destroy:function(){var a=this,b=a.el,d="div."+c;b.un("click",a.onCellClick,a,d),b.un("mousemove",a.onCellMouseMove,a,d),b.un("mousedown",a.onCellMouseDown,a,d),b.un("mousedown",a.onMouseDown,a)},getCell:function(a){return this.el.select("."+c+'[index="'+a+'"]')},onTriggerClick:function(b){var c=this,d=a.get(b.currentTarget),e=d.parent().parent(),f=parseInt(e.attr("index")),g=c.getColumns(),h=g[f];b.stopPropagation(),c.showMenu(e,f,h,g)},hideCell:function(b){var d=this,e=d.el.select("."+c+":not(."+j+")"),f=e.item(b),g=parseInt(f.css("width")),h=b+1,k=e.length,l=d.getColumns();if(f.hasCls(i)){var m=f.attr("group-index"),n=d.el.select("."+j+'[index="'+m+'"]').item(0),o=parseInt(n.css("width"));n.css("width",o-g)}f.hide();for(var p={};h<k;h++){var q=e.item(h),r=parseInt(q.css("left"))-g,s=l[h];s.grouping&&l[b].grouping!==s.grouping&&(p[s.grouping]=!0),q.css("left",r)}a.each(p,function(a,b){var c=d.el.select("."+j+'[index="'+b+'"]').item(0);c.css("left",parseInt(c.css("left"))-g)})},showCell:function(a){var b,d=this,e=d.el.select("."+c+":not(."+j+")"),f=e.item(a),g=a+1,h=e.length,k=d.getColumns();if(f.show(),b=parseInt(f.css("width")),f.hasCls(i)){var l=f.attr("group-index"),m=d.el.select("."+j+'[index="'+l+'"]').item(0),n=parseInt(m.css("width"));m.css("width",n+b)}for(var o={};g<h;g++){var p=e.item(g),q=parseInt(p.css("left"))+b,r=k[g];r.grouping&&k[a].grouping!==r.grouping&&(o[r.grouping]=!0),p.css("left",q)}for(var s in o){var m=d.el.select("."+j+'[index="'+s+'"]').item(0);m.css("left",parseInt(m.css("left"))+b)}},removeCell:function(a){var b=this,d=b.el.select("."+c+":not(."+j+")"),e=d.item(a),f=parseInt(e.css("width")),g=a+1,h=d.length,i={},k=!1;for(e.attr("group-index")&&(k=e.attr("group-index"),i[k]=!0),e.destroy();g<h;g++){var l=d.item(g),m=parseInt(l.css("left"))-f;l.attr("group-index")&&(i[l.attr("group-index")]=!0),l.attr("index",g-1),l.css("left",m)}for(var n in i){var o=b.el.select('[index="'+n+'"]'),p=parseInt(o.css("width"))-f,q=parseInt(o.css("left"))-f;k&&o?(o.css("width",p),o.attr("index")!==k&&o.css("left",q)):o.css("left",q)}if(k&&0===b.el.select('[group-index="'+k+'"]').length){var o=b.el.select('[index="'+k+'"]');o.destroy()}"center"!==b.side&&b.css("width",parseInt(b.css("width"))-f)},renderHeaderCheckBox:function(){for(var b=this,d=b.widget,f=b.getColumns(),g=0,h=f.length,i=b.el.select("."+c+":not(."+j+")");g<h;g++){var k=f[g];if(!0===k.headerCheckBox){var l=i.item(g),m=l.firstChild(),n=l.select("."+e),o=n.dom.innerHTML,p=o||!1,q=0;l.addCls("fancy-grid-header-cell-checkbox"),n.update(""),p.length&&(q=15*p.width),k.headerCheckBox=new a.CheckBox({renderTo:m.dom,renderId:!0,labelWidth:q,value:!1,label:p,labelAlign:"right",style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){for(var c=0,e=d.getViewTotal();c<e;c++)d.set(c,k.index,b)}}]})}}},reSetIndexes:function(){this.el.select("."+c+":not(."+j+")").each(function(a,b){a.attr("index",b)})},reSetGroupIndexes:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){var d=b[c],e=d.grouping;a.attr("group-index")&&!e?a.removeAttr("group-index"):e&&a.attr("group-index")!==e&&a.attr("group-index",e)})},updateTitles:function(){var b=this,d=b.getColumns();a.each(d,function(a,d){b.el.select("div."+c+'[index="'+d+'"] .'+e).update(a.title||"")})},updateCellsSizes:function(){var b=this,d=b.widget,e=b.getColumns(),f=0;"center"===b.side&&(f=-d.scroller.scrollLeft),a.each(e,function(a,d){b.el.select("div."+c+'[index="'+d+'"]').animate({width:a.width,left:f},o),f+=a.width})},calcRows:function(){var a=this,b=a.widget,c=b.columns.concat(b.leftColumns).concat(b.rightColumns),d=1;if(Fancy.each(c,function(a){a.grouping&&(d<2&&(d=2),a.filter&&a.filter.header&&d<3&&(d=3)),a.filter&&a.filter.header&&d<2&&(d=2)}),b.groupheader&&2===d){b.el.select("."+n).length&&(d=3)}return d},reSetColumnsAlign:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){var d=b[c];a.css("text-align",d.align||"")})},destroyMenus:function(){},onDocMove:function(){var a=this,b=a.widget;("none"===b.el.css("display")||b.panel&&b.panel.el&&"none"===b.panel.el.css("display")&&a.hideMenu)&&a.hideMenu()},reSetColumnsCls:function(){var a=this,b=(a.widget,a.getColumns());this.el.select("."+c+":not(."+j+")").each(function(a,c){b[c].menu?a.removeCls(h):a.addCls(h)})}})}(),function(){var a=Fancy,b=a.Date,c=a.PICKER_DATE_CELL_ACTIVE_CLS,d=a.PICKER_DATE_CLS,e=a.PICKER_DATE_CELL_TODAY_CLS,f=a.PICKER_DATE_CELL_OUT_RANGE_CLS,g=a.PICKER_BUTTON_BACK_CLS,h=a.PICKER_BUTTON_NEXT_CLS,i=a.PICKER_BUTTON_DATE_CLS,j=a.PICKER_BUTTON_DATE_WRAPPER_CLS,k=a.PICKER_BUTTON_TODAY_CLS,l=a.PICKER_BUTTON_TODAY_WRAPPER_CLS;a.define("Fancy.datepicker.Manager",{singleton:!0,opened:[],add:function(a){this.hide(),this.opened.push(a)},hide:function(){for(var a=this.opened,b=0,c=a.length;b<c;b++)a[b].hide();this.opened=[]}}),a.define(["Fancy.picker.Date","Fancy.DatePicker"],{extend:a.Grid,type:"datepicker",mixins:["Fancy.grid.mixin.Grid",a.panel.mixin.PrepareConfig,a.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn","Fancy.grid.mixin.Edit"],width:308,height:299,frame:!1,i18n:"en",cellTrackOver:!0,cellStylingCls:[f,e,c],activeCellCls:c,todayCellCls:e,pickerDateCls:d,outRangeCellCls:f,buttonBackCls:g,buttonDateCls:i,buttonDateWrapperCls:j,buttonNextCls:h,buttonTodayCls:k,buttonTodayWrapperCls:l,defaults:{type:"string",width:44,align:"center",cellAlign:"center"},gridBorders:[1,0,1,1],panelBodyBorders:[0,0,0,0],barScrollEnabled:!1,constructor:function(b){var c=this;a.apply(c,b),c.initFormat(),c.initColumns(),c.initDate(),c.initData(),c.initBars(),c.Super("constructor",[c])},init:function(){var a=this;a.Super("init",arguments),a.onUpdate(),a.addEvents("changedate"),a.on("update",a.onUpdate,a),a.on("cellclick",a.onCellClick,a),a.addCls(d),a.el.on("mousewheel",a.onMouseWheel,a),a.panel.el.on("mousedown",a.onMouseDown,a)},initFormat:function(){var b=this;b.format||(b.format=a.i18n[b.i18n].date)},initMonthPicker:function(){var b=this;(a.fullBuilt||!1===a.MODULELOAD||!1===a.MODULELOAD||!b.monthPicker&&a.modules.grid)&&(b.monthPicker=new a.MonthPicker({date:b.date,renderTo:b.panel.el.dom,style:{position:"absolute",top:"-"+b.panel.el.height()+"px",left:"0px"},events:[{cancelclick:b.onMonthCancelClick,scope:b},{okclick:b.onMonthOkClick,scope:b}]}))},initData:function(){this.data=this.setData()},initDate:function(){var a=this;void 0===a.date&&(a.date=new Date),a.showDate=a.date},initColumns:function(){for(var a=this,d=a.format,g=d.days,h=d.startDay,i=h,j=g.length,k=b.dayIndexes,l=[],m=new Date,n=function(b){switch(b.cls="",b.rowIndex){case 0:Number(b.value)>20&&(b.cls+=" "+f);break;case 4:case 5:Number(b.value)<15&&(b.cls+=" "+f)}var d=a.date,g=a.showDate;return m.getMonth()===g.getMonth()&&m.getFullYear()===g.getFullYear()&&b.value===m.getDate()&&(0===b.rowIndex?b.value<20&&(b.cls+=" "+e):4===b.rowIndex||5===b.rowIndex?b.value>20&&(b.cls+=" "+e):b.cls+=" "+e),d.getMonth()===g.getMonth()&&d.getFullYear()===g.getFullYear()&&b.value===d.getDate()&&(0===b.rowIndex?b.value<20&&(b.cls+=" "+c):4===b.rowIndex||5===b.rowIndex?b.value>20&&(b.cls+=" "+c):b.cls+=" "+c),b};i<j;i++)l.push({index:k[i],title:g[i][0].toLocaleUpperCase(),render:n});for(i=0,j=h;i<j;i++)l.push({index:k[i],title:g[i][0].toLocaleUpperCase(),render:n});a.columns=l},getDataFields:function(){for(var a=this,c=[],d=a.format,e=d.days,f=d.startDay,g=f,h=e.length,i=b.dayIndexes;g<h;g++)c.push(i[g]);for(g=0,h=f;g<h;g++)c.push(i[g]);return c},setData:function(){for(var a=this,c=a.format,d=c.startDay,e=a.showDate,f=b.getDaysInMonth(e),g=b.getFirstDayOfMonth(e),h=[],i=a.getDataFields(),j=0,k=f,l=0;j<k;j++){var m=j+g-d+l;m<0&&(m=7-d,l=m+1),0===m&&(m=7,l=m),h[m]=j+1}var n=e.getMonth(),o=e.getFullYear(),p=e.getDate(),q=e.getHours(),r=e.getMinutes(),s=e.getSeconds(),t=e.getMilliseconds();0===n?(n=11,o--):n--;var u=new Date(o,n,p,q,r,s,t),v=b.getDaysInMonth(u);for(j=7;j--;)void 0===h[j]&&(h[j]=v,v--);for(var j=28,k=42,w=1;j<k;j++)void 0===h[j]&&(h[j]=w,w++);for(var x=[],j=0,k=6;j<k;j++)x[j]=h.splice(0,7);return{fields:i,items:x}},initBars:function(){this.initTBar(),this.initBBar()},initTBar:function(){var a=this,b=[];b.push({cls:g,handler:a.onBackClick,scope:a,style:{}}),b.push({cls:i,wrapper:{cls:j},handler:a.onDateClick,scope:a,text:"                       "}),b.push("side"),b.push({cls:h,handler:a.onNextClick,scope:a}),a.tbar=b},initBBar:function(){var a=this,b=[];b.push({text:a.format.today,cls:k,wrapper:{cls:l},handler:a.onClickToday,scope:a}),a.bbar=b},onBackClick:function(){var a=this,b=a.showDate,c=b.getMonth(),d=b.getFullYear(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();0===c?(c=11,d--):c--,a.showDate=new Date(d,c,e,f,g,h,i);var j=a.setData();a.store.setData(j.items),a.update()},onNextClick:function(){var a=this,b=a.showDate,c=b.getMonth(),d=b.getFullYear(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();11===c?(c=0,d++):c++,a.showDate=new Date(d,c,e,f,g,h,i);var j=a.setData();a.store.setData(j.items),a.update()},onUpdate:function(){var a=this,c=b.format(a.showDate,"F Y",{date:a.format});a.tbar[1].setText(c)},onClickToday:function(){var a=this,b=new Date;a.showDate=b,a.date=b;var c=a.setData();a.store.setData(c.items),a.update()},onCellClick:function(b,d){var e,g=this,h=g.showDate,i=h.getFullYear(),j=h.getMonth(),k=h.getHours(),l=h.getMinutes(),m=h.getSeconds(),n=h.getMilliseconds(),o=a.get(d.cell);if(g.date=new Date(i,j,Number(d.value),k,l,m,n),g.el.select("."+c).removeCls(c),o.addCls(c),g.fire("changedate",g.date),o.hasCls(f)){e=Number(d.value),d.rowIndex<3?0===j?(i--,j=11):j--:11===j?(i++,j=11):j++,g.date=new Date(i,j,e,k,l,m,n),g.showDate=g.date;var p=g.setData();g.store.setData(p.items),g.update()}},onMouseWheel:function(b){a.getWheelDelta(b.originalEvent||b)<0?this.onBackClick():this.onNextClick()},onDateClick:function(){var b=this;b.initMonthPicker(),b.monthPicker.panel.css("display","block"),a.$.fn.animate?b.monthPicker.panel.el.animate({top:"0px"}):b.monthPicker.panel.css({top:"0px"})},onMonthCancelClick:function(){this.hideMonthPicker()},onMonthOkClick:function(){var a=this,b=a.monthPicker.date,c=b.getMonth(),d=b.getFullYear(),e=a.date.getDate(),f=a.date.getHours(),g=a.date.getMinutes(),h=a.date.getSeconds(),i=a.date.getMilliseconds();a.hideMonthPicker(),e>28&&(e=1),a.date=new Date(d,c,e,f,g,h,i),a.showDate=a.date;var j=a.setData();a.store.setData(j.items),a.update(),a.fire("changedate",a.date,!1)},hideMonthPicker:function(){var b=this.monthPicker.panel.el;a.$.fn.animate?b.animate({top:"-"+b.css("height")},{complete:function(){b.css("display","none")}}):b.css("display","none")},onMouseDown:function(a){a.preventDefault()},setDate:function(a){var b=this;b.date=a,b.showDate=a,b.store.setData(b.setData().items),b.update()}})}(),function(){var a=Fancy,b=a.PICKER_MONTH_CELL_ACTIVE_CLS,c=a.PICKER_MONTH_CLS,d=a.PICKER_BUTTON_BACK_CLS,e=a.PICKER_BUTTON_NEXT_CLS,f=a.PICKER_MONTH_ACTION_BUTTONS_CLS;a.define(["Fancy.picker.Month","Fancy.MonthPicker"],{extend:a.Grid,type:"monthpicker",mixins:["Fancy.grid.mixin.Grid",a.panel.mixin.PrepareConfig,a.panel.mixin.methods,"Fancy.grid.mixin.PrepareConfig","Fancy.grid.mixin.ActionColumn","Fancy.grid.mixin.Edit"],width:308,height:299,frame:!1,cellHeight:37,i18n:"en",cellTrackOver:!0,cellStylingCls:[b],activeCellCls:b,buttonBackCls:d,buttonNextCls:e,actionButtonsCls:f,defaults:{type:"string",width:76,align:"center",cellAlign:"center"},gridBorders:[1,0,1,1],panelBodyBorders:[0,0,0,0],header:!1,constructor:function(b){var c=this;a.apply(c,b),c.initLang(),c.initColumns(),c.initDate(),c.initData(),c.initBars(),c.Super("constructor",[c])},init:function(){var a=this;a.Super("init",arguments),a.addEvents("cancelclick","okclick"),a.addEvents("changedate"),a.on("cellclick",a.onCellClick,a),a.panel.addCls(c)},initData:function(){this.data=this.setData()},initDate:function(){var a=this;void 0===a.date&&(a.date=new Date),a.showDate=a.date},initLang:function(){var b=this;b.lang||(b.lang=a.Object.copy(a.i18n[b.i18n]))},initColumns:function(){var a=this,c=function(c){var d=a.date,e=d.getMonth();return a.lang.date.months[e].substr(0,3)===c.value&&(c.cls=b),c},d=function(c){return a.date.getFullYear()===Number(c.value)&&(c.cls=b),c};a.columns=[{index:"month1",render:c,locked:!0},{index:"month2",render:c,locked:!0,width:77},{index:"year1",render:d,width:77},{index:"year2",render:d,width:77}]},setData:function(){var a,b,c=this,d=c.lang,e=c.showDate,f=e.getFullYear(),g=d.date.months,h=[],i=[];for(a=0,b=12;a<b;a++)i.push(f-5+a);for(a=0,b=6;a<b;a++)h[a]={},h[a].month1=g[a].substr(0,3),h[a].month2=g[6+a].substr(0,3),h[a].year1=i[a],h[a].year2=i[6+a];return{fields:["month1","month2","year1","year2"],items:h}},initBars:function(){this.initTBar(),this.initBBar()},initTBar:function(){var a=this,b=[];b.push("side"),b.push({cls:d,handler:a.onBackClick,scope:a}),b.push({cls:e,handler:a.onNextClick,scope:a}),a.tbar=b},initBBar:function(){var a=this,b=[],c=a.lang;b.push({type:"wrapper",cls:f,items:[{text:c.date.ok,handler:a.onClickOk,scope:a},{text:c.date.cancel,handler:a.onClickCancel,scope:a}]}),a.bbar=b},onBackClick:function(){var a=this,b=a.showDate,c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();c-=10,a.showDate=new Date(c,d,e,f,g,h,i);var j=a.setData();a.store.setData(j.items),a.update()},onNextClick:function(){var a=this,b=a.showDate,c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getMilliseconds();c+=10,a.showDate=new Date(c,d,e,f,g,h,i);var j=a.setData();a.store.setData(j.items),a.update()},onClickOk:function(){this.fire("okclick")},onClickCancel:function(){this.fire("cancelclick")},onCellClick:function(c,d){var e,f=this,g=f.date,h=g.getFullYear(),i=g.getMonth(),j=g.getDate(),k=g.getHours(),l=g.getMinutes(),m=g.getSeconds(),n=g.getMilliseconds(),o=a.get(d.cell);"center"===d.side?(e=f.body,h=Number(d.value)):(e=f.leftBody,i=d.rowIndex+6*d.columnIndex),e.el.select("."+b).removeCls(b),o.addCls(b),j>28&&(j=1),f.showDate=new Date(h,i,j,k,l,m,n),f.date=f.showDate,f.fire("changedate",f.date)},onMouseWheel:function(b){a.getWheelDelta(b.originalEvent||b)<0?this.onBackClick():this.onNextClick()},onDateClick:function(){this.initMonthPicker()}})}(),Fancy.define("Fancy.spark.ProgressDonut",{svgns:"http://www.w3.org/2000/svg",sum:100,prefix:"fancy-spark-progress-donut-",constructor:function(a){var b=this;Fancy.apply(b,a),b.init()},init:function(){var a=this;a.initId(),a.initChart(),a.setSize(),a.setRadius(),a.setInnerRadius(),a.setParams(),a.iniColors(),a.preRender(),a.render(),!0!==a.inited&&(a.renderTo.appendChild(a.chart),a.ons())},initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},ons:function(){var a=this;a.el.on("mouseenter",a.onMouseEnter,a),a.el.on("mouseleave",a.onMouseLeave,a),a.el.on("mousemove",a.onMouseMove,a)},onMouseEnter:function(a){var b=this,c=b.el.attr("value");if(b.tipTpl){c=new Fancy.Template(b.tipTpl).getHTML({value:c})}b.tooltip=new Fancy.ToolTip({text:'<span style="color: '+b.color+';">●</span> '+c})},onMouseLeave:function(a){this.tooltip.destroy()},onMouseMove:function(a){var b=this;b.tooltip&&(b.tooltip.css("display","block"),b.tooltip.show(a.pageX+15,a.pageY-25))},iniColors:function(){var a=this;a.value<0?(a.backColor="#F9DDE0",a.color="#EA7369"):(a.backColor="#eee",a.color="#44A4D3")},preRender:function(){var a=this,b=a.size,c=a.chart;c.setAttribute("width",b),c.setAttribute("height",b),c.setAttribute("viewBox","0 0 "+b+" "+b)},render:function(){var a=this;a.renderBack(),a.renderProgress()},renderBack:function(){var a=this,b=a.radius,c=a.innerRadius,d=["M",a.cx,a.y1,"A",b,b,0,1,1,a.x2,a.y1,"L",a.x2,a.y2,"A",c,c,0,1,0,a.cx,a.y2].join(" "),e=document.createElementNS(a.svgns,"path");e.setAttribute("d",d),e.setAttribute("fill",a.backColor),a.chart.appendChild(e)},renderProgress:function(){var a=this,b=a.radius,c=a.innerRadius,d=document.createElementNS(a.svgns,"path"),e=a.value,f=0;e>99&&(e=99.99999),e<-99&&(e=99.99999),e<0&&(f=100+e,e*=-1);var g=e/a.sum,h=f+e,i=["M"].concat(a.scale(f,b),"A",b,b,0,g>.5?1:0,1,a.scale(h,b),"L");c?i=i.concat(a.scale(h,c),"A",c,c,0,g>.5?1:0,0,a.scale(f,c)):i.push(cx,cy),i=i.join(" "),d.setAttribute("d",i),d.setAttribute("fill",a.color),a.chart.appendChild(d)},initChart:function(){var a=this,b=Fancy.get(a.renderTo);a.renderTo=Fancy.get(a.renderTo).dom,0===b.select("svg").length?a.chart=document.createElementNS(a.svgns,"svg:svg"):(a.chart=b.select("svg").dom,a.chart.innerHTML="",a.inited=!0),a.el=Fancy.get(a.chart),a.el.attr("id",a.id),a.value<1&&a.value>0?a.el.attr("value",a.value.toFixed(1)):a.value>-1&&a.value<0?a.el.attr("value",a.value.toFixed(1)):a.el.attr("value",a.value.toFixed(0))},scale:function(a,b){var c=this,d=Math.PI,e=c.sum,f=a/e*d*2-d/2;return[b*Math.cos(f)+c.cx,b*Math.sin(f)+c.cy]},radians:function(a){return a*Math.PI/180},setSize:function(){var a=this;a.width=a.width||a.height||a.size||30,a.height=a.height||a.width||a.size||30,a.size=a.size||a.height},setRadius:function(){var a=this;a.radius=a.radius||a.height/2},setInnerRadius:function(){var a=this;a.innerRadius=a.innerRadius||a.height/2-a.height/4},setParams:function(){var a=this,b=a.radius,c=a.innerRadius,d=a.height,e=a.width;a.cy=d/2,a.y1=a.cy-b,a.y2=a.cy-c,a.cx=e/2,a.x2=a.cx-.01}}),Fancy.define("Fancy.spark.GrossLoss",{maxValue:100,tipTpl:'<span style="color: {color};">●</span> {value} {suffix}',constructor:function(a){Fancy.apply(this,a),this.init()},init:function(){var a=this;a.preRender(),a.render(),!0!==a.inited&&a.ons()},ons:function(){var a=this;a.el.on("mouseenter",a.onMouseEnter,a),a.el.on("mouseleave",a.onMouseLeave,a),a.el.on("mousemove",a.onMouseMove,a)},onMouseEnter:function(){var a,b=this,c=b.el.attr("value"),d=b.el.css("background-color"),e="";b.percents&&(e=" %"),a=new Fancy.Template(b.tipTpl).getHTML({value:c,color:d,suffix:e}),b.tooltip=new Fancy.ToolTip({text:a})},onMouseLeave:function(){this.tooltip.destroy()},onMouseMove:function(a){this.tooltip.el.css("display","block"),this.tooltip.show(a.pageX+15,a.pageY-25)},preRender:function(){},render:function(){var a=this,b=a.column,c=b.width,d=c/a.maxValue,e=0,f=0,g=a.value,h="";g<0?(e=-g*d/2,a.lossColor&&(h="background-color:"+a.lossColor+";"),g='<div class="fancy-grid-grossloss-loss" style="'+h+"width:"+e+'%">&nbsp;</div>'):(f=g*d/2,a.grossColor&&(h="background-color:"+a.grossColor+";"),g='<div class="fancy-grid-grossloss-gross" style="'+h+"width:"+f+'%">&nbsp;</div>'),a.renderTo.innerHTML=g,a.value<0?a.el=Fancy.get(a.renderTo).select(".fancy-grid-grossloss-loss").item(0):a.el=Fancy.get(a.renderTo).select(".fancy-grid-grossloss-gross").item(0),a.el.attr("value",a.value.toFixed(2))}}),Fancy.define("Fancy.spark.ProgressBar",{tipTpl:"{value} {suffix}",constructor:function(a){var b=this;Fancy.apply(b,a),b.init()},init:function(){var a=this;a.initId(),a.render(),!0!==a.inited&&a.ons()},initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},ons:function(){var a=this;!1!==a.tip&&(a.el.on("mouseenter",a.onMouseEnter,a),a.el.on("mouseleave",a.onMouseLeave,a),a.el.on("mousemove",a.onMouseMove,a))},onMouseEnter:function(a){var b=this,c=b.el.attr("value"),d="%";!1===b.percents&&(d="");var e=new Fancy.Template(b.tipTpl),f=e.getHTML({value:c,suffix:d});Fancy.tip.update(f)},onMouseLeave:function(a){Fancy.tip.hide(1e3)},onMouseMove:function(a){Fancy.tip.show(a.pageX+15,a.pageY-25)},render:function(){var a,b=this,c=b.column,d=c.width-18,e=d/b.maxValue,f=b.value*e,g=b.value,h=c.sparkConfig;g=!1===b.percents?b.value:g<1?b.value.toFixed(1):b.value.toFixed(0);var i="&nbsp;",j="",k="";if(h.label)switch(h.label.type){case"left":i='<div class="fancy-grid-bar-label" style="float: left;">'+g+"</div>",f<7*String(g).length&&(i="&nbsp;",j='<div class="fancy-grid-bar-label-out" style="">'+g+"</div>");break;case"right":i='<div class="fancy-grid-bar-label" style="float: right;">'+g+"</div>",f<7*String(g).length&&(i="&nbsp;",j="right"===h.align?'<div class="fancy-grid-bar-label-out-left" style="">'+g+"</div>":'<div class="fancy-grid-bar-label-out" style="">'+g+"</div>");break;default:i='<div class="fancy-grid-bar-label" style="float: left;">'+g+"</div>",f<7*String(g).length&&(i="&nbsp;",k='<div class="fancy-grid-bar-label-out-left" style="">'+g+"</div>")}var l="width:"+f+"px;",m="";if(h.align&&(m="float:"+h.align+";"),a='<div id="'+b.id+'" value="'+g+'" class="fancy-grid-column-progress-bar" style="'+l+m+'">'+i+"</div>"+j+k,b.renderTo.innerHTML=a,b.el=Fancy.get(b.renderTo).select(".fancy-grid-column-progress-bar").item(0),Fancy.isFunction(b.style)){var n=b.style({value:b.value,column:b.column,rowIndex:b.rowIndex,data:b.data});b.el.css(n)}},update:function(){var a=this,b=a.column,c=b.width-18,d=10,e=c/a.maxValue,f=a.value,g=f*e,h=b.sparkConfig,i=a.el.parent();if(a.el.css("width",g),a.el.attr("value",f),h.label)if("right"===h.label.type){var j=i.select(".fancy-grid-column-progress-bar"),k=i.select(".fancy-grid-bar-label"),l=i.select(".fancy-grid-bar-label-out");String(f).length*d+10>g?(k.dom&&(j.update("&nbsp;"),k.destroy()),l.dom?l.update(f):i.append('<div class="fancy-grid-bar-label-out">'+f+"</div>")):(k.dom||(j.append('<div class="fancy-grid-bar-label" style="float: right;"></div>'),k=i.select(".fancy-grid-bar-label")),k.update(f),l.dom&&l.destroy())}else{var j=i.select(".fancy-grid-column-progress-bar"),k=i.select(".fancy-grid-bar-label"),m=i.select(".fancy-grid-bar-label-out-left");String(f).length*d+10>g?(k.dom&&(j.update("&nbsp;"),k.destroy()),m.dom?m.update(f):i.append('<div class="fancy-grid-bar-label-out-left">'+f+"</div>")):(k.dom||(j.append('<div class="fancy-grid-bar-label" style="float: left;"></div>'),k=i.select(".fancy-grid-bar-label")),k.update(f),m.dom&&m.destroy())}}}),Fancy.define("Fancy.spark.HBar",{tipTpl:"{value}",maxValue:100,stacked:!1,fullStack:!1,constructor:function(a){var b=this;Fancy.apply(b,a),b.init()},init:function(){var a=this;a.initId(),a.render(),!0!==a.inited&&a.ons()},initId:function(){var a=this,b=a.prefix||Fancy.prefix;a.id=a.id||Fancy.id(null,b),Fancy.addWidget(a.id,a)},ons:function(){var a=this;!1!==a.tip&&(a.el.on("mouseenter",a.onMouseEnter,a,".fancy-grid-column-h-bar-node"),a.el.on("mouseleave",a.onMouseLeave,a,".fancy-grid-column-h-bar-node"),a.el.on("mousemove",a.onMouseMove,a,".fancy-grid-column-h-bar-node"))},onMouseEnter:function(a){var b=this,c=Fancy.get(a.target),d=c.attr("key"),e=c.attr("data-title"),f=Number(c.attr("value")),g=Number(c.attr("percents"));if(b.tipFormat){var h={value:f,percents:g,key:d,column:b.column,data:b.data,title:e};f=b.tipFormat(h)}var i=new Fancy.Template(b.tipTpl),j=i.getHTML({value:f});Fancy.tip.update(j)},onMouseLeave:function(a){Fancy.tip.hide(1e3)},onMouseMove:function(a){Fancy.tip.show(a.pageX+15,a.pageY-25)},render:function(){var a,b,c=this,d=c.column,e=d.width-18,f=e/100,g=d.index,h=0,i=d.disabled||{},j="",k="",l=2,m=0,n=g.length;d.fields?(n=d.fields.length,Fancy.each(d.fields,function(a){var b=d.index+"."+a;i[b]||(h+=c.data[d.index][b])})):Fancy.each(g,function(a){i[a]||(h+=c.data[a])}),c.stacked?c.fullStack||(h=c.maxValue):(h=c.maxItemValue,j="line-height:"+((c.height-1)/g.length-l)+"px;"),a=h/100,m=0;var o="fancy-spark-hbar";for(c.stacked&&(o+=" fancy-spark-stacked "),b='<div id="'+c.id+'" class="'+o+'">';m<n;m++){if(d.fields)var p=d.fields[m],q=c.data[d.index][p];else var p=g[m],q=c.data[p];var r=q/a,s=r*f;if(!i[p]){0!==m&&s--,c.stacked||(k="margin-top:"+l+"px;"),s>0&&s<1&&(s=2);var t="background: "+Fancy.COLORS[m]+";",u="width:"+s+";",v="",w='data-title=""';0===s&&(v="display: none;"),c.title&&(w='data-title="'+c.title[m]+'" ');var x='key="'+p+'" ';q='value="'+q+'" ';b+="<div "+w+x+q+('percents="'+r+'" ')+'" class="fancy-grid-column-h-bar-node" style="'+v+u+t+j+k+'">&nbsp;</div>'}}b+="</div>",c.renderTo.innerHTML=b,c.el=Fancy.get(c.renderTo)},update:function(a){var b,c,d=this,e=d.column,f=e.width-18,g=f/100,h=e.index,i=0,j=e.disabled||{},k=2;d.data=a;var l=0,m=h.length,n=0;for(e.fields?(m=e.fields.length,Fancy.each(e.fields,function(a){if(j[e.index+"."+a])return void n++;i+=d.data[e.index][a]})):Fancy.each(h,function(a){if(j[a])return void n++;i+=d.data[a]}),d.stacked?d.fullStack||(i=d.maxValue):(i=d.maxItemValue,c=(d.height-1)/(h.length-n)-k),b=i/100,l=0;l<m;l++){if(e.fields)var o=e.fields[l],p=d.data[e.index][o];else var o=h[l],p=d.data[o];var q=p/b,r=q*g,s=d.el.select('.fancy-grid-column-h-bar-node[key="'+o+'"]');e.fields&&j[e.index+"."+o]?(s.css("width","0px"),s.hide()):j[o]?(s.css("width","0px"),s.hide()):(0!==l&&r--,d.stacked||(s.css("line-height",c+"px"),s.css("margin-top",k+"px")),0===r||-1===r?s.css("display","none"):s.css("display","block"),r>0&&r<2&&(r=2),s.animate({duration:2,width:r}))}}}),function(){var a=Fancy,b=a.TOOLTIP_CLS,c=a.TOOLTIP_INNER_CLS;a.define("Fancy.ToolTip",{extend:a.Widget,constructor:function(a){this.Super("const",arguments)},init:function(){this.initTpl(),this.render()},tpl:['<div class="'+c+'">{text}</div>'],widgetCls:b,cls:"",extraCls:"",render:function(){var b=this,c=a.get(b.renderTo||document.body).dom,d=a.get(document.createElement("div"));d.addCls(a.cls,b.widgetCls,b.cls,b.extraCls),d.update(b.tpl.getHTML({text:b.text})),b.el=a.get(c.appendChild(d.dom))},show:function(a,b){var c=this;c.timeout&&(clearInterval(c.timeout),delete c.timeout),"none"===c.css("display")&&c.css({display:"block"}),c.css({left:a,top:b})},hide:function(a){var b=this;b.timeout&&(clearInterval(b.timeout),delete b.timeout),a?b.timeout=setTimeout(function(){b.el.hide()},a):b.el.hide()},destroy:function(){this.el.destroy()},update:function(a){this.el.select("."+c).update(a)}}),a.tip={update:function(b){a.tip=new a.ToolTip({text:b})},show:function(b,c){a.tip=new a.ToolTip({text:" "}),a.tip.show(b,c)},hide:function(){a.tip=new a.ToolTip({text:" "})}}}(),function(){"use strict";function a(b,d){function e(a,b){return function(){return a.apply(b,arguments)}}var f;if(d=d||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=d.touchBoundary||10,this.layer=b,this.tapDelay=d.tapDelay||200,this.tapTimeout=d.tapTimeout||700,!a.notNeeded(b)){for(var g=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],h=this,i=0,j=g.length;i<j;i++)h[g[i]]=e(h[g[i]],h);c&&(b.addEventListener("mouseover",this.onMouse,!0),b.addEventListener("mousedown",this.onMouse,!0),b.addEventListener("mouseup",this.onMouse,!0)),b.addEventListener("click",this.onClick,!0),b.addEventListener("touchstart",this.onTouchStart,!1),b.addEventListener("touchmove",this.onTouchMove,!1),b.addEventListener("touchend",this.onTouchEnd,!1),b.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(b.removeEventListener=function(a,c,d){var e=Node.prototype.removeEventListener;"click"===a?e.call(b,a,c.hijacked||c,d):e.call(b,a,c,d)},b.addEventListener=function(a,c,d){var e=Node.prototype.addEventListener;"click"===a?e.call(b,a,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(b,a,c,d)}),"function"==typeof b.onclick&&(f=b.onclick,b.addEventListener("click",function(a){f(a)},!1),b.onclick=null)}}var b=navigator.userAgent.indexOf("Windows Phone")>=0,c=navigator.userAgent.indexOf("Android")>0&&!b,d=/iP(ad|hone|od)/.test(navigator.userAgent)&&!b,e=d&&/OS 4_\d(_\d)?/.test(navigator.userAgent),f=d&&/OS [6-7]_\d/.test(navigator.userAgent),g=navigator.userAgent.indexOf("BB10")>0;a.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(d&&"file"===a.type||a.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(a.className)},a.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!c;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},a.prototype.sendClick=function(a,b){var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},a.prototype.determineEventType=function(a){return c&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},a.prototype.focus=function(a){var b;d&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type&&"month"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},a.prototype.updateScrollParent=function(a){var b,c;if(!(b=a.fastClickScrollParent)||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},a.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a},a.prototype.onTouchStart=function(a){var b,c,f;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],d){if(f=window.getSelection(),f.rangeCount&&!f.isCollapsed)return!0;if(!e){if(c.identifier&&c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},a.prototype.touchHasMoved=function(a){var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c},a.prototype.onTouchMove=function(a){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0)},a.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},a.prototype.onTouchEnd=function(a){var b,g,h,i,j,k=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(a.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,g=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,f&&(j=a.changedTouches[0],k=document.elementFromPoint(j.pageX-window.pageXOffset,j.pageY-window.pageYOffset)||k,k.fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(h=k.tagName.toLowerCase())){if(b=this.findControl(k)){if(this.focus(k),c)return!1;k=b}}else if(this.needsFocus(k))return a.timeStamp-g>100||d&&window.top!==window&&"input"===h?(this.targetElement=null,!1):(this.focus(k),this.sendClick(k,a),d&&"select"===h||(this.targetElement=null,a.preventDefault()),!1);return!(!d||e||!(i=k.fastClickScrollParent)||i.fastClickLastScrollTop===i.scrollTop)||(this.needsClick(k)||(a.preventDefault(),this.sendClick(k,a)),!1)},a.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},a.prototype.onMouse=function(a){return!this.targetElement||(!!a.forwardedTouchEvent||(!a.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1))))},a.prototype.onClick=function(a){var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail||(b=this.onMouse(a),b||(this.targetElement=null),b)},a.prototype.destroy=function(){var a=this.layer;c&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},a.notNeeded=function(a){var b,d,e;if(void 0===window.ontouchstart)return!0;if(d=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!c)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(d>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(g&&(e=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),e[1]>=10&&e[2]>=3&&(b=document.querySelector("meta[name=viewport]")))){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===a.style.msTouchAction||"manipulation"===a.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(b=document.querySelector("meta[name=viewport]"))&&(-1!==b.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===a.style.touchAction||"manipulation"===a.style.touchAction))},a.attach=function(b,c){return new a(b,c)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?(module.exports=a.attach,module.exports.FastClick=a):window.FastClick=a}(),Fancy.enableCompo=function(){function a(){if(0!==e)for(var a in f){var c,g,h=f[a],i=d.querySelectorAll(a),j=h.appPreSelector?h.appPreSelector+"-":"data-",k=h.preSelector?h.preSelector+"-":"fancy-",l=0,m=i.length;if(0===i.length)return;for(;l<m;l++){var n={},o=i[l],p=o.id||"rand-id-"+ +new Date,q=o.attributes;for(c=0,g=q.length;c<g;c++){var r=q[c],s=r.name,t=r.value;new RegExp(j).test(s)&&(t=b(t),n[s.replace(j,"")]=t)}!function(){var a=o.getElementsByTagName("*");for(c=0,g=a.length;c<g;c++){var d,e,f=a[c],h=f.tagName.toLowerCase();new RegExp(k).test(h)&&(d=h.replace(k,""),e=b(f.innerHTML),n[d.replace(j,"")]=e)}}(),o.outerHTML='<div id="'+p+'"></div>',h.init(d.getElementById(p),n)}}}function b(a){return/\[/.test(a)||/\{/.test(a)?(a=a.replace(/\n/g,""),a=new Function("return "+a+";")()):a=isNaN(Number(a))?a.replace(/\n/g,""):Number(a),a}var c,d=document,e=0,f={};Fancy.Component=function(a,b){e++,f[a]=b},Fancy.stopWatch=function(){clearInterval(c)},a(),d.addEventListener("DOMContentLoaded",function(){a()}),setTimeout(function(){a()},1),c=setInterval(function(){a()},250),Fancy.Component("fancy-grid",{preSelector:"fancy",attrPreSelector:"data",init:function(a,b){b.renderTo=a,window[a.id]=new FancyGrid(b)}}),Fancy.Component("fancy-form",{preSelector:"fancy",attrPreSelector:"data",init:function(a,b){b.renderTo=a,window[a.id]=new FancyForm(b)}}),Fancy.Component("fancy-tab",{preSelector:"fancy",attrPreSelector:"data",init:function(a,b){b.renderTo=a,window[a.id]=new FancyTab(b)}})};