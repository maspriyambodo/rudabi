Fancy.Mixin("Fancy.grid.mixin.PrepareConfig",{prepareConfig:function(a,b){var c=this;return a._plugins=a._plugins||[],a=c.copyColumns(a,b),a=c.prepareConfigScroll(a,b),a=c.prepareConfigData(a,b),a=c.prepareConfigTheme(a,b),a=c.prepareConfigLang(a,b),a=c.prepareConfigSpark(a,b),a=c.prepareConfigPaging(a,b),a=c.prepareConfigTBar(a),a=c.prepareConfigExpander(a),a=c.prepareConfigColumnMinMaxWidth(a),a=c.prepareConfigGrouping(a),a=c.prepareConfigGroupHeader(a),a=c.prepareConfigSorting(a),a=c.prepareConfigEdit(a),a=c.prepareConfigSelection(a),a=c.prepareConfigLoadMask(a,b),a=c.prepareConfigDefaults(a),a=c.prepareConfigFilter(a),a=c.prepareConfigSearch(a),a=c.prepareConfigSummary(a),a=c.prepareConfigExporter(a),a=c.prepareConfigSmartIndex(a),a=c.prepareConfigActionColumn(a),a=c.prepareConfigWidgetColumn(a),a=c.prepareConfigChart(a,b),a=c.prepareConfigCellTip(a),a=c.prepareConfigColumnsWidth(a),a=c.prepareConfigSize(a,b),a=c.prepareConfigColumns(a),a=c.prepareConfigColumnsResizer(a),a=c.prepareConfigFooter(a),a=c.prepareConfigDD(a)},copyColumns:function(a,b){return a.columns&&(a.columns=Fancy.Array.copy(a.columns,!0)),b.columns&&(b.columns=Fancy.Array.copy(b.columns)),a},prepareConfigScroll:function(a,b){return Fancy.isIE&&!1!==b.nativeScroller&&(a.nativeScroller=!0),a},prepareConfigSpark:function(a,b){var c=this;return Fancy.each(a.columns,function(b){var d=b.sparkConfig;if(d&&d.legend)switch(d.legend.type){case"tbar":case"bbar":case"buttons":var e=d.legend.type,f=b.index;a[e]=a[e]||[],a[e]=a[e].concat(c._generateLegendBar(d.title,f,d.legend.style,b))}}),a},_generateLegendBar:function(a,b,c,d){for(var e=0,f=a.length,g=[],h=this,i={length:0},j=function(b){var c,d=h;Fancy.each(h.columns,function(a,b){a.index===h.columns[b].index&&(c=b)}),(b.hasCls("fancy-legend-item-disabled")||a.length-1!==i.length)&&(b.toggleCls("fancy-legend-item-disabled"),b.hasCls("fancy-legend-item-disabled")?(i[b.index]=!0,d.disableLegend(c,b.index),i.length++):(d.enableLegend(c,b.index),delete i[b.index],i.length--))};e<f;e++){var k=b[e];Fancy.isString(d.index)&&(k=d.index+"."+e);var l={handler:j,index:k,imageColor:Fancy.COLORS[e],text:a[e]};0===e&&c&&(l.style=c),g.push(l)}return g},prepareConfigData:function(a,b){if(Fancy.isArray(a.data)&&0===a.data.length&&a.columns){var c=[];Fancy.each(a.columns,function(a){a.index&&c.push(a.index||a.key)}),a.data={fields:c,items:[]}}return a},prepareConfigLoadMask:function(a){return a._plugins.push({type:"grid.loadmask"}),a},reConfigStore:function(a){var b=this,c=b.store,d=b.getFieldsFromData(a),e="Fancy.model."+Fancy.id();Fancy.define(e,{extend:Fancy.Model,fields:d}),b.model=e,c.model=e,b.fields=d,c.fields=d,c.setModel()},prepareConfigDefaults:function(a){return a.defaults=a.defaults||{},void 0===a.defaults.type&&(a.defaults.type="string"),Fancy.each(a.defaults,function(b,c){Fancy.each(a.columns,function(b){switch(b.type){case"select":case"order":case"expand":return}void 0===b[c]&&(b[c]=a.defaults[c])})}),a},prepareConfigColumnMinMaxWidth:function(a){return Fancy.each(a.columns,function(a){void 0===a.width&&a.minWidth&&(a.width=a.minWidth)}),a},prepareConfigCellTip:function(a){return Fancy.each(a.columns,function(b){if(b.cellTip)return a._plugins.push({type:"grid.celltip"}),!0}),a},prepareConfigDD:function(a){if(a.gridToGrid){var b={type:"grid.dragdrop"};Fancy.apply(b,a.gridToGrid),a._plugins.push(b)}return a},prepareConfigColumns:function(a){for(var b=a.columns,c=[],d=[],e=0,f=b.length,g=!1;e<f;e++){var h=b[e];switch(h.draggable&&(g=!0),h.type){case"select":this.checkboxRowSelection=!0,this.multiSelect=!0,b[e].index="$selected",b[e].editable=!0;break;case"order":b[e].editable=!1,b[e].sortable=!1,b[e].cellAlign="right";break;case"checkbox":void 0===h.cellAlign&&(h.cellAlign="center");break;case"currency":void 0===h.format&&(h.format="number")}h.locked?(c.push(h),b.splice(e,1),e--,f--):h.rightLocked&&(d.push(h),b.splice(e,1),e--,f--)}return g&&a._plugins.push({type:"grid.columndrag"}),a.leftColumns=c,a.rightColumns=d,a},prepareConfigColumnsWidth:function(a){var b,c=a.columns,d=a.width,e=[],f=[],g=100,h=50,i=g,j=0,k=!1,l=!1;void 0===d&&a.renderTo&&(d=Fancy.get(a.renderTo).width()),!1!==a.flexScrollSensitive?(d-=a.bottomScrollHeight,d-=2*a.panelBorderWidth):d-=1,Fancy.each(c,function(b,c){switch(b.flex&&(a.hasFlexColumns=!0),b.type){case"select":void 0===b.width&&(b.width=35);break;case"order":void 0===b.width&&(b.width=40);break;case"expand":void 0===b.width&&(b.width=38)}b.locked&&(k=!0),b.rightLocked&&(l=!0),void 0===b.width?(b.flex&&(j+=b.flex,f.push(c)),e.push(c)):Fancy.isNumber(b.width)&&(d-=b.width)}),a.hasFlexColumns&&a._plugins.push({type:"grid.columnresizer"}),k&&l&&(d-=2);var m=d/e.length;m<h&&(m=h),m>g&&(i=g),m<h&&(i=h);var n=!1,o=d;return Fancy.each(e,function(a){b=c[a],void 0===b.flex&&(o-=i)}),j&&Fancy.each(f,function(a){o-=o/j*a.flex}),o<0&&(n=!0),Fancy.each(e,function(a){b=c[a],void 0===b.flex&&(b.width=i,d-=i)}),j&&Fancy.each(f,function(a){b=c[a],b.width=n?i*b.flex:d/j*b.flex}),a},prepareConfigActionRender:function(a){return function(b){return Fancy.each(a.items,function(a){var c=a.text||"",d=Fancy.styleToString(a.style),e=a.cls||"";b.value+=['<div class="fancy-grid-column-action-item '+e+'" style="'+d+'">',c,"</div>"].join(" ")}),b}},prepareConfigSmartIndex:function(a){return Fancy.each(a.columns,function(a){if(/\+|\-|\/|\*|\[|\./.test(a.index)){var b=a.index;switch(b){case"xAxis.categories":case"yAxis.categories":case"zAxis.categories":return}b=b.replace(/(\w+)/g,function(a,a,b,c){return"."===c[b-1]?a:isNaN(Number(a))?"data."+a:a}),b="return "+b+";",a.smartIndexFn=new Function("data",b)}}),a},prepareConfigActionColumn:function(a){for(var b=this,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];if("action"===f.type){f.sortable=!1,f.editable=!1,f.render=b.prepareConfigActionRender(f);var g=f.items;if(void 0!==g&&0!==g.length)for(var h,i=0,j=g.length;i<j;i++)switch(h=g[i],h.action){case"remove":void 0===h.handler&&(h.handler=function(a,b){a.remove(b)});break;case"dialog":!function(a){if(void 0===a.handler){for(var d=[],e=0,f=c.length,g=87;e<f;e++){var h=c[e];switch(h.type){case"action":continue}d.push({label:h.title||"",type:h.type,name:h.index}),g+=38}a.handler=function(c,e){a.dialog?(a.dialog.show(),a.dialog.set(e.data)):a.dialog=new FancyForm({window:!0,draggable:!0,modal:!0,title:{text:"Edit",tools:[{text:"Close",handler:function(){this.hide()}}]},width:300,height:g,items:d,buttons:["side",{text:"Clear",handler:function(){this.clear()}},{text:"Save",handler:function(){var a=this.get();a.id&&(b.getById(a.id).set(a),b.update())}}],events:[{init:function(){this.show(),this.set(e.data)}}]})}}}(h)}}}return a},prepareConfigWidgetColumn:function(a){for(var b=a.columns,c=0,d=b.length;c<d;c++){var e=b[c];e.widget&&(e.render=function(a){var b,c=a.cell.select("."+Fancy.FIELD_CLS),d=a.cell.dom,e=a.column,f={vtype:e.vtype,style:{padding:"0px","margin-top":"-10px","margin-left":"-1px"},label:!1,renderTo:d,value:a.value,emptyText:e.emptyText};if(c.length)b=Fancy.getWidget(c.dom.id),b.get()!=a.value&&b.set(a.value);else{var g=a.column.width,e=a.column,h=e.index;switch(a.column.type){case"number":case"currency":Fancy.apply(f,{spin:e.spin,min:e.min,max:e.max,events:[{change:function(b,c){grid.set(a.rowIndex,h,c),grid.updater.updateRow()}}]}),b=new Fancy.NumberField(f);break;case"string":case"image":Fancy.apply(f,{events:[{change:function(b,c){grid.set(a.rowIndex,h,c),grid.updater.updateRow()}}]}),b=new Fancy.StringField(f);break;case"combo":Fancy.apply(f,{displayKey:a.column.displayKey,valueKey:a.column.displayKey,padding:!1,checkValidOnTyping:!0,data:a.column.data,events:[{change:function(b,c){grid.set(a.rowIndex,h,c),grid.updater.updateRow()}}]}),b=new Fancy.Combo(f)}switch(a.column.type){case"number":case"string":case"currency":case"image":b.setInputSize({width:g+1,height:33});break;case"combo":b.size({width:g+1,height:33})}}return a})}return a},prepareConfigSorting:function(a){return(a.defaults||{}).sortable?(a._plugins.push({type:"grid.sorter"}),a):(Fancy.each(a.columns,function(b){b.sortable&&a._plugins.push({type:"grid.sorter"})}),a)},prepareConfigSelection:function(a){var b=!1,c={type:"grid.selection"};if((a.trackOver||a.columnTrackOver||a.cellTrackOver)&&(b=!0),a.selModel){b=!0;var d=!1,e=!1;if(Fancy.isObject(a.selModel)){if(d=!!a.selModel.checkOnly,!a.selModel.type)throw new Error("FancyGrid Error 5: Type for selection is not set");e=!0===a.selModel.memory,a.selModel=a.selModel.type}"rows"===a.selModel&&(a.multiSelect=!0),a.selection=a.selection||{},a.selection.selModel=a.selModel,a.selection[a.selModel]=!0,a.selection.checkOnly=d,a.selection.memory=e}return a.selection&&(b=!0,Fancy.isObject(a.selection)&&Fancy.apply(c,a.selection)),!0===b&&a._plugins.push(c),a},prepareConfigEdit:function(a){var b=a.defaults||{},c={type:"grid.edit"},d=!1,e=b.editable;return a.clicksToEdit&&(c.clicksToEdit=a.clicksToEdit),e&&(d||a._plugins.push(c),a._plugins.push({type:"grid.celledit"}),d=!0),a.rowEdit&&a._plugins.push({type:"grid.rowedit"}),Fancy.each(a.columns,function(b){switch(void 0===b.index&&void 0===b.key&&(b.editable=!1),b.type){case"image":b.sortable=!1;break;case"sparklineline":case"sparklinebar":case"sparklinetristate":case"sparklinediscrete":case"sparklinebullet":case"sparklinepie":case"sparklinebox":b.editable=!1,b.sortable=!1}b.editable&&!1===d&&(a._plugins.push(c),a._plugins.push({type:"grid.celledit"}))}),a},prepareConfigExpander:function(a){if(a.expander){var b=a.expander;Fancy.apply(b,{type:"grid.expander"}),a.expanded={},a.grouping&&(b.expanded=!1),a._plugins.push(b)}return a},prepareConfigGrouping:function(a){if(a.grouping){var b=a.grouping;Fancy.apply(b,{type:"grid.grouping"}),a.expanded={},a._plugins.push(b)}return a},prepareConfigSummary:function(a){if(a.summary){var b=a.summary;!0===b&&(b={}),Fancy.apply(b,{type:"grid.summary"}),a._plugins.push(b)}return a},prepareConfigExporter:function(a){if(a.exporter){var b=a.exporter;!0===b&&(b={}),Fancy.apply(b,{type:"grid.exporter"}),a._plugins.push(b)}return a},prepareConfigFilter:function(a){var b=a.columns,c=!1,d=!1,e=!1,f={type:"grid.filter"};return a.filter&&(!0===a.filter&&(c=!0,a.filter={}),Fancy.apply(f,a.filter)),Fancy.each(b,function(a){a.filter&&(c=!0,a.filter.header&&(d=!0,a.grouping&&(e=!0)))}),f.header=d,f.groupHeader=e,c&&a._plugins.push(f),a},prepareConfigSearch:function(a){var b={type:"grid.search"},c=!1;return a.searching&&(c=!0),c&&a._plugins.push(b),a},prepareConfigGroupHeader:function(a){var b=a.columns,c=0,d=b.length,e=[],f=!1,g=[];if(Fancy.each(b,function(a){a.columns&&(f=!0,e.push(a))}),f){for(c=0;c<d;c++){var h=b[c];if(h.columns){for(var i=0,j=h.columns.length,k=h.text||h.title||"  ";i<j;i++)h.locked&&(h.columns[i].locked=!0),h.rightLocked&&(h.columns[i].rightLocked=!0),h.columns[i].grouping=k,h.defaults&&Fancy.applyIf(h.columns[i],h.defaults);g=g.concat(h.columns),f=!0,e.push(h)}else g=g.concat(b.slice(c,c+1))}a.columns=g,a._plugins.push({type:"grid.groupheader",groups:e}),a.isGroupedHeader=!0}return a},prepareConfigPaging:function(a,b){var c=this,d=a.lang,e=a.paging,f="bbar";if(!e)return a;if(void 0!==e.barType)switch(e.barType){case"bbar":case"tbar":case"both":f=e.barType;break;case!1:case"none":f="none";break;default:throw new Error("[FancyGrid Error]: - not supported bar type for paging")}return a._plugins.push({i18n:b.i18n,type:"grid.paging",barType:f}),"both"===f?(a.tbar=c.generatePagingBar(e,d),a.bbar=c.generatePagingBar(e,d)):"none"===f||(a[f]=c.generatePagingBar(e,d)),a},generatePagingBar:function(a,b){var c=this,d=[],e="fancy-bar-button-disabled",f={float:"left","margin-right":"5px","margin-top":"3px"};if(d.push({imageCls:"fancy-paging-first",disabledCls:e,role:"first",handler:function(a){c.paging.firstPage()},style:{float:"left","margin-left":"5px","margin-right":"5px","margin-top":"3px"}}),d.push({imageCls:"fancy-paging-prev",disabledCls:e,role:"prev",handler:function(){c.paging.prevPage()},style:f}),d.push("|"),d.push({type:"text",text:b.paging.page}),d.push({type:"number",label:!1,padding:!1,style:{float:"left","margin-left":"-1px","margin-right":"8px","margin-top":"4px"},role:"pagenumber",min:1,width:30,listeners:[{enter:function(a){0===parseInt(a.getValue())&&a.set(1);var b=parseInt(a.getValue())-1,d=c.paging.setPage(b);b!==d&&a.set(d)}},{up:function(a,b){var d=c.store.pages;Number(b)>d&&a.set(d)}}]}),d.push({type:"text",text:"",role:"ofText"}),d.push("|"),d.push({imageCls:"fancy-paging-next",disabledCls:e,role:"next",style:f,handler:function(){c.paging.nextPage()}}),d.push({imageCls:"fancy-paging-last",disabledCls:e,role:"last",style:f,handler:function(){c.paging.lastPage()}}),Fancy.isObject(a)&&!0===a.refreshButton&&(d.push("|"),d.push({imageCls:"fancy-paging-refresh",disabledCls:e,role:"refresh",style:f,handler:function(){c.paging.refresh()}})),a&&Fancy.isArray(a.pageSizeData)){for(var g=a.pageSizeData,h=[],i=0,j=g.length,k=0;i<j;i++)h.push({index:i,value:g[i]}),a.pageSize===g[i]&&(k=i);var l=Fancy.Object.copy(f);l["margin-top"]="4px",d.push({editable:!1,width:50,type:"combo",role:"size",style:l,data:h,displayKey:"value",valueKey:"index",value:k,events:[{change:function(a,b){c.paging.setPageSize(g[b])}}]})}return d.push("side"),d.push({type:"text",role:"info",text:""}),d},prepareConfigColumnsResizer:function(a){if((a.defaults||{}).resizable)return a._plugins.push({type:"grid.columnresizer"}),a;var b=[].concat(a.columns).concat(a.leftColumns).concat(a.rightColumns);return Fancy.each(b,function(b){b.resizable&&a._plugins.push({type:"grid.columnresizer"})}),a},prepareConfigTBar:function(a){var b=this,c=a.tbar;if(c)for(var d=0,e=c.length;d<e;d++)switch("search"===c[d].type&&(a.searching=!0,a.filter=!0),c[d].action){case"add":void 0===c[d].handler&&(c[d].handler=function(){b.insert(0,{})});break;case"remove":void 0===c[d].handler&&(c[d].disabled=!0,c[d].handler=function(){Fancy.each(b.getSelection(),function(a){b.remove(a)}),b.selection.clearSelection()},c[d].events=[{render:function(){var a=this;setTimeout(function(){var b=Fancy.getWidget(a.el.parent().parent().parent().select("."+Fancy.GRID_CLS).dom.id);b.on("select",function(){0===b.getSelection().length?a.disable():a.enable()}),b.on("clearselect",function(){a.disable()})},10)}}])}return a},prepareConfigChart:function(a){var b=a.data,c=b.chart;return Fancy.isObject(c)&&(c=[c]),b&&b.chart&&(a._plugins.push({type:"grid.chartintegration",chart:c,toChart:!!b.items||!!b.proxy}),Fancy.each(c,function(b){var c=b.type;switch(c){case"highchart":case"highcharts":a._plugins.push({type:"grid.highchart"});break;case void 0:throw new Error("[FancyGrid Error] - type of chart is undefined");default:throw new Error("[FancyGrid Error] - type of chart "+c+" does not exist")}})),a},prepareConfigSize:function(a,b){var c,d=a.renderTo,e=!!(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel),f=a.panelBodyBorders,g=a.gridBorders;if(void 0===a.width)d&&(a.responsive=!0,c=Fancy.get(d),a.width=parseInt(c.width()));else if("fit"===a.width){var h=0,i=!1;Fancy.each(a.columns,function(a){h+=a.width,a.locked&&(i=!0)}),a.title||a.subTitle?h+=f[1]+f[3]+g[1]+g[3]:h+=g[1]+g[3],i&&h--,a.width=h}if("fit"===a.height){var j=0,k=1;Fancy.each(a.columns,function(a){a.grouping&&(k<2&&(k=2),a.filter&&a.filter.header&&k<3&&(k=3)),a.filter&&a.filter.header&&k<2&&(k=2)}),Fancy.isArray(a.data)?j=a.data.length:a.data&&Fancy.isArray(a.data.items)&&(j=a.data.items.length);var l=j*a.cellHeight;a.title&&(l+=a.titleHeight),(a.tbar||a.tabs)&&(l+=a.barHeight),a.bbar&&(l+=a.barHeight),a.buttons&&(l+=a.barHeight),a.subTBar&&(l+=a.barHeight),a.footer&&(l+=a.barHeight),!1!==a.header&&(l+=a.cellHeaderHeight*k),l+=e?f[0]+f[2]+g[0]+g[2]:g[0]+g[2],a.minHeight&&l<a.minHeight&&(l=a.minHeight),a.heightFit=!0,a.height=l}return a}}),Fancy.Mixin("Fancy.grid.mixin.ActionColumn",{initActionColumnHandler:function(){var a=this;a.on("cellclick",a.onCellClickColumnAction,a)},onCellClickColumnAction:function(a,b){var c,d,e=this,f=b.column,g=f.items;"action"===f.type&&(c=e.getActiveActionColumnItem(b),g&&void 0!==c&&(d=g[c],d.handler&&d.handler(e,b)))},getActiveActionColumnItem:function(a){for(var b=Fancy.get(a.cell),c=a.e.target,d=b.select("."+Fancy.GRID_COLUMN_ACTION_ITEM_CLS),e=0,f=d.length;e<f;e++)if(d.item(e).within(c))return e}}),function(){var a=Fancy,b=a.TOUCH_CLS,c=a.HIDDEN_CLS,d=a.GRID_CENTER_CLS,e=a.GRID_LEFT_CLS,f=a.GRID_RIGHT_CLS,g=a.GRID_HEADER_CLS,h=a.GRID_BODY_CLS,i=a.PANEL_BODY_INNER_CLS,j=a.GRID_UNSELECTABLE_CLS,k=a.GRID_LEFT_EMPTY_CLS,l=a.GRID_RIGHT_EMPTY_CLS;a.Mixin("Fancy.grid.mixin.Grid",{tpl:['<div class="'+e+" "+k+'"></div>','<div class="'+d+'"></div>','<div class="'+f+" "+l+'"></div>','<div class="fancy-grid-editors"></div>'],initStore:function(){var b,c,d,e=this,f=e.getFieldsFromData(e.data),g="Fancy.model."+a.id(),h=e.data,i=!1,j=e.state;e.data.items&&(h=e.data.items),b=e.data.remoteSort,c=e.data.remoteFilter,d=e.data.remotePage,a.define(g,{extend:a.Model,fields:f}),e.grouping&&void 0!==e.grouping.collapsed&&(i=e.grouping.collapsed);var k={widget:e,model:g,data:h,paging:e.paging,remoteSort:b,remoteFilter:c,pageType:d,collapsed:i,multiSort:e.multiSort};j&&j.filters&&(k.filters=j.filters),h.pageSize&&(k.pageSize=h.pageSize),e.store=new a.Store(k),e.model=g,e.fields=f,e.store.filters&&setTimeout(function(){e.filter.filters=e.store.filters,e.filter.updateStoreFilters()},1)},initTouch:function(){var c=this;a.isTouch&&window.FastClick&&(c.panel?(FastClick.attach(c.panel.el.dom),c.panel.addCls(b)):(FastClick.attach(c.el.dom),c.addCls(b)))},initElements:function(){var b=this;!1!==b.header&&(b.leftHeader=new a.grid.Header({widget:b,side:"left"}),b.header=new a.grid.Header({widget:b,side:"center"}),b.rightHeader=new a.grid.Header({widget:b,side:"right"})),b.leftBody=new a.grid.Body({widget:b,side:"left"}),b.body=new a.grid.Body({widget:b,side:"center"}),b.rightBody=new a.grid.Body({widget:b,side:"right"}),b.leftEl=b.el.select("."+e),b.centerEl=b.el.select("."+d),b.rightEl=b.el.select("."+f)},getFieldsFromData:function(a){var b=a.items||a;if(a.fields)return a.fields;if(!b)throw new Error("FancyGrid Error 4: Data is empty and not set fields of data to build model");var c=b[0],d=[];for(var e in c)d.push(e);return d},render:function(){var b=this,c=b.renderTo||document.body,d=a.get(document.createElement("div")),e=b.panelBodyBorders;d.addCls(a.cls,b.widgetCls,b.cls),d.attr("id",b.id),void 0===b.panel&&b.shadow&&d.addCls("fancy-panel-shadow"),!1===b.columnLines&&d.addCls("fancy-grid-disable-column-lines"),"default"===b.theme||b.panel||d.addCls("fancy-theme-"+b.theme);var f=0;b.panel&&(f=e[1]+e[3]),d.css({width:b.width-f+"px",height:b.height-0+"px"}),b.initTpl(),d.update(b.tpl.getHTML({})),b.el=a.get(a.get(c).dom.appendChild(d.dom)),b.setHardBordersWidth(),b.rendered=!0},setHardBordersWidth:function(){var a=this,b=a.panel?a.gridBorders:a.gridWithoutPanelBorders;a.wrapped&&(b=a.gridBorders),a.css({"border-top-width":b[0],"border-right-width":b[1],"border-bottom-width":b[2],"border-left-width":b[3]})},update:function(){var a=this;a.store.loading||(a.updater.update(),a.fire("update"),a.heightFit&&a.fitHeight(),a.setBodysHeight())},getColumnsWidth:function(a){var b=this;switch(a){case"center":return b.getCenterFullWidth();case"left":return b.getLeftFullWidth();case"right":return b.getRightFullWidth()}},setSides:function(){var a=this,b=a.leftColumns,c=a.rightColumns,i=a.getLeftFullWidth(),j=a.getCenterFullWidth(),m=a.getRightFullWidth(),n=a.gridBorders,o=a.panelBodyBorders,p=a.gridWithoutPanelBorders;b.length>0&&a.leftEl.removeCls(k),c.length>0&&a.rightEl.removeCls(l),j=a.wrapped?a.width-n[1]-n[3]:a.panel?a.width-n[1]-n[3]-o[1]-o[3]:a.width-p[1]-p[3],0===i&&0===m||(0===m?j-=i:0===i?j-=m:a.width>i+j+m?j-=i:j-=i+m),a.leftEl.css({width:i+"px"}),a.centerEl.css({left:i+"px",width:j+"px"}),a.header&&(a.el.select("."+e+" ."+g).css({width:i+"px"}),a.el.select("."+d+" ."+g).css({width:j+"px"})),a.el.select("."+d+" ."+h).css({width:j+"px"}),a.width>i+j+m?a.rightEl.css({right:"0px"}):a.rightEl.css({left:"",right:"0px"}),a.rightEl.css({width:m}),a.header&&a.el.select("."+f+" ."+g).css({width:m+"px"}),a.startWidths={center:j,left:i,right:m}},setColumnsPosition:function(){var a=this;a.body.setColumnsPosition(),a.leftBody.setColumnsPosition(),a.rightBody.setColumnsPosition()},setSidesHeight:function(){var a=this,b=a.store,c=1,d=a.cellHeaderHeight;!1!==a.header&&(c+=d,a.filter&&a.filter.header&&(a.groupheader?a.filter.groupHeader&&(c+=d):c+=d),a.groupheader&&(a.filter&&a.filter.header,c+=d)),a.grouping&&(c+=a.grouping.groups.length*a.groupRowHeight),a.expander&&(c+=a.expander.plusHeight),a.summary&&(c+=a.summary.topOffSet),c+=b.getLength()*a.cellHeight-1,a.paging&&a.summary&&"bottom"===a.summary.position&&(c=a.height),a.leftEl.css({height:c+"px"}),a.centerEl.css({height:c+"px"}),a.rightEl.css({height:c+"px"})},setBodysHeight:function(){var a=this;a.body.setHeight(),a.leftBody.setHeight(),a.rightBody.setHeight()},preRender:function(){var a=this;(a.title||a.subTitle||a.tbar||a.bbar||a.buttons||a.panel)&&a.renderPanel()},renderPanel:function(){var b=this,c={renderTo:b.renderTo,title:b.title,subTitle:b.subTitle,width:b.width,height:b.height,titleHeight:b.titleHeight,subTitleHeight:b.subTitleHeight,barHeight:b.barHeight,theme:b.theme,shadow:b.shadow,style:b.style||{},window:b.window,modal:b.modal,frame:b.frame,items:[b],draggable:b.draggable,resizable:b.resizable,minWidth:b.minWidth,minHeight:b.minHeight,panelBodyBorders:b.panelBodyBorders,barContainer:b.barContainer,barScrollEnabled:b.barScrollEnabled},d=b.panelBodyBorders;b.bbar&&(c.bbar=b.bbar,b.height-=b.barHeight),b.tbar&&(c.tbar=b.tbar,b.height-=b.barHeight),b.subTBar&&(c.subTBar=b.subTBar,b.height-=b.barHeight),b.buttons&&(c.buttons=b.buttons,b.height-=b.barHeight),b.footer&&(c.footer=b.footer,b.height-=b.barHeight),b.panel=new a.Panel(c),b.bbar=b.panel.bbar,b.tbar=b.panel.tbar,b.subTBar=b.panel.subTBar,b.buttons=b.panel.buttons,b.wrapped||b.panel.addCls("fancy-panel-grid-inside"),b.title&&(b.height-=b.titleHeight),b.subTitle&&(b.height-=b.subTitleHeight,b.height+=d[2]),b.height-=d[0]+d[2],b.renderTo=b.panel.el.select("."+i).dom},getBodyHeight:function(){var a=this,b=a.height,c=1,d=a.gridBorders,e=a.gridWithoutPanelBorders;return a.groupheader&&(c=2),a.filter&&a.filter.header&&(a.groupheader?a.filter.groupHeader&&c++:c++),!1!==a.header&&(b-=a.cellHeaderHeight*c),a.panel?b-=d[0]+d[2]:b-=e[0]+e[2],a.summary&&(b-=a.summary.topOffSet,b-=a.summary.bottomOffSet),b},ons:function(){var b=this,c=b.store,d=a.get(document);c.on("change",b.onChangeStore,b),c.on("set",b.onSetStore,b),c.on("remove",b.onRemoveStore,b),c.on("beforesort",b.onBeforeSortStore,b),c.on("sort",b.onSortStore,b),c.on("beforeload",b.onBeforeLoadStore,b),c.on("load",b.onLoadStore,b),d.on("mouseup",b.onDocMouseUp,b),d.on("click",b.onDocClick,b),d.on("mousemove",b.onDocMove,b),c.on("servererror",b.onServerError,b),c.on("serversuccess",b.onServerSuccess,b),b.responsive&&a.$(window).bind("resize",function(){b.onWindowResize()}),b.on("activate",b.onActivate,b),b.on("deactivate",b.onDeActivate,b)},onServerError:function(a,b,c,d){this.fire("servererror",b,c,d)},onServerSuccess:function(a,b,c){this.fire("serversuccess",b,c)},onChangeStore:function(){this.update()},onBeforeLoadStore:function(a){this.fire("beforeload")},onRemoveStore:function(a,b,c){this.fire("remove",b,c)},onLoadStore:function(a){this.fire("load")},onSetStore:function(a,b){this.fire("set",b)},onBeforeSortStore:function(a,b){this.fire("beforesort",b)},onSortStore:function(a,b){this.fire("sort",b)},getCellsViewHeight:function(){var a=this,b=a.store,d=0,e=0;return a.grouping&&(d+=a.grouping.plusScroll),a.expander&&(d+=a.expander.plusScroll),!a.scroller.scrollBottomEl||a.scroller.scrollBottomEl.hasCls(c)||(e=a.scroller.cornerSize),a.cellHeight*b.dataView.length+e+d},onDocMouseUp:function(a){this.fire("docmouseup")},onDocClick:function(a){this.fire("docclick",a)},onDocMove:function(a){this.fire("docmove",a)},getCenterViewWidth:function(){var a=this,b=a.centerEl.width();if(0===b){for(var c=0,d=a.columns,e=0,f=d.length;e<f;e++){var g=d[e];g.hidden||(c+=g.width)}return c}return b},getCenterFullWidth:function(){for(var a=this,b=0,c=a.columns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getLeftFullWidth:function(){for(var a=this,b=0,c=a.leftColumns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getRightFullWidth:function(){for(var a=this,b=0,c=a.rightColumns,d=0,e=c.length;d<e;d++){var f=c[d];f.hidden||(b+=f.width)}return b},getColumns:function(a){var b,c=this;switch(a){case"left":b=c.leftColumns;break;case"center":b=c.columns;break;case"right":b=c.rightColumns}return b},setColumns:function(a,b){var c=this;switch(b){case"left":c.leftColumns=a;break;case"center":case void 0:c.columns=a;break;case"right":c.rightColumns=a}},getBody:function(a){var b,c=this;switch(a){case"left":b=c.leftBody;break;case"center":b=c.body;break;case"right":b=c.rightBody}return b},getHeader:function(a){var b,c=this;switch(a){case"left":b=c.leftHeader;break;case"center":b=c.header;break;case"right":b=c.rightHeader}return b},getDomRow:function(a){for(var b=this,c=b.leftBody,d=b.body,e=b.rightBody,f=b.leftColumns,g=b.columns,h=b.rightColumns,i=0,j=f.length,k=[];i<j;i++)k.push(c.getDomCell(a,i));for(i=0,j=g.length;i<j;i++)k.push(d.getDomCell(a,i));for(i=0,j=h.length;i<j;i++)k.push(e.getDomCell(a,i));return k},initTextSelection:function(){var b=this,c=b.body,d=b.leftBody,e=b.rightBody;if(!1===b.textSelection){b.addCls(j);var f=function(b){var c=a.get(b.target);c.hasCls("fancy-field-text-input")||c.hasCls("fancy-textarea-text-input")||b.preventDefault()};c.el.on("mousedown",f),d.el.on("mousedown",f),e.el.on("mousedown",f)}},setTrackOver:function(a,b){var c=this;switch(a){case"cell":c.cellTrackOver=b;break;case"column":c.columnTrackOver=b;break;case"row":c.trackOver=b}},setSelModel:function(a){var b=this,c=b.selection;c.cell=!1,c.cells=!1,c.row=!1,c.rows=!1,c.column=!1,c.columns=!1,c[a]=!0,b.multiSelect="rows"===a,c.clearSelection()},getSelection:function(a){return this.selection.getSelection(a)},clearSelection:function(){this.selection.clearSelection()},destroy:function(){var b=this,c=a.get(document);c.un("mouseup",b.onDocMouseUp,b),c.un("click",b.onDocClick,b),c.un("mousemove",b.onDocMove,b),b.body.destroy(),b.leftBody.destroy(),b.rightBody.destroy(),b.header.destroy(),b.leftHeader.destroy(),b.rightHeader.destroy(),b.scroller.destroy(),b.el.destroy(),b.panel&&b.panel.el.destroy()},showAt:function(){var a=this;a.panel&&a.panel.showAt.apply(a.panel,arguments)},show:function(){var a=this;a.panel?a.panel.show.apply(a.panel,arguments):a.el.show()},hide:function(){var a=this;a.panel?a.panel.hide.apply(a.panel,arguments):a.el.hide()},initDateColumn:function(){var b=this,c=function(c){for(var d=0,e=c.length;d<e;d++){var f=c[d];if("date"===f.type){f.format=f.format||{};var g={type:"date"};a.applyIf(g,b.lang.date),a.applyIf(f.format,g)}}return c};b.columns=c(b.columns),b.leftColumns=c(b.leftColumns),b.rightColumns=c(b.rightColumns)},stopEditor:function(){this.edit.stopEditor()},getById:function(a){return this.store.getById(a)},get:function(a,b){var c=this,d=c.store;return void 0!==b?d.get(a,b):void 0===a?d.get():d.getItem(a)},getTotal:function(){return this.store.getTotal()},getViewTotal:function(){return this.store.getLength()},getDataView:function(){return this.store.getDataView()},getData:function(){return this.store.getData()},selectRow:function(a){this.selection.selectRow(a)},selectColumn:function(a){var b,c,d=this,e=d.leftColumns||[],f=d.columns||[],g=d.rightColumns||[],h=function(b){for(var d=0,e=b.length;d<e;d++){var f=b[d];if(f.index===a||f.key===a)return c=d,!0}return!1};h(e)?b="left":h(f)?b="center":h(g)&&(b="right"),b&&d.selection.selectColumns(c,b)},getColumnByIndex:function(a){for(var b=this,c=b.leftColumns||[],d=b.columns||[],e=b.rightColumns||[],f=c.concat(d).concat(e),g=0,h=f.length;g<h;g++){var i=f[g];if(i.index===a||i.key===a)return i}},load:function(){this.store.loadData()},save:function(){this.store.save()},onWindowResize:function(){var b,c=this,d=c.renderTo;c.panel&&(d=c.panel.renderTo,b=a.get(d),c.setWidth(parseInt(b.width()))),c.setBodysHeight()},setWidth:function(a){var b=this,c=b.el,e=b.gridBorders,f=b.gridWithoutPanelBorders,g=b.panelBodyBorders,h=b.body,i=b.header;b.scroller.scroll(0,0);var j,k=function(a){for(var b=0,c=a.length,d=0;b<c;b++){a[b].hidden||(d+=a[b].width)}return d},l=k(b.leftColumns),m=k(b.rightColumns),n=a-l-m-g[1]-g[3];b.wrapped?(j=a,n=a-l-m,n-=e[1]+e[3],b.css({width:j})):b.panel?(n=a-l-m-g[1]-g[3],b.panel.el.width(a),n-=e[1]+e[3],j=a-g[1]-g[3],b.css({width:j})):(n=a-l-m-f[1]-f[3],c.css("width",a)),n<100&&(n=100),c.select("."+d).css("width",n),i.css("width",n),h.css("width",n),b.hasFlexColumns&&(b.reCalcColumnsWidth(),b.columnresizer.updateColumnsWidth()),b.scroller.setScrollBars()},getWidth:function(){var a=this;return a.panel?parseInt(a.panel.css("width")):parseInt(a.css("width"))},getHeight:function(){var a=this;return a.panel?parseInt(a.panel.css("height")):parseInt(a.css("height"))},setHeight:function(a,b){var c=this,d=c.gridBorders,e=c.panelBodyBorders;c.panel&&!1!==b&&c.panel.setHeight(a),c.title&&(a-=c.titleHeight),c.subTitle&&(a-=c.subTitleHeight),c.footer&&(a-=c.barHeight),c.bbar&&(a-=c.barHeight),c.tbar&&(a-=c.barHeight),c.subTBar&&(a-=c.barHeight),c.buttons&&(a-=c.barHeight);var f=a;c.header&&(f-=c.cellHeaderHeight,c.groupheader&&(f-=c.cellHeaderHeight)),c.panel&&(f-=e[0]+e[2]),f-=d[0]+d[2],c.body&&c.body.css("height",f),c.leftBody&&c.leftBody.css("height",f),c.rightBody&&c.rightBody.css("height",f),c.el.css("height",a),c.height=a,c.scroller.update()},find:function(a,b){return this.store.find(a,b)},findItem:function(a,b){return this.store.findItem(a,b)},each:function(a,b){this.store.each(a,b)},onActivate:function(){var b=this,c=a.get(document);setTimeout(function(){c.on("click",b.onDeactivateClick,b)},100)},onDeActivate:function(){var b=this,c=a.get(document);b.activated=!1,c.un("click",b.onDeactivateClick,b)},onDeactivateClick:function(b){for(var c=this,d=0,e=20,f=a.get(b.target);d<e;d++){if(!f.dom)return;if(!f.dom.tagName||"body"===f.dom.tagName.toLocaleLowerCase())return void c.fire("deactivate");if(f.hasCls(c.widgetCls))return;f=f.parent()}},search:function(a,b){this.searching.search(a,b)},stopSelection:function(){var a=this;a.selection&&a.selection.stopSelection()},enableSelection:function(a){var b=this;b.selection&&b.selection.enableSelection(a)},hideColumn:function(a,b){for(var c,d,e=this,f=e.getBody(a),g=e.getHeader(a),h=e.getColumns(a),i=0,j=h.length,k=e.centerEl,l=e.leftEl,m=e.leftHeader,n=e.rightEl,o=e.rightHeader;i<j;i++)if(d=h[i],d.index===b){c=i,d.hidden=!0;break}switch(g.hideCell(c),f.hideColumn(c),e.rowedit&&e.rowedit.hideField(c,a),a){case"left":l.css("width",parseInt(l.css("width"))-d.width),m.css("width",parseInt(m.css("width"))-d.width),k.css("left",parseInt(k.css("left"))-d.width),k.css("width",parseInt(k.css("width"))+d.width),e.body.css("width",parseInt(e.body.css("width"))+d.width),e.header.css("width",parseInt(e.header.css("width"))+d.width);break;case"right":n.css("width",parseInt(n.css("width"))-d.width),o.css("width",parseInt(o.css("width"))-d.width),k.css("width",parseInt(k.css("width"))+d.width),e.body.css("width",parseInt(e.body.css("width"))+d.width),e.header.css("width",parseInt(e.header.css("width"))+d.width)}e.grouping&&e.grouping.updateGroupRows()},showColumn:function(a,b){for(var c,d,e=this,f=e.getBody(a),g=e.getHeader(a),h=e.getColumns(a),i=0,j=h.length,k=e.centerEl,l=e.leftEl,m=e.leftHeader,n=e.rightEl,o=e.rightHeader;i<j;i++)if(d=h[i],d.index===b){c=i,d.hidden=!1;break}switch(g.showCell(c),f.showColumn(c),e.rowedit&&e.rowedit.showField(c,a),a){case"left":l.css("width",parseInt(l.css("width"))+d.width),m.css("width",parseInt(m.css("width"))+d.width),k.css("left",parseInt(k.css("left"))+d.width),k.css("width",parseInt(k.css("width"))-d.width),e.body.css("width",parseInt(e.body.css("width"))-d.width),e.header.css("width",parseInt(e.header.css("width"))-d.width);break;case"right":n.css("width",parseInt(n.css("width"))+d.width),o.css("width",parseInt(o.css("width"))+d.width),k.css("width",parseInt(k.css("width"))-d.width),e.body.css("width",parseInt(e.body.css("width"))-d.width),e.header.css("width",parseInt(e.header.css("width"))-d.width)}e.grouping&&e.grouping.updateGroupRows()},removeColumn:function(a,b){var c,d=this,e=d.leftEl,f=d.leftHeader,g=d.leftBody,h=d.centerEl,i=d.body,j=d.header,k=d.rightEl,l=d.rightBody,m=d.rightHeader;switch(b){case"left":c=d.leftColumns[a],d.leftColumns.splice(a,1),f.removeCell(a),f.reSetIndexes(),g.removeColumn(a),e.css("width",parseInt(e.css("width"))-c.width),h.css("left",parseInt(h.css("left"))-c.width),h.css("width",parseInt(h.css("width"))+c.width),i.css("width",parseInt(i.css("width"))+c.width),j.css("width",parseInt(j.css("width"))+c.width);break;case"center":c=d.columns[a],d.columns.splice(a,1),j.removeCell(a),j.reSetIndexes(),i.removeColumn(a);break;case"right":c=d.rightColumns[a],d.rightColumns.splice(a,1),m.removeCell(a),m.reSetIndexes(),l.removeColumn(a),k.css("right",parseInt(k.css("right"))-c.width),h.css("width",parseInt(h.css("width"))+c.width),j.css("width",parseInt(j.css("width"))+c.width),i.css("width",parseInt(i.css("width"))+c.width)}return c.grouping&&delete c.grouping,d.summary&&d.summary.removeColumn(a,b),c},insertColumn:function(a,b,c,d){var e=this,f=e.leftEl,g=e.leftBody,h=e.leftHeader,i=e.centerEl,j=e.body,k=e.header,l=e.rightEl,m=e.rightBody,n=e.rightHeader;switch(c=c||"center"){case"center":e.columns.splice(b,0,a),k.insertCell(b,a),k.reSetIndexes(),j.insertColumn(b,a);break;case"left":e.leftColumns.splice(b,0,a),h.insertCell(b,a),h.reSetIndexes(),g.insertColumn(b,a),f.css("width",parseInt(f.css("width"))+a.width),i.css("width",parseInt(i.css("width"))-a.width),i.css("left",parseInt(i.css("left"))+a.width),j.el.css("width",parseInt(j.el.css("width"))-a.width),k.el.css("width",parseInt(k.el.css("width"))-a.width);break;case"right":e.rightColumns.splice(b,0,a),n.insertCell(b,a),n.reSetIndexes(),m.insertColumn(b,a),l.css("width",parseInt(l.css("width"))+a.width),i.css("width",parseInt(i.css("width"))-a.width),j.css("width",parseInt(j.css("width"))-a.width),k.css("width",parseInt(k.css("width"))-a.width)}a.menu&&(a.menu=!0),e.grouping&&(e.grouping.updateGroupRows(),e.grouping.setCellsPosition(b,c)),a.rowEditor&&("left"===c&&b--,e.rowedit.moveEditor(a,b,c,d)),e.summary&&e.summary.insertColumn(b,c),e.header.destroyMenus(),e.leftHeader.destroyMenus(),e.rightHeader.destroyMenus()},disableLegend:function(a,b){var c=this;c.columns[a].disabled=c.columns[a].disabled||{},c.columns[a].disabled[b]=!0,c.body.updateRows(void 0,a)},enableLegend:function(a,b){var c=this;c.columns[a].disabled=c.columns[a].disabled||{},delete c.columns[a].disabled[b],c.body.updateRows(void 0,a)},fitHeight:function(){var a=this,b=a.store,c=a.panelBodyBorders,d=a.gridBorders,e=b.getLength()*a.cellHeight,f=1,g=a.columns.concat(a.leftColumns||[]).concat(a.rightColumns||[]);Fancy.each(g,function(a){a.grouping&&(f<2&&(f=2),a.filter&&a.filter.header&&f<3&&(f=3)),a.filter&&a.filter.header&&f<2&&(f=2)}),a.title&&(e+=a.titleHeight),a.tbar&&(e+=a.barHeight),a.bbar&&(e+=a.barHeight),a.buttons&&(e+=a.barHeight),a.subTBar&&(e+=a.barHeight),a.footer&&(e+=a.barHeight),!1!==a.header&&(e+=a.cellHeaderHeight*f),a.grouping&&(e+=a.grouping.groups.length*a.groupRowHeight),a.panel?e+=c[0]+c[2]+d[0]+d[2]:e+=d[0]+d[2],a.setHeight(e)},addFilter:function(b,c,d){var e=this,f=e.filter.filters[b],d=d||"";if(void 0===f&&(f={}),a.isDate(c)){var g=this.getColumnByIndex(b).format;f.type="date",f.format=g,c=Number(c)}""===c?delete f[d]:f[d]=c,e.filter.filters[b]=f,e.filter.updateStoreFilters(),e.filter.addValuesInColumnFields(b,c,d)},clearFilter:function(a,b){var c=this,d=c.store;void 0===a?(c.filter.filters={},d.filters={}):void 0===b?(c.filter.filters[a]={},d.filters[a]={}):c.filter&&c.filter.filters&&c.filter.filters[a]&&c.filter.filters[a][b]&&(delete c.filter.filters[a][b],delete d.filters[a][b]),d.changeDataView(),c.update(),c.filter&&c.filter.clearColumnsFields(a,b)},showLoadMask:function(a){this.loadmask.showLoadMask(a)},hideLoadMask:function(){this.loadmask.hideLoadMask()},prevPage:function(){this.paging.prevPage()},nextPage:function(){this.paging.nextPage()},setPage:function(a){a--,a<0&&(a=0),this.paging.setPage(a)},firstPage:function(){this.paging.firstPage()},lastPage:function(){this.paging.lastPage()},setPageSize:function(a){this.paging.setPageSize(a)},getPage:function(){return this.store.showPage+1},getPages:function(){return this.store.pages},getPageSize:function(){return this.store.pageSize},refresh:function(){this.paging.refresh()},scroll:function(a,b){var c=this,d=c.scroller;d.scroll(a,b),d.scrollBottomKnob(),d.scrollRightKnob()},getDataFiltered:function(){return this.store.filteredData},reCalcColumnsWidth:function(){var a=this;if(a.hasFlexColumns){var b,c=a.scroller,d=a.getCenterViewWidth(),e=a.columns,f=0,g=0,h=e.length,i=d;for(!1!==a.flexScrollSensitive&&c.isRightScrollable()&&!c.nativeScroller&&(i-=a.bottomScrollHeight);g<h;g++){var j=e[g];j.flex?f+=j.flex:i-=j.width}if(0!==f)for(b=i/f,g=0;g<h;g++){var j=e[g];j.flex&&(j.width=Math.floor(j.flex*b),j.minWidth&&j.width<j.minWidth?j.width=j.minWidth:j.width<a.minColumnWidth&&(j.width=a.minColumnWidth))}}},getDisplayedData:function(){for(var b=this,c=b.getViewTotal(),d=[],e=0,f=b.leftColumns,g=b.columns,h=b.rightColumns;e<c;e++){var i=[];a.each(f,function(a){void 0!==a.index&&i.push(b.get(e,a.index))}),a.each(g,function(a){void 0!==a.index&&i.push(b.get(e,a.index))}),a.each(h,function(a){void 0!==a.index&&i.push(b.get(e,a.index))}),d.push(i)}return d},exportToExcel:function(){var a=this;a.exporter&&a.exporter.exportToExcel()}})}(),Fancy.define("Fancy.grid.plugin.Updater",{extend:Fancy.Plugin,ptype:"grid.updater",inWidgetName:"updater",constructor:function(a){Fancy.applyConfig(this,a),this.Super("const",arguments)},init:function(){},update:function(){var a=this.widget;a.leftBody.update(),a.body.update(),a.rightBody.update()},updateRow:function(a){var b=this.widget;b.leftBody.updateRows(a),b.body.updateRows(a),b.rightBody.updateRows(a)}}),function(){var a=Fancy,b="fancy-scroll-right-inner",c="fancy-scroll-bottom-inner",d="fancy-scroll-right-hover",e="fancy-scroll-bottom-hover",f="fancy-scroll-right-active",g="fancy-scroll-bottom-active",h=a.HIDDEN_CLS,i=a.GRID_COLUMN_CLS,j=a.GRID_CENTER_CLS;a.define("Fancy.grid.plugin.Scroller",{extend:a.Plugin,ptype:"grid.scroller",inWidgetName:"scroller",rightKnobDown:!1,bottomKnobDown:!1,minRightKnobHeight:35,minBottomKnobWidth:35,cornerSize:12,scrollLeft:0,constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var b=this,c=b.widget,d=a.getMouseWheelEventName();c.once("render",function(){b.render(),c.leftBody.el.on(d,b.onMouseWheel,b),c.nativeScroller&&(c.leftBody.el.on(d,b.onMouseWheelLeft,b),c.rightBody.el.on(d,b.onMouseWheelRight,b)),c.body.el.on(d,b.onMouseWheel,b),c.rightBody.el.on(d,b.onMouseWheel,b),c.once("init",b.onGridInit,b),c.nativeScroller&&(c.body.el.on("scroll",b.onNativeScrollBody,b),c.leftBody.el.on("scroll",b.onNativeScrollLeftBody,b),c.rightBody.el.on("scroll",b.onNativeScrollRightBody,b))}),b.on("render",b.onRender,b),c.store.on("change",b.onChangeStore,b)},destroy:function(){var b=this,c=b.widget,d=c.leftBody,e=c.body,f=c.rightBody,g=a.get(document),h=a.getMouseWheelEventName();g.un("mouseup",b.onMouseUpDoc,b),g.un("mousemove",b.onMouseMoveDoc,b),d.el.un(h,b.onMouseWheel,b),e.el.un(h,b.onMouseWheel,b),f.el.un(h,b.onMouseWheel,b),b.scrollBottomEl.un("mousedown",b.onMouseDownBottomSpin,b),b.scrollRightEl.un("mousedown",b.onMouseDownRightSpin,b),a.isTouch&&(d.el.un("touchstart",b.onBodyTouchStart,b),d.el.un("touchmove",b.onBodyTouchMove,b),e.el.un("touchstart",b.onBodyTouchStart,b),e.el.un("touchmove",b.onBodyTouchMove,b),f.el.un("touchstart",b.onBodyTouchStart,b),f.el.un("touchmove",b.onBodyTouchMove,b),g.un("touchend",b.onMouseUpDoc,b))},onGridInit:function(){var b=this,c=b.widget,d=a.get(document);b.setScrollBars(),d.on("mouseup",b.onMouseUpDoc,b),d.on("mousemove",b.onMouseMoveDoc,b),c.on("columnresize",b.onColumnResize,b),c.on("lockcolumn",b.onLockColumn,b),c.on("rightlockcolumn",b.onRightLockColumn,b),c.on("unlockcolumn",b.onUnLockColumn,b),setTimeout(function(){b.update()},1)},render:function(){var d=this,e=d.widget,f=e.body,g=a.get(document.createElement("div")),i=a.get(document.createElement("div"));e.nativeScroller?e.el.addCls("fancy-grid-native-scroller"):(g.addCls("fancy-scroll-right"),i.addCls("fancy-scroll-bottom",h),g.update(['<div class="'+b+'"></div>'].join(" ")),g.select("."+b).css("margin-top",e.knobOffSet),i.update(['<div class="'+c+'"></div>'].join(" ")),a.get(f.el.append(g.dom)),d.scrollRightEl=f.el.select(".fancy-scroll-right"),a.get(f.el.append(i.dom)),d.scrollBottomEl=f.el.select(".fancy-scroll-bottom")),d.fire("render")},onMouseWheel:function(b){var c=this,d=c.widget,e=a.getWheelDelta(b.originalEvent||b);0!=c.isRightScrollable()&&(d.stopProp&&b.stopPropagation(),d.nativeScroller||(c.scrollDelta(e)&&b.preventDefault(),c.scrollRightKnob()))},onRender:function(){var b=this;!0!==b.widget.nativeScroller&&(b.scrollRightEl.hover(function(){!0!==b.bottomKnobDown&&b.scrollRightEl.addCls(d)},function(){b.scrollRightEl.removeCls(d)}),b.scrollBottomEl.hover(function(){!0!==b.rightKnobDown&&b.scrollBottomEl.addCls(e)},function(){b.scrollBottomEl.removeCls(e)}),b.initRightScroll(),b.initBottomScroll()),a.isTouch&&b.initTouch()},initTouch:function(){var b=this,c=b.widget,d=c.leftBody,e=c.body,f=c.rightBody,g=a.get(document);d.el.on("touchstart",b.onBodyTouchStart,b),d.el.on("touchmove",b.onBodyTouchMove,b),e.el.on("touchstart",b.onBodyTouchStart,b),e.el.on("touchmove",b.onBodyTouchMove,b),f.el.on("touchstart",b.onBodyTouchStart,b),f.el.on("touchmove",b.onBodyTouchMove,b),g.on("touchend",b.onMouseUpDoc,b)},onBodyTouchStart:function(a){var b=this,a=a.originalEvent||a,c=a.changedTouches[0];b.rightKnobDown=!0,b.bottomKnobDown=!0,b.mouseDownXY={x:c.pageX,y:c.pageY},b.rightKnobTop=parseInt(b.rightKnob.css("margin-top")),b.scrollRightEl.addCls(f),b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addCls(g)},onBodyTouchEnd:function(){this.onMouseUpDoc()},onBodyTouchMove:function(a){var b=this,a=a.originalEvent,c=a.changedTouches[0];!0===b.rightKnobDown&&a.preventDefault(),!0===b.bottomKnobDown&&a.preventDefault(),b.onMouseMoveDoc({pageX:c.pageX,pageY:c.pageY})},initRightScroll:function(){var a=this;a.rightKnob=a.scrollRightEl.select("."+b),a.scrollRightEl.on("mousedown",a.onMouseDownRightSpin,a)},initBottomScroll:function(){var a=this;a.bottomKnob=a.scrollBottomEl.select("."+c),a.scrollBottomEl.on("mousedown",a.onMouseDownBottomSpin,a)},onMouseDownRightSpin:function(b){var c=this;a.isTouch||(b.preventDefault(),c.rightKnobDown=!0,c.mouseDownXY={x:b.pageX,y:b.pageY},c.rightKnobTop=parseInt(c.rightKnob.css("margin-top")),c.scrollRightEl.addCls(f))},onMouseDownBottomSpin:function(a){var b=this;a.preventDefault(),b.bottomKnobDown=!0,b.mouseDownXY={x:a.pageX,y:a.pageY},b.bottomKnobLeft=parseInt(b.bottomKnob.css("margin-left")),b.scrollBottomEl.addCls(g)},onMouseUpDoc:function(){var a=this;!1===a.rightKnobDown&&!1===a.bottomKnobDown||(a.scrollRightEl.removeCls(f),a.scrollBottomEl.removeCls(g),a.rightKnobDown=!1,a.bottomKnobDown=!1)},onMouseMoveDoc:function(b){var c,d,e,f,g=this,h=g.widget,i=!1,j=!1,k=h.knobOffSet,l=b.pageX,m=b.pageY;g.rightKnobDown&&(a.isTouch?(d=g.mouseDownXY.y-m,e=d+g.rightKnobTop):(d=m-g.mouseDownXY.y,e=d+g.rightKnobTop),e<g.knobOffSet&&(e=g.knobOffSet),g.bodyViewHeight<e+g.rightKnobHeight&&(e=g.bodyViewHeight-g.rightKnobHeight),e<g.rightScrollScale&&(e=0),g.rightKnob.css("margin-top",e+k+"px"),i=g.rightScrollScale*e,g.scroll(i)),g.bottomKnobDown&&(a.isTouch?(c=g.mouseDownXY.x-l,d=g.mouseDownXY.y-m,f=c+g.bottomKnobLeft):(c=l-g.mouseDownXY.x,d=m-g.mouseDownXY.y,f=c+g.bottomKnobLeft),f<1&&(f=1),g.bodyViewWidth-2<f+g.bottomKnobWidth&&(f=g.bodyViewWidth-g.bottomKnobWidth-2),g.bottomScrollScale<0&&f<0&&(f=0,g.bottomScrollScale=0),g.bottomKnob.css("margin-left",f+"px"),j=Math.ceil(g.bottomScrollScale*(f-1)),g.scroll(!1,j))},setScrollBars:function(){var a=this,b=a.widget;setTimeout(function(){a.checkRightScroll()},1),a.checkBottomScroll()||a.scrollTop&&b.scroll(!1,0),b.nativeScroller||(a.checkCorner(),a.setRightKnobSize(),a.setBottomKnobSize())},checkRightScroll:function(){var a=this,b=a.widget,c=b.body,d=b.gridBorders,e=b.getBodyHeight(),f=b.getCellsViewHeight()-d[0]-d[2];b.nativeScroller?e>=f?c.el.css("overflow-y","hidden"):c.el.css("overflow-y","scroll"):e>=f?a.scrollRightEl.addCls(h):a.scrollRightEl.removeCls(h)},isRightScrollable:function(){var a=this.widget;return a.nativeScroller?"scroll"===a.body.el.css("overflow-y"):!this.scrollRightEl.hasCls(h)},setRightKnobSize:function(){var b=this,c=b.widget;if(!c.nativeScroller){var d=c.getBodyHeight()-(b.corner?b.cornerSize:0)-2,e=c.getCellsViewHeight()-(b.corner?b.cornerSize:0),f=e-d,g=100-f/(d/100),h=d*(g/100),i=c.knobOffSet;h<b.minRightKnobHeight&&(h=b.minRightKnobHeight),!1===b.corner&&(d-=i),b.rightKnob.animate({height:h},a.ANIMATE_DURATION),b.rightKnobHeight=h,b.bodyViewHeight=d,b.rightScrollScale=(e-d)/(d-h)}},checkBottomScroll:function(){var a,b=this,c=b.widget,d=c.body,e=c.getCenterViewWidth(),f=c.getCenterFullWidth()-2;return c.nativeScroller?e>f?(a=!1,d.el.css("overflow-x","hidden")):(a=!0,d.el.css("overflow-x","scroll")):e>f?(a=!1,b.scrollBottomEl.addCls(h)):(a=!0,b.scrollBottomEl.removeCls(h)),a},checkCorner:function(){var a=this;a.widget.nativeScroller||(a.corner=!a.scrollRightEl.hasCls(h)&&!a.scrollBottomEl.hasCls(h))},setBottomKnobSize:function(){var b=this,c=b.widget;if(!c.nativeScroller){var d=c.getCenterViewWidth()-(b.corner?b.cornerSize:0),e=c.getCenterFullWidth()-(b.corner?b.cornerSize:0),f=e-d,g=100-f/(e/100),h=d*(g/100)-2;h<b.minBottomKnobWidth&&(h=b.minBottomKnobWidth),b.bottomKnob.animate({width:h},a.ANIMATE_DURATION),b.bottomKnobWidth=h,b.bodyViewWidth=d,b.bottomScrollScale=(d-e)/(d-h-2-1)}},scroll:function(a,b){var c,d=this,e=d.widget;if(e.nativeScroller)return null!==a&&void 0!==a&&(e.body.el.dom.scrollTop=a),null!==b&&void 0!==b&&(e.body.el.dom.scrollLeft=b,e.header&&e.header.scroll(b)),void e.fire("scroll");e.leftBody.scroll(a),c=e.body.scroll(a,b),e.rightBody.scroll(a),void 0!==c.scrollTop&&(d.scrollTop=Math.abs(c.scrollTop)),void 0!==c.scrollLeft&&(d.scrollLeft=Math.abs(c.scrollLeft)),e.fire("scroll")},scrollDelta:function(a){var b,c=this,d=c.widget;return d.leftBody.wheelScroll(a),b=d.body.wheelScroll(a),d.rightBody.wheelScroll(a),c.scrollTop=Math.abs(b.newScroll),d.fire("scroll"),b.scrolled},scrollRightKnob:function(){var a=this,b=a.widget,c=a.getScroll(),d=c/a.rightScrollScale+b.knobOffSet;a.rightKnob&&a.rightKnob.css("margin-top",d+"px")},scrollBottomKnob:function(){var a=this,b=a.widget,c=a.getBottomScroll(),d=c/a.bottomScrollScale+b.knobOffSet;0===c&&(d=-1),a.bottomKnob&&a.bottomKnob.css("margin-left",-d+"px")},getScroll:function(){return Math.abs(parseInt(this.widget.body.el.select("."+i).item(0).css("top")))},getBottomScroll:function(){return Math.abs(parseInt(this.widget.body.el.select("."+i).item(0).css("left")))},update:function(){this.setScrollBars(),this.checkScroll()},onChangeStore:function(){this.update()},onColumnResize:function(){this.setScrollBars()},checkScroll:function(){var a=this,b=a.widget,c=a.getScroll(),d=b.getBodyHeight()-(a.corner?a.cornerSize:0),e=b.getCellsViewHeight()-(a.corner?a.cornerSize:0);c&&e<d&&(a.scroll(0),b.nativeScroller||a.scrollRightKnob())},scrollToCell:function(b){var c=this,d=c.widget,e=d.cellHeight,f=a.get(b),g=f.parent(),h=Number(f.attr("index")),i=Number(g.attr("index")),k=c.getScroll(),l=e*(h+1),m=d.getBodyHeight(),n=c.getBottomScroll(),o=parseInt(d.body.el.css("width")),p=0,q=g.parent().parent().hasCls(j);if(!d.nativeScroller){if(0===h&&0===i)return c.scroll(0,0),c.scrollBottomKnob(),void c.scrollRightKnob();if(l-k>m&&(k+=e,c.scroll(k)),q){for(var r=d.columns,s=0;s<=i;s++)p+=r[s].width;p-n>o?r[s]?c.scroll(k,-(n+r[s-1].width)):c.scroll(k,-(p-n-o)):0!==n&&0===i&&c.scroll(k,0),c.scrollBottomKnob()}c.scrollRightKnob()}},onNativeScrollBody:function(){var a=this,b=a.widget,c=b.body.el.dom.scrollTop,d=b.body.el.dom.scrollLeft;b.header&&b.header.scroll(-d),b.leftBody&&(b.leftBody.el.dom.scrollTop=c),b.rightBody&&(b.rightBody.el.dom.scrollTop=c),b.leftColumns.length&&b.leftBody.el.dom.scrollTop!==b.body.el.dom.scrollTop?b.body.el.dom.scrollTop=b.leftBody.el.dom.scrollTop:b.rightColumns.length&&b.rightBody.el.dom.scrollTop!==b.body.el.dom.scrollTop&&(b.body.el.dom.scrollTop=b.rightBody.el.dom.scrollTop),b.fire("nativescroll")},onNativeScrollLeftBody:function(){var a=this.widget;a.leftBody.el.dom.scrollTop!==a.body.el.dom.scrollTop&&this.onNativeScrollBody()},onNativeScrollRightBody:function(){var a=this.widget;a.rightBody.el.dom.scrollTop!==a.body.el.dom.scrollTop&&this.onNativeScrollBody()},onMouseWheelLeft:function(b){var c=this.widget,d=a.getWheelDelta(b.originalEvent||b),e=d*c.cellHeight;c.leftBody.el.dom.scrollTop-=e,c.body.el.dom.scrollTop-=e,c.rightBody.el.dom.scrollTop-=e},onMouseWheelRight:function(b){var c=this.widget,d=a.getWheelDelta(b.originalEvent||b),e=d*c.cellHeight;c.leftBody.el.dom.scrollTop-=e,c.body.el.dom.scrollTop-=e,c.rightBody.el.dom.scrollTop-=e},onLockColumn:function(){this.update(),this.widget.setColumnsPosition()},onRightLockColumn:function(){this.update(),this.widget.setColumnsPosition()},onUnLockColumn:function(){this.update(),this.widget.setColumnsPosition()}})}(),Fancy.define("Fancy.grid.plugin.LoadMask",{extend:Fancy.Plugin,ptype:"grid.loadmask",inWidgetName:"loadmask",cls:"fancy-loadmask",innerCls:"fancy-loadmask-inner",imageCls:"fancy-loadmask-image",textCls:"fancy-loadmask-text",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this,b=a.widget,c=b.store;b.once("render",function(){a.render(),c.loading&&a.onBeforeLoad(),b.on("beforeload",a.onBeforeLoad,a),b.on("load",a.onLoad,a)})},render:function(){var a,b,c=this,d=c.widget,e=d.el,f=e,g=Fancy.get(document.createElement("div")),h=d.lang;d.panel&&(f=d.panel.el),a=f.width(),b=f.height(),g.addCls(c.cls),"default"!==d.theme&&g.addCls("fancy-theme-"+d.theme),g.css({width:a,height:b,opacity:0}),g.update(['<div class="'+c.innerCls+'"><div class="'+c.imageCls+'"></div><div class="'+c.textCls+'">'+h.loadingText+"</div></div>"].join(" ")),c.el=Fancy.get(f.dom.appendChild(g.dom)),c.innerEl=c.el.select("."+c.innerCls),c.textEl=c.el.select("."+c.textCls);var i=c.innerEl.width(),j=c.innerEl.height();c.innerEl.css({left:a/2-i/2,top:b/2-j/2}),!0!==d.store.loading?g.css("display","none"):(g.css("display","block"),c.showLoadMask()),g.css("opacity",1)},onBeforeLoad:function(){this.showLoadMask()},onLoad:function(){this.hideLoadMask()},showLoadMask:function(a){var b=this,c=b.widget,d=c.lang;if(a)return b.textEl.update(a),void b.el.css("display","block");b.loaded=!1,setTimeout(function(){!0!==b.loaded&&(b.textEl.update(d.loadingText),b.el.css("display","block"))},50)},hideLoadMask:function(){this.loaded=!0,this.el.css("display","none")}}),function(){var a=Fancy,b=a.get,c=a.FIELD_CLS,d=a.GRID_RESIZER_LEFT_CLS,e=a.GRID_RESIZER_RIGHT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_CLS,i=a.GRID_COLUMN_RESIZER_CLS,j=a.GRID_COLUMN_CLS,k=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,l=a.GRID_STATE_RESIZE_COLUMN_CLS,m=a.ANIMATE_DURATION;a.define("Fancy.grid.plugin.ColumnResizer",{extend:a.Plugin,ptype:"grid.columnresizer",inWidgetName:"columnresizer",constructor:function(a){this.Super("const",arguments)},init:function(){var a=this,b=a.widget;a.Super("init",arguments),b.on("render",function(){a.render(),a.ons()})},ons:function(){var a=this,b=a.widget;b.on("headercellmousemove",a.onCellMouseMove,a),b.on("headercellmousedown",a.onHeaderCellMouseDown,a),b.on("docclick",a.onDocClick,a),b.on("docmove",a.onDocMove,a),b.on("docmouseup",a.onDocMouseUp,a)},onCellMouseMove:function(a,d){var e=this,h=e.widget,i=d.e,j=b(d.cell),k=i.offsetX,l=j.width(),m=b(i.target),n=m.hasCls(f),o=m.hasCls(g),p=j.select("."+f).item(0),q=j.select("."+g).item(0),r=b(i.target).closest("."+c).hasCls(c),s=parseInt(p.css("width")),t=parseInt(q.css("width")),u=l,v=7;if(n&&(u=s),o&&(u=t),!h.startResizing)if("left"===d.side&&d.index===h.leftColumns.length-1&&u-k<v+2&&(v+=2),!n&&!o&&"right"===d.side&&0===d.index&&k<v)e.isColumnResizable(d)&&(r||e.addCellResizeCls(d.cell));else if(!n&&!o&&k<v&&"center"===d.side&&0===d.index&&h.leftColumns.length)d.side="left",d.index=h.leftColumns.length-1,e.isColumnResizable(d)&&(r||e.addCellResizeCls(d.cell));else if(n||o||!(u-k<v||k<v)||0===d.index)u-k<v?o?t-k>2?e.removeCellResizeCls(d.cell):e.addCellResizeCls(d.cell):e.isColumnResizable(d)&&e.addCellResizeCls(d.cell):e.removeCellResizeCls(d.cell);else{var w=k<v;e.isColumnResizable(d,w)&&(r||e.addCellResizeCls(d.cell))}},addCellResizeCls:function(a){var c=this,d=c.widget,e=d.columndrag;e&&"dragging"===e.status||(b(a).addCls(i),b(a).select("."+f).addCls(i))},removeCellResizeCls:function(a){b(a).removeClass(i),b(a).select("."+f).item(0).removeClass(i)},onHeaderCellMouseDown:function(d,e){var h=this,i=h.widget,d=e.e,j=b(d.target),k=b(e.cell),l=d.offsetX,m=k.width(),n=k.select("."+c),o=j.hasCls(f),p=j.hasCls(g),q=k.select("."+f).item(0),r=k.select("."+g).item(0),s=parseInt(q.css("width")),t=parseInt(r.css("width")),u=m,v=7;if(o&&(u=s),p)return void(u=t);n.length>0&&n.item(0).within(j.dom)||("left"===e.side&&e.index===i.leftColumns.length-1&&u-l<v+2&&(v+=2),!o&&!p&&"right"===e.side&&0===e.index&&l<v?(i.startResizing=!0,a.apply(h,{cell:e.cell,activeSide:e.side,clientX:d.clientX,columnIndex:e.index,moveLeftResizer:!0})):l<7&&"center"===e.side&&0===e.index&&i.leftColumns.length?(i.startResizing=!0,e.side="left",e.index=i.leftColumns.length-1,a.apply(h,{cell:h.getCell(e),activeSide:e.side,clientX:d.clientX,columnIndex:e.index})):!o&&!p&&l<v&&0!==e.index?(i.startResizing=!0,a.apply(h,{cell:h.getPrevCell(e),activeSide:e.side,clientX:d.clientX,columnIndex:e.index-1})):u-l<v&&(i.startResizing=!0,a.apply(h,{cell:e.cell,activeSide:e.side,clientX:d.clientX,columnIndex:e.index})),i.startResizing&&h.isColumnResizable())},isColumnResizable:function(a,b){var c,d,e,f=this,g=f.widget;if(a){if(c=g.getColumns(a.side),e=a.index,b&&e--,isNaN(e))return;return d=c[e],!0===d.resizable}c=g.getColumns(f.activeSide),!0!==c[f.columnIndex].resizable&&(g.startResizing=!1,delete f.cell,delete f.activeSide,delete f.clientX,delete f.columnIndex)},getMinColumnWidth:function(){var a,b,c=this,d=c.widget,e=d.minCellWidth;return void 0===c.columnIndex?e:(a=d.getColumns(c.activeSide),b=a[c.columnIndex],b.minWidth?b.minWidth:e)},getMaxColumnWidth:function(){var a,b,c=this,d=c.widget;return void 0!==c.columnIndex&&(a=d.getColumns(c.activeSide),b=a[c.columnIndex],!!b.maxWidth&&b.maxWidth)},onDocClick:function(){this.widget.startResizing=!1},onDocMove:function(a,b){this.widget.startResizing&&this.moveResizeEls(b)},render:function(){var a=this,c=a.widget,f=b(document.createElement("div")),g=b(document.createElement("div"));f.addCls(d),g.addCls(e),a.leftEl=b(c.el.dom.appendChild(f.dom)),a.rightEl=b(c.el.dom.appendChild(g.dom))},moveResizeEls:function(c){var d=this,e=d.widget,f=b(d.cell),g=parseInt(f.css("left")),h=d.getMinColumnWidth(),i=d.getMaxColumnWidth();switch(e.header.hideMenu&&(e.header.hideMenu(),e.el.addCls(l),a.get(document.body).addCls(l)),d.activeSide){case"left":break;case"center":g+=parseInt(e.leftEl.css("width"));break;case"right":g+=parseInt(e.leftEl.css("width")),g+=parseInt(e.centerEl.css("width"))}var j=c.clientX,k=j-d.clientX,m=f.width()+k;m<h&&(m=h),i&&m>i&&(m=i),d.deltaWidth=f.width()-m,d.moveLeftResizer?(k=j-d.clientX,m=f.width()-k,m<h&&(m=h),d.deltaWidth=f.width()-m,d.leftEl.css({display:"block",left:g+k+"px"}),d.rightEl.css({display:"block",left:g+f.width()-1+"px"})):(d.leftEl.css({display:"block",left:g+"px"}),d.rightEl.css({display:"block",left:g+m+"px"})),d.cellWidth=m},onDocMouseUp:function(){var b=this,c=b.widget;!1!==c.startResizing&&(c.el.removeCls(l),a.get(document.body).removeCls(l),b.leftEl.css({display:"none"}),b.rightEl.css({display:"none"}),b.fixSidesWidth(),c.startResizing=!1,b.moveLeftResizer=!1,delete b.cellWidth)},fixSidesWidth:function(){var c,d,e,f,g=this,i=g.widget,l=g.cellWidth,n=g.columnIndex,o=g.deltaWidth,p=i.leftEl,q=i.centerEl,r=i.rightEl,s=i.leftHeader.el,t=i.header.el,u=i.rightHeader.el,v=i.body.el,w={},x={},y=g.minCenterWidth;if(void 0!==l){var z=1;switch(a.nojQuery&&(z=0),g.activeSide){case"left":if((f=parseInt(q.css("width"))+o+z)<y)return;e=i.leftColumns[n],i.leftColumns[g.columnIndex].width=l,c=i.leftBody.el.select("."+j),d=i.leftHeader.el.select("."+h),c.item(n).animate({width:l},m);for(var A=g.columnIndex+1,B=d.length,C=0,D=A;C<D;C++){var E=d.item(C),F=E.attr("group-index");F&&(x[F]=!0)}for(;A<B;A++){var G=c.item(A),E=d.item(A);G.animate({left:parseInt(G.css("left"))-o-z},m),E.hasCls(k)&&x[E.attr("index")]||E.animate({left:parseInt(E.css("left"))-o-z},m)}p.animate({width:parseInt(p.css("width"))-o-z},m),s.animate({width:parseInt(s.css("width"))-o-z+"px"},m),i.columns.length&&(q.animate({left:parseInt(q.css("left"))-o-z,width:f},m),t.animate({width:parseInt(t.css("width"))+o+z},m),v.animate({width:parseInt(v.css("width"))+o+z},m));break;case"center":e=i.columns[n],i.columns[g.columnIndex].width=l,c=i.body.el.select("."+j),d=i.header.el.select("."+h),c.item(n).animate({width:l},m);for(var A=g.columnIndex+1,B=d.length,C=0,D=A;C<D;C++){var E=d.item(C),F=E.attr("group-index");F&&(x[F]=!0)}for(;A<B;A++){var G=c.item(A),E=d.item(A),H=parseInt(G.css("left"))-o-z,I=parseInt(E.css("left"))-o-z;E.attr("group-index")&&(w[E.attr("group-index")]={}),G.animate({left:H},m),E.hasCls(k)&&x[E.attr("index")]||E.animate({left:I},m)}break;case"right":if((f=parseInt(q.css("width"))+o+z)<y)return;e=i.rightColumns[n],i.rightColumns[g.columnIndex].width=l,c=i.rightBody.el.select("."+j),d=i.rightHeader.el.select("."+h),c.item(n).animate({width:l+"px"},m);for(var A=g.columnIndex+1,B=d.length,C=0,D=A;C<D;C++){var E=d.item(C),F=E.attr("group-index");F&&(x[F]=!0)}for(;A<B;A++){var G=c.item(A),E=d.item(A);G.animate({left:parseInt(G.css("left"))-o-z},m),E.hasCls(k)&&x[E.attr("index")]||E.animate({left:parseInt(E.css("left"))-o-z},m)}r.animate({width:parseInt(r.css("width"))-o-z},m),u.animate({width:parseInt(u.css("width"))-o-z+"px"},m),i.columns.length&&(q.animate({width:f},m),t.animate({width:parseInt(t.css("width"))+o+z},m),v.animate({width:parseInt(v.css("width"))+o+z},m))}var J,K=b(g.cell),L=K.attr("group-index");if(K.animate({width:l+"px"},m),L)J=i.el.select("[index='"+L+"']"),J.animate({width:parseInt(J.css("width"))-o-z},m);else for(var M in w)J=i.el.select("[index='"+M+"']"),J.css("left",parseInt(J.css("left"))-(w[M].delta||0)-z);if(i.fire("columnresize",{cell:K.dom,width:l}),/sparkline/.test(e.type))switch(g.activeSide){case"left":i.leftBody.updateRows(void 0,n);break;case"center":i.body.updateRows(void 0,n);break;case"right":i.rightBody.updateRows(void 0,n)}}},getPrevCell:function(a){var b,c=this,d=c.widget;switch(a.side){case"left":b=d.leftHeader;break;case"center":b=d.header;break;case"right":b=d.rightHeader}return b.el.select("."+h).item(a.index-1).dom},getCell:function(a){var b,c=this,d=c.widget;switch(a.side){case"left":b=d.leftHeader;break;case"center":b=d.header;break;case"right":b=d.rightHeader}return b.el.select("."+h).item(a.index).dom},updateColumnsWidth:function(a){for(var b=this,c=b.widget,a=a||"center",d=c.getHeader(a),e=c.getColumns(a),f=0,g=e.length;f<g;f++){var h=e[f];b.setColumnWidth(f,h.width,a)}d.setCellsPosition()},setColumnWidth:function(a,c,d){var e,f,g=this,h=g.widget,i=h.getColumns(d),j=h.getHeader(d),k=h.getBody(d),l=b(k.getDomColumn(a)),m=j.getCell(a),n=parseInt(l.css("left"));l.css("width",c),m.css("width",c),i[a+1]&&(n+=c,f=b(k.getDomColumn(a+1)),f.css("left",n),e=j.getCell(a+1),e.css("left",n))}})}(),Fancy.define("Fancy.grid.plugin.Licence",{extend:Fancy.Plugin,ptype:"grid.licence",inWidgetName:"licence",constructor:function(a){this.Super("const",arguments)},init:function(){this.Super("init",arguments),this.ons()},ons:function(){var a=this;a.widget.once("render",function(){a.render()})},render:function(){var a=this,b=a.widget,c=b.body,d=Fancy.get(document.createElement("div"));/fancygrid/.test(location.host)&&!b.watermark||(!0!==a.checkLicence()||b.watermark)&&(d.css({position:"absolute","z-index":2,width:"30px",height:"30px"}),b.nativeScroller?d.css({top:"2px",left:"2px"}):d.css({right:"4px",bottom:"0px"}),d.update('<a href="http://www.fancygrid.com" title="JavaScript Grid - FancyGrid" style="background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAPklEQVR42mNgGLGAo+/4f1IwTN+i8y/+k4JHLR61eNTiUYuHgcUjD5AbZORG0ajFoxaPWjxq8RC2eBQMWwAAuxzh7E9tdUsAAAAASUVORK5CYII=);color: #60B3E2;font-size: 25px;line-height: 30px;text-decoration: none;">&nbsp;&nbsp;&nbsp;&nbsp;</a>'),Fancy.get(c.el.append(d.dom)),a.licenceEl=d,b.watermark&&a.configWatermark(),a.showConsoleText())},showConsoleText:function(){window.console&&console.log&&Fancy.isChrome&&console.log("%cFancy%cGrid%c %cTrial%c Version! \nPurchase license for legal usage!\nSales email: sales@fancygrid.com","color:#A2CFE8;font-size: 14px;font-weight: bold;","color:#088EC7;font-size: 14px;font-weight: bold;","font-weight:bold;color: #515151;font-size: 12px;","color: red;font-weight: bold;font-size: 14px;","font-weight:bold;color: #515151;font-size: 12px;")},configWatermark:function(){var a=this,b=a.widget,c=b.watermark;if(c.text){var d=a.licenceEl.firstChild();d.css("background-image","none"),d.css("font-size","11px"),d.update(c.text),a.licenceEl.css("width","initial")}c.style&&a.licenceEl.css(c.style)},checkLicence:function(){var a=this,b="FancyGrid";if(!Fancy.LICENSE&&!FancyGrid.LICENSE)return!1;var c,d,e=String(a.md5(location.host.replace(/^www\./,""),b)),f=Fancy.LICENSE||FancyGrid.LICENSE||[],g=a.md5("UNIVERSAL",b),h=a.md5("SAAS",b),i=a.md5("INTERNAL",b),j=a.md5("OEM",b),k=a.md5("ENTERPRISE",b);for(c=0,d=f.length;c<d;c++)switch(String(f[c])){case e:case g:case h:case i:case j:case k:return!0}return!1},md5:function(a,b,c){var d=function(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c},e=function(a,b){return a<<b|a>>>32-b},f=function(a,b,c,f,g,h){return d(e(d(d(b,a),d(f,h)),g),c)},g=function(a,b,c,d,e,g,h){return f(b&c|~b&d,a,b,e,g,h)},h=function(a,b,c,d,e,g,h){return f(b&d|c&~d,a,b,e,g,h)},i=function(a,b,c,d,e,g,h){return f(b^c^d,a,b,e,g,h)},j=function(a,b,c,d,e,g,h){return f(c^(b|~d),a,b,e,g,h)},k=function(a,b){a[b>>5]|=128<<b%32,a[14+(b+64>>>9<<4)]=b;var c,e,f,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(c=0;c<a.length;c+=16)e=m,f=n,k=o,l=p,m=g(m,n,o,p,a[c],7,-680876936),p=g(p,m,n,o,a[c+1],12,-389564586),o=g(o,p,m,n,a[c+2],17,606105819),n=g(n,o,p,m,a[c+3],22,-1044525330),m=g(m,n,o,p,a[c+4],7,-176418897),p=g(p,m,n,o,a[c+5],12,1200080426),o=g(o,p,m,n,a[c+6],17,-1473231341),n=g(n,o,p,m,a[c+7],22,-45705983),m=g(m,n,o,p,a[c+8],7,1770035416),p=g(p,m,n,o,a[c+9],12,-1958414417),o=g(o,p,m,n,a[c+10],17,-42063),n=g(n,o,p,m,a[c+11],22,-1990404162),m=g(m,n,o,p,a[c+12],7,1804603682),p=g(p,m,n,o,a[c+13],12,-40341101),o=g(o,p,m,n,a[c+14],17,-1502002290),n=g(n,o,p,m,a[c+15],22,1236535329),m=h(m,n,o,p,a[c+1],5,-165796510),p=h(p,m,n,o,a[c+6],9,-1069501632),o=h(o,p,m,n,a[c+11],14,643717713),n=h(n,o,p,m,a[c],20,-373897302),m=h(m,n,o,p,a[c+5],5,-701558691),p=h(p,m,n,o,a[c+10],9,38016083),o=h(o,p,m,n,a[c+15],14,-660478335),n=h(n,o,p,m,a[c+4],20,-405537848),m=h(m,n,o,p,a[c+9],5,568446438),p=h(p,m,n,o,a[c+14],9,-1019803690),o=h(o,p,m,n,a[c+3],14,-187363961),n=h(n,o,p,m,a[c+8],20,1163531501),m=h(m,n,o,p,a[c+13],5,-1444681467),p=h(p,m,n,o,a[c+2],9,-51403784),o=h(o,p,m,n,a[c+7],14,1735328473),n=h(n,o,p,m,a[c+12],20,-1926607734),m=i(m,n,o,p,a[c+5],4,-378558),p=i(p,m,n,o,a[c+8],11,-2022574463),o=i(o,p,m,n,a[c+11],16,1839030562),n=i(n,o,p,m,a[c+14],23,-35309556),m=i(m,n,o,p,a[c+1],4,-1530992060),p=i(p,m,n,o,a[c+4],11,1272893353),o=i(o,p,m,n,a[c+7],16,-155497632),n=i(n,o,p,m,a[c+10],23,-1094730640),m=i(m,n,o,p,a[c+13],4,681279174),p=i(p,m,n,o,a[c],11,-358537222),o=i(o,p,m,n,a[c+3],16,-722521979),n=i(n,o,p,m,a[c+6],23,76029189),m=i(m,n,o,p,a[c+9],4,-640364487),p=i(p,m,n,o,a[c+12],11,-421815835),o=i(o,p,m,n,a[c+15],16,530742520),n=i(n,o,p,m,a[c+2],23,-995338651),m=j(m,n,o,p,a[c],6,-198630844),p=j(p,m,n,o,a[c+7],10,1126891415),o=j(o,p,m,n,a[c+14],15,-1416354905),n=j(n,o,p,m,a[c+5],21,-57434055),m=j(m,n,o,p,a[c+12],6,1700485571),p=j(p,m,n,o,a[c+3],10,-1894986606),o=j(o,p,m,n,a[c+10],15,-1051523),n=j(n,o,p,m,a[c+1],21,-2054922799),m=j(m,n,o,p,a[c+8],6,1873313359),p=j(p,m,n,o,a[c+15],10,-30611744),o=j(o,p,m,n,a[c+6],15,-1560198380),n=j(n,o,p,m,a[c+13],21,1309151649),m=j(m,n,o,p,a[c+4],6,-145523070),p=j(p,m,n,o,a[c+11],10,-1120210379),o=j(o,p,m,n,a[c+2],15,718787259),n=j(n,o,p,m,a[c+9],21,-343485551),m=d(m,e),n=d(n,f),o=d(o,k),p=d(p,l);return[m,n,o,p]},l=function(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c},m=function(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c},n=function(a){return l(k(m(a),8*a.length))},o=function(a,b){var c,d,e=m(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=k(e,8*a.length)),c=0;c<16;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=k(f.concat(m(b)),512+8*b.length),l(k(g.concat(d),640))},p=function(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e},q=function(a){return unescape(encodeURIComponent(a))},r=function(a){return n(q(a))},s=function(a){return p(r(a))},t=function(a,b){return o(q(a),q(b))},u=function(a,b){return p(t(a,b))};return function(a,b,c){return b?c?t(b,a):u(b,a):c?r(a):s(a)}(a,b,c)}}),function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_EVEN_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_COLUMN_TEXT_CLS,f=a.GRID_COLUMN_ELLIPSIS_CLS,g=a.GRID_COLUMN_ORDER_CLS,h=a.GRID_COLUMN_SELECT_CLS,i=a.GRID_CELL_INNER_CLS,j=a.GRID_CELL_DIRTY_CLS,k=a.GRID_CELL_DIRTY_EL_CLS,l=a.GRID_PSEUDO_CELL_CLS,m=a.GRID_EMPTY_CLS,n=a.GRID_COLUMN_SPARKLINE_CLS,o=a.GRID_COLUMN_SPARKLINE_BULLET_CLS,p=a.GRID_COLUMN_CHART_CIRCLE_CLS,q=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,r=a.GRID_COLUMN_GROSSLOSS_CLS,s=a.GRID_COLUMN_PROGRESS_CLS,t=a.GRID_COLUMN_PROGRESS_BAR_CLS,u=a.GRID_COLUMN_H_BAR_CLS;a.ns("Fancy.grid.body.mixin"),a.grid.body.mixin.Updater=function(){},a.grid.body.mixin.Updater.prototype={update:function(){var a=this,b=a.widget,c=b.store;a.checkDomColumns(),c.loading||(a.checkDomCells(),a.updateRows(),a.showEmptyText())},checkDomColumns:function(){var b=this,c=b.widget,i=b.el.select("."+d).length,j=b.getColumns(),k=0,l=j.length;if(!(l<=i)){for(;k<l;k++){var m=j[k],n=m.width,o=a.get(document.createElement("div"));if(m.hidden&&o.css("display","none"),o.addCls(d),o.attr("grid",c.id),"$selected"===m.index)o.addCls(h);else switch(m.type){case"order":o.addCls(g)}if(m.cls&&o.addCls(m.cls),"text"===m.type&&o.addCls(e),o.css({width:n+"px"}),o.attr("index",k),m.cellAlign&&o.css("text-align",m.cellAlign),!0===m.ellipsis)switch(m.type){case"string":case"text":case"number":o.addCls(f)}b.el.dom.appendChild(o.dom)}b.fire("adddomcolumns")}},checkDomCells:function(e){var f,g,h=this,i=h.widget,j=i.store,k=0,m=j.dataView.length,n=0;switch(h.side){case"left":g=i.leftColumns;break;case"center":g=i.columns;break;case"right":g=i.rightColumns}f=g.length;var o=h.el.select("."+d),p=j.getLength(),q=h.cellTpl;for(i.cellWrapper&&(q=h.cellWrapperTpl),void 0!==e&&(n=e,f=e);n<f;n++){g[n];var r=o.item(n);k=0;var s=p-r.select("."+b).length;for(k=m-s;k<m;k++){var t=q.getHTML({}),u=a.get(document.createElement("div"));u.css({height:i.cellHeight+"px"}),u.addCls(b),u.attr("index",k),k%2!=0&&i.striped&&u.addCls(c),u.update(t),r.dom.appendChild(u.dom)}if(i.nativeScroller&&("left"===h.side||"right"===h.side)){r.select("."+l).destroy();var t=q.getHTML({cellValue:"&nbsp;"}),u=a.get(document.createElement("div"));u.css({height:i.cellHeight+"px"}),u.addCls(l),u.update(t),r.dom.appendChild(u.dom)}}},updateRows:function(a,b){var c,d,e=this,f=e.widget,g=0;switch(void 0===a?e.clearDirty():e.clearDirty(a),e.side){case"left":c=f.leftColumns;break;case"center":c=f.columns;break;case"right":c=f.rightColumns}for(d=c.length,void 0!==b&&(g=b,d=b+1);g<d;g++){var h=c[g];switch(h.type){case"string":case"number":case"combo":case"action":case"text":case"date":case"currency":e.renderUniversal(g,a);break;case"order":e.renderOrder(g,a);break;case"expand":e.renderExpand(g,a);break;case"select":e.renderSelect(g,a);break;case"color":e.renderColor(g,a);break;case"checkbox":e.renderCheckbox(g,a);break;case"image":e.renderImage(g,a);break;case"sparklineline":e.renderSparkLine(g,a,"line");break;case"sparklinebar":e.renderSparkLine(g,a,"bar");break;case"sparklinetristate":e.renderSparkLine(g,a,"tristate");break;case"sparklinediscrete":e.renderSparkLine(g,a,"discrete");break;case"sparklinebullet":e.renderSparkLine(g,a,"bullet");break;case"sparklinepie":e.renderSparkLine(g,a,"pie");break;case"sparklinebox":e.renderSparkLine(g,a,"box");break;case"circle":e.renderCircle(g,a);break;case"progressdonut":e.renderProgressDonut(g,a);break;case"progressbar":e.renderProgressBar(g,a);break;case"hbar":e.renderHBar(g,a);break;case"grossloss":e.renderGrossLoss(g,a);break;default:throw new Error("[FancyGrid error] - not existed column type "+h.type)}}e.removeNotUsedCells()},renderUniversal:function(a,c){var e,f,g,h=this,j=h.widget,k=j.lang,l=j.emptyValue,m=j.store,n=h.getColumns(),o=n[a],p=h.el.select("."+d),q=p.item(a),r=q.select("."+b),s=q.select("."+b+" ."+i),t=k.currencySign;for(e=void 0!==o.key?o.key:void 0!==o.index?o.index:"action"===o.type?"none":void 0,void 0!==c?(f=c,g=c+1):(f=0,g=m.getLength());f<g;f++){var u,v=m.get(f),w=m.getId(f),x=s.item(f),y=r.item(f),z={rowIndex:f,data:v,style:{},column:o,id:w,item:m.getItem(f),inner:x,cell:y},A=!1;switch(m.changed[z.id]&&m.changed[z.id][o.index]&&(A=!0),u=o.smartIndexFn?o.smartIndexFn(v):m.get(f,e),z.value=u,o.format&&(z.value=h.format(z.value,o.format),u=z.value),o.type){case"currency":""!==u&&(u=t+u),z.value=u}switch(o.render&&(z=o.render(z),u=z.value),u){case"":case void 0:u=l}j.cellStylingCls&&h.clearCls(y),z.cls&&y.addCls(z.cls),A&&j.dirtyEnabled&&h.enableCellDirty(y),y.css(z.style),z.column.widget||x.update(u)}},renderOrder:function(a){var c=this,e=c.widget,f=e.store,g=c.getColumns(),h=g[a],j=c.el.select("."+d),k=j.item(a),l=k.select("."+b),m=k.select("."+b+" ."+i),n=0,o=f.getLength(),p=0;for(e.paging&&(p+=f.showPage*f.pageSize);n<o;n++){var q=f.get(n),r=f.getId(n),s={rowIndex:n,data:q,style:{},column:h,id:r,item:f.getItem(n)},t=n+1+p;s.value=t,h.render&&(s=h.render(s),t=s.value);var u=l.item(n);e.cellStylingCls&&c.clearCls(u),s.cls&&u.addCls(s.cls),u.css(s.style),m.item(n).update(t)}},renderExpand:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.el.select("."+d),m=l.item(c),n=m.select("."+b+" ."+i);for(void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var o,p=n.item(f),q=p.select(".fancy-field-checkbox"),r=0!==q.length,s=j.get(f),t=s.id;!1===r?(n.item(f).update(""),new a.CheckBox({renderTo:n.item(f).dom,renderId:!0,value:!1,label:!1,expander:!0,style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){e=a.el.parent().parent().attr("index"),b?j.expander.expand(e):j.expander.collapse(e)}}]})):(o=q.dom.id,q=a.getWidget(o),j.expander._expandedIds[t]?q.set(!0,!1):q.set(!1,!1))}},clearCls:function(b){var c=this.widget;a.each(c.cellStylingCls,function(a){b.removeCls(a)})},renderColor:function(a,c){var e,f,g=this,h=g.widget,j=h.store,k=g.getColumns(),l=k[a],m=l.key||l.index,n=g.el.select("."+d),o=n.item(a),p=o.select("."+b);for(void 0!==c?(e=c,f=c+1):(e=0,f=j.getLength());e<f;e++){var q,r=j.get(e),s={rowIndex:e,data:r,style:{},column:l};q=l.smartIndexFn?l.smartIndexFn(r):j.get(e,m),l.render&&(s=l.render(s),q=s.value),s.value=q;var t=p.item(e);t.css(s.style);t.select("."+i).update('<div class="fancy-grid-color-cell" style="background: '+q+';"></div>')}},renderCombo:function(a,c){var e,f,g=this,h=g.widget,j=h.store,k=g.getColumns(),l=k[a],m=l.key||l.index,n=g.el.select("."+d),o=n.item(a),p=o.select("."+b),q=o.select("."+b+" ."+i);for(void 0!==c?(e=c,f=c+1):(e=0,f=j.getLength());e<f;e++){var r=j.get(e,m),s={rowIndex:e,value:r,style:{}};l.render&&(s=l.render(s),r=s.value),p.item(e).css(s.style),q.item(e).update(r)}},renderCheckbox:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+i);for(void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var s,t=k.get(f),u=k.get(f,n),v=r.item(f),w=v.select(".fancy-field-checkbox"),x=0!==w.length,y=!1,z=k.getId(f),A={rowIndex:f,data:t,style:{},column:m,id:z,item:k.getItem(f),value:u};if(k.changed[A.id]&&k.changed[A.id][m.index]&&(y=!0),m.render&&(A=m.render(A),u=A.value),!1===x)if(A.stopped)r.item(f).update(u);else{var B=!0;j.rowEdit&&(B=!1),r.item(f).update(""),new a.CheckBox({renderTo:r.item(f).dom,renderId:!0,value:u,label:!1,editable:B,style:{padding:"0px",display:"inline-block"},events:[{beforechange:function(a){"$selected"!==m.index&&!0!==m.editable&&(a.canceledChange=!0)}},{change:function(a,b){"$selected"!==m.index&&(j.celledit.checkBoxChangedValue=b)}}]})}else s=w.dom.id,w=a.getWidget(s),A.stopped?(w.destroy(),r.item(f).update(u)):w.set(u,!1);if(y){var C=q.item(f);h.enableCellDirty(C)}}},renderSelect:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b+" ."+i);for(void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var r,s=k.get(f,n),t=k.get(f,"id"),u=q.item(f),v=u.select(".fancy-field-checkbox"),w=0!==v.length;j.selection.memory&&(j.selection.memory.all&&!j.selection.memory.except[t]?(s=!0,j.selection.domSelectRow(f)):j.selection.memory.selected[t]?(s=!0,j.selection.domSelectRow(f)):(s=!1,j.selection.domDeSelectRow(f))),!1===w?new a.CheckBox({renderTo:q.item(f).dom,renderId:!0,value:s,label:!1,stopIfCTRL:!0,style:{padding:"0px",display:"inline-block"}}):(r=v.dom.id,v=a.getWidget(r),v.set(s,!1))}},renderImage:function(a,c){var e,f,g=this,h=g.widget,j=h.store,k=g.getColumns(),l=k[a],m=l.key||l.index,n=g.el.select("."+d),o=n.item(a),p=o.select("."+b),q=o.select("."+b+" ."+i);for(void 0!==c?(e=c,f=c+1):(e=0,f=j.getLength());e<f;e++){var r=j.get(e,m),s=j.get(e),t={rowIndex:e,value:r,data:s,style:{}},u="";if(l.render&&(t=l.render(t),r=t.value),t.attr)for(var v in t.attr)u+=v+'="'+t.attr[v]+'"';r="<img "+u+' src="'+t.value+'">',p.item(e).css(t.style),q.item(e).update(r)}},renderSparkLine:function(c,e,f){var g,h,j=this,k=j.widget,l=k.cellHeight,m=k.store,p=j.getColumns(),q=p[c],r=q.width,s=q.key||q.index,t=j.el.select("."+d),u=t.item(c),v=u.select("."+b),w=u.select("."+b+" ."+i),x=q.sparkConfig||{};u.addCls(n),void 0!==e?(g=e,h=e+1):(g=0,h=m.getLength());var y,z=l-1,A=r-20;switch(f){case"line":case"pie":case"box":y="width";break;case"bullet":y="width",z-=11,u.addCls(o);break;case"discrete":y="width",A=r,z-=2;break;case"bar":case"tristate":y="barWidth"}for(;g<h;g++){var B=m.get(g,s),C=m.get(g),D={rowIndex:g,value:B,data:C,style:{}};if(q.render&&(D=q.render(D),B=D.value),a.isArray(q.values)){var E=0,F=q.values.length;for(B=[];E<F;E++)B.push(m.get(g,q.values[E]))}v.item(g).css(D.style);var G=w.item(g).dom,H={type:f,fillColor:"transparent",height:z};a.apply(H,x),"bar"!==f&&"tristate"!==f||(A=r-20,A/=B.length),H[y]=A,a.$(G).sparkline(B,H)}},renderProgressDonut:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),r=p.select("."+b),s=p.select("."+b+" ."+i);for(p.addCls(q),void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var t,u=k.get(f),v={rowIndex:f,data:u,style:{},column:m};t=m.smartIndexFn?m.smartIndexFn(u):k.get(f,n),v.value=t,m.format&&(v.value=h.format(v.value,m.format),t=v.value),m.render&&(v=m.render(v),t=v.value),r.item(f).css(v.style);var w=m.sparkConfig||{},x=s.item(f).dom;a.apply(w,{renderTo:x,value:t}),w.size||w.height||w.width||(w.size=j.cellHeaderHeight-6),a.get(x).update(""),new a.spark.ProgressDonut(w)}},renderGrossLoss:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),s=p.select("."+b+" ."+i);p.addCls(r),void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());var t=m.sparkConfig||{};for(t.showOnMax&&(t.maxValue=Math.max.apply(Math,k.getColumnData(n,m.smartIndexFn)));f<g;f++){var u,v=k.get(f),w={rowIndex:f,data:v,style:{},column:m};u=m.smartIndexFn?m.smartIndexFn(v):k.get(f,n),w.value=u,m.format&&(w.value=h.format(w.value,m.format),u=w.value),m.render&&(w=m.render(w),u=w.value),q.item(f).css(w.style),a.apply(t,{renderTo:s.item(f).dom,value:u,column:m}),new a.spark.GrossLoss(t)}},renderProgressBar:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+i),u=100;p.addCls(s),void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());var v=m.sparkConfig||{};for(!1===v.percents&&(u=Math.max.apply(Math,k.getColumnData(n)));f<g;f++){var w,x=k.get(f),y={rowIndex:f,data:x,style:{},column:m};w=m.smartIndexFn?m.smartIndexFn(x):k.get(f,n),y.value=w,m.format&&(y.value=h.format(y.value,m.format),w=y.value),m.render&&(y=m.render(y),w=y.value),q.item(f).css(y.style);var z=a.get(r.item(f).dom);if(z.select("."+t).length){var A=a.getWidget(z.select("."+t).item(0).attr("id"));A.value=w,A.maxValue=u,A.update()}else a.apply(v,{renderTo:r.item(f).dom,value:w,column:m,maxValue:u}),new a.spark.ProgressBar(v)}},renderHBar:function(c,e){var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[c],n=m.key||m.index,o=h.el.select("."+d),p=o.item(c),q=p.select("."+b),r=p.select("."+b+" ."+i),s=m.sparkConfig||{},t=m.disabled||{};p.addCls(u);var v,w,x={},c=0,y=Number.MIN_VALUE;if(a.isArray(m.index))for(v=m.index.length;c<v;c++){var z=m.index[c];if(!t[z]){x[z]=k.getColumnData(z);var A=Math.max.apply(Math,x[z]);A>y&&(y=A),w=x[z].length}}else{var B=k.getColumnData(m.index),C=[];for(v=B.length;c<v;c++)for(var D=0,E=B[c].length;D<E;D++)t[D]||(x[D]=x[D]||[],x[D].push(B[c][D]));for(var F in x){var A=Math.max.apply(Math,x[F]);C.push(F),A>y&&(y=A),w=x[F].length}m.fields||(m.fields=C)}for(var G=[],H=0;H<w;H++){G[H]=0;for(var F in x)m.fields&&t[m.index+"."+F]||t[F]||(G[H]+=x[F][H])}for(maxValue=Math.max.apply(Math,G),s.maxItemValue=y,void 0!==e?(f=e,g=e+1):(f=0,g=k.getLength());f<g;f++){var I,B=k.get(f),J={rowIndex:f,data:B,style:{},column:m};I=m.smartIndexFn?m.smartIndexFn(B):k.get(f,n),J.value=I,m.format&&(J.value=h.format(J.value,m.format),I=J.value),m.render&&(J=m.render(J),I=J.value),q.item(f).css(J.style);var K=a.get(r.item(f).dom);if(K.select(".fancy-spark-hbar").length){var L=a.getWidget(K.select(".fancy-spark-hbar").item(0).attr("id"));L.maxValue=maxValue,L.maxItemValue=y,L.update(B)}else a.apply(s,{renderTo:r.item(f).dom,value:I,data:B,column:m,maxValue:maxValue,height:j.cellHeight-1}),new a.spark.HBar(s)}},renderCircle:function(a,c){function e(a,b){var c="http://www.w3.org/2000/svg",d=document.createElementNS(c,"svg:svg");d.setAttribute("width",b),d.setAttribute("height",b),d.setAttribute("viewBox","0 0 "+b+" "+b);var e=document.createElementNS(c,"circle");e.setAttributeNS(null,"cx",b/2),e.setAttributeNS(null,"cy",b/2),e.setAttributeNS(null,"r",b/2);var f="#F0F0F0";b>50&&(f="F0F0F0"),a<0&&(f="#F9DDE0"),e.setAttributeNS(null,"fill",f),d.appendChild(e);var g=document.createElementNS(c,"path"),h=2*Math.PI/100,i=0,j=a*h-.001,k=b/2+b/2*Math.sin(i),l=b/2-b/2*Math.cos(i),m=b/2+b/2*Math.sin(j),n=b/2-b/2*Math.cos(j),o=0;j-i>Math.PI&&(o=1);var p="M "+b/2+","+b/2+" L "+k+","+l+" A "+b/2+","+b/2+" 0 "+o+" 1 "+m+","+n+" Z";g.setAttribute("d",p),a<0?g.setAttribute("fill","#EA7369"):g.setAttribute("fill","#44A4D3"),d.appendChild(g);var q=document.createElementNS(c,"circle");return q.setAttributeNS(null,"cx",b/2),q.setAttributeNS(null,"cy",b/2),q.setAttributeNS(null,"r",.25*b),q.setAttributeNS(null,"fill","#fff"),d.appendChild(q),d}var f,g,h=this,j=h.widget,k=j.store,l=h.getColumns(),m=l[a],n=m.key||m.index,o=h.el.select("."+d),q=o.item(a),r=q.select("."+b+" ."+i),s=j.cellHeight-4;for(q.addCls(p),void 0!==c?(f=c,g=c+1):(f=0,g=k.getLength());f<g;f++){var t,u=k.get(f),v={rowIndex:f,data:u,style:{}};t=m.smartIndexFn?m.smartIndexFn(u):k.get(f,n),v.value=t,m.render&&(v=m.render(v),t=v.value);var w=r.item(f).dom;""===w.innerHTML&&w.appendChild(e(t,s))}},removeNotUsedCells:function(){for(var a=this,c=a.widget,e=c.store,f=a.el.select("."+d),g=0,h=f.length;g<h;g++)for(var i=f.item(g),j=i.select("."+b),k=e.getLength(),l=j.length;k<l;k++)j.item(k).remove()},getFormat:function(b){var c=this,d=c.widget,e=d.lang;switch(b){case"number":return function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e.thousandSeparator)};case"date":return function(c){var d=a.Date.parse(c,e.date.read,b.mode);return c=a.Date.format(d,e.date.write,b.mode)}}switch(b.type){case"date":return function(c){if(0===c.length)return"";var d=a.Date.parse(c,b.read,b.mode);return c=a.Date.format(d,b.write,void 0,b.mode)}}if(b.inputFn)return b.inputFn},format:function(b,c){switch(a.typeOf(c)){case"string":b=this.getFormat(c)(b);break;case"function":b=c(b);break;case"object":b=c.inputFn?c.inputFn(b):this.getFormat(c)(b)}return b},enableCellDirty:function(a){a.hasCls(j)||(a.addCls(j),a.append('<div class="'+k+'"></div>'))},clearDirty:function(a){var c=this;if(void 0!==a)return c.el.select("."+b+'[index="'+a+'"] .'+k).destroy(),void c.el.select("."+j+'[index="'+a+'"]').removeCls(j);c.el.select("."+k).destroy(),c.el.select("."+j).removeCls(j)},showEmptyText:function(){var b=this,c=b.widget,d=c.store;if("center"===b.side&&(b.emptyTextEl&&(b.emptyTextEl.destroy(),delete b.emptyTextEl),0===d.dataView.length)){var e=a.get(document.createElement("div"));e.addCls(m),e.update(c.emptyText),b.emptyTextEl=a.get(b.el.dom.appendChild(e.dom))}}}}(),function(){var a=Fancy,b=a.GRID_CELL_CLS,c=a.GRID_CELL_INNER_CLS,d=a.GRID_COLUMN_CLS,e=a.GRID_BODY_CLS,f=a.GRID_CELL_WRAPPER_CLS,g=a.GRID_COLUMN_SELECT_CLS,h=a.GRID_COLUMN_ELLIPSIS_CLS,i=a.GRID_COLUMN_ORDER_CLS,j=a.GRID_COLUMN_TEXT_CLS,k=a.GRID_COLUMN_SPARKLINE_CLS,l=(a.GRID_COLUMN_SPARKLINE_BULLET_CLS,a.GRID_COLUMN_CHART_CIRCLE_CLS),m=a.GRID_COLUMN_SPARK_PROGRESS_DONUT_CLS,n=a.GRID_COLUMN_GROSSLOSS_CLS,o=a.GRID_COLUMN_PROGRESS_CLS,p=(a.GRID_COLUMN_PROGRESS_BAR_CLS,a.GRID_COLUMN_H_BAR_CLS),q=a.ANIMATE_DURATION;a.define("Fancy.grid.Body",{extend:a.Widget,mixins:[a.grid.body.mixin.Updater],cls:e,cellTpl:['<div class="'+c+'">{cellValue}</div>'],cellWrapperTpl:['<div class="'+f+'">','<div class="'+c+'">{cellValue}</div>',"</div>"],constructor:function(){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.addEvents("adddomcolumns"),a.initTpl(),a.render(),a.ons()},initTpl:function(){var b=this;b.cellTpl=new a.Template(b.cellTpl),b.cellWrapperTpl=new a.Template(b.cellWrapperTpl)},ons:function(){var a=this,c=a.widget,e=c.id;c.on("afterrender",a.onAfterRender,a);var f="."+d+'[grid="'+e+'"]',g=f+" div."+b;a.el.on("click",a.onCellClick,a,g),a.el.on("dblclick",a.onCellDblClick,a,g),a.el.on("mouseenter",a.onCellMouseEnter,a,g),a.el.on("mouseleave",a.onCellMouseLeave,a,g),a.el.on("mousedown",a.onCellMouseDown,a,g),a.el.on("mouseenter",a.onColumnMouseEnter,a,f),a.el.on("mouseleave",a.onColumnMouseLeave,a,f)},render:function(){var b,c=this,d=c.widget,f=a.get(document.createElement("div"));f.addCls(e),b=d.el.select(".fancy-grid-"+c.side).dom,c.el=a.get(b.appendChild(f.dom))},onAfterRender:function(){this.update(),this.setHeight()},setColumnsPosition:function(a){var b=this,c=b.widget,e=b.getColumns(),f=0,g=e.length,h=0,i=b.el.select("."+d+'[grid="'+c.id+'"]'),a=a||b.scrollLeft||0;for(h+=a;f<g;f++){var j=e[f];i.item(f).css({left:h+"px"}),j.hidden||(h+=j.width)}},wheelScroll:function(a){var b=this,c=b.widget,e=c.knobOffSet,f=b.el.select("."+d+'[grid="'+c.id+'"]');if(0!==f.length){for(var g=parseInt(f.item(0).css("top")),h=0,i=f.length,j=c.getBodyHeight(),k=c.getCellsViewHeight(),l=k-j+e,m={oldScroll:parseInt(f.item(0).css("top")),newScroll:parseInt(f.item(0).css("top"))+30*a,deltaScroll:30*a};h<i;h++){var n=f.item(h),o=parseInt(n.css("top"))+30*a;o>0?(o=0,m.newScroll=0):Math.abs(o)>l&&(o=-l-e,m.newScroll=o),n.css("top",o+"px")}return m.scrolled=g!==parseInt(f.item(0).css("top")),m}},scroll:function(a,b){var c=this,e=c.widget,f=c.el.select("."+d+'[grid="'+e.id+'"]'),g=0,h=f.length,i={};if(!1!==a&&null!==a&&void 0!==a)for(i.scrollTop=a;g<h;g++){var j=f.item(g);j.css("top",-a+"px")}return!1!==b&&null!==b&&void 0!==b&&(i.scrollLeft=b,e.header&&e.header.scroll(b),c.scrollLeft=b,e.body.setColumnsPosition(b),"center"===c.side&&(e.grouping&&e.grouping.scrollLeft(b),e.summary&&e.summary.scrollLeft(b))),i},setHeight:function(){var a=this.widget.getBodyHeight();this.css("height",a+"px")},onCellClick:function(a){var b=this,c=b.widget;c.fire("cellclick",b.getEventParams(a)),c.fire("rowclick",b.getEventParams(a)),c.fire("columnclick",b.getColumnEventParams(a)),!1===c.activated&&(c.activated=!0,c.fire("activate"))},onCellDblClick:function(a){var b=this,c=b.widget;c.fire("celldblclick",b.getEventParams(a)),c.fire("rowdblclick",b.getEventParams(a)),c.fire("columndblclick",b.getColumnEventParams(a))},getEventParams:function(b){var c=this,d=c.widget,e=d.store,f=c.getColumns(),g=b.currentTarget,h=a.get(b.currentTarget),i=h.parent();if(void 0===h.parent().dom)return!1;if(0===e.getLength())return!1;var j=parseInt(i.attr("index")),k=parseInt(h.attr("index")),l=f[j],m=l.index||l.key,n=e.get(k,m),o=e.getId(k),p=e.get(k),q=e.getById(o);return l.smartIndexFn&&(n=l.smartIndexFn(p)),{e:b,id:o,side:c.side,cell:g,column:l,rowIndex:k,columnIndex:j,value:n,data:p,item:q}},getColumnEventParams:function(b){var c=this,d=c.widget,e=d.store,f=a.get(b.currentTarget),g=f.parent(),h=parseInt(g.attr("index")),i=c.getColumns(),j=i[h],k={e:b,side:c.side,columnIndex:h,column:j,columnDom:g.dom};return d.columnClickData&&(k.data=e.getColumnData(j.index,j.smartIndexFn)),k},getColumnHoverEventParams:function(b){var c=this,d=a.get(b.currentTarget),e=parseInt(d.attr("index")),f=c.getColumns(),g=f[e];return{e:b,side:c.side,columnIndex:e,column:g,columnDom:d.dom}},getColumns:function(){return this.widget.getColumns(this.side)},onCellMouseEnter:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;a.nojQuery&&f&&c.fixZeptoBug&&(e.rowIndex===f.rowIndex&&e.columnIndex===f.columnIndex&&e.side===f.side||(d.fire("cellleave",f),e.rowIndex!==f.rowIndex&&d.fire("rowleave",f))),f?e.rowIndex!==c.prevCellOver.rowIndex&&d.fire("rowenter",e):d.fire("rowenter",e),d.fire("cellenter",e),c.prevCellOver=e},onCellMouseDown:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f={e:e.e,side:e.side,columnDom:a.get(e.cell).parent().dom,column:e.column,columnIndex:e.columnIndex};d.fire("beforecellmousedown",e),d.fire("cellmousedown",e),d.fire("columnmousedown",f)},onCellMouseLeave:function(b){var c=this,d=c.widget,e=c.getEventParams(b),f=c.prevCellOver;if(a.nojQuery){if(void 0===f)return;return void(c.fixZeptoBug=e)}d.fire("rowleave",f),d.fire("cellleave",f),delete c.prevCellOver},onColumnMouseEnter:function(a){var b=this,c=b.widget,d=b.getColumnHoverEventParams(a);b.prevColumnOver?b.prevCellOver&&d.rowIndex!==b.prevCellOver.rowIndex&&c.fire("rowenter",d):c.fire("columnenter",d),b.prevColumnOver=d},onColumnMouseLeave:function(a){var b=this;b.widget.fire("columnleave",b.prevColumnOver),delete b.prevColumnOver},getCell:function(a,c){var e=this,f=e.widget;return this.el.select("."+d+'[index="'+c+'"][grid="'+f.id+'"] .'+b+'[index="'+a+'"]')},getDomCell:function(a,c){var e=this,f=e.widget;return e.el.select("."+d+'[index="'+c+'"][grid="'+f.id+'"] .'+b+'[index="'+a+'"]').dom},getDomColumn:function(a){var b=this,c=b.widget;return b.el.select("."+d+'[index="'+a+'"][grid="'+c.id+'"]').dom},destroy:function(){var a=this,c=a.el,e="div."+b,f="div."+d;c.un("click",a.onCellClick,a,e),c.un("dblclick",a.onCellDblClick,a,e),c.un("mouseenter",a.onCellMouseEnter,a,e),c.un("mouseleave",a.onCellMouseLeave,a,e),c.un("mousedown",a.onCellMouseDown,a,e),c.un("mouseenter",a.onColumnMouseEnter,a,f),c.un("mouseleave",a.onColumnMouseLeave,a,f)},hideColumn:function(a){var b=this,c=b.el.select("."+d),e=c.item(a),f=parseInt(e.css("width")),g=a+1,h=c.length;for(e.hide();g<h;g++){var i=c.item(g),j=parseInt(i.css("left"))-f;i.css("left",j)}},showColumn:function(a){var b,c=this,e=c.el.select("."+d),f=e.item(a),g=a+1,h=e.length;for(f.show(),b=parseInt(f.css("width"));g<h;g++){var i=e.item(g),j=parseInt(i.css("left"))+b;i.css("left",j)}},removeColumn:function(a){var b=this,c=b.el.select("."+d),e=c.item(a),f=parseInt(e.css("width")),g=a+1,h=c.length;for(e.destroy();g<h;g++){var i=c.item(g),j=parseInt(i.css("left"))-f;i.attr("index",g-1),i.css("left",j)}},insertColumn:function(b,c){var e,f=this,k=f.widget,l=f.getColumns(),m=f.el.select("."+d),n=c.width,o=a.get(document.createElement("div")),p=b,q=m.length,r=0,s=0,t=b;for("center"===f.side&&(r=-k.scroller.scrollLeft);s<t;s++)r+=l[s].width;for(e=r;p<q;p++){var u=m.item(p);r=parseInt(u.css("left"))+c.width,u.css("left",r),u.attr("index",p+1)}if(o.addCls(d),o.attr("grid",k.id),"$selected"===c.index)o.addCls(g);else switch(c.type){case"order":o.addCls(i)}if(c.cls&&o.addCls(c.cls),"text"===c.type&&o.addCls(j),o.css({width:n+"px"}),o.attr("index",b),c.cellAlign&&o.css("text-align",c.cellAlign),!0===c.ellipsis)switch(c.type){case"string":case"text":case"number":o.addCls(h)}var v=k.scroller.getScroll();o.css("top",-v),0===b&&m.length?(o.css("left","0px"),f.el.dom.insertBefore(o.dom,m.item(b).dom)):0!==b&&m.length&&(b===m.length?(o.css("left",r+"px"),f.el.dom.appendChild(o.dom)):(o.css("left",e+"px"),f.el.dom.insertBefore(o.dom,m.item(b).dom))),f.checkDomCells(),f.updateRows(void 0,b)},reSetIndexes:function(){var b=this,c=b.getColumns();a.each(c,function(a,c){b.el.select("."+d+'[index="'+c+'"]').attr("index",c)})},clearColumnsStyles:function(){this.el.select("div."+b).each(function(a){a.css("color",""),a.css("background-color","")})},updateColumnsSizes:function(){var b=this,c=b.widget,e=b.getColumns(),f=0;"center"===b.side&&(f=-c.scroller.scrollLeft),a.each(e,function(a,c){b.el.select("."+d+'[index="'+c+'"]').animate({width:a.width,left:f},q),f+=a.width})},reSetColumnsAlign:function(){var a=this,b=a.getColumns();this.el.select("."+d).each(function(a,c){var d=b[c];a.css("text-align",d.cellAlign||"")})},reSetColumnsCls:function(){var b=this,c=b.getColumns();this.el.select("."+d).each(function(b,e){var f=c[e],g=b.attr("class").split(" ");a.each(g,function(a){switch(a){case d:case f.cls:case r[f.type]:break;default:b.removeCls(a)}}),f.cls&&b.addCls(f.cls),"order"===f.type&&b.addCls(i),f.menu})}});var r={sparklineline:k,sparklinebar:k,sparklinetristate:k,sparklinediscrete:k,sparklinebullet:k,sparklinepie:k,sparklinebox:k,circle:l,progressdonut:m,grossloss:n,progressbar:o,hbar:p}}(),function(){var a=Fancy,b=a.GRID_HEADER_CLS,c=a.GRID_HEADER_CELL_CLS,d=a.GRID_HEADER_CELL_CONTAINER_CLS,e=a.GRID_HEADER_CELL_TEXT_CLS,f=a.GRID_HEADER_CELL_TRIGGER_CLS,g=a.GRID_HEADER_CELL_TRIGGER_IMAGE_CLS,h=a.GRID_HEADER_CELL_TRIGGER_DISABLED_CLS,i=a.GRID_HEADER_CELL_GROUP_LEVEL_1_CLS,j=a.GRID_HEADER_CELL_GROUP_LEVEL_2_CLS,k=a.GRID_HEADER_CELL_SELECT_CLS,l=a.GRID_HEADER_CELL_FILTER_FULL_CLS,m=a.GRID_HEADER_CELL_FILTER_SMALL_CLS,n=a.GRID_HEADER_CELL_TRIPLE_CLS,o=a.ANIMATE_DURATION;a.define("Fancy.grid.Header",{extend:a.Widget,cls:b,mixins:["Fancy.grid.header.mixin.Menu"],cellTpl:['<div class="'+c+' {cls}" style="display:{display};width:{columnWidth}px;height: {height};left: {left};" {groupIndex} index="{index}">','<div class="'+d+'" style="height: {height};">','<span class="'+e+'">{columnName}</span>','<span class="'+f+'">','<div class="'+g+'"></div>',"</span>","</div>","</div>"],constructor:function(a){this.Super("const",arguments)},init:function(){var a=this;a.Super("init",arguments),a.initTpl(),a.render(),a.renderHeaderCheckBox(),a.setAlign(),a.setCellsPosition(),a.ons()},initTpl:function(){this.cellTpl=new a.Template(this.cellTpl)},ons:function(){var a=this,b=a.widget,d=a.el,e="div."+c;b.on("render",a.onAfterRender,a),b.on("docmove",a.onDocMove,a),d.on("click",a.onTriggerClick,a,"span."+f),d.on("click",a.onCellClick,a,e),d.on("mousemove",a.onCellMouseMove,a,e),d.on("mousedown",a.onCellMouseDown,a,e),d.on("mousedown",a.onMouseDown,a)},render:function(){var b,c=this,d=c.widget,e=c.getColumns(),f=a.get(document.createElement("div")),g="",j=0,n=e.length,o=1,p={},q=0,r=d.filter&&d.filter.header,s="full",t=d.cellHeaderHeight;for(d.groupheader&&(r&&!d.filter.groupHeader?s="small":o=2),r&&o++;j<n;j++){var u=e[j],v=u.title||u.header,w=t,x="",y="";if(1!==o&&(u.grouping?(p[u.grouping]||(p[u.grouping]={width:0,title:u.grouping,left:q}),w=r&&d.filter.groupHeader?2*t+"px":t+"px",u.hidden||(p[u.grouping].width+=u.width),y='group-index="'+u.grouping+'"',x=i):w=o*t+"px"),q+=u.width,"$selected"===u.index&&(x+=" "+k),u.menu||(x+=" "+h),u.filter&&u.filter.header)switch(s){case"small":x+=" "+m;break;case"full":x+=" "+l}g+=c.cellTpl.getHTML({cls:x,columnName:v,columnWidth:u.width,index:j,height:w,left:"initial",groupIndex:y,display:u.hidden?"none":""})}f.css({height:t*o+"px",width:c.getColumnsWidth()}),f.addCls(c.cls),d.groupheader&&(f.addCls("fancy-grid-header-grouped"),g+=c.getGroupingCellsHTML(p)),f.update(g),b=d.el.select(".fancy-grid-"+c.side).dom,c.el=a.get(b.appendChild(f.dom))},insertCell:function(b,d){var e=this,f=e.widget,g=e.el.select("."+c+":not(."+j+")"),i=e.getColumns(),l="",m=d.title||d.header,n=parseInt(g.item(0).css("height")),o="",p=0;if("center"===e.side&&(p=-f.scroller.scrollLeft),f.groupheader){n=2*f.cellHeight;var q=e.el.select("."+j);b!==f.columns.length-1&&q.each(function(a){var b=parseInt(a.css("left")||0)+d.width;a.css("left",b)})}"$selected"===d.index&&(l+=" "+k),d.menu||(l+=" "+h);for(var r=0,s=b;r<s;r++)p+=i[r].width;for(var t=b,u=i.length-1;t<u;t++){var v=g.item(t),w=parseInt(v.css("left")||0)+d.width;v.css("left",w)}var x=e.cellTpl.getHTML({cls:l,columnName:m,columnWidth:d.width,index:b,height:String(n)+"px",left:String(p)+"px",groupIndex:o});0===b&&g.length?a.get(g.item(0).before(x)):0!==b&&g.length&&(b===g.length?e.el.append(x):a.get(g.item(b).before(x))),e.css("width",parseInt(e.css("width"))+d.width)},setAlign:function(){for(var a=this,b=a.getColumns(),c=0,d=b.length;c<d;c++){var e=b[c];e.align&&a.getDomCell(c).css("text-align",e.align)}},onAfterRender:function(){},setCellsPosition:function(){var b=this,d=b.widget,e=b.getColumns(),f=0,g=b.el.select("."+c);if(f+=b.scrollLeft||0,a.each(e,function(a,b){var c=g.item(b),e="0px";a.grouping&&(e=d.cellHeaderHeight+"px"),c.css({top:e,left:f+"px"}),a.hidden||(f+=a.width)}),d.groupheader){b.el.select("."+j).each(function(c){var d=c.attr("index"),f=b.el.select('[group-index="'+d+'"]'),g=f.item(0).css("left"),h=0;a.each(e,function(a){a.grouping!==d||a.hidden||(h+=a.width)}),c.css("left",g),c.css("width",h)})}},fixGroupHeaderSizing:function(){var b=this,d=b.widget,e=d.cellHeaderHeight,f=b.getColumns(),g=b.el.select("."+c),h=0,k={},n={},o={},p=b.calcRows();"center"===b.side&&(h=d.scroller.scrollLeft),a.each(f,function(a,b){var c=g.item(b),f=a.grouping,j="0px",q=e*p;k[f]=!0,f?(void 0===n[f]?(n[f]=a.width,o[f]=h):n[f]+=a.width,c.addCls(i),j=e+"px",q=e,a.filter&&a.filter.header&&(q=2*e,setTimeout(function(){c.addCls(l)},30))):(c.removeCls(i),a.filter&&a.filter.header&&(setTimeout(function(){c.addCls(m)},30),c.addCls(m))),!d.groupheader||q!==e||f||a.filter||(q=2*e),c.css({top:j,height:q}),h+=a.width});for(var q in n){b.el.select('[index="'+q+'"]').css({left:o[q],width:n[q]})}b.el.select("."+j).each(function(a){var b=a.attr("index");k[b]||a.destroy()})},getColumnsWidth:function(){for(var a=this,b=a.getColumns(),c=0,d=0,e=b.length;d<e;d++){c+=b[d].width}return c},getColumns:function(){var a,b=this,c=b.widget;switch(b.side){case"left":a=c.leftColumns;break;case"center":a=c.columns;break;case"right":a=c.rightColumns}return a},getDomCell:function(a){return this.el.select("."+c).item(a)},onCellClick:function(b){var c=this,d=c.widget,e=d.columndrag,h=b.currentTarget,i=a.get(b.target),k=parseInt(a.get(h).attr("index"));e&&"dragging"===e.status||i.hasCls(f)||i.hasCls(g)||a.get(h).hasCls(j)||d.fire("headercellclick",{e:b,side:c.side,cell:h,index:k})},onCellMouseMove:function(b){var c=this,d=c.widget,e=b.currentTarget,f=a.get(e),g=f.hasCls(j),h=parseInt(a.get(e).attr("index"));g||d.fire("headercellmousemove",{e:b,side:c.side,cell:e,index:h})},onMouseDown:function(b){"INPUT"===a.get(b.target).prop("tagName")||b.preventDefault()},onCellMouseDown:function(b){var c=this.widget,d=b.currentTarget,e=parseInt(a.get(d).attr("index"));c.fire("headercellmousedown",{e:b,side:this.side,cell:d,index:e})},scroll:function(a){this.scrollLeft=a,this.setCellsPosition()},getGroupingCellsHTML:function(b){var c=this,d=c.widget,e="";return a.each(b,function(a,b){e+=c.cellTpl.getHTML({cls:j,columnName:a.title,columnWidth:a.width,index:b,height:d.cellHeaderHeight+"px",left:a.left+"px",groupIndex:""})}),e},destroy:function(){var a=this,b=a.el,d="div."+c;b.un("click",a.onCellClick,a,d),b.un("mousemove",a.onCellMouseMove,a,d),b.un("mousedown",a.onCellMouseDown,a,d),b.un("mousedown",a.onMouseDown,a)},getCell:function(a){return this.el.select("."+c+'[index="'+a+'"]')},onTriggerClick:function(b){var c=this,d=a.get(b.currentTarget),e=d.parent().parent(),f=parseInt(e.attr("index")),g=c.getColumns(),h=g[f];b.stopPropagation(),c.showMenu(e,f,h,g)},hideCell:function(b){var d=this,e=d.el.select("."+c+":not(."+j+")"),f=e.item(b),g=parseInt(f.css("width")),h=b+1,k=e.length,l=d.getColumns();if(f.hasCls(i)){var m=f.attr("group-index"),n=d.el.select("."+j+'[index="'+m+'"]').item(0),o=parseInt(n.css("width"));n.css("width",o-g)}f.hide();for(var p={};h<k;h++){var q=e.item(h),r=parseInt(q.css("left"))-g,s=l[h];s.grouping&&l[b].grouping!==s.grouping&&(p[s.grouping]=!0),q.css("left",r)}a.each(p,function(a,b){var c=d.el.select("."+j+'[index="'+b+'"]').item(0);c.css("left",parseInt(c.css("left"))-g)})},showCell:function(a){var b,d=this,e=d.el.select("."+c+":not(."+j+")"),f=e.item(a),g=a+1,h=e.length,k=d.getColumns();if(f.show(),b=parseInt(f.css("width")),f.hasCls(i)){var l=f.attr("group-index"),m=d.el.select("."+j+'[index="'+l+'"]').item(0),n=parseInt(m.css("width"));m.css("width",n+b)}for(var o={};g<h;g++){var p=e.item(g),q=parseInt(p.css("left"))+b,r=k[g];r.grouping&&k[a].grouping!==r.grouping&&(o[r.grouping]=!0),p.css("left",q)}for(var s in o){var m=d.el.select("."+j+'[index="'+s+'"]').item(0);m.css("left",parseInt(m.css("left"))+b)}},removeCell:function(a){var b=this,d=b.el.select("."+c+":not(."+j+")"),e=d.item(a),f=parseInt(e.css("width")),g=a+1,h=d.length,i={},k=!1;for(e.attr("group-index")&&(k=e.attr("group-index"),i[k]=!0),e.destroy();g<h;g++){var l=d.item(g),m=parseInt(l.css("left"))-f;l.attr("group-index")&&(i[l.attr("group-index")]=!0),l.attr("index",g-1),l.css("left",m)}for(var n in i){var o=b.el.select('[index="'+n+'"]'),p=parseInt(o.css("width"))-f,q=parseInt(o.css("left"))-f;k&&o?(o.css("width",p),o.attr("index")!==k&&o.css("left",q)):o.css("left",q)}if(k&&0===b.el.select('[group-index="'+k+'"]').length){var o=b.el.select('[index="'+k+'"]');o.destroy()}"center"!==b.side&&b.css("width",parseInt(b.css("width"))-f)},renderHeaderCheckBox:function(){for(var b=this,d=b.widget,f=b.getColumns(),g=0,h=f.length,i=b.el.select("."+c+":not(."+j+")");g<h;g++){var k=f[g];if(!0===k.headerCheckBox){var l=i.item(g),m=l.firstChild(),n=l.select("."+e),o=n.dom.innerHTML,p=o||!1,q=0;l.addCls("fancy-grid-header-cell-checkbox"),n.update(""),p.length&&(q=15*p.width),k.headerCheckBox=new a.CheckBox({renderTo:m.dom,renderId:!0,labelWidth:q,value:!1,label:p,labelAlign:"right",style:{padding:"0px",display:"inline-block"},events:[{change:function(a,b){for(var c=0,e=d.getViewTotal();c<e;c++)d.set(c,k.index,b)}}]})}}},reSetIndexes:function(){this.el.select("."+c+":not(."+j+")").each(function(a,b){a.attr("index",b)})},reSetGroupIndexes:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){var d=b[c],e=d.grouping;a.attr("group-index")&&!e?a.removeAttr("group-index"):e&&a.attr("group-index")!==e&&a.attr("group-index",e)})},updateTitles:function(){var b=this,d=b.getColumns();a.each(d,function(a,d){b.el.select("div."+c+'[index="'+d+'"] .'+e).update(a.title||"")})},updateCellsSizes:function(){var b=this,d=b.widget,e=b.getColumns(),f=0;"center"===b.side&&(f=-d.scroller.scrollLeft),a.each(e,function(a,d){b.el.select("div."+c+'[index="'+d+'"]').animate({width:a.width,left:f},o),f+=a.width})},calcRows:function(){var a=this,b=a.widget,c=b.columns.concat(b.leftColumns).concat(b.rightColumns),d=1;if(Fancy.each(c,function(a){a.grouping&&(d<2&&(d=2),a.filter&&a.filter.header&&d<3&&(d=3)),a.filter&&a.filter.header&&d<2&&(d=2)}),b.groupheader&&2===d){b.el.select("."+n).length&&(d=3)}return d},reSetColumnsAlign:function(){var a=this,b=a.getColumns();this.el.select("."+c+":not(."+j+")").each(function(a,c){var d=b[c];a.css("text-align",d.align||"")})},destroyMenus:function(){},onDocMove:function(){var a=this,b=a.widget;("none"===b.el.css("display")||b.panel&&b.panel.el&&"none"===b.panel.el.css("display")&&a.hideMenu)&&a.hideMenu()},reSetColumnsCls:function(){var a=this,b=(a.widget,a.getColumns());this.el.select("."+c+":not(."+j+")").each(function(a,c){b[c].menu?a.removeCls(h):a.addCls(h)})}})}();